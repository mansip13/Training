[0m11:05:33.105163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abdcfeefb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abdd14fadb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abdcfeec470>]}


============================== 11:05:33.123070 | 2c5d31db-909a-470f-9c7d-d91a0f54a06e ==============================
[0m11:05:33.123070 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:05:33.124848 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:05:33.203239 [info ] [MainThread]: dbt version: 1.9.0
[0m11:05:33.204151 [info ] [MainThread]: python version: 3.12.4
[0m11:05:33.205241 [info ] [MainThread]: python path: /usr/local/bin/python
[0m11:05:33.206118 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m11:05:33.207710 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m11:05:33.208617 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m11:05:33.209310 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m11:05:33.416760 [info ] [MainThread]: Configuration:
[0m11:05:33.418776 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m11:05:33.419634 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:05:33.420379 [info ] [MainThread]: Required dependencies:
[0m11:05:33.421089 [debug] [MainThread]: Executing "git --help"
[0m11:05:33.426139 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:05:33.426931 [debug] [MainThread]: STDERR: "b''"
[0m11:05:33.427538 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:05:33.428374 [info ] [MainThread]: Connection test skipped since no profile was found
[0m11:05:33.429223 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:05:33.429969 [info ] [MainThread]: dbt looked for a profiles.yml file in /root/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m11:05:33.434612 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.42924336, "process_in_blocks": "0", "process_kernel_time": 0.537718, "process_mem_max_rss": "88384", "process_out_blocks": "1480", "process_user_time": 2.973748}
[0m11:05:33.436826 [debug] [MainThread]: Command `dbt debug` failed at 11:05:33.436551 after 0.43 seconds
[0m11:05:33.438308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abdd18f33e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abdcfa6e6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abdcfc7c560>]}
[0m11:05:33.439981 [debug] [MainThread]: Flushing usage events
[0m11:05:34.799217 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:11:17.364707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b328a14ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b32854fcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b3287f1af0>]}


============================== 11:11:17.374619 | 2e11cf84-876e-4bae-90cb-3b7cff3ba151 ==============================
[0m11:11:17.374619 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:11:17.375744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:11:17.379140 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'my_project'
[0m11:11:17.381099 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.09143526, "process_in_blocks": "64", "process_kernel_time": 0.388102, "process_mem_max_rss": "86908", "process_out_blocks": "1472", "process_user_time": 1.924509}
[0m11:11:17.382209 [debug] [MainThread]: Command `dbt run` failed at 11:11:17.382048 after 0.09 seconds
[0m11:11:17.383632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b3286ddbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b32828bbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b32854fcb0>]}
[0m11:11:17.385041 [debug] [MainThread]: Flushing usage events
[0m11:11:18.783154 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:14:04.250398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79db4be0fda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79db4bb6e660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79db4d7ccc50>]}


============================== 11:14:04.260861 | ebdc667d-ca0b-47f5-80c7-15ce97ac67b0 ==============================
[0m11:14:04.260861 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:14:04.261938 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:14:04.318715 [info ] [MainThread]: dbt version: 1.9.0
[0m11:14:04.319295 [info ] [MainThread]: python version: 3.12.4
[0m11:14:04.319911 [info ] [MainThread]: python path: /usr/local/bin/python
[0m11:14:04.320636 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m11:14:04.321434 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m11:14:04.322229 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m11:14:04.322785 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m11:14:04.464948 [info ] [MainThread]: Configuration:
[0m11:14:04.465678 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m11:14:04.466438 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:14:04.467271 [info ] [MainThread]: Required dependencies:
[0m11:14:04.468002 [debug] [MainThread]: Executing "git --help"
[0m11:14:04.472687 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:14:04.473423 [debug] [MainThread]: STDERR: "b''"
[0m11:14:04.473979 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:14:04.474774 [info ] [MainThread]: Connection test skipped since no profile was found
[0m11:14:04.475692 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:14:04.476714 [info ] [MainThread]: dbt looked for a profiles.yml file in /root/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m11:14:04.479580 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.4705232, "process_in_blocks": "64", "process_kernel_time": 0.452305, "process_mem_max_rss": "88600", "process_out_blocks": "1480", "process_user_time": 2.041377}
[0m11:14:04.481345 [debug] [MainThread]: Command `dbt debug` failed at 11:14:04.480998 after 0.47 seconds
[0m11:14:04.482947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79db4ba5b980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79db4b797ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79db4d6cb410>]}
[0m11:14:04.484608 [debug] [MainThread]: Flushing usage events
[0m11:14:05.816547 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:16:42.549697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac9c8b9efc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac9ca094c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac9c8d43b60>]}


============================== 11:16:42.561099 | 2fef4d78-a631-4b3a-97bc-10c4e4b67977 ==============================
[0m11:16:42.561099 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:16:42.562776 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:16:42.618185 [info ] [MainThread]: dbt version: 1.9.0
[0m11:16:42.618898 [info ] [MainThread]: python version: 3.12.4
[0m11:16:42.619732 [info ] [MainThread]: python path: /usr/local/bin/python
[0m11:16:42.620553 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m11:16:42.621356 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m11:16:42.622036 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m11:16:42.622655 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m11:16:42.768325 [info ] [MainThread]: Configuration:
[0m11:16:42.769094 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m11:16:42.770030 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:16:42.770887 [info ] [MainThread]: Required dependencies:
[0m11:16:42.771747 [debug] [MainThread]: Executing "git --help"
[0m11:16:42.776335 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:16:42.776968 [debug] [MainThread]: STDERR: "b''"
[0m11:16:42.777498 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:16:42.778345 [info ] [MainThread]: Connection test skipped since no profile was found
[0m11:16:42.779221 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:16:42.780102 [info ] [MainThread]: dbt looked for a profiles.yml file in /root/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m11:16:42.782429 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.3103413, "process_in_blocks": "0", "process_kernel_time": 0.360726, "process_mem_max_rss": "88892", "process_out_blocks": "1480", "process_user_time": 2.132297}
[0m11:16:42.784526 [debug] [MainThread]: Command `dbt debug` failed at 11:16:42.783937 after 0.31 seconds
[0m11:16:42.785614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac9c8b9efc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac9c841f380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac9c8b22930>]}
[0m11:16:42.787272 [debug] [MainThread]: Flushing usage events
[0m11:16:44.136018 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:20:39.403998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76268635e480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76268465fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762684e2caa0>]}


============================== 11:20:39.413730 | fc48f8ec-8798-4d97-883f-90b07c160e08 ==============================
[0m11:20:39.413730 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:20:39.414743 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:20:39.473942 [info ] [MainThread]: dbt version: 1.9.0
[0m11:20:39.474592 [info ] [MainThread]: python version: 3.12.4
[0m11:20:39.475421 [info ] [MainThread]: python path: /usr/local/bin/python
[0m11:20:39.476434 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m11:20:39.477602 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m11:20:39.478557 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m11:20:39.479429 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m11:20:39.666259 [info ] [MainThread]: Configuration:
[0m11:20:39.667020 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m11:20:39.667945 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:20:39.668752 [info ] [MainThread]: Required dependencies:
[0m11:20:39.669557 [debug] [MainThread]: Executing "git --help"
[0m11:20:39.674363 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:20:39.675350 [debug] [MainThread]: STDERR: "b''"
[0m11:20:39.676054 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:20:39.678005 [info ] [MainThread]: Connection test skipped since no profile was found
[0m11:20:39.680311 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:20:39.681432 [info ] [MainThread]: dbt looked for a profiles.yml file in /root/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m11:20:39.684133 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.36215097, "process_in_blocks": "0", "process_kernel_time": 0.413308, "process_mem_max_rss": "88648", "process_out_blocks": "1480", "process_user_time": 2.102657}
[0m11:20:39.685477 [debug] [MainThread]: Command `dbt debug` failed at 11:20:39.685122 after 0.36 seconds
[0m11:20:39.686290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7626862c8530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762684246420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762684368080>]}
[0m11:20:39.687189 [debug] [MainThread]: Flushing usage events
[0m11:20:41.450917 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:23:57.697307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6c46ffdc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6c471403b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6c4590c1d0>]}


============================== 11:23:57.708732 | d11a28af-e47f-4d9e-8567-7cfd3380262f ==============================
[0m11:23:57.708732 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:23:57.710029 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:23:57.782831 [info ] [MainThread]: dbt version: 1.9.0
[0m11:23:57.783607 [info ] [MainThread]: python version: 3.12.4
[0m11:23:57.784478 [info ] [MainThread]: python path: /usr/local/bin/python
[0m11:23:57.785155 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m11:23:57.911974 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m11:23:57.912624 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m11:23:57.913511 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m11:23:57.914727 [info ] [MainThread]: adapter type: postgres
[0m11:23:57.915570 [info ] [MainThread]: adapter version: 1.9.0
[0m11:23:58.144547 [info ] [MainThread]: Configuration:
[0m11:23:58.145446 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:23:58.146526 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:23:58.147303 [info ] [MainThread]: Required dependencies:
[0m11:23:58.148147 [debug] [MainThread]: Executing "git --help"
[0m11:23:58.153257 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:23:58.154569 [debug] [MainThread]: STDERR: "b''"
[0m11:23:58.155347 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:23:58.156234 [info ] [MainThread]: Connection:
[0m11:23:58.157030 [info ] [MainThread]:   host: db
[0m11:23:58.157909 [info ] [MainThread]:   port: 5432
[0m11:23:58.158848 [info ] [MainThread]:   user: db_user
[0m11:23:58.159645 [info ] [MainThread]:   database: db
[0m11:23:58.160503 [info ] [MainThread]:   schema: dev
[0m11:23:58.161560 [info ] [MainThread]:   connect_timeout: 10
[0m11:23:58.162473 [info ] [MainThread]:   role: None
[0m11:23:58.163429 [info ] [MainThread]:   search_path: None
[0m11:23:58.164174 [info ] [MainThread]:   keepalives_idle: 0
[0m11:23:58.165287 [info ] [MainThread]:   sslmode: None
[0m11:23:58.166726 [info ] [MainThread]:   sslcert: None
[0m11:23:58.168463 [info ] [MainThread]:   sslkey: None
[0m11:23:58.169988 [info ] [MainThread]:   sslrootcert: None
[0m11:23:58.171569 [info ] [MainThread]:   application_name: dbt
[0m11:23:58.172684 [info ] [MainThread]:   retries: 1
[0m11:23:58.174121 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:23:58.337369 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m11:23:58.394179 [debug] [MainThread]: Using postgres connection "debug"
[0m11:23:58.394734 [debug] [MainThread]: On debug: select 1 as id
[0m11:23:58.395212 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:23:58.415643 [debug] [MainThread]: SQL status: SELECT 1 in 0.020 seconds
[0m11:23:58.417885 [debug] [MainThread]: On debug: Close
[0m11:23:58.418769 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:23:58.419719 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:23:58.425524 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.821539, "process_in_blocks": "0", "process_kernel_time": 0.518445, "process_mem_max_rss": "101596", "process_out_blocks": "1520", "process_user_time": 2.879802}
[0m11:23:58.426389 [debug] [MainThread]: Command `dbt debug` succeeded at 11:23:58.426221 after 0.82 seconds
[0m11:23:58.426866 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:23:58.427351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6c45e5b8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6c4514cfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6c45d3c4a0>]}
[0m11:23:58.428071 [debug] [MainThread]: Flushing usage events
[0m11:24:00.203318 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:24:37.230867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a25bf683980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a25bfaf33b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a25c1284380>]}


============================== 11:24:37.241351 | 77942875-3222-4b26-9830-75671d3154d3 ==============================
[0m11:24:37.241351 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:24:37.242329 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:24:37.612829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77942875-3222-4b26-9830-75671d3154d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a25bd9c1cd0>]}
[0m11:24:37.720723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77942875-3222-4b26-9830-75671d3154d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a25bf3936b0>]}
[0m11:24:37.722453 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:24:37.884188 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:24:37.887816 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:24:37.889300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '77942875-3222-4b26-9830-75671d3154d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a25bda74ec0>]}
[0m11:24:40.093578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77942875-3222-4b26-9830-75671d3154d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a25bc548830>]}
[0m11:24:40.227966 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:24:40.233056 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:24:40.610412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77942875-3222-4b26-9830-75671d3154d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a25bd81b440>]}
[0m11:24:40.612370 [info ] [MainThread]: Found 2 models, 4 data tests, 429 macros
[0m11:24:40.617033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77942875-3222-4b26-9830-75671d3154d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a25bd77be00>]}
[0m11:24:40.622275 [info ] [MainThread]: 
[0m11:24:40.623649 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:24:40.624637 [info ] [MainThread]: 
[0m11:24:40.626190 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:24:40.639847 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:24:40.759775 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:24:40.760481 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:24:40.760922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:24:40.798912 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.037 seconds
[0m11:24:40.805299 [debug] [ThreadPool]: On list_db: Close
[0m11:24:40.808321 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m11:24:40.825009 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:24:40.825888 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:24:40.826488 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:24:40.843552 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m11:24:40.844310 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:24:40.845011 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:24:40.872859 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.027 seconds
[0m11:24:40.875873 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:24:40.877304 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:24:41.059165 [debug] [MainThread]: Using postgres connection "master"
[0m11:24:41.059810 [debug] [MainThread]: On master: BEGIN
[0m11:24:41.060339 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:24:41.076465 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m11:24:41.077263 [debug] [MainThread]: Using postgres connection "master"
[0m11:24:41.077880 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:24:41.123282 [debug] [MainThread]: SQL status: SELECT 0 in 0.045 seconds
[0m11:24:41.125632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77942875-3222-4b26-9830-75671d3154d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a25bf8f8f20>]}
[0m11:24:41.126496 [debug] [MainThread]: On master: ROLLBACK
[0m11:24:41.127304 [debug] [MainThread]: Using postgres connection "master"
[0m11:24:41.127774 [debug] [MainThread]: On master: BEGIN
[0m11:24:41.128973 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:24:41.130598 [debug] [MainThread]: On master: COMMIT
[0m11:24:41.133094 [debug] [MainThread]: Using postgres connection "master"
[0m11:24:41.134410 [debug] [MainThread]: On master: COMMIT
[0m11:24:41.136648 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:24:41.137589 [debug] [MainThread]: On master: Close
[0m11:24:41.142503 [debug] [Thread-1 (]: Began running node model.my_project.my_first_dbt_model
[0m11:24:41.143554 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.my_first_dbt_model ............................ [RUN]
[0m11:24:41.144525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.my_first_dbt_model)
[0m11:24:41.145344 [debug] [Thread-1 (]: Began compiling node model.my_project.my_first_dbt_model
[0m11:24:41.160881 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.my_first_dbt_model"
[0m11:24:41.167885 [debug] [Thread-1 (]: Began executing node model.my_project.my_first_dbt_model
[0m11:24:41.242098 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.my_first_dbt_model"
[0m11:24:41.244917 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m11:24:41.247578 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: BEGIN
[0m11:24:41.248511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:24:41.262006 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m11:24:41.263746 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m11:24:41.266025 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_first_dbt_model"} */

  
    

  create  table "db"."dev"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m11:24:41.282498 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.015 seconds
[0m11:24:41.291492 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m11:24:41.292065 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_first_dbt_model"} */
alter table "db"."dev"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m11:24:41.293365 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:24:41.342845 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: COMMIT
[0m11:24:41.343596 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m11:24:41.344137 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: COMMIT
[0m11:24:41.350410 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m11:24:41.359640 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."my_first_dbt_model__dbt_backup"
[0m11:24:41.371470 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m11:24:41.372561 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_first_dbt_model"} */
drop table if exists "db"."dev"."my_first_dbt_model__dbt_backup" cascade
[0m11:24:41.374300 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m11:24:41.377984 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: Close
[0m11:24:41.385379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77942875-3222-4b26-9830-75671d3154d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a25c11fa510>]}
[0m11:24:41.387438 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.my_first_dbt_model ....................... [[32mSELECT 2[0m in 0.24s]
[0m11:24:41.389832 [debug] [Thread-1 (]: Finished running node model.my_project.my_first_dbt_model
[0m11:24:41.391713 [debug] [Thread-3 (]: Began running node model.my_project.my_second_dbt_model
[0m11:24:41.392504 [info ] [Thread-3 (]: 2 of 2 START sql view model dev.my_second_dbt_model ............................ [RUN]
[0m11:24:41.393387 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.my_second_dbt_model'
[0m11:24:41.394003 [debug] [Thread-3 (]: Began compiling node model.my_project.my_second_dbt_model
[0m11:24:41.402085 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.my_second_dbt_model"
[0m11:24:41.403572 [debug] [Thread-3 (]: Began executing node model.my_project.my_second_dbt_model
[0m11:24:41.438551 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.my_second_dbt_model"
[0m11:24:41.439449 [debug] [Thread-3 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m11:24:41.439966 [debug] [Thread-3 (]: On model.my_project.my_second_dbt_model: BEGIN
[0m11:24:41.440434 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:24:41.454518 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m11:24:41.455519 [debug] [Thread-3 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m11:24:41.456186 [debug] [Thread-3 (]: On model.my_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_second_dbt_model"} */

  create view "db"."dev"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "db"."dev"."my_first_dbt_model"
where id = 1
  );
[0m11:24:41.461787 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m11:24:41.469530 [debug] [Thread-3 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m11:24:41.470141 [debug] [Thread-3 (]: On model.my_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_second_dbt_model"} */
alter table "db"."dev"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m11:24:41.471307 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:24:41.473265 [debug] [Thread-3 (]: On model.my_project.my_second_dbt_model: COMMIT
[0m11:24:41.473751 [debug] [Thread-3 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m11:24:41.474278 [debug] [Thread-3 (]: On model.my_project.my_second_dbt_model: COMMIT
[0m11:24:41.480893 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m11:24:41.488207 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."my_second_dbt_model__dbt_backup"
[0m11:24:41.493279 [debug] [Thread-3 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m11:24:41.493872 [debug] [Thread-3 (]: On model.my_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_second_dbt_model"} */
drop view if exists "db"."dev"."my_second_dbt_model__dbt_backup" cascade
[0m11:24:41.495742 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m11:24:41.500586 [debug] [Thread-3 (]: On model.my_project.my_second_dbt_model: Close
[0m11:24:41.501793 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77942875-3222-4b26-9830-75671d3154d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a25bd77bec0>]}
[0m11:24:41.503332 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dev.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.11s]
[0m11:24:41.505357 [debug] [Thread-3 (]: Finished running node model.my_project.my_second_dbt_model
[0m11:24:41.508933 [debug] [MainThread]: Using postgres connection "master"
[0m11:24:41.509526 [debug] [MainThread]: On master: BEGIN
[0m11:24:41.510097 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:24:41.528701 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m11:24:41.530184 [debug] [MainThread]: On master: COMMIT
[0m11:24:41.533007 [debug] [MainThread]: Using postgres connection "master"
[0m11:24:41.534379 [debug] [MainThread]: On master: COMMIT
[0m11:24:41.536712 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:24:41.537594 [debug] [MainThread]: On master: Close
[0m11:24:41.538799 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:24:41.539388 [debug] [MainThread]: Connection 'model.my_project.my_first_dbt_model' was properly closed.
[0m11:24:41.539848 [debug] [MainThread]: Connection 'model.my_project.my_second_dbt_model' was properly closed.
[0m11:24:41.540499 [info ] [MainThread]: 
[0m11:24:41.541136 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m11:24:41.543509 [debug] [MainThread]: Command end result
[0m11:24:41.586931 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:24:41.590894 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:24:41.606077 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:24:41.606618 [info ] [MainThread]: 
[0m11:24:41.607414 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:24:41.608201 [info ] [MainThread]: 
[0m11:24:41.609381 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:24:41.612622 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.467041, "process_in_blocks": "56", "process_kernel_time": 0.651816, "process_mem_max_rss": "113316", "process_out_blocks": "4216", "process_user_time": 6.012098}
[0m11:24:41.613692 [debug] [MainThread]: Command `dbt run` succeeded at 11:24:41.613453 after 4.47 seconds
[0m11:24:41.614442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a25bfc23830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a25bf7ba300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a25bd632c30>]}
[0m11:24:41.615446 [debug] [MainThread]: Flushing usage events
[0m11:24:43.382721 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:33:08.617379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785b9b2db620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785b9b004bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785b9bffa780>]}


============================== 11:33:08.631618 | 02dd4537-3268-4ca9-ba47-cdcfff4a01e7 ==============================
[0m11:33:08.631618 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:33:08.633241 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:33:09.043702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02dd4537-3268-4ca9-ba47-cdcfff4a01e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785b9b41eb10>]}
[0m11:33:09.169207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02dd4537-3268-4ca9-ba47-cdcfff4a01e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785b99047470>]}
[0m11:33:09.170684 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:33:09.425505 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:33:09.711607 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:33:09.712560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '02dd4537-3268-4ca9-ba47-cdcfff4a01e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785b9ad640e0>]}
[0m11:33:12.153416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02dd4537-3268-4ca9-ba47-cdcfff4a01e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785b98e3d2e0>]}
[0m11:33:12.290927 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:33:12.295928 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:33:12.515499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02dd4537-3268-4ca9-ba47-cdcfff4a01e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785b8b97d820>]}
[0m11:33:12.516270 [info ] [MainThread]: Found 1 model, 1 source, 429 macros
[0m11:33:12.516906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02dd4537-3268-4ca9-ba47-cdcfff4a01e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785b98ac8770>]}
[0m11:33:12.519634 [info ] [MainThread]: 
[0m11:33:12.520230 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:33:12.521099 [info ] [MainThread]: 
[0m11:33:12.522641 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:33:12.525173 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:33:12.690985 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:33:12.691526 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:33:12.691960 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:33:12.720840 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.029 seconds
[0m11:33:12.722478 [debug] [ThreadPool]: On list_db: Close
[0m11:33:12.724613 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m11:33:12.737194 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:33:12.737688 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:33:12.738097 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:33:12.756998 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m11:33:12.757890 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:33:12.758827 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:33:12.770325 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m11:33:12.772926 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:33:12.774244 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:33:12.783717 [debug] [MainThread]: Using postgres connection "master"
[0m11:33:12.784287 [debug] [MainThread]: On master: BEGIN
[0m11:33:12.784820 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:33:12.806912 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m11:33:12.807695 [debug] [MainThread]: Using postgres connection "master"
[0m11:33:12.808385 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:33:12.827796 [debug] [MainThread]: SQL status: SELECT 0 in 0.017 seconds
[0m11:33:12.831412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02dd4537-3268-4ca9-ba47-cdcfff4a01e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785b8ac35700>]}
[0m11:33:12.832537 [debug] [MainThread]: On master: ROLLBACK
[0m11:33:12.833381 [debug] [MainThread]: Using postgres connection "master"
[0m11:33:12.833867 [debug] [MainThread]: On master: BEGIN
[0m11:33:12.834965 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:33:12.835769 [debug] [MainThread]: On master: COMMIT
[0m11:33:12.836422 [debug] [MainThread]: Using postgres connection "master"
[0m11:33:12.837311 [debug] [MainThread]: On master: COMMIT
[0m11:33:12.838078 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:33:12.838499 [debug] [MainThread]: On master: Close
[0m11:33:12.846140 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m11:33:12.848121 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging ....................................... [RUN]
[0m11:33:12.850602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m11:33:12.851910 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m11:33:12.870409 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m11:33:12.873502 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m11:33:12.940652 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m11:33:12.944771 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:33:12.945322 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m11:33:12.945703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:12.957295 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m11:33:12.958359 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:33:12.959545 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

select *
from"sb"."dev"."raw_weather_data"
  );
  
[0m11:33:12.962587 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "sb.dev.raw_weather_data"
LINE 15: from"sb"."dev"."raw_weather_data"
             ^

[0m11:33:12.964114 [debug] [Thread-1 (]: On model.my_project.staging: ROLLBACK
[0m11:33:12.966156 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m11:33:12.982451 [debug] [Thread-1 (]: Database Error in model staging (models/staging/staging.sql)
  cross-database references are not implemented: "sb.dev.raw_weather_data"
  LINE 15: from"sb"."dev"."raw_weather_data"
               ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m11:33:12.987960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02dd4537-3268-4ca9-ba47-cdcfff4a01e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785b98b31340>]}
[0m11:33:12.989797 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev.staging .............................. [[31mERROR[0m in 0.13s]
[0m11:33:12.991975 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m11:33:12.995502 [debug] [Thread-7 (]: Marking all children of 'model.my_project.staging' to be skipped because of status 'error'.  Reason: Database Error in model staging (models/staging/staging.sql)
  cross-database references are not implemented: "sb.dev.raw_weather_data"
  LINE 15: from"sb"."dev"."raw_weather_data"
               ^
  compiled code at target/run/my_project/models/staging/staging.sql.
[0m11:33:13.002931 [debug] [MainThread]: Using postgres connection "master"
[0m11:33:13.003967 [debug] [MainThread]: On master: BEGIN
[0m11:33:13.005081 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:33:13.025454 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m11:33:13.027473 [debug] [MainThread]: On master: COMMIT
[0m11:33:13.028842 [debug] [MainThread]: Using postgres connection "master"
[0m11:33:13.029877 [debug] [MainThread]: On master: COMMIT
[0m11:33:13.031896 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:33:13.032603 [debug] [MainThread]: On master: Close
[0m11:33:13.033356 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:33:13.033811 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m11:33:13.034332 [info ] [MainThread]: 
[0m11:33:13.035281 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m11:33:13.037193 [debug] [MainThread]: Command end result
[0m11:33:13.084634 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:33:13.087620 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:33:13.104052 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:33:13.104604 [info ] [MainThread]: 
[0m11:33:13.105352 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:33:13.106094 [info ] [MainThread]: 
[0m11:33:13.107552 [error] [MainThread]:   Database Error in model staging (models/staging/staging.sql)
  cross-database references are not implemented: "sb.dev.raw_weather_data"
  LINE 15: from"sb"."dev"."raw_weather_data"
               ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m11:33:13.111964 [info ] [MainThread]: 
[0m11:33:13.114954 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:33:13.118227 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.6579857, "process_in_blocks": "2984", "process_kernel_time": 1.254077, "process_mem_max_rss": "110308", "process_out_blocks": "2520", "process_user_time": 6.225888}
[0m11:33:13.119995 [debug] [MainThread]: Command `dbt run` failed at 11:33:13.119551 after 4.66 seconds
[0m11:33:13.121407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785b9b463ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785b9c5c7c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785b98bf96a0>]}
[0m11:33:13.122949 [debug] [MainThread]: Flushing usage events
[0m11:33:15.366938 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:33:50.251103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e7efb46600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e7ee8c3440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e7eecf3740>]}


============================== 11:33:50.256392 | e1de5bda-6b43-409c-ae55-c53216cb02fd ==============================
[0m11:33:50.256392 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:33:50.257425 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:33:50.595525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1de5bda-6b43-409c-ae55-c53216cb02fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e7ec39c170>]}
[0m11:33:50.706771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1de5bda-6b43-409c-ae55-c53216cb02fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e7efeeb140>]}
[0m11:33:50.708192 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:33:50.906456 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:33:51.118855 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:33:51.120812 [debug] [MainThread]: Partial parsing: updated file: my_project://models/sources/sources.yml
[0m11:33:51.743499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1de5bda-6b43-409c-ae55-c53216cb02fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e7eaea0e30>]}
[0m11:33:51.840214 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:33:51.843579 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:33:51.863185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1de5bda-6b43-409c-ae55-c53216cb02fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e7eaf523c0>]}
[0m11:33:51.863818 [info ] [MainThread]: Found 1 model, 1 source, 429 macros
[0m11:33:51.864332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1de5bda-6b43-409c-ae55-c53216cb02fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e7ec12ef30>]}
[0m11:33:51.867319 [info ] [MainThread]: 
[0m11:33:51.868110 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:33:51.868951 [info ] [MainThread]: 
[0m11:33:51.870188 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:33:51.872265 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:33:51.951789 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:33:51.952368 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:33:51.952943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:33:51.968729 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m11:33:51.970632 [debug] [ThreadPool]: On list_db: Close
[0m11:33:51.973013 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m11:33:51.982178 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:33:51.982607 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:33:51.983294 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:33:52.005242 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m11:33:52.006182 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:33:52.006893 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:33:52.020212 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.013 seconds
[0m11:33:52.021907 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:33:52.022783 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:33:52.029226 [debug] [MainThread]: Using postgres connection "master"
[0m11:33:52.029843 [debug] [MainThread]: On master: BEGIN
[0m11:33:52.030323 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:33:52.041062 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m11:33:52.042100 [debug] [MainThread]: Using postgres connection "master"
[0m11:33:52.042822 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:33:52.048331 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m11:33:52.050829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1de5bda-6b43-409c-ae55-c53216cb02fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e7eaf03bf0>]}
[0m11:33:52.051503 [debug] [MainThread]: On master: ROLLBACK
[0m11:33:52.052307 [debug] [MainThread]: Using postgres connection "master"
[0m11:33:52.052711 [debug] [MainThread]: On master: BEGIN
[0m11:33:52.054146 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:33:52.055021 [debug] [MainThread]: On master: COMMIT
[0m11:33:52.055976 [debug] [MainThread]: Using postgres connection "master"
[0m11:33:52.056585 [debug] [MainThread]: On master: COMMIT
[0m11:33:52.057325 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:33:52.058092 [debug] [MainThread]: On master: Close
[0m11:33:52.063591 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m11:33:52.064880 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging ....................................... [RUN]
[0m11:33:52.065851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m11:33:52.066524 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m11:33:52.078745 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m11:33:52.080039 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m11:33:52.158090 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m11:33:52.159491 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:33:52.160138 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m11:33:52.160679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:52.175132 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m11:33:52.176198 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:33:52.177039 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

select *
from"db"."dev"."raw_weather_data"
  );
  
[0m11:33:52.260073 [debug] [Thread-1 (]: SQL status: SELECT 97 in 0.082 seconds
[0m11:33:52.267315 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:33:52.267841 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m11:33:52.268823 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:33:52.290309 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m11:33:52.290781 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:33:52.291307 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m11:33:52.297694 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m11:33:52.305496 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m11:33:52.315647 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:33:52.316165 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m11:33:52.317119 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m11:33:52.320153 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m11:33:52.322373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1de5bda-6b43-409c-ae55-c53216cb02fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e7ef9fa7b0>]}
[0m11:33:52.323287 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.staging .................................. [[32mSELECT 97[0m in 0.26s]
[0m11:33:52.324744 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m11:33:52.328952 [debug] [MainThread]: Using postgres connection "master"
[0m11:33:52.329514 [debug] [MainThread]: On master: BEGIN
[0m11:33:52.329910 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:33:52.348280 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m11:33:52.349191 [debug] [MainThread]: On master: COMMIT
[0m11:33:52.349882 [debug] [MainThread]: Using postgres connection "master"
[0m11:33:52.350691 [debug] [MainThread]: On master: COMMIT
[0m11:33:52.351450 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:33:52.351838 [debug] [MainThread]: On master: Close
[0m11:33:52.352556 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:33:52.352961 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m11:33:52.353468 [info ] [MainThread]: 
[0m11:33:52.354123 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m11:33:52.355914 [debug] [MainThread]: Command end result
[0m11:33:52.395355 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:33:52.397540 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:33:52.405102 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:33:52.405690 [info ] [MainThread]: 
[0m11:33:52.406497 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:33:52.407406 [info ] [MainThread]: 
[0m11:33:52.408853 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:33:52.411858 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2874517, "process_in_blocks": "40", "process_kernel_time": 0.585113, "process_mem_max_rss": "111440", "process_out_blocks": "2520", "process_user_time": 3.59484}
[0m11:33:52.412946 [debug] [MainThread]: Command `dbt run` succeeded at 11:33:52.412691 after 2.29 seconds
[0m11:33:52.413811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e7ee2dd550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e7ec1b4110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e7ee73cc80>]}
[0m11:33:52.414763 [debug] [MainThread]: Flushing usage events
[0m11:33:54.610980 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:33.910173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723d98d294c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723d9936e600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723d9989e000>]}


============================== 11:38:33.914741 | f479ba56-cadd-43f9-8e22-ab5a7251c682 ==============================
[0m11:38:33.914741 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:38:33.915684 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:38:34.168506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f479ba56-cadd-43f9-8e22-ab5a7251c682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723d9a787470>]}
[0m11:38:34.253241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f479ba56-cadd-43f9-8e22-ab5a7251c682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723d98b28470>]}
[0m11:38:34.254252 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:38:34.384129 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:38:34.537886 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:38:34.538878 [debug] [MainThread]: Partial parsing: updated file: my_project://models/staging/staging.sql
[0m11:38:34.983656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f479ba56-cadd-43f9-8e22-ab5a7251c682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723d96ede090>]}
[0m11:38:35.104894 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:38:35.108134 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:38:35.138188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f479ba56-cadd-43f9-8e22-ab5a7251c682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723d96e0e0c0>]}
[0m11:38:35.138974 [info ] [MainThread]: Found 1 model, 1 source, 429 macros
[0m11:38:35.139556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f479ba56-cadd-43f9-8e22-ab5a7251c682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723d971bbd70>]}
[0m11:38:35.143226 [info ] [MainThread]: 
[0m11:38:35.144154 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:38:35.144918 [info ] [MainThread]: 
[0m11:38:35.146220 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:38:35.148500 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:38:35.220742 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:38:35.221215 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:38:35.221659 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:35.240352 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.019 seconds
[0m11:38:35.243008 [debug] [ThreadPool]: On list_db: Close
[0m11:38:35.246072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m11:38:35.259708 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:38:35.260994 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:38:35.262068 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:35.274946 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m11:38:35.275908 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:38:35.276953 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:38:35.281743 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m11:38:35.283528 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:38:35.284318 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:38:35.291367 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:35.292095 [debug] [MainThread]: On master: BEGIN
[0m11:38:35.292824 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:38:35.306273 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m11:38:35.306769 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:35.307258 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:38:35.313102 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m11:38:35.315637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f479ba56-cadd-43f9-8e22-ab5a7251c682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723d96faa090>]}
[0m11:38:35.316350 [debug] [MainThread]: On master: ROLLBACK
[0m11:38:35.317408 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:35.318261 [debug] [MainThread]: On master: BEGIN
[0m11:38:35.319958 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:38:35.320825 [debug] [MainThread]: On master: COMMIT
[0m11:38:35.321396 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:35.321899 [debug] [MainThread]: On master: COMMIT
[0m11:38:35.322846 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:38:35.323467 [debug] [MainThread]: On master: Close
[0m11:38:35.329479 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m11:38:35.330386 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging ....................................... [RUN]
[0m11:38:35.331282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m11:38:35.331844 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m11:38:35.344714 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m11:38:35.346215 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m11:38:35.410349 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m11:38:35.411192 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:38:35.411749 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m11:38:35.412278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:35.425482 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m11:38:35.426361 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:38:35.426823 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

)

select
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from source
  );
  
[0m11:38:35.428751 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "weather_descriptions" does not exist
LINE 23:     weather_descriptions,
             ^
HINT:  Perhaps you meant to reference the column "source.weather_description".

[0m11:38:35.429374 [debug] [Thread-1 (]: On model.my_project.staging: ROLLBACK
[0m11:38:35.430345 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m11:38:35.434781 [debug] [Thread-1 (]: Database Error in model staging (models/staging/staging.sql)
  column "weather_descriptions" does not exist
  LINE 23:     weather_descriptions,
               ^
  HINT:  Perhaps you meant to reference the column "source.weather_description".
  compiled code at target/run/my_project/models/staging/staging.sql
[0m11:38:35.436882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f479ba56-cadd-43f9-8e22-ab5a7251c682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723d994bdfa0>]}
[0m11:38:35.437700 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev.staging .............................. [[31mERROR[0m in 0.10s]
[0m11:38:35.438973 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m11:38:35.440479 [debug] [Thread-7 (]: Marking all children of 'model.my_project.staging' to be skipped because of status 'error'.  Reason: Database Error in model staging (models/staging/staging.sql)
  column "weather_descriptions" does not exist
  LINE 23:     weather_descriptions,
               ^
  HINT:  Perhaps you meant to reference the column "source.weather_description".
  compiled code at target/run/my_project/models/staging/staging.sql.
[0m11:38:35.445055 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:35.445621 [debug] [MainThread]: On master: BEGIN
[0m11:38:35.446343 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:38:35.459236 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m11:38:35.459923 [debug] [MainThread]: On master: COMMIT
[0m11:38:35.460550 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:35.461219 [debug] [MainThread]: On master: COMMIT
[0m11:38:35.462363 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:38:35.462950 [debug] [MainThread]: On master: Close
[0m11:38:35.463678 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:38:35.464093 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m11:38:35.464548 [info ] [MainThread]: 
[0m11:38:35.465203 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m11:38:35.467394 [debug] [MainThread]: Command end result
[0m11:38:35.503947 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:38:35.506026 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:38:35.516058 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:38:35.516559 [info ] [MainThread]: 
[0m11:38:35.517220 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:38:35.518596 [info ] [MainThread]: 
[0m11:38:35.519865 [error] [MainThread]:   Database Error in model staging (models/staging/staging.sql)
  column "weather_descriptions" does not exist
  LINE 23:     weather_descriptions,
               ^
  HINT:  Perhaps you meant to reference the column "source.weather_description".
  compiled code at target/run/my_project/models/staging/staging.sql
[0m11:38:35.520684 [info ] [MainThread]: 
[0m11:38:35.521635 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:38:35.524005 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7230965, "process_in_blocks": "768", "process_kernel_time": 0.588481, "process_mem_max_rss": "110556", "process_out_blocks": "2528", "process_user_time": 3.246658}
[0m11:38:35.525266 [debug] [MainThread]: Command `dbt run` failed at 11:38:35.524938 after 1.72 seconds
[0m11:38:35.526550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723d98bfda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723d96f14950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723d9a755730>]}
[0m11:38:35.527626 [debug] [MainThread]: Flushing usage events
[0m11:38:37.386721 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:39:11.749809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7849becb0890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7849c0636570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7849becb2360>]}


============================== 11:39:11.754034 | d56871f1-576a-4382-b073-2ca0550da38e ==============================
[0m11:39:11.754034 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:39:11.755104 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:39:12.020631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd56871f1-576a-4382-b073-2ca0550da38e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7849bcfabbc0>]}
[0m11:39:12.129157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd56871f1-576a-4382-b073-2ca0550da38e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7849bf0e8b00>]}
[0m11:39:12.131299 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:39:12.354803 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:39:12.598576 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:39:12.599393 [debug] [MainThread]: Partial parsing: updated file: my_project://models/staging/staging.sql
[0m11:39:12.970862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd56871f1-576a-4382-b073-2ca0550da38e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7849bcedfc80>]}
[0m11:39:13.107500 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:39:13.112257 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:39:13.143419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd56871f1-576a-4382-b073-2ca0550da38e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7849bcafe3c0>]}
[0m11:39:13.145071 [info ] [MainThread]: Found 1 model, 1 source, 429 macros
[0m11:39:13.146662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd56871f1-576a-4382-b073-2ca0550da38e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7849bcae9f40>]}
[0m11:39:13.150848 [info ] [MainThread]: 
[0m11:39:13.151634 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:39:13.152709 [info ] [MainThread]: 
[0m11:39:13.154290 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:39:13.157052 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:39:13.237190 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:39:13.237680 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:39:13.238299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:13.253213 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m11:39:13.255005 [debug] [ThreadPool]: On list_db: Close
[0m11:39:13.257393 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m11:39:13.268046 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:39:13.268510 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:39:13.268970 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:39:13.282676 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m11:39:13.283452 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:39:13.283953 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:39:13.290659 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m11:39:13.294390 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:39:13.295393 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:39:13.302229 [debug] [MainThread]: Using postgres connection "master"
[0m11:39:13.302859 [debug] [MainThread]: On master: BEGIN
[0m11:39:13.303283 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:39:13.317119 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m11:39:13.317697 [debug] [MainThread]: Using postgres connection "master"
[0m11:39:13.318402 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:39:13.323666 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m11:39:13.326961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd56871f1-576a-4382-b073-2ca0550da38e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7849bcba4c80>]}
[0m11:39:13.327694 [debug] [MainThread]: On master: ROLLBACK
[0m11:39:13.328762 [debug] [MainThread]: Using postgres connection "master"
[0m11:39:13.329346 [debug] [MainThread]: On master: BEGIN
[0m11:39:13.330735 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:39:13.331229 [debug] [MainThread]: On master: COMMIT
[0m11:39:13.331673 [debug] [MainThread]: Using postgres connection "master"
[0m11:39:13.332098 [debug] [MainThread]: On master: COMMIT
[0m11:39:13.332840 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:39:13.333229 [debug] [MainThread]: On master: Close
[0m11:39:13.337937 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m11:39:13.338732 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging ....................................... [RUN]
[0m11:39:13.339454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m11:39:13.340618 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m11:39:13.350952 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m11:39:13.351749 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m11:39:13.411811 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m11:39:13.412933 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:39:13.413420 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m11:39:13.413815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:13.428995 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m11:39:13.429659 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:39:13.430334 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

)

select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from source
  );
  
[0m11:39:13.437707 [debug] [Thread-1 (]: SQL status: SELECT 118 in 0.006 seconds
[0m11:39:13.446223 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:39:13.446729 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m11:39:13.447722 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:39:13.451576 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:39:13.452016 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m11:39:13.453070 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:39:13.480785 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m11:39:13.481777 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:39:13.482822 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m11:39:13.708067 [debug] [Thread-1 (]: SQL status: COMMIT in 0.224 seconds
[0m11:39:13.717092 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m11:39:13.729139 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:39:13.729818 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m11:39:13.737006 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m11:39:13.742905 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m11:39:13.746151 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd56871f1-576a-4382-b073-2ca0550da38e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7849c04e6660>]}
[0m11:39:13.747142 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.staging .................................. [[32mSELECT 118[0m in 0.40s]
[0m11:39:13.748466 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m11:39:13.752183 [debug] [MainThread]: Using postgres connection "master"
[0m11:39:13.752742 [debug] [MainThread]: On master: BEGIN
[0m11:39:13.753266 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:39:13.767466 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m11:39:13.768006 [debug] [MainThread]: On master: COMMIT
[0m11:39:13.768636 [debug] [MainThread]: Using postgres connection "master"
[0m11:39:13.769029 [debug] [MainThread]: On master: COMMIT
[0m11:39:13.769832 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:39:13.770387 [debug] [MainThread]: On master: Close
[0m11:39:13.771105 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:39:13.771485 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m11:39:13.772007 [info ] [MainThread]: 
[0m11:39:13.773306 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m11:39:13.776741 [debug] [MainThread]: Command end result
[0m11:39:13.818382 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:39:13.820586 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:39:13.829738 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:39:13.830298 [info ] [MainThread]: 
[0m11:39:13.831071 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:39:13.831964 [info ] [MainThread]: 
[0m11:39:13.833029 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:39:13.835152 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1984074, "process_in_blocks": "0", "process_kernel_time": 0.504439, "process_mem_max_rss": "110120", "process_out_blocks": "2528", "process_user_time": 3.46702}
[0m11:39:13.836248 [debug] [MainThread]: Command `dbt run` succeeded at 11:39:13.836086 after 2.20 seconds
[0m11:39:13.836747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7849be721550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7849be722660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7849bcbabaa0>]}
[0m11:39:13.837221 [debug] [MainThread]: Flushing usage events
[0m11:39:15.625706 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:46:40.488788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa07fd2750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa08663d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa07882240>]}


============================== 11:46:40.492971 | 95c1f7ad-6822-495e-b1a2-216e9b516375 ==============================
[0m11:46:40.492971 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:46:40.494171 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:46:40.714470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95c1f7ad-6822-495e-b1a2-216e9b516375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa073f8920>]}
[0m11:46:40.789042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95c1f7ad-6822-495e-b1a2-216e9b516375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa07447230>]}
[0m11:46:40.790032 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:46:40.923457 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:46:41.065470 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m11:46:41.066148 [debug] [MainThread]: Partial parsing: added file: my_project://models/mart/weather_report.sql
[0m11:46:41.066734 [debug] [MainThread]: Partial parsing: updated file: my_project://models/staging/staging.sql
[0m11:46:41.470237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95c1f7ad-6822-495e-b1a2-216e9b516375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa059fe630>]}
[0m11:46:41.564512 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:46:41.567627 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:46:41.587697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95c1f7ad-6822-495e-b1a2-216e9b516375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa058f29f0>]}
[0m11:46:41.588616 [info ] [MainThread]: Found 2 models, 1 source, 429 macros
[0m11:46:41.589158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95c1f7ad-6822-495e-b1a2-216e9b516375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa05ac0bf0>]}
[0m11:46:41.592024 [info ] [MainThread]: 
[0m11:46:41.592630 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:46:41.593426 [info ] [MainThread]: 
[0m11:46:41.594626 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:46:41.603047 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:46:41.669748 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:46:41.670477 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:46:41.671423 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:41.686695 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m11:46:41.688719 [debug] [ThreadPool]: On list_db: Close
[0m11:46:41.690940 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m11:46:41.698022 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:46:41.698416 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:46:41.698791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:46:41.710797 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m11:46:41.711268 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:46:41.711674 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:46:41.715837 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m11:46:41.717733 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:46:41.718411 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:46:41.724973 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:41.725428 [debug] [MainThread]: On master: BEGIN
[0m11:46:41.725896 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:46:41.738794 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m11:46:41.739510 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:41.740202 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:46:41.744294 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m11:46:41.746001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95c1f7ad-6822-495e-b1a2-216e9b516375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa0933c4a0>]}
[0m11:46:41.746820 [debug] [MainThread]: On master: ROLLBACK
[0m11:46:41.747625 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:41.748001 [debug] [MainThread]: On master: BEGIN
[0m11:46:41.749231 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:46:41.749701 [debug] [MainThread]: On master: COMMIT
[0m11:46:41.750109 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:41.750488 [debug] [MainThread]: On master: COMMIT
[0m11:46:41.751241 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:46:41.751627 [debug] [MainThread]: On master: Close
[0m11:46:41.756606 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m11:46:41.757262 [debug] [Thread-2 (]: Began running node model.my_project.weather_report
[0m11:46:41.757986 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.staging ....................................... [RUN]
[0m11:46:41.758977 [info ] [Thread-2 (]: 2 of 2 START sql table model dev.weather_report ................................ [RUN]
[0m11:46:41.759933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m11:46:41.761239 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m11:46:41.761793 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m11:46:41.762453 [debug] [Thread-2 (]: Began compiling node model.my_project.weather_report
[0m11:46:41.773473 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m11:46:41.777821 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m11:46:41.778735 [debug] [Thread-2 (]: Began executing node model.my_project.weather_report
[0m11:46:41.784446 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m11:46:41.866253 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m11:46:41.867467 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m11:46:41.869268 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:46:41.870148 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m11:46:41.870974 [debug] [Thread-2 (]: Using postgres connection "model.my_project.weather_report"
[0m11:46:41.871603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:41.872311 [debug] [Thread-2 (]: On model.my_project.weather_report: BEGIN
[0m11:46:41.873535 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:46:41.886257 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m11:46:41.887117 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:46:41.887953 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m11:46:41.888639 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

)

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m11:46:41.889309 [debug] [Thread-2 (]: Using postgres connection "model.my_project.weather_report"
[0m11:46:41.890214 [debug] [Thread-2 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    
  );
  
[0m11:46:41.890886 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "de_dup"
LINE 19: de_dup as(
         ^

[0m11:46:41.891694 [debug] [Thread-1 (]: On model.my_project.staging: ROLLBACK
[0m11:46:41.892517 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 13:   );
           ^

[0m11:46:41.893255 [debug] [Thread-2 (]: On model.my_project.weather_report: ROLLBACK
[0m11:46:41.893861 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m11:46:41.896762 [debug] [Thread-2 (]: On model.my_project.weather_report: Close
[0m11:46:41.904394 [debug] [Thread-1 (]: Database Error in model staging (models/staging/staging.sql)
  syntax error at or near "de_dup"
  LINE 19: de_dup as(
           ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m11:46:41.906289 [debug] [Thread-2 (]: Database Error in model weather_report (models/mart/weather_report.sql)
  syntax error at or near ")"
  LINE 13:   );
             ^
  compiled code at target/run/my_project/models/mart/weather_report.sql
[0m11:46:41.908967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95c1f7ad-6822-495e-b1a2-216e9b516375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa0472b710>]}
[0m11:46:41.909396 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95c1f7ad-6822-495e-b1a2-216e9b516375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa0819df10>]}
[0m11:46:41.910223 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model dev.staging .............................. [[31mERROR[0m in 0.15s]
[0m11:46:41.911636 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model dev.weather_report ....................... [[31mERROR[0m in 0.15s]
[0m11:46:41.913119 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m11:46:41.914693 [debug] [Thread-2 (]: Finished running node model.my_project.weather_report
[0m11:46:41.915725 [debug] [Thread-7 (]: Marking all children of 'model.my_project.staging' to be skipped because of status 'error'.  Reason: Database Error in model staging (models/staging/staging.sql)
  syntax error at or near "de_dup"
  LINE 19: de_dup as(
           ^
  compiled code at target/run/my_project/models/staging/staging.sql.
[0m11:46:41.917540 [debug] [Thread-7 (]: Marking all children of 'model.my_project.weather_report' to be skipped because of status 'error'.  Reason: Database Error in model weather_report (models/mart/weather_report.sql)
  syntax error at or near ")"
  LINE 13:   );
             ^
  compiled code at target/run/my_project/models/mart/weather_report.sql.
[0m11:46:41.921470 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:41.922052 [debug] [MainThread]: On master: BEGIN
[0m11:46:41.922628 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:46:41.937684 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m11:46:41.938662 [debug] [MainThread]: On master: COMMIT
[0m11:46:41.939290 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:41.939808 [debug] [MainThread]: On master: COMMIT
[0m11:46:41.940825 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:46:41.941253 [debug] [MainThread]: On master: Close
[0m11:46:41.941887 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:46:41.942241 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m11:46:41.942624 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m11:46:41.943145 [info ] [MainThread]: 
[0m11:46:41.943672 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m11:46:41.945745 [debug] [MainThread]: Command end result
[0m11:46:41.981463 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:46:41.983620 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:46:41.991998 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:46:41.992659 [info ] [MainThread]: 
[0m11:46:41.993277 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m11:46:41.994274 [info ] [MainThread]: 
[0m11:46:41.995469 [error] [MainThread]:   Database Error in model staging (models/staging/staging.sql)
  syntax error at or near "de_dup"
  LINE 19: de_dup as(
           ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m11:46:41.996324 [info ] [MainThread]: 
[0m11:46:41.997399 [error] [MainThread]:   Database Error in model weather_report (models/mart/weather_report.sql)
  syntax error at or near ")"
  LINE 13:   );
             ^
  compiled code at target/run/my_project/models/mart/weather_report.sql
[0m11:46:41.998185 [info ] [MainThread]: 
[0m11:46:41.999214 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m11:46:42.001532 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6141398, "process_in_blocks": "0", "process_kernel_time": 0.519995, "process_mem_max_rss": "111324", "process_out_blocks": "2560", "process_user_time": 2.923976}
[0m11:46:42.003501 [debug] [MainThread]: Command `dbt run` failed at 11:46:42.003015 after 1.62 seconds
[0m11:46:42.004924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa07c589e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa059011c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afa076e0c20>]}
[0m11:46:42.006186 [debug] [MainThread]: Flushing usage events
[0m11:46:45.613204 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:47:26.200819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75abc569be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75abc5cd4aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75abc5699be0>]}


============================== 11:47:26.204787 | 2c9d5b52-f023-40ea-881a-9f0c80734bea ==============================
[0m11:47:26.204787 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:47:26.206006 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:47:26.443371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c9d5b52-f023-40ea-881a-9f0c80734bea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75abc5aa6a20>]}
[0m11:47:26.523593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c9d5b52-f023-40ea-881a-9f0c80734bea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75abc73ddca0>]}
[0m11:47:26.524645 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:47:26.647216 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:47:26.784597 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:47:26.785568 [debug] [MainThread]: Partial parsing: updated file: my_project://models/mart/weather_report.sql
[0m11:47:27.051810 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_project.weather_report' (models/mart/weather_report.sql) depends on a node named 'stg_weather_data' which was not found
[0m11:47:27.054138 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9504195, "process_in_blocks": "0", "process_kernel_time": 0.393598, "process_mem_max_rss": "98108", "process_out_blocks": "8", "process_user_time": 2.309907}
[0m11:47:27.055634 [debug] [MainThread]: Command `dbt run` failed at 11:47:27.055327 after 0.95 seconds
[0m11:47:27.056382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75abc5425fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75abc56f36b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75abc384c590>]}
[0m11:47:27.056997 [debug] [MainThread]: Flushing usage events
[0m11:47:29.907502 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:48:34.099626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ded95795370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ded94e687a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ded957968a0>]}


============================== 11:48:34.104093 | 7e992bb1-016f-45bf-8a05-d9cc0776f0ea ==============================
[0m11:48:34.104093 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:48:34.105260 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:48:34.386640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e992bb1-016f-45bf-8a05-d9cc0776f0ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ded94be3ec0>]}
[0m11:48:34.481890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e992bb1-016f-45bf-8a05-d9cc0776f0ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ded94d305c0>]}
[0m11:48:34.483013 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:48:34.631168 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:48:34.770477 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:48:34.771302 [debug] [MainThread]: Partial parsing: updated file: my_project://models/mart/weather_report.sql
[0m11:48:35.183693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e992bb1-016f-45bf-8a05-d9cc0776f0ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ded930c10d0>]}
[0m11:48:35.296469 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:48:35.300004 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:48:35.329664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e992bb1-016f-45bf-8a05-d9cc0776f0ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ded930c6750>]}
[0m11:48:35.330374 [info ] [MainThread]: Found 2 models, 1 source, 429 macros
[0m11:48:35.330964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e992bb1-016f-45bf-8a05-d9cc0776f0ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ded930c35f0>]}
[0m11:48:35.334374 [info ] [MainThread]: 
[0m11:48:35.335047 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:48:35.335750 [info ] [MainThread]: 
[0m11:48:35.337156 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:48:35.348010 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:48:35.422423 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:48:35.422884 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:48:35.423350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:35.439171 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m11:48:35.441568 [debug] [ThreadPool]: On list_db: Close
[0m11:48:35.445144 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m11:48:35.454308 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:48:35.454830 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:48:35.455225 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:48:35.468215 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m11:48:35.468706 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:48:35.469110 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:48:35.472990 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m11:48:35.475868 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:48:35.477029 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:48:35.487165 [debug] [MainThread]: Using postgres connection "master"
[0m11:48:35.487786 [debug] [MainThread]: On master: BEGIN
[0m11:48:35.488253 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:48:35.502758 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m11:48:35.503552 [debug] [MainThread]: Using postgres connection "master"
[0m11:48:35.504213 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:48:35.509797 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m11:48:35.511931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e992bb1-016f-45bf-8a05-d9cc0776f0ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ded931c6a80>]}
[0m11:48:35.512551 [debug] [MainThread]: On master: ROLLBACK
[0m11:48:35.513291 [debug] [MainThread]: Using postgres connection "master"
[0m11:48:35.513947 [debug] [MainThread]: On master: BEGIN
[0m11:48:35.515456 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:48:35.516003 [debug] [MainThread]: On master: COMMIT
[0m11:48:35.516497 [debug] [MainThread]: Using postgres connection "master"
[0m11:48:35.516893 [debug] [MainThread]: On master: COMMIT
[0m11:48:35.517630 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:48:35.518041 [debug] [MainThread]: On master: Close
[0m11:48:35.523046 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m11:48:35.524228 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.staging ....................................... [RUN]
[0m11:48:35.525465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m11:48:35.526740 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m11:48:35.539951 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m11:48:35.541437 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m11:48:35.602656 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m11:48:35.603734 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:48:35.604474 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m11:48:35.604996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:48:35.619436 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m11:48:35.620141 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:48:35.620752 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

)

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m11:48:35.621980 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "de_dup"
LINE 19: de_dup as(
         ^

[0m11:48:35.622677 [debug] [Thread-1 (]: On model.my_project.staging: ROLLBACK
[0m11:48:35.624023 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m11:48:35.630102 [debug] [Thread-1 (]: Database Error in model staging (models/staging/staging.sql)
  syntax error at or near "de_dup"
  LINE 19: de_dup as(
           ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m11:48:35.632239 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e992bb1-016f-45bf-8a05-d9cc0776f0ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ded932a3f20>]}
[0m11:48:35.633455 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model dev.staging .............................. [[31mERROR[0m in 0.11s]
[0m11:48:35.634826 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m11:48:35.636040 [debug] [Thread-7 (]: Marking all children of 'model.my_project.staging' to be skipped because of status 'error'.  Reason: Database Error in model staging (models/staging/staging.sql)
  syntax error at or near "de_dup"
  LINE 19: de_dup as(
           ^
  compiled code at target/run/my_project/models/staging/staging.sql.
[0m11:48:35.638024 [debug] [Thread-3 (]: Began running node model.my_project.weather_report
[0m11:48:35.638724 [info ] [Thread-3 (]: 2 of 2 SKIP relation dev.weather_report ........................................ [[33mSKIP[0m]
[0m11:48:35.639499 [debug] [Thread-3 (]: Finished running node model.my_project.weather_report
[0m11:48:35.643792 [debug] [MainThread]: Using postgres connection "master"
[0m11:48:35.644409 [debug] [MainThread]: On master: BEGIN
[0m11:48:35.644842 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:48:35.657792 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m11:48:35.658855 [debug] [MainThread]: On master: COMMIT
[0m11:48:35.659651 [debug] [MainThread]: Using postgres connection "master"
[0m11:48:35.660304 [debug] [MainThread]: On master: COMMIT
[0m11:48:35.661473 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:48:35.662102 [debug] [MainThread]: On master: Close
[0m11:48:35.662966 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:48:35.663366 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m11:48:35.663983 [info ] [MainThread]: 
[0m11:48:35.666795 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m11:48:35.669672 [debug] [MainThread]: Command end result
[0m11:48:35.709007 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:48:35.712142 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:48:35.720802 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:48:35.721284 [info ] [MainThread]: 
[0m11:48:35.721873 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:48:35.722804 [info ] [MainThread]: 
[0m11:48:35.723825 [error] [MainThread]:   Database Error in model staging (models/staging/staging.sql)
  syntax error at or near "de_dup"
  LINE 19: de_dup as(
           ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m11:48:35.724993 [info ] [MainThread]: 
[0m11:48:35.726013 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m11:48:35.728251 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7522763, "process_in_blocks": "0", "process_kernel_time": 0.588602, "process_mem_max_rss": "110084", "process_out_blocks": "2536", "process_user_time": 3.563865}
[0m11:48:35.729157 [debug] [MainThread]: Command `dbt run` failed at 11:48:35.728864 after 1.75 seconds
[0m11:48:35.730490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ded94da3830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ded9523c530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ded95962330>]}
[0m11:48:35.732372 [debug] [MainThread]: Flushing usage events
[0m11:48:37.651103 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:49:02.123891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709ebba6deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709ebafedc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709ebc1d39e0>]}


============================== 11:49:02.130539 | 5597d0cf-632d-4751-a7af-c277dfc27185 ==============================
[0m11:49:02.130539 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:49:02.131771 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:49:02.449059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5597d0cf-632d-4751-a7af-c277dfc27185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709ebae051c0>]}
[0m11:49:02.545112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5597d0cf-632d-4751-a7af-c277dfc27185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709ebb7fcb00>]}
[0m11:49:02.547242 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:49:02.709772 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:49:02.889401 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:49:02.891805 [debug] [MainThread]: Partial parsing: updated file: my_project://models/staging/staging.sql
[0m11:49:03.394267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5597d0cf-632d-4751-a7af-c277dfc27185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709eb9309730>]}
[0m11:49:03.532076 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:49:03.535799 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:49:03.563053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5597d0cf-632d-4751-a7af-c277dfc27185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709eb9302ab0>]}
[0m11:49:03.564990 [info ] [MainThread]: Found 2 models, 1 source, 429 macros
[0m11:49:03.565626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5597d0cf-632d-4751-a7af-c277dfc27185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709eb930b800>]}
[0m11:49:03.569457 [info ] [MainThread]: 
[0m11:49:03.570047 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:49:03.570729 [info ] [MainThread]: 
[0m11:49:03.572383 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:49:03.582263 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:49:03.665394 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:49:03.665933 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:49:03.666388 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:03.680668 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m11:49:03.682358 [debug] [ThreadPool]: On list_db: Close
[0m11:49:03.684774 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m11:49:03.698253 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:49:03.698946 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:49:03.699475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:49:03.727392 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m11:49:03.728530 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:49:03.729365 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:49:03.738494 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m11:49:03.744187 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:49:03.746012 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:49:03.760254 [debug] [MainThread]: Using postgres connection "master"
[0m11:49:03.760854 [debug] [MainThread]: On master: BEGIN
[0m11:49:03.761265 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:49:03.775066 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m11:49:03.775792 [debug] [MainThread]: Using postgres connection "master"
[0m11:49:03.776942 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:49:03.782003 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m11:49:03.784186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5597d0cf-632d-4751-a7af-c277dfc27185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709eb93f1730>]}
[0m11:49:03.784989 [debug] [MainThread]: On master: ROLLBACK
[0m11:49:03.786185 [debug] [MainThread]: Using postgres connection "master"
[0m11:49:03.786713 [debug] [MainThread]: On master: BEGIN
[0m11:49:03.788404 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:49:03.789632 [debug] [MainThread]: On master: COMMIT
[0m11:49:03.790736 [debug] [MainThread]: Using postgres connection "master"
[0m11:49:03.791328 [debug] [MainThread]: On master: COMMIT
[0m11:49:03.792340 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:49:03.792861 [debug] [MainThread]: On master: Close
[0m11:49:03.797900 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m11:49:03.798915 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.staging ....................................... [RUN]
[0m11:49:03.800012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m11:49:03.800893 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m11:49:03.815707 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m11:49:03.816784 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m11:49:03.886426 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m11:49:03.888106 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:49:03.888906 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m11:49:03.890075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:49:03.902345 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m11:49:03.903001 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:49:03.903781 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m11:49:03.912983 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m11:49:03.921499 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:49:03.922546 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m11:49:03.923935 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:49:03.928141 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:49:03.928865 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m11:49:03.930065 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:49:03.961812 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m11:49:03.962456 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:49:03.963186 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m11:49:03.969058 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m11:49:03.979625 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m11:49:03.988158 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m11:49:03.989595 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m11:49:03.996849 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m11:49:04.001963 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m11:49:04.005583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5597d0cf-632d-4751-a7af-c277dfc27185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709ebcc7a630>]}
[0m11:49:04.007432 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.20s]
[0m11:49:04.008712 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m11:49:04.010547 [debug] [Thread-3 (]: Began running node model.my_project.weather_report
[0m11:49:04.012779 [info ] [Thread-3 (]: 2 of 2 START sql table model dev.weather_report ................................ [RUN]
[0m11:49:04.013792 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m11:49:04.015045 [debug] [Thread-3 (]: Began compiling node model.my_project.weather_report
[0m11:49:04.025883 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m11:49:04.028373 [debug] [Thread-3 (]: Began executing node model.my_project.weather_report
[0m11:49:04.032997 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m11:49:04.034181 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m11:49:04.034795 [debug] [Thread-3 (]: On model.my_project.weather_report: BEGIN
[0m11:49:04.035237 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:49:04.053499 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m11:49:04.054660 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m11:49:04.058131 [debug] [Thread-3 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select * 
from "db"."dev"."staging"
  );
  
[0m11:49:04.062310 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m11:49:04.071652 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m11:49:04.073506 [debug] [Thread-3 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m11:49:04.075671 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:49:04.078937 [debug] [Thread-3 (]: On model.my_project.weather_report: COMMIT
[0m11:49:04.079818 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m11:49:04.081307 [debug] [Thread-3 (]: On model.my_project.weather_report: COMMIT
[0m11:49:04.087734 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m11:49:04.092822 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m11:49:04.094198 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m11:49:04.095095 [debug] [Thread-3 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m11:49:04.096554 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m11:49:04.100964 [debug] [Thread-3 (]: On model.my_project.weather_report: Close
[0m11:49:04.103020 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5597d0cf-632d-4751-a7af-c277dfc27185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709e9b3a37a0>]}
[0m11:49:04.105486 [info ] [Thread-3 (]: 2 of 2 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.09s]
[0m11:49:04.108600 [debug] [Thread-3 (]: Finished running node model.my_project.weather_report
[0m11:49:04.113129 [debug] [MainThread]: Using postgres connection "master"
[0m11:49:04.114333 [debug] [MainThread]: On master: BEGIN
[0m11:49:04.115536 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:49:04.135331 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m11:49:04.136119 [debug] [MainThread]: On master: COMMIT
[0m11:49:04.136888 [debug] [MainThread]: Using postgres connection "master"
[0m11:49:04.137474 [debug] [MainThread]: On master: COMMIT
[0m11:49:04.139313 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:49:04.141520 [debug] [MainThread]: On master: Close
[0m11:49:04.143933 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:49:04.145127 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m11:49:04.145931 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m11:49:04.146837 [info ] [MainThread]: 
[0m11:49:04.148823 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m11:49:04.151745 [debug] [MainThread]: Command end result
[0m11:49:04.189603 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:49:04.192399 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:49:04.202745 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:49:04.203356 [info ] [MainThread]: 
[0m11:49:04.204329 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:49:04.205230 [info ] [MainThread]: 
[0m11:49:04.206343 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:49:04.208781 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.214026, "process_in_blocks": "0", "process_kernel_time": 0.626702, "process_mem_max_rss": "110556", "process_out_blocks": "2560", "process_user_time": 3.928941}
[0m11:49:04.209952 [debug] [MainThread]: Command `dbt run` succeeded at 11:49:04.209724 after 2.22 seconds
[0m11:49:04.210730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709ebe6d68a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709ebbb803e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709ebcf00500>]}
[0m11:49:04.211500 [debug] [MainThread]: Flushing usage events
[0m11:49:09.743898 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:01:56.968214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214878269c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72148767cbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214890dc050>]}


============================== 12:01:56.973346 | 77bb3b9a-109f-484d-b10a-fec5e9116149 ==============================
[0m12:01:56.973346 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:01:56.974740 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:01:57.290173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77bb3b9a-109f-484d-b10a-fec5e9116149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721488e5b1d0>]}
[0m12:01:57.373542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77bb3b9a-109f-484d-b10a-fec5e9116149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214859b77d0>]}
[0m12:01:57.374975 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:01:57.511248 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:01:57.663157 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m12:01:57.663953 [debug] [MainThread]: Partial parsing: added file: my_project://models/mart/daily_average.sql
[0m12:01:57.664609 [debug] [MainThread]: Partial parsing: updated file: my_project://models/mart/weather_report.sql
[0m12:01:58.126791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77bb3b9a-109f-484d-b10a-fec5e9116149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214855b7680>]}
[0m12:01:58.291122 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:01:58.294485 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:01:58.316597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77bb3b9a-109f-484d-b10a-fec5e9116149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214854df020>]}
[0m12:01:58.317226 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:01:58.317832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77bb3b9a-109f-484d-b10a-fec5e9116149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721485598470>]}
[0m12:01:58.320584 [info ] [MainThread]: 
[0m12:01:58.321138 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:01:58.321704 [info ] [MainThread]: 
[0m12:01:58.322739 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:01:58.329989 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:01:58.405269 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:01:58.405859 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:01:58.406363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:01:58.465867 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.059 seconds
[0m12:01:58.467714 [debug] [ThreadPool]: On list_db: Close
[0m12:01:58.470090 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:01:58.478355 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:01:58.478941 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:01:58.479354 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:58.509420 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m12:01:58.511280 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:01:58.512879 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:01:58.548254 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.034 seconds
[0m12:01:58.554056 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:01:58.556433 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:01:58.578828 [debug] [MainThread]: Using postgres connection "master"
[0m12:01:58.580421 [debug] [MainThread]: On master: BEGIN
[0m12:01:58.582267 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:01:58.644291 [debug] [MainThread]: SQL status: BEGIN in 0.062 seconds
[0m12:01:58.646531 [debug] [MainThread]: Using postgres connection "master"
[0m12:01:58.648278 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:01:58.691854 [debug] [MainThread]: SQL status: SELECT 0 in 0.041 seconds
[0m12:01:58.698420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77bb3b9a-109f-484d-b10a-fec5e9116149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72146773fb90>]}
[0m12:01:58.700218 [debug] [MainThread]: On master: ROLLBACK
[0m12:01:58.702753 [debug] [MainThread]: Using postgres connection "master"
[0m12:01:58.704204 [debug] [MainThread]: On master: BEGIN
[0m12:01:58.707703 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m12:01:58.709185 [debug] [MainThread]: On master: COMMIT
[0m12:01:58.710801 [debug] [MainThread]: Using postgres connection "master"
[0m12:01:58.712235 [debug] [MainThread]: On master: COMMIT
[0m12:01:58.714958 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:01:58.717030 [debug] [MainThread]: On master: Close
[0m12:01:58.734308 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m12:01:58.737021 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m12:01:58.739791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m12:01:58.742020 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m12:01:58.779185 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m12:01:58.782179 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m12:01:58.959098 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m12:01:58.964685 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:01:58.970195 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m12:01:58.974794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:59.000116 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m12:01:59.001199 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:01:59.002429 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m12:01:59.011608 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m12:01:59.028429 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:01:59.029666 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m12:01:59.031448 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:01:59.090925 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:01:59.091865 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:01:59.092693 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:01:59.098511 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m12:01:59.107072 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m12:01:59.114891 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:01:59.115438 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m12:01:59.116481 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:01:59.119698 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m12:01:59.121995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77bb3b9a-109f-484d-b10a-fec5e9116149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721488e5a2a0>]}
[0m12:01:59.122846 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.38s]
[0m12:01:59.123867 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m12:01:59.125673 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:01:59.126343 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:01:59.127204 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:01:59.128267 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:01:59.129660 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:01:59.130642 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:01:59.131347 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:01:59.132193 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:01:59.137005 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:01:59.142571 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:01:59.143984 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:01:59.144790 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:01:59.151943 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:01:59.156535 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:01:59.157955 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:01:59.158469 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:01:59.158951 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:01:59.159852 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:01:59.160910 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:01:59.162124 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:01:59.174776 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m12:01:59.175398 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:01:59.175929 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m12:01:59.177395 [debug] [Thread-4 (]: SQL status: BEGIN in 0.018 seconds
[0m12:01:59.178099 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:01:59.178632 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m12:01:59.187083 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m12:01:59.187716 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.009 seconds
[0m12:01:59.191776 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:01:59.196068 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:01:59.196873 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:01:59.197869 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:01:59.199237 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:01:59.199787 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:01:59.201960 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:01:59.205729 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:01:59.206404 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:01:59.207078 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:01:59.207728 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:01:59.208872 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:01:59.213895 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:01:59.214579 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m12:01:59.216300 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:01:59.224550 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:01:59.226968 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:01:59.232118 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:01:59.236234 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:01:59.239049 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m12:01:59.246260 [debug] [Thread-4 (]: SQL status: COMMIT in 0.011 seconds
[0m12:01:59.244788 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:01:59.254956 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:01:59.258266 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:01:59.260463 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77bb3b9a-109f-484d-b10a-fec5e9116149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72146456fdd0>]}
[0m12:01:59.262459 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:01:59.265425 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.13s]
[0m12:01:59.269415 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:01:59.280719 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.012 seconds
[0m12:01:59.289362 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:01:59.292424 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77bb3b9a-109f-484d-b10a-fec5e9116149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72146456f7d0>]}
[0m12:01:59.295625 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.16s]
[0m12:01:59.300503 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:01:59.310223 [debug] [MainThread]: Using postgres connection "master"
[0m12:01:59.312431 [debug] [MainThread]: On master: BEGIN
[0m12:01:59.314121 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:01:59.371024 [debug] [MainThread]: SQL status: BEGIN in 0.057 seconds
[0m12:01:59.373256 [debug] [MainThread]: On master: COMMIT
[0m12:01:59.374932 [debug] [MainThread]: Using postgres connection "master"
[0m12:01:59.376286 [debug] [MainThread]: On master: COMMIT
[0m12:01:59.378898 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:01:59.380499 [debug] [MainThread]: On master: Close
[0m12:01:59.382594 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:01:59.383920 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m12:01:59.385633 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:01:59.387732 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:01:59.389416 [info ] [MainThread]: 
[0m12:01:59.391248 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.07 seconds (1.07s).
[0m12:01:59.397414 [debug] [MainThread]: Command end result
[0m12:01:59.479056 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:01:59.483510 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:01:59.493728 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:01:59.494469 [info ] [MainThread]: 
[0m12:01:59.495144 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:01:59.496006 [info ] [MainThread]: 
[0m12:01:59.497510 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:01:59.500314 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.6439247, "process_in_blocks": "8", "process_kernel_time": 0.619871, "process_mem_max_rss": "110940", "process_out_blocks": "2624", "process_user_time": 3.807212}
[0m12:01:59.501506 [debug] [MainThread]: Command `dbt run` succeeded at 12:01:59.501306 after 2.65 seconds
[0m12:01:59.502317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72148767cbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721488e5a2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214855b7ad0>]}
[0m12:01:59.503574 [debug] [MainThread]: Flushing usage events
[0m12:02:01.670192 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:16:06.812849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ff4900c530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ff4900e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ff4900c710>]}


============================== 12:16:06.819067 | ba84a9a6-7d6a-4dad-9138-519ff4f54190 ==============================
[0m12:16:06.819067 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:16:06.820361 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:16:07.344544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba84a9a6-7d6a-4dad-9138-519ff4f54190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ff4a82b7a0>]}
[0m12:16:07.497705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba84a9a6-7d6a-4dad-9138-519ff4f54190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ff490d9d00>]}
[0m12:16:07.499127 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:16:07.743008 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:16:07.949956 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:16:07.950587 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:16:08.047409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba84a9a6-7d6a-4dad-9138-519ff4f54190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ff4716cf50>]}
[0m12:16:08.238378 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:16:08.243599 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:16:08.384203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba84a9a6-7d6a-4dad-9138-519ff4f54190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ff46f50530>]}
[0m12:16:08.384885 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:16:08.385440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba84a9a6-7d6a-4dad-9138-519ff4f54190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ff47223770>]}
[0m12:16:08.391846 [info ] [MainThread]: 
[0m12:16:08.392814 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:16:08.393696 [info ] [MainThread]: 
[0m12:16:08.395336 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:16:08.402303 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:16:08.499443 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:16:08.500031 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:16:08.500503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:08.522030 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.021 seconds
[0m12:16:08.524344 [debug] [ThreadPool]: On list_db: Close
[0m12:16:08.526745 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:16:08.534897 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:16:08.539356 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:16:08.540471 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:16:08.566304 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m12:16:08.567788 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:16:08.569357 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:16:08.588814 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.017 seconds
[0m12:16:08.594497 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:16:08.596513 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:16:08.615371 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:08.616451 [debug] [MainThread]: On master: BEGIN
[0m12:16:08.617524 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:16:08.652050 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m12:16:08.655294 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:08.658483 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:16:08.670509 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m12:16:08.675213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba84a9a6-7d6a-4dad-9138-519ff4f54190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ff48a2e3f0>]}
[0m12:16:08.676819 [debug] [MainThread]: On master: ROLLBACK
[0m12:16:08.678613 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:08.679772 [debug] [MainThread]: On master: BEGIN
[0m12:16:08.681878 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:16:08.684765 [debug] [MainThread]: On master: COMMIT
[0m12:16:08.687257 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:08.688491 [debug] [MainThread]: On master: COMMIT
[0m12:16:08.690624 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:16:08.692762 [debug] [MainThread]: On master: Close
[0m12:16:08.708759 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m12:16:08.710971 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m12:16:08.712991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m12:16:08.715538 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m12:16:08.755052 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m12:16:08.756886 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m12:16:08.890569 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m12:16:08.893055 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:16:08.895588 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m12:16:08.896961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:08.916010 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m12:16:08.917233 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:16:08.919776 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m12:16:08.927504 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m12:16:08.945037 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:16:08.945764 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m12:16:08.947278 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:16:08.953041 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:16:08.954454 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m12:16:08.955667 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:16:08.991511 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:16:08.993306 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:16:08.994296 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:16:08.998939 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m12:16:09.013202 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m12:16:09.024171 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:16:09.024818 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m12:16:09.141711 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.116 seconds
[0m12:16:09.155169 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m12:16:09.178784 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba84a9a6-7d6a-4dad-9138-519ff4f54190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ff4a82a900>]}
[0m12:16:09.185087 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.45s]
[0m12:16:09.193697 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m12:16:09.196627 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:16:09.197750 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:16:09.200470 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:16:09.204422 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:16:09.207619 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:16:09.209521 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:16:09.210688 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:16:09.211721 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:16:09.229076 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:16:09.232057 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:16:09.235008 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:16:09.242368 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:16:09.244591 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:16:09.255469 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:16:09.258877 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:16:09.260063 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:16:09.261286 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:16:09.262526 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:16:09.263503 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:16:09.264350 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:16:09.293632 [debug] [Thread-3 (]: SQL status: BEGIN in 0.029 seconds
[0m12:16:09.295375 [debug] [Thread-4 (]: SQL status: BEGIN in 0.032 seconds
[0m12:16:09.297040 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:16:09.298650 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:16:09.302198 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m12:16:09.304269 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m12:16:09.314319 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m12:16:09.323966 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:16:09.325036 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.019 seconds
[0m12:16:09.325980 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:16:09.334364 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:16:09.336430 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:16:09.338050 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:16:09.346531 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m12:16:09.350401 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:16:09.360917 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:16:09.362207 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:16:09.363811 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:16:09.367497 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:16:09.369806 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:16:09.377403 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:16:09.382697 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:16:09.384645 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:16:09.385743 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:16:09.386912 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:16:09.388129 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:16:09.500114 [debug] [Thread-4 (]: SQL status: COMMIT in 0.111 seconds
[0m12:16:09.505476 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:16:09.506506 [debug] [Thread-3 (]: SQL status: COMMIT in 0.117 seconds
[0m12:16:09.508103 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:16:09.513832 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:16:09.518015 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:16:09.521601 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:16:09.526357 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:16:09.534702 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.009 seconds
[0m12:16:09.539244 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:16:09.540720 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.013 seconds
[0m12:16:09.543151 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba84a9a6-7d6a-4dad-9138-519ff4f54190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ff2ef33e60>]}
[0m12:16:09.550576 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:16:09.554996 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.33s]
[0m12:16:09.557727 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:16:09.559398 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba84a9a6-7d6a-4dad-9138-519ff4f54190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ff2ef23bf0>]}
[0m12:16:09.561178 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.35s]
[0m12:16:09.562680 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:16:09.570824 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:09.572724 [debug] [MainThread]: On master: BEGIN
[0m12:16:09.574939 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:16:09.593536 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m12:16:09.594789 [debug] [MainThread]: On master: COMMIT
[0m12:16:09.595359 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:09.595830 [debug] [MainThread]: On master: COMMIT
[0m12:16:09.597023 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:16:09.599137 [debug] [MainThread]: On master: Close
[0m12:16:09.601202 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:09.602841 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m12:16:09.605255 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:16:09.606454 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:16:09.607170 [info ] [MainThread]: 
[0m12:16:09.608012 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.21 seconds (1.21s).
[0m12:16:09.610701 [debug] [MainThread]: Command end result
[0m12:16:09.656888 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:16:09.659295 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:16:09.670501 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:16:09.671030 [info ] [MainThread]: 
[0m12:16:09.671684 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:16:09.672280 [info ] [MainThread]: 
[0m12:16:09.673155 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:16:09.674987 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.0219123, "process_in_blocks": "1864", "process_kernel_time": 0.865903, "process_mem_max_rss": "107416", "process_out_blocks": "1792", "process_user_time": 4.437757}
[0m12:16:09.675728 [debug] [MainThread]: Command `dbt run` succeeded at 12:16:09.675572 after 3.02 seconds
[0m12:16:09.676234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ff48a92300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ff497362a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ff461d5040>]}
[0m12:16:09.676799 [debug] [MainThread]: Flushing usage events
[0m12:16:11.302476 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:17:39.046522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7351979ed790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7351976bcb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7351979ef0b0>]}


============================== 12:17:39.057299 | 52bb4a5a-c02c-40ec-9c05-4eaf0e4f3077 ==============================
[0m12:17:39.057299 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:17:39.058769 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:17:39.366959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52bb4a5a-c02c-40ec-9c05-4eaf0e4f3077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735195b7a810>]}
[0m12:17:39.459159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52bb4a5a-c02c-40ec-9c05-4eaf0e4f3077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735197627e00>]}
[0m12:17:39.460251 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:17:39.621174 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:17:39.805901 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:17:39.806462 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:17:39.861666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52bb4a5a-c02c-40ec-9c05-4eaf0e4f3077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735195bfcef0>]}
[0m12:17:39.972903 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:17:39.976489 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:17:40.017216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52bb4a5a-c02c-40ec-9c05-4eaf0e4f3077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735195968260>]}
[0m12:17:40.017930 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:17:40.018449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52bb4a5a-c02c-40ec-9c05-4eaf0e4f3077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7351987d3c20>]}
[0m12:17:40.021332 [info ] [MainThread]: 
[0m12:17:40.021919 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:17:40.022410 [info ] [MainThread]: 
[0m12:17:40.023796 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:17:40.030840 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:17:40.127119 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:17:40.127661 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:17:40.128092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:40.168102 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.040 seconds
[0m12:17:40.170102 [debug] [ThreadPool]: On list_db: Close
[0m12:17:40.172259 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:17:40.180041 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:17:40.180562 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:17:40.180982 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:17:40.193501 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m12:17:40.194139 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:17:40.194920 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:17:40.207432 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.012 seconds
[0m12:17:40.209921 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:17:40.211075 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:17:40.219383 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:40.219951 [debug] [MainThread]: On master: BEGIN
[0m12:17:40.220443 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:17:40.238329 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m12:17:40.239035 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:40.240006 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:17:40.256552 [debug] [MainThread]: SQL status: SELECT 0 in 0.016 seconds
[0m12:17:40.259666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52bb4a5a-c02c-40ec-9c05-4eaf0e4f3077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7351974c0a10>]}
[0m12:17:40.260559 [debug] [MainThread]: On master: ROLLBACK
[0m12:17:40.261652 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:40.262172 [debug] [MainThread]: On master: BEGIN
[0m12:17:40.263387 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:17:40.264148 [debug] [MainThread]: On master: COMMIT
[0m12:17:40.264837 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:40.265358 [debug] [MainThread]: On master: COMMIT
[0m12:17:40.266191 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:17:40.266711 [debug] [MainThread]: On master: Close
[0m12:17:40.271659 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m12:17:40.273009 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m12:17:40.273937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m12:17:40.276208 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m12:17:40.291897 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m12:17:40.293330 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m12:17:40.385054 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m12:17:40.386087 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:17:40.386576 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m12:17:40.387139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:40.403329 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m12:17:40.404496 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:17:40.405446 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m12:17:40.514193 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.108 seconds
[0m12:17:40.522164 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:17:40.522728 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m12:17:40.524121 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:17:40.527899 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:17:40.528468 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m12:17:40.529648 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:17:40.557479 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:17:40.558045 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:17:40.558512 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:17:40.564366 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m12:17:40.573645 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m12:17:40.581353 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:17:40.581849 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m12:17:40.589110 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m12:17:40.593041 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m12:17:40.595915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52bb4a5a-c02c-40ec-9c05-4eaf0e4f3077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735197f86420>]}
[0m12:17:40.596888 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.32s]
[0m12:17:40.598083 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m12:17:40.600477 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:17:40.602256 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:17:40.603969 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:17:40.605260 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:17:40.606397 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:17:40.601631 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:17:40.611771 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:17:40.612710 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:17:40.613702 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:17:40.620502 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:17:40.621622 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:17:40.627206 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:17:40.628394 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:17:40.634251 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:17:40.634874 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:17:40.635612 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:17:40.636496 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:17:40.637459 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:17:40.638048 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:17:40.638694 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:17:40.652648 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m12:17:40.653689 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:17:40.654569 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m12:17:40.656248 [debug] [Thread-4 (]: SQL status: BEGIN in 0.020 seconds
[0m12:17:40.657008 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:17:40.659141 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m12:17:40.660636 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m12:17:40.667609 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:17:40.668235 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.008 seconds
[0m12:17:40.668820 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:17:40.675112 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:17:40.676295 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:17:40.677238 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:17:40.683730 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m12:17:40.684257 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:17:40.688170 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:17:40.688860 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:17:40.689505 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:17:40.691060 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:17:40.691893 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:17:40.694790 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:17:40.697319 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:17:40.697976 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:17:40.698614 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:17:40.699260 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:17:40.699940 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:17:41.576587 [debug] [Thread-3 (]: SQL status: COMMIT in 0.876 seconds
[0m12:17:41.580916 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:17:41.581577 [debug] [Thread-4 (]: SQL status: COMMIT in 0.881 seconds
[0m12:17:41.582668 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:17:41.586372 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:17:41.587373 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:17:41.588517 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:17:41.589904 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:17:41.595993 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m12:17:41.598533 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:17:41.599867 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.009 seconds
[0m12:17:41.600918 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52bb4a5a-c02c-40ec-9c05-4eaf0e4f3077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73519419b560>]}
[0m12:17:41.603389 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:17:41.604794 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.99s]
[0m12:17:41.606657 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:17:41.608037 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52bb4a5a-c02c-40ec-9c05-4eaf0e4f3077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73519419e450>]}
[0m12:17:41.610251 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 1.00s]
[0m12:17:41.611750 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:17:41.616374 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:41.617375 [debug] [MainThread]: On master: BEGIN
[0m12:17:41.618320 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:17:41.634190 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m12:17:41.636102 [debug] [MainThread]: On master: COMMIT
[0m12:17:41.637203 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:41.637708 [debug] [MainThread]: On master: COMMIT
[0m12:17:41.638584 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:17:41.639451 [debug] [MainThread]: On master: Close
[0m12:17:41.641049 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:17:41.641664 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m12:17:41.642332 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:17:41.643033 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:17:41.643950 [info ] [MainThread]: 
[0m12:17:41.644843 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.62 seconds (1.62s).
[0m12:17:41.648102 [debug] [MainThread]: Command end result
[0m12:17:41.693151 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:17:41.695575 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:17:41.704820 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:17:41.705561 [info ] [MainThread]: 
[0m12:17:41.706786 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:17:41.707663 [info ] [MainThread]: 
[0m12:17:41.708542 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:17:41.710448 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.7397304, "process_in_blocks": "824", "process_kernel_time": 1.006102, "process_mem_max_rss": "108216", "process_out_blocks": "3400", "process_user_time": 3.419146}
[0m12:17:41.711353 [debug] [MainThread]: Command `dbt run` succeeded at 12:17:41.711181 after 2.74 seconds
[0m12:17:41.711960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7351958e6ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735195bab320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735195c1e960>]}
[0m12:17:41.712519 [debug] [MainThread]: Flushing usage events
[0m12:17:43.133908 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:25:29.222015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db462a1e360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db460d20a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db460fbfda0>]}


============================== 12:25:29.226652 | 458e820c-0c75-4887-9a63-4da6eeb674ae ==============================
[0m12:25:29.226652 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:25:29.228034 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:25:29.529091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '458e820c-0c75-4887-9a63-4da6eeb674ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db460a3a7b0>]}
[0m12:25:29.625384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '458e820c-0c75-4887-9a63-4da6eeb674ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db4616a0980>]}
[0m12:25:29.626622 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:25:29.772459 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:25:29.950777 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:25:29.951374 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:25:30.020782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '458e820c-0c75-4887-9a63-4da6eeb674ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db45f2e07d0>]}
[0m12:25:30.149793 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:25:30.153402 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:25:30.178004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '458e820c-0c75-4887-9a63-4da6eeb674ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db45eff8260>]}
[0m12:25:30.178718 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:25:30.179330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '458e820c-0c75-4887-9a63-4da6eeb674ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db45efea570>]}
[0m12:25:30.182764 [info ] [MainThread]: 
[0m12:25:30.183528 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:25:30.184162 [info ] [MainThread]: 
[0m12:25:30.185551 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:25:30.192858 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:25:30.270356 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:25:30.270909 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:25:30.271455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:30.290609 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.019 seconds
[0m12:25:30.292548 [debug] [ThreadPool]: On list_db: Close
[0m12:25:30.295472 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:25:30.308730 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:25:30.309510 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:25:30.309920 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:30.323552 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m12:25:30.324544 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:25:30.325330 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:25:30.333352 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m12:25:30.335388 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:25:30.336231 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:25:30.347446 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:30.348163 [debug] [MainThread]: On master: BEGIN
[0m12:25:30.348668 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:25:30.361216 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m12:25:30.363263 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:30.364344 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:25:30.370265 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m12:25:30.372458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '458e820c-0c75-4887-9a63-4da6eeb674ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db460a3a390>]}
[0m12:25:30.373131 [debug] [MainThread]: On master: ROLLBACK
[0m12:25:30.374045 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:30.374513 [debug] [MainThread]: On master: BEGIN
[0m12:25:30.375624 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:25:30.376216 [debug] [MainThread]: On master: COMMIT
[0m12:25:30.376793 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:30.377807 [debug] [MainThread]: On master: COMMIT
[0m12:25:30.379524 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:25:30.380543 [debug] [MainThread]: On master: Close
[0m12:25:30.386587 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m12:25:30.387437 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m12:25:30.388328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m12:25:30.388972 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m12:25:30.401589 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m12:25:30.402535 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m12:25:30.463580 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m12:25:30.464562 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:25:30.465085 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m12:25:30.465583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:30.478075 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m12:25:30.479247 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:25:30.479867 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m12:25:30.485757 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m12:25:30.497237 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:25:30.498008 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m12:25:30.499251 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:25:30.503695 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:25:30.504363 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m12:25:30.505537 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:25:30.541236 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:25:30.542146 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:25:30.543088 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:25:30.879177 [debug] [Thread-1 (]: SQL status: COMMIT in 0.335 seconds
[0m12:25:30.890024 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m12:25:30.902572 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:25:30.903817 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m12:25:31.062449 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.158 seconds
[0m12:25:31.069453 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m12:25:31.073521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '458e820c-0c75-4887-9a63-4da6eeb674ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db4628d2570>]}
[0m12:25:31.075507 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.68s]
[0m12:25:31.078514 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m12:25:31.081922 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:25:31.083209 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:25:31.084285 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:25:31.085716 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:25:31.087498 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:25:31.088906 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:25:31.089824 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:25:31.091005 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:25:31.097049 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:25:31.106708 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:25:31.108920 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:25:31.110195 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:25:31.117345 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:25:31.122858 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:25:31.124325 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:25:31.125034 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:25:31.125808 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:25:31.126330 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:25:31.127219 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:25:31.128632 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:25:31.145439 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m12:25:31.147167 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:25:31.149310 [debug] [Thread-4 (]: SQL status: BEGIN in 0.020 seconds
[0m12:25:31.150527 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m12:25:31.151886 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:25:31.153531 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m12:25:31.158344 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m12:25:31.159232 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m12:25:31.167266 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:25:31.173328 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:25:31.175141 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:25:31.176041 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:25:31.178090 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:25:31.179314 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:25:31.187088 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:25:31.196122 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:25:31.197857 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:25:31.199599 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:25:31.203020 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:25:31.203971 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:25:31.208620 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:25:31.211954 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:25:31.212823 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:25:31.213596 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:25:31.214394 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:25:31.215076 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:25:31.223101 [debug] [Thread-3 (]: SQL status: COMMIT in 0.007 seconds
[0m12:25:31.227535 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:25:31.228898 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:25:31.230430 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:25:31.370324 [debug] [Thread-4 (]: SQL status: COMMIT in 0.154 seconds
[0m12:25:31.375503 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:25:31.376313 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.145 seconds
[0m12:25:31.377607 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:25:31.380395 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:25:31.381279 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:25:31.382833 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '458e820c-0c75-4887-9a63-4da6eeb674ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db45c093dd0>]}
[0m12:25:31.384252 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.30s]
[0m12:25:31.385702 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:25:31.553555 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.171 seconds
[0m12:25:31.557060 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:25:31.558486 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '458e820c-0c75-4887-9a63-4da6eeb674ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db45c0a7f20>]}
[0m12:25:31.559866 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.47s]
[0m12:25:31.571874 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:25:31.576042 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:31.577021 [debug] [MainThread]: On master: BEGIN
[0m12:25:31.578370 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:25:31.598537 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m12:25:31.599817 [debug] [MainThread]: On master: COMMIT
[0m12:25:31.600668 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:31.601175 [debug] [MainThread]: On master: COMMIT
[0m12:25:31.602004 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:25:31.602579 [debug] [MainThread]: On master: Close
[0m12:25:31.603718 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:25:31.604266 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m12:25:31.604907 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:25:31.605559 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:25:31.606236 [info ] [MainThread]: 
[0m12:25:31.606999 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.42 seconds (1.42s).
[0m12:25:31.610747 [debug] [MainThread]: Command end result
[0m12:25:31.675762 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:25:31.679971 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:25:31.690464 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:25:31.691039 [info ] [MainThread]: 
[0m12:25:31.691649 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:25:31.692285 [info ] [MainThread]: 
[0m12:25:31.693329 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:25:31.696538 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.6028538, "process_in_blocks": "0", "process_kernel_time": 0.579843, "process_mem_max_rss": "107456", "process_out_blocks": "1792", "process_user_time": 3.607915}
[0m12:25:31.698711 [debug] [MainThread]: Command `dbt run` succeeded at 12:25:31.698367 after 2.61 seconds
[0m12:25:31.699705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db4610bbe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db462be2090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db460d85220>]}
[0m12:25:31.700644 [debug] [MainThread]: Flushing usage events
[0m12:25:33.267097 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:31:27.031859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc9e4a51a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc9e4d4c860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc9e4a511c0>]}


============================== 12:31:27.040976 | c4e32c71-0990-4037-8637-ab59fbe8dba5 ==============================
[0m12:31:27.040976 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:31:27.042196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:31:27.399865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4e32c71-0990-4037-8637-ab59fbe8dba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc9e4542a20>]}
[0m12:31:27.521793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4e32c71-0990-4037-8637-ab59fbe8dba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc9e4a7f5c0>]}
[0m12:31:27.523471 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:31:27.699176 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:31:27.935871 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:31:27.936480 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:31:28.003576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4e32c71-0990-4037-8637-ab59fbe8dba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc9e2b80c80>]}
[0m12:31:28.144812 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:31:28.148424 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:31:28.186212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4e32c71-0990-4037-8637-ab59fbe8dba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc9e2960770>]}
[0m12:31:28.187116 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:31:28.188621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4e32c71-0990-4037-8637-ab59fbe8dba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc9e2929c70>]}
[0m12:31:28.192075 [info ] [MainThread]: 
[0m12:31:28.192991 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:31:28.193843 [info ] [MainThread]: 
[0m12:31:28.195241 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:31:28.204661 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:31:28.311858 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:31:28.312403 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:31:28.312941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:28.342920 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.030 seconds
[0m12:31:28.344950 [debug] [ThreadPool]: On list_db: Close
[0m12:31:28.347884 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:31:28.360189 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:31:28.360745 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:31:28.361246 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:31:28.374826 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m12:31:28.375809 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:31:28.376425 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:31:28.383025 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m12:31:28.387346 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:31:28.388602 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:31:28.399778 [debug] [MainThread]: Using postgres connection "master"
[0m12:31:28.401460 [debug] [MainThread]: On master: BEGIN
[0m12:31:28.402857 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:31:28.417198 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m12:31:28.419146 [debug] [MainThread]: Using postgres connection "master"
[0m12:31:28.419943 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:31:28.427368 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m12:31:28.430213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4e32c71-0990-4037-8637-ab59fbe8dba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc9e2c48ce0>]}
[0m12:31:28.431078 [debug] [MainThread]: On master: ROLLBACK
[0m12:31:28.431925 [debug] [MainThread]: Using postgres connection "master"
[0m12:31:28.432515 [debug] [MainThread]: On master: BEGIN
[0m12:31:28.435423 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m12:31:28.436985 [debug] [MainThread]: On master: COMMIT
[0m12:31:28.439090 [debug] [MainThread]: Using postgres connection "master"
[0m12:31:28.440100 [debug] [MainThread]: On master: COMMIT
[0m12:31:28.441035 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:31:28.441565 [debug] [MainThread]: On master: Close
[0m12:31:28.446755 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m12:31:28.447606 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m12:31:28.448475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m12:31:28.449714 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m12:31:28.464333 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m12:31:28.465357 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m12:31:28.541123 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m12:31:28.542131 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:31:28.542656 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m12:31:28.543106 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:28.557409 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m12:31:28.558360 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:31:28.559240 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m12:31:28.567231 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m12:31:28.579483 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:31:28.580074 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m12:31:28.581291 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:31:28.589136 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:31:28.589783 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m12:31:28.591539 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:31:28.631130 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:31:28.632015 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:31:28.635238 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:31:28.730174 [debug] [Thread-1 (]: SQL status: COMMIT in 0.094 seconds
[0m12:31:28.745497 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m12:31:28.758102 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:31:28.758965 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m12:31:28.765836 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m12:31:28.772741 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m12:31:28.775362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4e32c71-0990-4037-8637-ab59fbe8dba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc9e622e5a0>]}
[0m12:31:28.776361 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.33s]
[0m12:31:28.777877 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m12:31:28.780156 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:31:28.780982 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:31:28.781743 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:31:28.785939 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:31:28.783383 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:31:28.788053 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:31:28.791062 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:31:28.796280 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:31:28.797163 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:31:28.804859 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:31:28.806382 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:31:28.811046 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:31:28.812090 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:31:28.817524 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:31:28.819676 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:31:28.820373 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:31:28.820927 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:31:28.821521 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:31:28.822528 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:31:28.823184 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:31:28.836095 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m12:31:28.837618 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:31:28.838698 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m12:31:28.839404 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m12:31:28.840531 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:31:28.841221 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m12:31:28.845936 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m12:31:28.846659 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m12:31:28.853660 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:31:28.859105 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:31:28.859874 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:31:28.860471 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:31:28.861965 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:31:28.862528 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:31:28.867175 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:31:28.875158 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:31:28.875785 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:31:28.876516 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:31:28.877813 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:31:28.878340 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:31:28.880674 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:31:28.884175 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:31:28.885097 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:31:28.885704 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:31:28.886358 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:31:28.886937 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:31:28.892516 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m12:31:28.895776 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:31:28.896448 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m12:31:28.897434 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:31:28.903456 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:31:28.904596 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:31:28.905816 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:31:28.906693 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:31:28.912059 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.005 seconds
[0m12:31:28.914388 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:31:28.915591 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4e32c71-0990-4037-8637-ab59fbe8dba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc9e1c04b60>]}
[0m12:31:28.918371 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.010 seconds
[0m12:31:28.919976 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.13s]
[0m12:31:28.924364 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:31:28.925554 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:31:28.926847 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4e32c71-0990-4037-8637-ab59fbe8dba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc9e0243f50>]}
[0m12:31:28.928449 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.14s]
[0m12:31:28.930675 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:31:28.935876 [debug] [MainThread]: Using postgres connection "master"
[0m12:31:28.936608 [debug] [MainThread]: On master: BEGIN
[0m12:31:28.937847 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:31:28.954176 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m12:31:28.955465 [debug] [MainThread]: On master: COMMIT
[0m12:31:28.956143 [debug] [MainThread]: Using postgres connection "master"
[0m12:31:28.956621 [debug] [MainThread]: On master: COMMIT
[0m12:31:28.957496 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:31:28.958053 [debug] [MainThread]: On master: Close
[0m12:31:28.958900 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:31:28.959316 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m12:31:28.959725 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:31:28.960131 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:31:28.960657 [info ] [MainThread]: 
[0m12:31:28.961689 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m12:31:28.965324 [debug] [MainThread]: Command end result
[0m12:31:29.017663 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:31:29.020970 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:31:29.031817 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:31:29.033165 [info ] [MainThread]: 
[0m12:31:29.034974 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:31:29.036446 [info ] [MainThread]: 
[0m12:31:29.037648 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:31:29.040397 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1671207, "process_in_blocks": "0", "process_kernel_time": 0.675677, "process_mem_max_rss": "107612", "process_out_blocks": "1784", "process_user_time": 3.842166}
[0m12:31:29.041287 [debug] [MainThread]: Command `dbt run` succeeded at 12:31:29.041127 after 2.17 seconds
[0m12:31:29.041888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc9e64b05c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc9e2d5f170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc9e451cc50>]}
[0m12:31:29.042849 [debug] [MainThread]: Flushing usage events
[0m12:31:30.740077 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:35:12.434063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cc04d85e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cc04978dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cc04d877d0>]}


============================== 12:35:12.439011 | 13983b53-4f17-46d8-baf9-bca8b35c76dd ==============================
[0m12:35:12.439011 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:35:12.439890 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:35:12.709385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13983b53-4f17-46d8-baf9-bca8b35c76dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cc047dda90>]}
[0m12:35:12.832986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13983b53-4f17-46d8-baf9-bca8b35c76dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cc066a8050>]}
[0m12:35:12.834174 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:35:13.016679 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:35:13.207217 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:35:13.207988 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:35:13.315620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13983b53-4f17-46d8-baf9-bca8b35c76dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cc0300c7d0>]}
[0m12:35:13.451715 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:35:13.455862 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:35:13.482864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13983b53-4f17-46d8-baf9-bca8b35c76dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cc02d245c0>]}
[0m12:35:13.483572 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:35:13.484249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13983b53-4f17-46d8-baf9-bca8b35c76dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cc02f72660>]}
[0m12:35:13.487566 [info ] [MainThread]: 
[0m12:35:13.488515 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:35:13.489276 [info ] [MainThread]: 
[0m12:35:13.490503 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:35:13.499943 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:35:13.580952 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:35:13.581514 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:35:13.581955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:13.603161 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.021 seconds
[0m12:35:13.605111 [debug] [ThreadPool]: On list_db: Close
[0m12:35:13.607318 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:35:13.614941 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:35:13.615479 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:35:13.615902 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:35:13.629179 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m12:35:13.630029 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:35:13.631026 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:35:13.637929 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m12:35:13.640243 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:35:13.641487 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:35:13.650131 [debug] [MainThread]: Using postgres connection "master"
[0m12:35:13.650832 [debug] [MainThread]: On master: BEGIN
[0m12:35:13.651326 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:35:13.665930 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m12:35:13.666625 [debug] [MainThread]: Using postgres connection "master"
[0m12:35:13.667530 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:35:13.673708 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m12:35:13.676232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13983b53-4f17-46d8-baf9-bca8b35c76dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cc02d16510>]}
[0m12:35:13.677457 [debug] [MainThread]: On master: ROLLBACK
[0m12:35:13.678731 [debug] [MainThread]: Using postgres connection "master"
[0m12:35:13.679432 [debug] [MainThread]: On master: BEGIN
[0m12:35:13.680850 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:35:13.681545 [debug] [MainThread]: On master: COMMIT
[0m12:35:13.682356 [debug] [MainThread]: Using postgres connection "master"
[0m12:35:13.682930 [debug] [MainThread]: On master: COMMIT
[0m12:35:13.683754 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:35:13.684244 [debug] [MainThread]: On master: Close
[0m12:35:13.690136 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m12:35:13.691450 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m12:35:13.692333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m12:35:13.693518 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m12:35:13.705372 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m12:35:13.706439 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m12:35:13.761997 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m12:35:13.762960 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:35:13.763455 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m12:35:13.763962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:13.776088 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m12:35:13.777177 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:35:13.777768 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m12:35:13.783701 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m12:35:13.795046 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:35:13.795656 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m12:35:13.796925 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:35:13.800700 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:35:13.801247 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m12:35:13.802289 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:35:13.829650 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:35:13.830247 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:35:13.830709 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:35:13.853934 [debug] [Thread-1 (]: SQL status: COMMIT in 0.023 seconds
[0m12:35:13.862060 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m12:35:13.870075 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:35:13.870636 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m12:35:13.877000 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m12:35:13.880231 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m12:35:13.882781 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13983b53-4f17-46d8-baf9-bca8b35c76dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cc065fe4b0>]}
[0m12:35:13.883882 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.19s]
[0m12:35:13.885337 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m12:35:13.887352 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:35:13.888030 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:35:13.888969 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:35:13.890064 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:35:13.891376 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:35:13.893494 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:35:13.894289 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:35:13.894947 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:35:13.902071 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:35:13.906774 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:35:13.908464 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:35:13.909716 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:35:13.915245 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:35:13.919808 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:35:13.921698 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:35:13.922649 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:35:13.923305 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:35:13.923987 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:35:13.924628 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:35:13.925298 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:35:13.940720 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m12:35:13.943229 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:35:13.944307 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m12:35:13.946310 [debug] [Thread-4 (]: SQL status: BEGIN in 0.021 seconds
[0m12:35:13.947401 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:35:13.948356 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m12:35:13.952684 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m12:35:13.958820 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:35:13.959670 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.010 seconds
[0m12:35:13.960257 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:35:13.964360 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:35:13.965193 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:35:13.965752 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:35:13.972406 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m12:35:13.974919 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:35:13.981101 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:35:13.981879 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:35:13.982539 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:35:13.983947 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:35:13.984806 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:35:13.987439 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:35:13.990129 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:35:13.990953 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:35:13.991612 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:35:13.992260 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:35:13.992964 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:35:13.998625 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m12:35:14.001913 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:35:14.003046 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:35:14.003627 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:35:14.054248 [debug] [Thread-4 (]: SQL status: COMMIT in 0.060 seconds
[0m12:35:14.058318 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:35:14.059155 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.055 seconds
[0m12:35:14.060364 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:35:14.062919 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:35:14.063736 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:35:14.065354 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13983b53-4f17-46d8-baf9-bca8b35c76dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cc005d5940>]}
[0m12:35:14.066632 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.17s]
[0m12:35:14.068138 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:35:14.071648 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.007 seconds
[0m12:35:14.073915 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:35:14.075045 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13983b53-4f17-46d8-baf9-bca8b35c76dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cc005d3e00>]}
[0m12:35:14.076414 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.18s]
[0m12:35:14.078099 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:35:14.081977 [debug] [MainThread]: Using postgres connection "master"
[0m12:35:14.082630 [debug] [MainThread]: On master: BEGIN
[0m12:35:14.083111 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:35:14.096336 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m12:35:14.097358 [debug] [MainThread]: On master: COMMIT
[0m12:35:14.097968 [debug] [MainThread]: Using postgres connection "master"
[0m12:35:14.098458 [debug] [MainThread]: On master: COMMIT
[0m12:35:14.099264 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:35:14.099748 [debug] [MainThread]: On master: Close
[0m12:35:14.100518 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:35:14.101051 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m12:35:14.101520 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:35:14.102021 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:35:14.102916 [info ] [MainThread]: 
[0m12:35:14.104277 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m12:35:14.108728 [debug] [MainThread]: Command end result
[0m12:35:14.144388 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:35:14.146917 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:35:14.156293 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:35:14.156885 [info ] [MainThread]: 
[0m12:35:14.157556 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:35:14.158188 [info ] [MainThread]: 
[0m12:35:14.159112 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:35:14.161190 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8619766, "process_in_blocks": "0", "process_kernel_time": 0.576883, "process_mem_max_rss": "107676", "process_out_blocks": "1792", "process_user_time": 3.541421}
[0m12:35:14.162327 [debug] [MainThread]: Command `dbt run` succeeded at 12:35:14.162084 after 1.86 seconds
[0m12:35:14.162887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cc04ab07a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cc053ccb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72cc04a49be0>]}
[0m12:35:14.163440 [debug] [MainThread]: Flushing usage events
[0m12:35:15.618769 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:36:59.132848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75af0485ee40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75af02865cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75af038c0da0>]}


============================== 12:36:59.139171 | f66d5acd-088d-49ee-bbe4-4ec0ce5138ef ==============================
[0m12:36:59.139171 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:36:59.140289 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:36:59.491301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f66d5acd-088d-49ee-bbe4-4ec0ce5138ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75af02a34740>]}
[0m12:36:59.611839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f66d5acd-088d-49ee-bbe4-4ec0ce5138ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75af02b71df0>]}
[0m12:36:59.613697 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:36:59.779984 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:36:59.982096 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:36:59.982661 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:37:00.056613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f66d5acd-088d-49ee-bbe4-4ec0ce5138ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75af00f39190>]}
[0m12:37:00.204889 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:37:00.212382 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:37:00.245209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f66d5acd-088d-49ee-bbe4-4ec0ce5138ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75af00c28260>]}
[0m12:37:00.245958 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:37:00.246519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f66d5acd-088d-49ee-bbe4-4ec0ce5138ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75af00c18320>]}
[0m12:37:00.249588 [info ] [MainThread]: 
[0m12:37:00.250269 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:37:00.253539 [info ] [MainThread]: 
[0m12:37:00.255656 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:37:00.267340 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:37:00.359630 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:37:00.360181 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:37:00.360687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:00.383442 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.023 seconds
[0m12:37:00.387343 [debug] [ThreadPool]: On list_db: Close
[0m12:37:00.389944 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:37:00.398693 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:37:00.399408 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:37:00.400042 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:37:00.418168 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m12:37:00.420404 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:37:00.421782 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:37:00.428507 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m12:37:00.431196 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:37:00.432245 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:37:00.449909 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:00.452485 [debug] [MainThread]: On master: BEGIN
[0m12:37:00.454688 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:37:00.469203 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m12:37:00.470229 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:00.471473 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:37:00.482143 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m12:37:00.488082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f66d5acd-088d-49ee-bbe4-4ec0ce5138ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75af00ebd880>]}
[0m12:37:00.489828 [debug] [MainThread]: On master: ROLLBACK
[0m12:37:00.491327 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:00.492327 [debug] [MainThread]: On master: BEGIN
[0m12:37:00.494842 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:37:00.495809 [debug] [MainThread]: On master: COMMIT
[0m12:37:00.496579 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:00.497436 [debug] [MainThread]: On master: COMMIT
[0m12:37:00.498490 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:37:00.499059 [debug] [MainThread]: On master: Close
[0m12:37:00.510346 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m12:37:00.511229 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m12:37:00.512025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m12:37:00.512905 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m12:37:00.531566 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m12:37:00.533159 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m12:37:00.612375 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m12:37:00.613493 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:37:00.614109 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m12:37:00.614609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:37:00.629542 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m12:37:00.630423 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:37:00.631211 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m12:37:00.641387 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m12:37:00.654714 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:37:00.655545 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m12:37:00.656828 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:37:00.660646 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:37:00.661228 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m12:37:00.662408 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:37:00.698873 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:37:00.699547 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:37:00.700170 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:37:00.825009 [debug] [Thread-1 (]: SQL status: COMMIT in 0.123 seconds
[0m12:37:00.837017 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m12:37:00.846013 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:37:00.846620 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m12:37:00.853255 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m12:37:00.856674 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m12:37:00.859168 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66d5acd-088d-49ee-bbe4-4ec0ce5138ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75af04546510>]}
[0m12:37:00.860145 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.35s]
[0m12:37:00.861226 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m12:37:00.863315 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:37:00.864043 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:37:00.864979 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:37:00.866497 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:37:00.868655 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:37:00.870349 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:37:00.871441 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:37:00.872701 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:37:00.883661 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:37:00.891422 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:37:00.893317 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:37:00.898227 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:37:00.899181 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:37:00.905516 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:37:00.906268 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:37:00.909506 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:37:00.910122 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:37:00.911389 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:37:00.912315 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:37:00.912987 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:37:00.924439 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m12:37:00.925473 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:37:00.926402 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m12:37:00.927298 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m12:37:00.928118 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:37:00.929109 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m12:37:00.932876 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m12:37:00.940191 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.013 seconds
[0m12:37:00.943492 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:37:00.947941 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:37:00.948678 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:37:00.949397 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:37:00.953052 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:37:00.954230 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:37:00.960364 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:37:00.966134 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:37:00.967738 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:37:00.969759 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:37:00.971846 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:37:00.972889 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:37:00.975782 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:37:00.978154 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:37:00.978816 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:37:00.979380 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:37:00.980022 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:37:00.980623 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:37:00.986993 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m12:37:00.990337 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:37:00.991027 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m12:37:00.992078 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:37:00.995202 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:37:00.995888 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:37:00.996845 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:37:00.997626 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:37:01.003376 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m12:37:01.007229 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:37:01.009071 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.011 seconds
[0m12:37:01.011624 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:37:01.012345 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66d5acd-088d-49ee-bbe4-4ec0ce5138ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75aefbdd0830>]}
[0m12:37:01.013345 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66d5acd-088d-49ee-bbe4-4ec0ce5138ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75aefbde0710>]}
[0m12:37:01.014456 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.14s]
[0m12:37:01.016300 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.15s]
[0m12:37:01.019702 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:37:01.022142 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:37:01.027406 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:01.027993 [debug] [MainThread]: On master: BEGIN
[0m12:37:01.028460 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:37:01.042631 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m12:37:01.043582 [debug] [MainThread]: On master: COMMIT
[0m12:37:01.044300 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:01.044881 [debug] [MainThread]: On master: COMMIT
[0m12:37:01.045611 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:37:01.046145 [debug] [MainThread]: On master: Close
[0m12:37:01.046928 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:37:01.047393 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m12:37:01.047788 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:37:01.048192 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:37:01.048857 [info ] [MainThread]: 
[0m12:37:01.049744 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m12:37:01.055585 [debug] [MainThread]: Command end result
[0m12:37:01.101435 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:37:01.105467 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:37:01.115131 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:37:01.115668 [info ] [MainThread]: 
[0m12:37:01.120267 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:37:01.121098 [info ] [MainThread]: 
[0m12:37:01.123196 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:37:01.125935 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1195962, "process_in_blocks": "0", "process_kernel_time": 0.58673, "process_mem_max_rss": "107568", "process_out_blocks": "1792", "process_user_time": 3.879603}
[0m12:37:01.126834 [debug] [MainThread]: Command `dbt run` succeeded at 12:37:01.126663 after 2.12 seconds
[0m12:37:01.127475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75af032ccf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75aefbeb4c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75af027f05c0>]}
[0m12:37:01.128046 [debug] [MainThread]: Flushing usage events
[0m12:37:02.735850 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:41:31.844083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e06dbed2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e06dbed3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e06dbed1f0>]}


============================== 12:41:31.851721 | c99d8510-fbb4-40ef-88d0-b47d79b1c0ca ==============================
[0m12:41:31.851721 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:41:31.853073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:41:32.251421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c99d8510-fbb4-40ef-88d0-b47d79b1c0ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e06dd00b30>]}
[0m12:41:32.393542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c99d8510-fbb4-40ef-88d0-b47d79b1c0ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e06dbecbc0>]}
[0m12:41:32.395419 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:41:32.584208 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:41:32.781286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:41:32.781932 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:41:32.846989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c99d8510-fbb4-40ef-88d0-b47d79b1c0ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e06c385a90>]}
[0m12:41:32.992191 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:41:32.996390 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:41:33.024938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c99d8510-fbb4-40ef-88d0-b47d79b1c0ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e06c0a42c0>]}
[0m12:41:33.025658 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:41:33.026317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c99d8510-fbb4-40ef-88d0-b47d79b1c0ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e06c13a240>]}
[0m12:41:33.030244 [info ] [MainThread]: 
[0m12:41:33.030993 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:41:33.032028 [info ] [MainThread]: 
[0m12:41:33.033401 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:41:33.045991 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:41:33.134246 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:41:33.134811 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:41:33.135564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:41:33.154572 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.019 seconds
[0m12:41:33.156456 [debug] [ThreadPool]: On list_db: Close
[0m12:41:33.159055 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:41:33.169626 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:41:33.170388 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:41:33.170907 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:41:33.187008 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m12:41:33.187835 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:41:33.188614 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:41:33.194215 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m12:41:33.197648 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:41:33.198981 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:41:33.209763 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:33.210636 [debug] [MainThread]: On master: BEGIN
[0m12:41:33.211111 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:41:33.225071 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m12:41:33.226185 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:33.227160 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:41:33.233968 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m12:41:33.237298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c99d8510-fbb4-40ef-88d0-b47d79b1c0ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e06c16c200>]}
[0m12:41:33.238261 [debug] [MainThread]: On master: ROLLBACK
[0m12:41:33.239253 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:33.239771 [debug] [MainThread]: On master: BEGIN
[0m12:41:33.240862 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:41:33.241900 [debug] [MainThread]: On master: COMMIT
[0m12:41:33.242628 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:33.243148 [debug] [MainThread]: On master: COMMIT
[0m12:41:33.243978 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:41:33.244507 [debug] [MainThread]: On master: Close
[0m12:41:33.250279 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m12:41:33.251301 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m12:41:33.252682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m12:41:33.254333 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m12:41:33.266280 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m12:41:33.267322 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m12:41:33.337109 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m12:41:33.338276 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:41:33.338807 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m12:41:33.339339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:41:33.352356 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m12:41:33.353826 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:41:33.354803 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m12:41:33.361135 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m12:41:33.375073 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:41:33.376070 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m12:41:33.377476 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:41:33.381693 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:41:33.382381 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m12:41:33.383587 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:41:33.416470 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:41:33.417090 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:41:33.417845 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:41:33.424919 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m12:41:33.435094 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m12:41:33.447716 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:41:33.448507 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m12:41:33.455761 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m12:41:33.459455 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m12:41:33.462130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c99d8510-fbb4-40ef-88d0-b47d79b1c0ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e06f95a7b0>]}
[0m12:41:33.463515 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.21s]
[0m12:41:33.465008 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m12:41:33.467128 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:41:33.467920 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:41:33.468975 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:41:33.470653 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:41:33.472652 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:41:33.474213 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:41:33.475123 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:41:33.476068 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:41:33.482640 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:41:33.490646 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:41:33.492205 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:41:33.492905 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:41:33.497508 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:41:33.502826 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:41:33.505611 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:41:33.506702 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:41:33.507313 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:41:33.507874 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:41:33.508475 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:41:33.509282 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:41:33.522577 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m12:41:33.523725 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m12:41:33.524844 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:41:33.525572 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:41:33.526644 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m12:41:33.527612 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m12:41:33.532570 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m12:41:33.533816 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m12:41:33.540407 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:41:33.545594 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:41:33.546416 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:41:33.547082 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:41:33.548311 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:41:33.548802 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:41:33.555526 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:41:33.562259 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:41:33.563218 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:41:33.564001 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:41:33.565515 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:41:33.566388 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:41:33.569905 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:41:33.574337 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:41:33.575339 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:41:33.576341 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:41:33.577304 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:41:33.578430 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:41:33.584238 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m12:41:33.589183 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:41:33.589949 [debug] [Thread-4 (]: SQL status: COMMIT in 0.010 seconds
[0m12:41:33.591393 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:41:33.596749 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:41:33.597561 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:41:33.598691 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:41:33.599571 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:41:33.605968 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.007 seconds
[0m12:41:33.608877 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:41:33.609615 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.009 seconds
[0m12:41:33.610452 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c99d8510-fbb4-40ef-88d0-b47d79b1c0ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e068137bf0>]}
[0m12:41:33.612587 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:41:33.613820 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.14s]
[0m12:41:33.615704 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:41:33.616580 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c99d8510-fbb4-40ef-88d0-b47d79b1c0ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e06814b5c0>]}
[0m12:41:33.618633 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.14s]
[0m12:41:33.620906 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:41:33.624933 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:33.626291 [debug] [MainThread]: On master: BEGIN
[0m12:41:33.627052 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:41:33.641044 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m12:41:33.642138 [debug] [MainThread]: On master: COMMIT
[0m12:41:33.642802 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:33.643258 [debug] [MainThread]: On master: COMMIT
[0m12:41:33.644034 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:41:33.644592 [debug] [MainThread]: On master: Close
[0m12:41:33.645436 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:41:33.645958 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m12:41:33.646510 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:41:33.647044 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:41:33.647642 [info ] [MainThread]: 
[0m12:41:33.649010 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m12:41:33.654238 [debug] [MainThread]: Command end result
[0m12:41:33.700122 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:41:33.704153 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:41:33.715013 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:41:33.715716 [info ] [MainThread]: 
[0m12:41:33.717078 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:41:33.720502 [info ] [MainThread]: 
[0m12:41:33.721572 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:41:33.724669 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9986962, "process_in_blocks": "0", "process_kernel_time": 0.541804, "process_mem_max_rss": "107372", "process_out_blocks": "1792", "process_user_time": 3.473923}
[0m12:41:33.725891 [debug] [MainThread]: Command `dbt run` succeeded at 12:41:33.725604 after 2.00 seconds
[0m12:41:33.726724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e0713ba8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e06e847e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e06e88ff80>]}
[0m12:41:33.727375 [debug] [MainThread]: Flushing usage events
[0m12:41:35.354469 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:45:42.204842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d4342a1df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d434383290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d4342a3b00>]}


============================== 12:45:42.221170 | 8d83c945-2c1d-4286-a598-6f2f979a1f05 ==============================
[0m12:45:42.221170 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:45:42.221961 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:45:42.221858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dce9ae090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dce810a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dd03fc410>]}


============================== 12:45:42.238550 | 5d515f84-e387-4f19-a275-ec123bf9f2db ==============================
[0m12:45:42.238550 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:45:42.239731 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:45:42.644287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d83c945-2c1d-4286-a598-6f2f979a1f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d435c3b5f0>]}
[0m12:45:42.665471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d515f84-e387-4f19-a275-ec123bf9f2db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dccb6a000>]}
[0m12:45:42.763900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d83c945-2c1d-4286-a598-6f2f979a1f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d4348b8e30>]}
[0m12:45:42.765452 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:45:42.788411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d515f84-e387-4f19-a275-ec123bf9f2db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dcf08f650>]}
[0m12:45:42.789590 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:45:42.957981 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:45:42.973460 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:45:43.191885 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:45:43.192673 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:45:43.204527 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:45:43.205308 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:45:43.277539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d83c945-2c1d-4286-a598-6f2f979a1f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d4324aac00>]}
[0m12:45:43.291176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d515f84-e387-4f19-a275-ec123bf9f2db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dcf45f2c0>]}
[0m12:45:43.433216 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:45:43.435935 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:45:43.438965 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:45:43.496640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d83c945-2c1d-4286-a598-6f2f979a1f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d43218f320>]}
[0m12:45:43.497350 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:45:43.497915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d83c945-2c1d-4286-a598-6f2f979a1f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d4324a9490>]}
[0m12:45:43.500551 [info ] [MainThread]: 
[0m12:45:43.501252 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:45:43.501771 [info ] [MainThread]: 
[0m12:45:43.502762 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:45:43.509430 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:45:43.541731 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:45:43.595322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d515f84-e387-4f19-a275-ec123bf9f2db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dcc92b1a0>]}
[0m12:45:43.596522 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:45:43.597174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d515f84-e387-4f19-a275-ec123bf9f2db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dcc964350>]}
[0m12:45:43.600552 [info ] [MainThread]: 
[0m12:45:43.601319 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:45:43.602206 [info ] [MainThread]: 
[0m12:45:43.603628 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:45:43.614263 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:45:43.624624 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:45:43.625181 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:45:43.625647 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:43.649865 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.024 seconds
[0m12:45:43.651805 [debug] [ThreadPool]: On list_db: Close
[0m12:45:43.654123 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:45:43.668930 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:45:43.669856 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:45:43.670782 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:45:43.694112 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m12:45:43.695680 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:45:43.696276 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:45:43.707650 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.011 seconds
[0m12:45:43.709729 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:45:43.711111 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:45:43.720224 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:43.720886 [debug] [MainThread]: On master: BEGIN
[0m12:45:43.721379 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:45:43.735286 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m12:45:43.736218 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:43.737129 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:45:43.742587 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m12:45:43.747803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d83c945-2c1d-4286-a598-6f2f979a1f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d433c6f6e0>]}
[0m12:45:43.748011 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:45:43.748917 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:45:43.748945 [debug] [MainThread]: On master: ROLLBACK
[0m12:45:43.749578 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:43.749951 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:43.750478 [debug] [MainThread]: On master: BEGIN
[0m12:45:43.751524 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:45:43.752266 [debug] [MainThread]: On master: COMMIT
[0m12:45:43.752959 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:43.753480 [debug] [MainThread]: On master: COMMIT
[0m12:45:43.754308 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:45:43.754866 [debug] [MainThread]: On master: Close
[0m12:45:43.761130 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m12:45:43.763498 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m12:45:43.764906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m12:45:43.765758 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m12:45:43.777837 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.028 seconds
[0m12:45:43.778388 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m12:45:43.780756 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m12:45:43.781327 [debug] [ThreadPool]: On list_db: Close
[0m12:45:43.783776 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:45:43.792068 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:45:43.792611 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:45:43.793244 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:45:43.806991 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m12:45:43.808020 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:45:43.808813 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:45:43.823856 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.014 seconds
[0m12:45:43.826161 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:45:43.828051 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:45:43.837603 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:43.838191 [debug] [MainThread]: On master: BEGIN
[0m12:45:43.838656 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:45:43.853226 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m12:45:43.854003 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:43.855125 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:45:43.861351 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m12:45:43.864134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d515f84-e387-4f19-a275-ec123bf9f2db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dccb33230>]}
[0m12:45:43.864957 [debug] [MainThread]: On master: ROLLBACK
[0m12:45:43.865890 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:43.866472 [debug] [MainThread]: On master: BEGIN
[0m12:45:43.867628 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:45:43.868370 [debug] [MainThread]: On master: COMMIT
[0m12:45:43.869284 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:43.869647 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m12:45:43.870170 [debug] [MainThread]: On master: COMMIT
[0m12:45:43.871118 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:45:43.871546 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:45:43.871865 [debug] [MainThread]: On master: Close
[0m12:45:43.872229 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m12:45:43.872858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:43.880219 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m12:45:43.881551 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m12:45:43.882755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m12:45:43.883954 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m12:45:43.888983 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m12:45:43.889969 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:45:43.890785 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m12:45:43.897416 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m12:45:43.900965 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m12:45:43.901935 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m12:45:43.907568 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:45:43.908172 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m12:45:43.909567 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:45:43.914438 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:45:43.914979 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m12:45:43.916332 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:45:43.956292 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:45:43.956912 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:45:43.957424 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:45:43.962564 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m12:45:43.971987 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m12:45:43.972729 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m12:45:43.972967 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:45:43.973470 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m12:45:43.973951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:43.982930 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:45:43.983635 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m12:45:43.989970 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m12:45:43.994580 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m12:45:43.996532 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m12:45:43.997479 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:45:43.998566 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m12:45:43.998626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d83c945-2c1d-4286-a598-6f2f979a1f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d43480e6c0>]}
[0m12:45:43.999973 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.23s]
[0m12:45:44.001222 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m12:45:44.003387 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:45:44.005672 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m12:45:44.004277 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:45:44.005576 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:45:44.007042 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:45:44.008599 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:45:44.009980 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:45:44.011064 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:45:44.012171 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:45:44.017023 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:45:44.017573 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m12:45:44.018599 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:45:44.016779 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:45:44.022014 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:45:44.022752 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:45:44.023385 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m12:45:44.023474 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:45:44.024383 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:45:44.024087 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:45:44.029866 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:45:44.034571 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:45:44.035798 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:45:44.036479 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:45:44.037027 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:45:44.037678 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:45:44.038330 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:45:44.038930 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:45:44.056461 [debug] [Thread-4 (]: SQL status: BEGIN in 0.018 seconds
[0m12:45:44.057841 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m12:45:44.058576 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:45:44.059770 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:45:44.061662 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:45:44.060891 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m12:45:44.061780 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m12:45:44.062422 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:45:44.062963 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:45:44.068639 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m12:45:44.074428 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.012 seconds
[0m12:45:44.080088 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:45:44.080726 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.018 seconds
[0m12:45:44.082288 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m12:45:44.081305 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:45:44.085553 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:45:44.086424 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:45:44.087062 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:45:44.090799 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:45:44.091389 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m12:45:44.091970 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:45:44.093347 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m12:45:44.098280 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m12:45:44.094340 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:45:44.099640 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:45:44.100478 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:45:44.101165 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:45:44.102077 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m12:45:44.104016 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:45:44.104465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d515f84-e387-4f19-a275-ec123bf9f2db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dce4f6f60>]}
[0m12:45:44.104739 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:45:44.105390 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.22s]
[0m12:45:44.106718 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m12:45:44.105292 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:45:44.108710 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:45:44.108727 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:45:44.110390 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:45:44.110107 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:45:44.111349 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:45:44.112633 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:45:44.111496 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:45:44.112584 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:45:44.113541 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:45:44.114448 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:45:44.117407 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m12:45:44.115318 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:45:44.121550 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:45:44.121817 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:45:44.122723 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:45:44.122170 [debug] [Thread-3 (]: SQL status: COMMIT in 0.009 seconds
[0m12:45:44.127957 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:45:44.123370 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:45:44.128992 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:45:44.128628 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:45:44.129397 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:45:44.130337 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:45:44.131330 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:45:44.129621 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:45:44.137275 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m12:45:44.134198 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:45:44.138881 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:45:44.139644 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:45:44.140522 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d83c945-2c1d-4286-a598-6f2f979a1f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d431351490>]}
[0m12:45:44.140464 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:45:44.141512 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:45:44.141287 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.009 seconds
[0m12:45:44.142190 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:45:44.143650 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:45:44.145426 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:45:44.142535 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.13s]
[0m12:45:44.146729 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:45:44.146298 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:45:44.147819 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:45:44.149626 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d83c945-2c1d-4286-a598-6f2f979a1f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d430263470>]}
[0m12:45:44.151767 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.14s]
[0m12:45:44.153399 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:45:44.156832 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:44.157572 [debug] [MainThread]: On master: BEGIN
[0m12:45:44.158175 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:45:44.162726 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m12:45:44.163819 [debug] [Thread-3 (]: SQL status: BEGIN in 0.020 seconds
[0m12:45:44.165850 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:45:44.166396 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m12:45:44.164923 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:45:44.167171 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m12:45:44.173451 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m12:45:44.177842 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m12:45:44.179182 [debug] [MainThread]: On master: COMMIT
[0m12:45:44.180319 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:44.181109 [debug] [MainThread]: On master: COMMIT
[0m12:45:44.182512 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:45:44.174485 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m12:45:44.183256 [debug] [MainThread]: On master: Close
[0m12:45:44.184032 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:45:44.184471 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m12:45:44.184938 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:45:44.185774 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:45:44.186780 [info ] [MainThread]: 
[0m12:45:44.187759 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m12:45:44.183119 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:45:44.190146 [debug] [MainThread]: Command end result
[0m12:45:44.190088 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:45:44.190704 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:45:44.191412 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:45:44.193439 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:45:44.194538 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:45:44.199268 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:45:44.203465 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:45:44.204130 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:45:44.204770 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:45:44.205945 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:45:44.206418 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:45:44.209705 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:45:44.212716 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:45:44.213397 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:45:44.213985 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:45:44.214579 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:45:44.215173 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:45:44.220059 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m12:45:44.223348 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:45:44.223972 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m12:45:44.227696 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:45:44.224918 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:45:44.231442 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:45:44.231477 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:45:44.232200 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:45:44.233250 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:45:44.234112 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:45:44.239565 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m12:45:44.243806 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:45:44.243603 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:45:44.244685 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.010 seconds
[0m12:45:44.244902 [info ] [MainThread]: 
[0m12:45:44.245747 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:45:44.246656 [info ] [MainThread]: 
[0m12:45:44.247639 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:45:44.248237 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:45:44.249712 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d515f84-e387-4f19-a275-ec123bf9f2db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dcba859a0>]}
[0m12:45:44.249952 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.145398, "process_in_blocks": "928", "process_kernel_time": 1.221491, "process_mem_max_rss": "108608", "process_out_blocks": "3384", "process_user_time": 4.056955}
[0m12:45:44.251238 [debug] [MainThread]: Command `dbt run` succeeded at 12:45:44.250994 after 2.15 seconds
[0m12:45:44.251988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d435cb86b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d43482c170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d43482c5f0>]}
[0m12:45:44.252049 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d515f84-e387-4f19-a275-ec123bf9f2db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dc8967fb0>]}
[0m12:45:44.252899 [debug] [MainThread]: Flushing usage events
[0m12:45:44.251043 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.13s]
[0m12:45:44.255699 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:45:44.253333 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.14s]
[0m12:45:44.257847 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:45:44.263184 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:44.263822 [debug] [MainThread]: On master: BEGIN
[0m12:45:44.264311 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:45:44.278589 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m12:45:44.279441 [debug] [MainThread]: On master: COMMIT
[0m12:45:44.280197 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:44.280789 [debug] [MainThread]: On master: COMMIT
[0m12:45:44.281523 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:45:44.281978 [debug] [MainThread]: On master: Close
[0m12:45:44.282690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:45:44.283175 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m12:45:44.283613 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:45:44.284087 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:45:44.284698 [info ] [MainThread]: 
[0m12:45:44.285317 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m12:45:44.288056 [debug] [MainThread]: Command end result
[0m12:45:44.329052 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:45:44.331426 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:45:44.340370 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:45:44.341011 [info ] [MainThread]: 
[0m12:45:44.342039 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:45:44.343234 [info ] [MainThread]: 
[0m12:45:44.344442 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:45:44.346147 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2277884, "process_in_blocks": "0", "process_kernel_time": 1.261224, "process_mem_max_rss": "108460", "process_out_blocks": "2816", "process_user_time": 3.931347}
[0m12:45:44.346887 [debug] [MainThread]: Command `dbt run` succeeded at 12:45:44.346732 after 2.23 seconds
[0m12:45:44.347492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dceae67b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dced82b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736dced83770>]}
[0m12:45:44.348010 [debug] [MainThread]: Flushing usage events
[0m12:45:45.678184 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:45:45.678514 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:46:31.781352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee83482dfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee8348d8ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee8348d8f20>]}


============================== 12:46:31.791097 | cb390156-dc1d-4639-b9b9-93f27e6ad56d ==============================
[0m12:46:31.791097 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:46:31.792485 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:46:32.326333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb390156-dc1d-4639-b9b9-93f27e6ad56d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee833d27770>]}
[0m12:46:32.470359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb390156-dc1d-4639-b9b9-93f27e6ad56d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee833fea810>]}
[0m12:46:32.472549 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:46:32.669973 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:46:32.862135 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:46:32.862750 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:46:32.932012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb390156-dc1d-4639-b9b9-93f27e6ad56d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee8324c9400>]}
[0m12:46:33.057819 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:46:33.061372 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:46:33.098216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb390156-dc1d-4639-b9b9-93f27e6ad56d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee833cf4ce0>]}
[0m12:46:33.098898 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:46:33.099513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb390156-dc1d-4639-b9b9-93f27e6ad56d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee8322d25d0>]}
[0m12:46:33.102316 [info ] [MainThread]: 
[0m12:46:33.103068 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:46:33.104567 [info ] [MainThread]: 
[0m12:46:33.105820 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:46:33.113333 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:46:33.247917 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:46:33.248503 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:46:33.248999 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:33.265014 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m12:46:33.266961 [debug] [ThreadPool]: On list_db: Close
[0m12:46:33.269278 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:46:33.278865 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:46:33.279473 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:46:33.279961 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:46:33.292355 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m12:46:33.292998 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:46:33.293536 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:46:33.297934 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m12:46:33.300078 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:46:33.301038 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:46:33.309194 [debug] [MainThread]: Using postgres connection "master"
[0m12:46:33.309873 [debug] [MainThread]: On master: BEGIN
[0m12:46:33.310423 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:46:33.323729 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m12:46:33.324651 [debug] [MainThread]: Using postgres connection "master"
[0m12:46:33.325259 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:46:33.330030 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m12:46:33.333959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb390156-dc1d-4639-b9b9-93f27e6ad56d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee833d68410>]}
[0m12:46:33.335601 [debug] [MainThread]: On master: ROLLBACK
[0m12:46:33.337369 [debug] [MainThread]: Using postgres connection "master"
[0m12:46:33.338685 [debug] [MainThread]: On master: BEGIN
[0m12:46:33.341473 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:46:33.342955 [debug] [MainThread]: On master: COMMIT
[0m12:46:33.344404 [debug] [MainThread]: Using postgres connection "master"
[0m12:46:33.345647 [debug] [MainThread]: On master: COMMIT
[0m12:46:33.347534 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:46:33.348839 [debug] [MainThread]: On master: Close
[0m12:46:33.359055 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m12:46:33.360868 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m12:46:33.362519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m12:46:33.364116 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m12:46:33.388702 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m12:46:33.390862 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m12:46:33.496280 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m12:46:33.497580 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:46:33.498263 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m12:46:33.499453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:46:33.516010 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m12:46:33.517108 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:46:33.517786 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m12:46:33.525587 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m12:46:33.537817 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:46:33.539075 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m12:46:33.540720 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:46:33.545632 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:46:33.546287 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m12:46:33.547660 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:46:33.596362 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:46:33.597620 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:46:33.599120 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:46:33.645554 [debug] [Thread-1 (]: SQL status: COMMIT in 0.045 seconds
[0m12:46:33.664656 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m12:46:33.700395 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:46:33.702082 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m12:46:33.713780 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m12:46:33.726266 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m12:46:33.734120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb390156-dc1d-4639-b9b9-93f27e6ad56d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee83482e480>]}
[0m12:46:33.736815 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.37s]
[0m12:46:33.742609 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m12:46:33.747790 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:46:33.751271 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:46:33.753571 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:46:33.757169 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:46:33.760456 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:46:33.763047 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:46:33.765759 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:46:33.767907 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:46:33.790441 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:46:33.800543 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:46:33.804251 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:46:33.806703 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:46:33.821794 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:46:33.835761 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:46:33.840340 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:46:33.842655 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:46:33.844465 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:46:33.846525 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:46:33.848699 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:46:33.852265 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:46:33.892629 [debug] [Thread-3 (]: SQL status: BEGIN in 0.045 seconds
[0m12:46:33.895708 [debug] [Thread-4 (]: SQL status: BEGIN in 0.044 seconds
[0m12:46:33.898001 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:46:33.900662 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:46:33.902915 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m12:46:33.906610 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m12:46:33.919495 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.009 seconds
[0m12:46:33.921539 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.012 seconds
[0m12:46:33.936348 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:46:33.956583 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:46:33.952729 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:46:33.962019 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:46:33.965386 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:46:33.974893 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m12:46:33.994179 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:46:34.008333 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:46:34.005762 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:46:34.012544 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:46:34.014348 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:46:34.024757 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m12:46:34.039260 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:46:34.045560 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:46:34.048407 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:46:34.050676 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:46:34.052954 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:46:34.055784 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:46:34.064290 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m12:46:34.073904 [debug] [Thread-3 (]: SQL status: COMMIT in 0.015 seconds
[0m12:46:34.077836 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:46:34.093134 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:46:34.095621 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:46:34.097950 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:46:34.101322 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:46:34.104235 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:46:34.115575 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.011 seconds
[0m12:46:34.124372 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.017 seconds
[0m12:46:34.126450 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:46:34.133328 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:46:34.138365 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb390156-dc1d-4639-b9b9-93f27e6ad56d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee831375c10>]}
[0m12:46:34.142805 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb390156-dc1d-4639-b9b9-93f27e6ad56d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee830283560>]}
[0m12:46:34.148628 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.38s]
[0m12:46:34.153347 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.38s]
[0m12:46:34.160496 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:46:34.164472 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:46:34.176916 [debug] [MainThread]: Using postgres connection "master"
[0m12:46:34.178704 [debug] [MainThread]: On master: BEGIN
[0m12:46:34.180403 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:46:34.225336 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m12:46:34.229845 [debug] [MainThread]: On master: COMMIT
[0m12:46:34.233228 [debug] [MainThread]: Using postgres connection "master"
[0m12:46:34.236734 [debug] [MainThread]: On master: COMMIT
[0m12:46:34.240682 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:46:34.242795 [debug] [MainThread]: On master: Close
[0m12:46:34.246593 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:46:34.248270 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m12:46:34.249678 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:46:34.250909 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:46:34.254520 [info ] [MainThread]: 
[0m12:46:34.258489 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.15 seconds (1.15s).
[0m12:46:34.269143 [debug] [MainThread]: Command end result
[0m12:46:34.330316 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:46:34.332915 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:46:34.342257 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:46:34.342810 [info ] [MainThread]: 
[0m12:46:34.343520 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:46:34.344068 [info ] [MainThread]: 
[0m12:46:34.344983 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:46:34.346579 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.6489875, "process_in_blocks": "0", "process_kernel_time": 0.846734, "process_mem_max_rss": "108652", "process_out_blocks": "3400", "process_user_time": 4.667072}
[0m12:46:34.347430 [debug] [MainThread]: Command `dbt run` succeeded at 12:46:34.347260 after 2.65 seconds
[0m12:46:34.347994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee8349f1a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee83484c710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee83484d070>]}
[0m12:46:34.348554 [debug] [MainThread]: Flushing usage events
[0m12:46:36.095653 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:47:31.212296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7e6bf15190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7e6a1a37d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7e6a50ec90>]}


============================== 12:47:31.221571 | 22333616-10e8-4b54-ba21-01971fe7163b ==============================
[0m12:47:31.221571 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:47:31.222542 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:47:31.560916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22333616-10e8-4b54-ba21-01971fe7163b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7e69f69af0>]}
[0m12:47:31.662185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22333616-10e8-4b54-ba21-01971fe7163b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7e6a537b90>]}
[0m12:47:31.663259 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:47:31.796564 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:47:31.945198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:47:31.945763 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:47:31.995942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22333616-10e8-4b54-ba21-01971fe7163b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7e68751790>]}
[0m12:47:32.102817 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:47:32.106386 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:47:32.138157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22333616-10e8-4b54-ba21-01971fe7163b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7e69fdc380>]}
[0m12:47:32.138822 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:47:32.139506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22333616-10e8-4b54-ba21-01971fe7163b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7e6848dfd0>]}
[0m12:47:32.142286 [info ] [MainThread]: 
[0m12:47:32.142874 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:47:32.143473 [info ] [MainThread]: 
[0m12:47:32.144759 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:47:32.151551 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:47:32.220299 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:47:32.315183 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:47:32.316906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:32.365292 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.048 seconds
[0m12:47:32.370963 [debug] [ThreadPool]: On list_db: Close
[0m12:47:32.377172 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:47:32.401626 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:47:32.403045 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:47:32.404357 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:47:32.440931 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m12:47:32.444033 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:47:32.446224 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:47:32.462465 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.015 seconds
[0m12:47:32.469246 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:47:32.471855 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:47:32.503314 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:32.505375 [debug] [MainThread]: On master: BEGIN
[0m12:47:32.506959 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:47:32.533365 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m12:47:32.534975 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:32.536466 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:47:32.546890 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m12:47:32.551078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22333616-10e8-4b54-ba21-01971fe7163b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7e6a178f80>]}
[0m12:47:32.552616 [debug] [MainThread]: On master: ROLLBACK
[0m12:47:32.554118 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:32.555034 [debug] [MainThread]: On master: BEGIN
[0m12:47:32.556956 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:47:32.558060 [debug] [MainThread]: On master: COMMIT
[0m12:47:32.559073 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:32.560459 [debug] [MainThread]: On master: COMMIT
[0m12:47:32.562173 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:47:32.563285 [debug] [MainThread]: On master: Close
[0m12:47:32.571763 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m12:47:32.573355 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m12:47:32.574701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m12:47:32.575657 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m12:47:32.598235 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m12:47:32.599990 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m12:47:32.668410 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m12:47:32.669312 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:47:32.669831 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m12:47:32.670243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:32.682584 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m12:47:32.683809 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:47:32.684328 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m12:47:32.688668 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m12:47:32.697872 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:47:32.698477 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m12:47:32.699571 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:47:32.703590 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:47:32.704118 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m12:47:32.705115 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:47:32.733353 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:47:32.733983 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:47:32.734440 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:47:32.739578 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m12:47:32.750798 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m12:47:32.765188 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:47:32.766451 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m12:47:32.775857 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m12:47:32.783429 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m12:47:32.792073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22333616-10e8-4b54-ba21-01971fe7163b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7e6aaa2030>]}
[0m12:47:32.795764 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.21s]
[0m12:47:32.799185 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m12:47:32.804504 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:47:32.806500 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:47:32.809218 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:47:32.812793 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:47:32.816707 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:47:32.819209 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:47:32.821643 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:47:32.823735 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:47:32.837609 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:47:32.850388 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:47:32.853915 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:47:32.855644 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:47:32.870132 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:47:32.883859 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:47:32.887720 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:47:32.889500 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:47:32.891454 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:47:32.895547 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:47:32.899170 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:47:32.903265 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:47:32.939341 [debug] [Thread-3 (]: SQL status: BEGIN in 0.044 seconds
[0m12:47:32.943013 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:47:32.944871 [debug] [Thread-4 (]: SQL status: BEGIN in 0.042 seconds
[0m12:47:32.947291 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m12:47:32.950013 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:47:32.953753 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m12:47:32.967639 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.011 seconds
[0m12:47:32.969533 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.017 seconds
[0m12:47:32.982695 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:47:32.996048 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:47:32.998008 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:47:33.000685 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:47:33.002898 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:47:33.004710 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:47:33.023786 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:47:33.032565 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:47:33.035196 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:47:33.037616 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:47:33.039514 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:47:33.047636 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:47:33.049533 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m12:47:33.051499 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:47:33.059187 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:47:33.061488 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:47:33.063636 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:47:33.066303 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:47:33.232995 [debug] [Thread-4 (]: SQL status: COMMIT in 0.167 seconds
[0m12:47:33.244217 [debug] [Thread-3 (]: SQL status: COMMIT in 0.176 seconds
[0m12:47:33.245794 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:47:33.256445 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:47:33.259281 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:47:33.262349 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:47:33.264620 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:47:33.266922 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:47:33.278793 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.009 seconds
[0m12:47:33.285395 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:47:33.287162 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.017 seconds
[0m12:47:33.290118 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22333616-10e8-4b54-ba21-01971fe7163b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7e675e90d0>]}
[0m12:47:33.296591 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:47:33.300267 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.47s]
[0m12:47:33.303771 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22333616-10e8-4b54-ba21-01971fe7163b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7e644f3fe0>]}
[0m12:47:33.307559 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:47:33.310978 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.49s]
[0m12:47:33.316545 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:47:33.325317 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:33.327004 [debug] [MainThread]: On master: BEGIN
[0m12:47:33.329183 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:47:33.366043 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m12:47:33.368213 [debug] [MainThread]: On master: COMMIT
[0m12:47:33.370586 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:33.372182 [debug] [MainThread]: On master: COMMIT
[0m12:47:33.375310 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:47:33.379292 [debug] [MainThread]: On master: Close
[0m12:47:33.382653 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:47:33.385307 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m12:47:33.388034 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:47:33.390595 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:47:33.394166 [info ] [MainThread]: 
[0m12:47:33.397362 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.25 seconds (1.25s).
[0m12:47:33.405459 [debug] [MainThread]: Command end result
[0m12:47:33.532913 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:47:33.536629 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:47:33.548183 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:47:33.548726 [info ] [MainThread]: 
[0m12:47:33.549324 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:47:33.549910 [info ] [MainThread]: 
[0m12:47:33.550720 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:47:33.552758 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.416058, "process_in_blocks": "0", "process_kernel_time": 0.695673, "process_mem_max_rss": "108380", "process_out_blocks": "3400", "process_user_time": 3.910165}
[0m12:47:33.553555 [debug] [MainThread]: Command `dbt run` succeeded at 12:47:33.553393 after 2.42 seconds
[0m12:47:33.554105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7e6bf15190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7e6aac0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7e68440380>]}
[0m12:47:33.554648 [debug] [MainThread]: Flushing usage events
[0m12:47:34.981221 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:50:18.567077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d016108a030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d015fd3a5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d016108a090>]}


============================== 12:50:18.579660 | 936dcaf0-20c7-4aa7-b467-5d2b81072062 ==============================
[0m12:50:18.579660 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:50:18.581935 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:50:19.049290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '936dcaf0-20c7-4aa7-b467-5d2b81072062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d015f2ce900>]}
[0m12:50:19.167742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '936dcaf0-20c7-4aa7-b467-5d2b81072062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d015fa05100>]}
[0m12:50:19.170307 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:50:19.363922 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:50:19.632339 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:50:19.633021 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:50:19.699613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '936dcaf0-20c7-4aa7-b467-5d2b81072062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d015d9e80e0>]}
[0m12:50:19.854980 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:50:19.858770 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:50:19.895738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '936dcaf0-20c7-4aa7-b467-5d2b81072062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d015d6b8d40>]}
[0m12:50:19.896434 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:50:19.897012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '936dcaf0-20c7-4aa7-b467-5d2b81072062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d015d69b200>]}
[0m12:50:19.899482 [info ] [MainThread]: 
[0m12:50:19.900155 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:50:19.901195 [info ] [MainThread]: 
[0m12:50:19.902803 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:50:19.912211 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:50:20.089706 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:50:20.091069 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:50:20.092348 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:20.121061 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.029 seconds
[0m12:50:20.125596 [debug] [ThreadPool]: On list_db: Close
[0m12:50:20.129887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:50:20.154890 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:50:20.156625 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:50:20.157610 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:50:20.174776 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m12:50:20.175640 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:50:20.176284 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:50:20.181856 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m12:50:20.185246 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:50:20.186758 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:50:20.196169 [debug] [MainThread]: Using postgres connection "master"
[0m12:50:20.196947 [debug] [MainThread]: On master: BEGIN
[0m12:50:20.197435 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:50:20.214080 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m12:50:20.215094 [debug] [MainThread]: Using postgres connection "master"
[0m12:50:20.215931 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:50:20.224114 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m12:50:20.226769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '936dcaf0-20c7-4aa7-b467-5d2b81072062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d015d942de0>]}
[0m12:50:20.227967 [debug] [MainThread]: On master: ROLLBACK
[0m12:50:20.228950 [debug] [MainThread]: Using postgres connection "master"
[0m12:50:20.229631 [debug] [MainThread]: On master: BEGIN
[0m12:50:20.230963 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:50:20.232021 [debug] [MainThread]: On master: COMMIT
[0m12:50:20.232866 [debug] [MainThread]: Using postgres connection "master"
[0m12:50:20.235251 [debug] [MainThread]: On master: COMMIT
[0m12:50:20.238029 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:50:20.238831 [debug] [MainThread]: On master: Close
[0m12:50:20.245133 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m12:50:20.246475 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m12:50:20.247654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m12:50:20.248689 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m12:50:20.268899 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m12:50:20.271172 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m12:50:20.377922 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m12:50:20.379148 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:50:20.379786 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m12:50:20.380369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:50:20.396958 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m12:50:20.398004 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:50:20.398618 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m12:50:20.408827 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m12:50:20.423346 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:50:20.424200 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m12:50:20.425548 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:50:20.429946 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:50:20.430571 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m12:50:20.431712 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:50:20.466704 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:50:20.467818 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:50:20.468697 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:50:20.535099 [debug] [Thread-1 (]: SQL status: COMMIT in 0.065 seconds
[0m12:50:20.546732 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m12:50:20.557308 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:50:20.557962 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m12:50:20.564748 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m12:50:20.575542 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m12:50:20.578319 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '936dcaf0-20c7-4aa7-b467-5d2b81072062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d015fd1a870>]}
[0m12:50:20.579359 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.33s]
[0m12:50:20.580931 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m12:50:20.583516 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:50:20.584919 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:50:20.586255 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:50:20.587587 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:50:20.588900 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:50:20.590128 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:50:20.590995 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:50:20.591885 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:50:20.597238 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:50:20.606872 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:50:20.608460 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:50:20.609191 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:50:20.614047 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:50:20.621651 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:50:20.623168 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:50:20.623843 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:50:20.624423 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:50:20.625208 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:50:20.625803 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:50:20.626702 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:50:20.642785 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m12:50:20.644051 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:50:20.645103 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m12:50:20.646156 [debug] [Thread-4 (]: SQL status: BEGIN in 0.019 seconds
[0m12:50:20.647297 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:50:20.648349 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m12:50:20.654209 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m12:50:20.655264 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m12:50:20.659771 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:50:20.664861 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:50:20.666838 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:50:20.668427 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:50:20.670859 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:50:20.671572 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:50:20.676186 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:50:20.680853 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:50:20.681844 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:50:20.683544 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:50:20.685775 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:50:20.686623 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:50:20.689370 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:50:20.691834 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:50:20.692660 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:50:20.693458 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:50:20.694061 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:50:20.694675 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:50:20.700574 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m12:50:20.704631 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:50:20.705831 [debug] [Thread-4 (]: SQL status: COMMIT in 0.010 seconds
[0m12:50:20.706876 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:50:20.711017 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:50:20.711914 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:50:20.713145 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:50:20.714057 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:50:20.845368 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.131 seconds
[0m12:50:20.847923 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:50:20.850075 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '936dcaf0-20c7-4aa7-b467-5d2b81072062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0155710110>]}
[0m12:50:20.851784 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.137 seconds
[0m12:50:20.853375 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.26s]
[0m12:50:20.856337 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:50:20.857425 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:50:20.858870 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '936dcaf0-20c7-4aa7-b467-5d2b81072062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0155710500>]}
[0m12:50:20.860166 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.27s]
[0m12:50:20.861452 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:50:20.865048 [debug] [MainThread]: Using postgres connection "master"
[0m12:50:20.866290 [debug] [MainThread]: On master: BEGIN
[0m12:50:20.867395 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:50:20.884195 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m12:50:20.885354 [debug] [MainThread]: On master: COMMIT
[0m12:50:20.885978 [debug] [MainThread]: Using postgres connection "master"
[0m12:50:20.886582 [debug] [MainThread]: On master: COMMIT
[0m12:50:20.887717 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:50:20.888300 [debug] [MainThread]: On master: Close
[0m12:50:20.889365 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:50:20.889843 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m12:50:20.890825 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:50:20.891483 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:50:20.892231 [info ] [MainThread]: 
[0m12:50:20.893507 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m12:50:20.896465 [debug] [MainThread]: Command end result
[0m12:50:20.938728 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:50:20.941617 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:50:20.953985 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:50:20.954690 [info ] [MainThread]: 
[0m12:50:20.955827 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:50:20.957137 [info ] [MainThread]: 
[0m12:50:20.958347 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:50:20.960466 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.489135, "process_in_blocks": "0", "process_kernel_time": 0.815181, "process_mem_max_rss": "108508", "process_out_blocks": "3400", "process_user_time": 4.652992}
[0m12:50:20.961396 [debug] [MainThread]: Command `dbt run` succeeded at 12:50:20.961225 after 2.49 seconds
[0m12:50:20.961969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d015f213d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d015fd1a870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d015f579f10>]}
[0m12:50:20.962616 [debug] [MainThread]: Flushing usage events
[0m12:50:22.369289 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:50:47.269097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797e78e3dfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797e788b1460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797e788b0260>]}


============================== 12:50:47.276697 | f70da957-4056-4ca6-a0f3-b189f1d2925a ==============================
[0m12:50:47.276697 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:50:47.277935 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:50:47.541444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f70da957-4056-4ca6-a0f3-b189f1d2925a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797e7881fe00>]}
[0m12:50:47.629507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f70da957-4056-4ca6-a0f3-b189f1d2925a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797e7881f4d0>]}
[0m12:50:47.630531 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:50:47.742909 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:50:47.894866 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:50:47.895341 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:50:47.948728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f70da957-4056-4ca6-a0f3-b189f1d2925a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797e77011400>]}
[0m12:50:48.054076 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:50:48.057411 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:50:48.087911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f70da957-4056-4ca6-a0f3-b189f1d2925a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797e78e3fce0>]}
[0m12:50:48.088710 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:50:48.089285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f70da957-4056-4ca6-a0f3-b189f1d2925a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797e788b2bd0>]}
[0m12:50:48.091957 [info ] [MainThread]: 
[0m12:50:48.092552 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:50:48.093360 [info ] [MainThread]: 
[0m12:50:48.094616 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:50:48.100456 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:50:48.160921 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:50:48.161546 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:50:48.161982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:48.176473 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m12:50:48.178797 [debug] [ThreadPool]: On list_db: Close
[0m12:50:48.184570 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:50:48.206518 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:50:48.207909 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:50:48.209155 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:50:48.245200 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m12:50:48.247450 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:50:48.249557 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:50:48.263439 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.012 seconds
[0m12:50:48.269561 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:50:48.272088 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:50:48.295186 [debug] [MainThread]: Using postgres connection "master"
[0m12:50:48.296686 [debug] [MainThread]: On master: BEGIN
[0m12:50:48.298185 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:50:48.335136 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m12:50:48.337127 [debug] [MainThread]: Using postgres connection "master"
[0m12:50:48.339341 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:50:48.357212 [debug] [MainThread]: SQL status: SELECT 0 in 0.016 seconds
[0m12:50:48.364747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f70da957-4056-4ca6-a0f3-b189f1d2925a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797e76e17ad0>]}
[0m12:50:48.367014 [debug] [MainThread]: On master: ROLLBACK
[0m12:50:48.369414 [debug] [MainThread]: Using postgres connection "master"
[0m12:50:48.371305 [debug] [MainThread]: On master: BEGIN
[0m12:50:48.375042 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m12:50:48.378102 [debug] [MainThread]: On master: COMMIT
[0m12:50:48.380412 [debug] [MainThread]: Using postgres connection "master"
[0m12:50:48.382363 [debug] [MainThread]: On master: COMMIT
[0m12:50:48.385299 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:50:48.387807 [debug] [MainThread]: On master: Close
[0m12:50:48.402867 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m12:50:48.405395 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m12:50:48.408846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m12:50:48.412410 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m12:50:48.461913 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m12:50:48.464871 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m12:50:48.538265 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m12:50:48.539358 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:50:48.539830 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m12:50:48.540587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:50:48.552140 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m12:50:48.553094 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:50:48.553713 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m12:50:48.557965 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m12:50:48.566991 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:50:48.567549 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m12:50:48.568492 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:50:48.572020 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:50:48.572514 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m12:50:48.573366 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:50:48.609792 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:50:48.610959 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:50:48.611868 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:50:48.667591 [debug] [Thread-1 (]: SQL status: COMMIT in 0.046 seconds
[0m12:50:48.681256 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m12:50:48.693312 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:50:48.693983 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m12:50:48.700291 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m12:50:48.704082 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m12:50:48.707808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f70da957-4056-4ca6-a0f3-b189f1d2925a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797e79376420>]}
[0m12:50:48.709055 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.30s]
[0m12:50:48.710270 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m12:50:48.712069 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:50:48.713265 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:50:48.714363 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:50:48.715942 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:50:48.717096 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:50:48.717846 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:50:48.718532 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:50:48.719285 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:50:48.723752 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:50:48.728094 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:50:48.729955 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:50:48.731309 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:50:48.738530 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:50:48.747527 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:50:48.750117 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:50:48.751151 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:50:48.752230 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:50:48.753429 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:50:48.754425 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:50:48.755391 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:50:48.772548 [debug] [Thread-4 (]: SQL status: BEGIN in 0.018 seconds
[0m12:50:48.773553 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:50:48.774406 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m12:50:48.775256 [debug] [Thread-3 (]: SQL status: BEGIN in 0.020 seconds
[0m12:50:48.776157 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:50:48.776857 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m12:50:48.779763 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m12:50:48.788595 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m12:50:48.787897 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:50:48.795424 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:50:48.796613 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:50:48.797670 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:50:48.799526 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:50:48.800607 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:50:48.807005 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:50:48.812704 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:50:48.814901 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:50:48.816560 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:50:48.819393 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:50:48.820525 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:50:48.825722 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:50:48.828286 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:50:48.829005 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:50:48.829597 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:50:48.830209 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:50:48.830804 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:50:48.836008 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m12:50:48.839584 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:50:48.840406 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m12:50:48.841547 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:50:48.845304 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:50:48.846190 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:50:48.847522 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:50:48.848560 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:50:48.999652 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.151 seconds
[0m12:50:49.006052 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:50:49.007959 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.158 seconds
[0m12:50:49.016558 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f70da957-4056-4ca6-a0f3-b189f1d2925a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797e75eb64b0>]}
[0m12:50:49.017996 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:50:49.022937 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.30s]
[0m12:50:49.027347 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f70da957-4056-4ca6-a0f3-b189f1d2925a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797e745cb830>]}
[0m12:50:49.031531 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:50:49.035826 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.31s]
[0m12:50:49.041609 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:50:49.052293 [debug] [MainThread]: Using postgres connection "master"
[0m12:50:49.054097 [debug] [MainThread]: On master: BEGIN
[0m12:50:49.056889 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:50:49.094721 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m12:50:49.096944 [debug] [MainThread]: On master: COMMIT
[0m12:50:49.098367 [debug] [MainThread]: Using postgres connection "master"
[0m12:50:49.100152 [debug] [MainThread]: On master: COMMIT
[0m12:50:49.102512 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:50:49.105544 [debug] [MainThread]: On master: Close
[0m12:50:49.108554 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:50:49.110124 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m12:50:49.112093 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:50:49.113829 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:50:49.116003 [info ] [MainThread]: 
[0m12:50:49.117968 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m12:50:49.124495 [debug] [MainThread]: Command end result
[0m12:50:49.181940 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:50:49.184736 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:50:49.195183 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:50:49.195812 [info ] [MainThread]: 
[0m12:50:49.196529 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:50:49.197137 [info ] [MainThread]: 
[0m12:50:49.198022 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:50:49.199903 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.99341, "process_in_blocks": "0", "process_kernel_time": 0.580248, "process_mem_max_rss": "108120", "process_out_blocks": "3400", "process_user_time": 3.211516}
[0m12:50:49.200676 [debug] [MainThread]: Command `dbt run` succeeded at 12:50:49.200469 after 1.99 seconds
[0m12:50:49.201216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797e788b3110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797e76fa3170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797e77011280>]}
[0m12:50:49.201812 [debug] [MainThread]: Flushing usage events
[0m12:50:50.629123 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:51:48.526327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da3b17d19d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da3b17d2de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da3b1f361e0>]}


============================== 12:51:48.534934 | acbbdd1a-465b-4dc8-80f0-4951d82513fb ==============================
[0m12:51:48.534934 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:51:48.536041 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:51:48.884709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'acbbdd1a-465b-4dc8-80f0-4951d82513fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da3b317f140>]}
[0m12:51:48.965650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'acbbdd1a-465b-4dc8-80f0-4951d82513fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da3b1218560>]}
[0m12:51:48.966825 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:51:49.083755 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:51:49.226314 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:51:49.226847 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:51:49.274739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'acbbdd1a-465b-4dc8-80f0-4951d82513fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da3b126be30>]}
[0m12:51:49.372217 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:51:49.375257 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:51:49.405225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'acbbdd1a-465b-4dc8-80f0-4951d82513fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da3af6f7e30>]}
[0m12:51:49.406205 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:51:49.406861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acbbdd1a-465b-4dc8-80f0-4951d82513fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da3afa05910>]}
[0m12:51:49.409663 [info ] [MainThread]: 
[0m12:51:49.410297 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:51:49.410962 [info ] [MainThread]: 
[0m12:51:49.412164 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:51:49.420132 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:51:49.481612 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:51:49.482095 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:51:49.482453 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:49.497286 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m12:51:49.499145 [debug] [ThreadPool]: On list_db: Close
[0m12:51:49.501354 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:51:49.509042 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:51:49.509555 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:51:49.509945 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:51:49.521972 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m12:51:49.522825 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:51:49.523426 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:51:49.527570 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m12:51:49.529740 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:51:49.530651 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:51:49.539467 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:49.540054 [debug] [MainThread]: On master: BEGIN
[0m12:51:49.540478 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:51:49.552983 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m12:51:49.554124 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:49.554825 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:51:49.560081 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m12:51:49.562280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acbbdd1a-465b-4dc8-80f0-4951d82513fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da3b25d6ea0>]}
[0m12:51:49.562973 [debug] [MainThread]: On master: ROLLBACK
[0m12:51:49.563896 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:49.564390 [debug] [MainThread]: On master: BEGIN
[0m12:51:49.565522 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:51:49.566039 [debug] [MainThread]: On master: COMMIT
[0m12:51:49.566889 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:49.567378 [debug] [MainThread]: On master: COMMIT
[0m12:51:49.568171 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:51:49.568686 [debug] [MainThread]: On master: Close
[0m12:51:49.573933 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m12:51:49.575436 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m12:51:49.576737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m12:51:49.577710 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m12:51:49.591356 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m12:51:49.592492 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m12:51:49.655125 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m12:51:49.656051 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:51:49.656647 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m12:51:49.657097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:51:49.669381 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m12:51:49.670255 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:51:49.670925 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m12:51:49.675440 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m12:51:49.684890 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:51:49.685519 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m12:51:49.686603 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:51:49.690521 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:51:49.691014 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m12:51:49.691949 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:51:49.718182 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:51:49.718733 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:51:49.719196 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:51:49.724734 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m12:51:49.734518 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m12:51:49.742042 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:51:49.742549 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m12:51:49.749152 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m12:51:49.752603 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m12:51:49.754927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acbbdd1a-465b-4dc8-80f0-4951d82513fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da3b317e210>]}
[0m12:51:49.755860 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.18s]
[0m12:51:49.756762 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m12:51:49.758476 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:51:49.759120 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:51:49.759929 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:51:49.760984 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:51:49.762117 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:51:49.762982 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:51:49.763693 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:51:49.764395 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:51:49.768572 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:51:49.772218 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:51:49.773341 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:51:49.774012 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:51:49.778236 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:51:49.782298 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:51:49.783650 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:51:49.784388 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:51:49.785022 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:51:49.785684 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:51:49.786392 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:51:49.787032 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:51:49.805613 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m12:51:49.806426 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:51:49.807142 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m12:51:49.808025 [debug] [Thread-4 (]: SQL status: BEGIN in 0.021 seconds
[0m12:51:49.809269 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:51:49.809800 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m12:51:49.812722 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m12:51:49.813416 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m12:51:49.818464 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:51:49.822938 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:51:49.823748 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:51:49.824645 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:51:49.825970 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:51:49.826527 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:51:49.830768 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:51:49.834546 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:51:49.835252 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:51:49.835949 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:51:49.837097 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:51:49.837622 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:51:49.840102 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:51:49.842232 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:51:49.843014 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:51:49.843701 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:51:49.844434 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:51:49.845121 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:51:49.850444 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m12:51:49.853730 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:51:49.854621 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:51:49.855204 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m12:51:49.855766 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:51:49.858867 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:51:49.860091 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:51:49.860709 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:51:49.865398 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m12:51:49.867439 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:51:49.868397 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acbbdd1a-465b-4dc8-80f0-4951d82513fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da39773bf20>]}
[0m12:51:49.869220 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.11s]
[0m12:51:49.870147 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.009 seconds
[0m12:51:49.871358 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:51:49.873497 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:51:49.874986 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acbbdd1a-465b-4dc8-80f0-4951d82513fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da397709550>]}
[0m12:51:49.875988 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.11s]
[0m12:51:49.877195 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:51:49.880810 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:49.881439 [debug] [MainThread]: On master: BEGIN
[0m12:51:49.881924 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:51:49.895210 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m12:51:49.895966 [debug] [MainThread]: On master: COMMIT
[0m12:51:49.896554 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:49.897025 [debug] [MainThread]: On master: COMMIT
[0m12:51:49.897864 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:51:49.898372 [debug] [MainThread]: On master: Close
[0m12:51:49.899077 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:51:49.899544 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m12:51:49.900095 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:51:49.900596 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:51:49.901277 [info ] [MainThread]: 
[0m12:51:49.901835 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m12:51:49.904282 [debug] [MainThread]: Command end result
[0m12:51:49.935776 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:51:49.938269 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:51:49.946770 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:51:49.947250 [info ] [MainThread]: 
[0m12:51:49.947859 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:51:49.948637 [info ] [MainThread]: 
[0m12:51:49.949403 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:51:49.951268 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4863348, "process_in_blocks": "0", "process_kernel_time": 0.450413, "process_mem_max_rss": "108096", "process_out_blocks": "3400", "process_user_time": 2.983992}
[0m12:51:49.952226 [debug] [MainThread]: Command `dbt run` succeeded at 12:51:49.951780 after 1.49 seconds
[0m12:51:49.952730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da3b152c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da3b1c14a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da3af7843e0>]}
[0m12:51:49.953218 [debug] [MainThread]: Flushing usage events
[0m12:51:51.500748 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:52:47.591546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737b0a9f0ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737b0b8b9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737b0b448800>]}


============================== 12:52:47.599937 | e2defc0c-ad89-44a4-a772-ad4f38443ca8 ==============================
[0m12:52:47.599937 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:52:47.601084 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:52:47.880204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2defc0c-ad89-44a4-a772-ad4f38443ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737b099caff0>]}
[0m12:52:47.962663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2defc0c-ad89-44a4-a772-ad4f38443ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737b09af2900>]}
[0m12:52:47.964154 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:52:48.090848 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:52:48.226522 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:52:48.227131 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:52:48.272347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2defc0c-ad89-44a4-a772-ad4f38443ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737b09a85cd0>]}
[0m12:52:48.370738 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:52:48.374209 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:52:48.406106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2defc0c-ad89-44a4-a772-ad4f38443ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737b07f75880>]}
[0m12:52:48.406832 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:52:48.407478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2defc0c-ad89-44a4-a772-ad4f38443ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737b082187d0>]}
[0m12:52:48.410045 [info ] [MainThread]: 
[0m12:52:48.410780 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:52:48.411571 [info ] [MainThread]: 
[0m12:52:48.413006 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:52:48.419583 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:52:48.511141 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:52:48.511656 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:52:48.512114 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:48.525599 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m12:52:48.527408 [debug] [ThreadPool]: On list_db: Close
[0m12:52:48.529732 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:52:48.537353 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:52:48.537844 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:52:48.538201 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:48.550259 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m12:52:48.551287 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:52:48.551808 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:52:48.556052 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m12:52:48.558235 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:52:48.559118 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:52:48.568552 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:48.569118 [debug] [MainThread]: On master: BEGIN
[0m12:52:48.569577 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:52:48.581402 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m12:52:48.582044 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:48.582596 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:52:48.587448 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m12:52:48.589571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2defc0c-ad89-44a4-a772-ad4f38443ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737b0992fb30>]}
[0m12:52:48.590411 [debug] [MainThread]: On master: ROLLBACK
[0m12:52:48.591646 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:48.592273 [debug] [MainThread]: On master: BEGIN
[0m12:52:48.593393 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:52:48.594003 [debug] [MainThread]: On master: COMMIT
[0m12:52:48.594631 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:48.595128 [debug] [MainThread]: On master: COMMIT
[0m12:52:48.595826 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:52:48.596332 [debug] [MainThread]: On master: Close
[0m12:52:48.600806 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m12:52:48.601672 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m12:52:48.602673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m12:52:48.603420 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m12:52:48.614206 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m12:52:48.615202 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m12:52:48.667705 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m12:52:48.668665 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:52:48.669118 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m12:52:48.669575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:48.681859 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m12:52:48.682860 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:52:48.683677 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m12:52:48.689166 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m12:52:48.699658 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:52:48.700297 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m12:52:48.701422 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:52:48.705330 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:52:48.705918 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m12:52:48.707016 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:52:48.738960 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:52:48.739706 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:52:48.740246 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:52:48.963926 [debug] [Thread-1 (]: SQL status: COMMIT in 0.222 seconds
[0m12:52:48.993411 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m12:52:49.004687 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:52:49.005454 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m12:52:49.012375 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m12:52:49.017331 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m12:52:49.020593 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2defc0c-ad89-44a4-a772-ad4f38443ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737b0a54a6f0>]}
[0m12:52:49.022113 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.42s]
[0m12:52:49.023611 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m12:52:49.025906 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:52:49.026763 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:52:49.028017 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:52:49.029541 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:52:49.031570 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:52:49.032703 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:52:49.033565 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:52:49.034352 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:52:49.039464 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:52:49.044278 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:52:49.045716 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:52:49.046365 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:52:49.051506 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:52:49.056816 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:52:49.058218 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:52:49.059154 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:52:49.059938 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:52:49.060697 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:52:49.061407 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:52:49.062164 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:52:49.082986 [debug] [Thread-3 (]: SQL status: BEGIN in 0.021 seconds
[0m12:52:49.086017 [debug] [Thread-4 (]: SQL status: BEGIN in 0.023 seconds
[0m12:52:49.088176 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:52:49.090398 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:52:49.092766 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m12:52:49.095204 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m12:52:49.106751 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.009 seconds
[0m12:52:49.114425 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.017 seconds
[0m12:52:49.121038 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:52:49.133106 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:52:49.135810 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:52:49.138081 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:52:49.141962 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:52:49.143637 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:52:49.162277 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:52:49.170112 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:52:49.171791 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:52:49.174021 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:52:49.177662 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:52:49.179627 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:52:49.186571 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:52:49.194261 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:52:49.196681 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:52:49.198787 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:52:49.201116 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:52:49.203532 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:52:49.212344 [debug] [Thread-4 (]: SQL status: COMMIT in 0.007 seconds
[0m12:52:49.222616 [debug] [Thread-3 (]: SQL status: COMMIT in 0.017 seconds
[0m12:52:49.224227 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:52:49.234463 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:52:49.237713 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:52:49.240877 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:52:49.243179 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:52:49.245272 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:52:49.256202 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.009 seconds
[0m12:52:49.263210 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:52:49.264933 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.017 seconds
[0m12:52:49.267867 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2defc0c-ad89-44a4-a772-ad4f38443ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737ae7f101a0>]}
[0m12:52:49.276084 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:52:49.279134 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.23s]
[0m12:52:49.283252 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2defc0c-ad89-44a4-a772-ad4f38443ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737b07d3cad0>]}
[0m12:52:49.286133 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:52:49.289218 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.25s]
[0m12:52:49.293694 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:52:49.302752 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:49.304739 [debug] [MainThread]: On master: BEGIN
[0m12:52:49.306201 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:52:49.342516 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m12:52:49.344414 [debug] [MainThread]: On master: COMMIT
[0m12:52:49.345976 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:49.347599 [debug] [MainThread]: On master: COMMIT
[0m12:52:49.349685 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:52:49.351409 [debug] [MainThread]: On master: Close
[0m12:52:49.353537 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:49.354849 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m12:52:49.356975 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:52:49.358476 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:52:49.360424 [info ] [MainThread]: 
[0m12:52:49.361964 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m12:52:49.368598 [debug] [MainThread]: Command end result
[0m12:52:49.418039 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:52:49.420835 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:52:49.431865 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:52:49.432498 [info ] [MainThread]: 
[0m12:52:49.433235 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:52:49.433957 [info ] [MainThread]: 
[0m12:52:49.434991 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:52:49.436849 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9101397, "process_in_blocks": "0", "process_kernel_time": 0.481811, "process_mem_max_rss": "108488", "process_out_blocks": "3392", "process_user_time": 3.153674}
[0m12:52:49.437579 [debug] [MainThread]: Command `dbt run` succeeded at 12:52:49.437414 after 1.91 seconds
[0m12:52:49.438132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737b0a54a7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737b082182c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737b0a4c1d00>]}
[0m12:52:49.438685 [debug] [MainThread]: Flushing usage events
[0m12:52:51.052631 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:53:47.889149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7406af3d18e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7406ac6e58e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7406ac6e5ee0>]}


============================== 12:53:47.902081 | c5efc09e-60d1-4656-acc9-df61e29b936e ==============================
[0m12:53:47.902081 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:53:47.902995 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:53:48.340847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5efc09e-60d1-4656-acc9-df61e29b936e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7406ac6ba900>]}
[0m12:53:48.492819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5efc09e-60d1-4656-acc9-df61e29b936e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7406ac27f560>]}
[0m12:53:48.494333 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:53:48.655666 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:53:48.946438 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:53:48.947293 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:53:49.052650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5efc09e-60d1-4656-acc9-df61e29b936e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7406aaabcbf0>]}
[0m12:53:49.187822 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:53:49.194021 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:53:49.235629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5efc09e-60d1-4656-acc9-df61e29b936e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7406aa7808f0>]}
[0m12:53:49.236318 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:53:49.236898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5efc09e-60d1-4656-acc9-df61e29b936e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7406ace03b30>]}
[0m12:53:49.242887 [info ] [MainThread]: 
[0m12:53:49.244552 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:53:49.245538 [info ] [MainThread]: 
[0m12:53:49.246740 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:53:49.253692 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:53:49.336013 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:53:49.336588 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:53:49.337038 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:49.353371 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m12:53:49.356116 [debug] [ThreadPool]: On list_db: Close
[0m12:53:49.359291 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:53:49.369425 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:53:49.369982 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:53:49.370502 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:49.386827 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m12:53:49.391135 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:53:49.392470 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:53:49.397507 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m12:53:49.399837 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:53:49.400783 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:53:49.409982 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:49.410574 [debug] [MainThread]: On master: BEGIN
[0m12:53:49.411035 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:53:49.425234 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m12:53:49.426347 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:49.427154 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:53:49.435131 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m12:53:49.440327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5efc09e-60d1-4656-acc9-df61e29b936e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7406ac513c20>]}
[0m12:53:49.442847 [debug] [MainThread]: On master: ROLLBACK
[0m12:53:49.445981 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:49.446594 [debug] [MainThread]: On master: BEGIN
[0m12:53:49.447786 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:53:49.448561 [debug] [MainThread]: On master: COMMIT
[0m12:53:49.449110 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:49.449567 [debug] [MainThread]: On master: COMMIT
[0m12:53:49.450348 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:53:49.450824 [debug] [MainThread]: On master: Close
[0m12:53:49.457278 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m12:53:49.459180 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m12:53:49.460419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m12:53:49.461588 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m12:53:49.477454 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m12:53:49.478750 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m12:53:49.554348 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m12:53:49.555440 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:53:49.555953 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m12:53:49.556439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:49.570307 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m12:53:49.573021 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:53:49.574266 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m12:53:49.580245 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m12:53:49.590277 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:53:49.590922 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m12:53:49.591978 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:53:49.595895 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:53:49.596395 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m12:53:49.597327 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:53:49.656245 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:53:49.657756 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:53:49.658925 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:53:49.666266 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m12:53:49.693518 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m12:53:49.715164 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:53:49.716168 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m12:53:49.723594 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m12:53:49.729108 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m12:53:49.733061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5efc09e-60d1-4656-acc9-df61e29b936e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7406ace39dc0>]}
[0m12:53:49.734933 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.27s]
[0m12:53:49.739970 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m12:53:49.742391 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:53:49.743579 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:53:49.744697 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:53:49.746307 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:53:49.748287 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:53:49.749533 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:53:49.750635 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:53:49.751694 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:53:49.761680 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:53:49.770186 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:53:49.772833 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:53:49.774116 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:53:49.781888 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:53:49.791031 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:53:49.793372 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:53:49.794359 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:53:49.795620 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:53:49.796764 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:53:49.797969 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:53:49.799030 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:53:49.818492 [debug] [Thread-3 (]: SQL status: BEGIN in 0.020 seconds
[0m12:53:49.820942 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:53:49.822042 [debug] [Thread-4 (]: SQL status: BEGIN in 0.023 seconds
[0m12:53:49.823253 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m12:53:49.824429 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:53:49.825967 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m12:53:49.834574 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m12:53:49.835817 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.010 seconds
[0m12:53:49.843139 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:53:49.848626 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:53:49.849547 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:53:49.850520 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:53:49.853016 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:53:49.854427 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:53:49.861361 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:53:49.866669 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:53:49.867776 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:53:49.869151 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:53:49.872418 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:53:49.873594 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:53:49.877930 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:53:49.881635 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:53:49.882674 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:53:49.884077 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:53:49.885150 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:53:49.886793 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:53:49.894164 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m12:53:49.900535 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:53:49.901549 [debug] [Thread-3 (]: SQL status: COMMIT in 0.012 seconds
[0m12:53:49.904299 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:53:49.909874 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:53:49.911015 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:53:49.912610 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:53:49.913876 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:53:49.920753 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.007 seconds
[0m12:53:49.925933 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:53:49.926843 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.012 seconds
[0m12:53:49.930338 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:53:49.931735 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5efc09e-60d1-4656-acc9-df61e29b936e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7406a9aed4f0>]}
[0m12:53:49.933338 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5efc09e-60d1-4656-acc9-df61e29b936e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7406a99303e0>]}
[0m12:53:49.934938 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.18s]
[0m12:53:49.941024 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.19s]
[0m12:53:49.945473 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:53:49.948293 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:53:49.955055 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:49.956403 [debug] [MainThread]: On master: BEGIN
[0m12:53:49.957296 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:53:49.983596 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m12:53:49.985346 [debug] [MainThread]: On master: COMMIT
[0m12:53:49.989431 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:49.992476 [debug] [MainThread]: On master: COMMIT
[0m12:53:49.994000 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:53:49.995078 [debug] [MainThread]: On master: Close
[0m12:53:49.996498 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:49.997441 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m12:53:49.998596 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:53:49.999284 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:53:50.000270 [info ] [MainThread]: 
[0m12:53:50.001459 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m12:53:50.008751 [debug] [MainThread]: Command end result
[0m12:53:50.057529 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:53:50.060725 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:53:50.072253 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:53:50.072821 [info ] [MainThread]: 
[0m12:53:50.073953 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:53:50.075057 [info ] [MainThread]: 
[0m12:53:50.076043 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:53:50.077809 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2831502, "process_in_blocks": "0", "process_kernel_time": 0.758312, "process_mem_max_rss": "108636", "process_out_blocks": "3392", "process_user_time": 4.457102}
[0m12:53:50.078591 [debug] [MainThread]: Command `dbt run` succeeded at 12:53:50.078426 after 2.28 seconds
[0m12:53:50.079103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7406ac9f14c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7406ac2d32c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7406ac3492b0>]}
[0m12:53:50.079701 [debug] [MainThread]: Flushing usage events
[0m12:53:51.558742 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:54:48.197943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5334423e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5332ec7fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e53341ac5f0>]}


============================== 12:54:48.206579 | 6ea039f5-00bc-440c-8da7-ddcb36f74109 ==============================
[0m12:54:48.206579 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:54:48.207682 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:54:48.526981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ea039f5-00bc-440c-8da7-ddcb36f74109', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e533281b710>]}
[0m12:54:48.644761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ea039f5-00bc-440c-8da7-ddcb36f74109', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e53321a8470>]}
[0m12:54:48.645936 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:54:48.821545 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:54:49.146502 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:54:49.147795 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:54:49.339998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ea039f5-00bc-440c-8da7-ddcb36f74109', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e53309d4d70>]}
[0m12:54:49.474352 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:54:49.478860 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:54:49.520362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ea039f5-00bc-440c-8da7-ddcb36f74109', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e53306a4920>]}
[0m12:54:49.521139 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:54:49.521871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ea039f5-00bc-440c-8da7-ddcb36f74109', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e53309b1b80>]}
[0m12:54:49.526211 [info ] [MainThread]: 
[0m12:54:49.527336 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:54:49.528848 [info ] [MainThread]: 
[0m12:54:49.533652 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:54:49.542889 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:54:49.675760 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:54:49.678074 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:54:49.679765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:49.719569 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.040 seconds
[0m12:54:49.726809 [debug] [ThreadPool]: On list_db: Close
[0m12:54:49.732865 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:54:49.754925 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:54:49.756198 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:54:49.757140 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:54:49.789320 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m12:54:49.791385 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:54:49.794354 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:54:49.806464 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.011 seconds
[0m12:54:49.812699 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:54:49.814740 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:54:49.833865 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:49.835745 [debug] [MainThread]: On master: BEGIN
[0m12:54:49.837124 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:54:49.871365 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m12:54:49.875273 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:49.877850 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:54:49.893702 [debug] [MainThread]: SQL status: SELECT 0 in 0.012 seconds
[0m12:54:49.899203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ea039f5-00bc-440c-8da7-ddcb36f74109', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e53308faba0>]}
[0m12:54:49.901218 [debug] [MainThread]: On master: ROLLBACK
[0m12:54:49.902943 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:49.904420 [debug] [MainThread]: On master: BEGIN
[0m12:54:49.907402 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:54:49.909714 [debug] [MainThread]: On master: COMMIT
[0m12:54:49.910942 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:49.912204 [debug] [MainThread]: On master: COMMIT
[0m12:54:49.914223 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:54:49.916971 [debug] [MainThread]: On master: Close
[0m12:54:49.928939 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m12:54:49.931837 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m12:54:49.936643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m12:54:49.938159 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m12:54:49.968270 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m12:54:49.969825 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m12:54:50.048811 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m12:54:50.049918 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:54:50.050476 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m12:54:50.050969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:50.062916 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m12:54:50.063822 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:54:50.064563 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m12:54:50.069108 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m12:54:50.078911 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:54:50.079559 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m12:54:50.080668 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:54:50.088754 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:54:50.089779 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m12:54:50.091098 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:54:50.119787 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:54:50.120483 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:54:50.120991 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:54:50.125960 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m12:54:50.136934 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m12:54:50.145973 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:54:50.146575 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m12:54:50.152525 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m12:54:50.156016 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m12:54:50.158464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ea039f5-00bc-440c-8da7-ddcb36f74109', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5332d02810>]}
[0m12:54:50.159582 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.22s]
[0m12:54:50.161117 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m12:54:50.162895 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:54:50.163633 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:54:50.164452 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:54:50.165423 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:54:50.166580 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:54:50.167699 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:54:50.168892 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:54:50.173429 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:54:50.174226 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:54:50.178565 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:54:50.179712 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:54:50.184742 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:54:50.185598 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:54:50.190513 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:54:50.191926 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:54:50.192519 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:54:50.193227 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:54:50.193930 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:54:50.194628 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:54:50.195213 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:54:50.214669 [debug] [Thread-4 (]: SQL status: BEGIN in 0.019 seconds
[0m12:54:50.215565 [debug] [Thread-3 (]: SQL status: BEGIN in 0.021 seconds
[0m12:54:50.216458 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:54:50.217376 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:54:50.218108 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m12:54:50.218856 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m12:54:50.225382 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m12:54:50.232281 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.012 seconds
[0m12:54:50.234364 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:54:50.238855 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:54:50.239741 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:54:50.240808 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:54:50.242185 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:54:50.242920 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:54:50.247652 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:54:50.252069 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:54:50.252856 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:54:50.253566 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:54:50.254819 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:54:50.255565 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:54:50.259131 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:54:50.261634 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:54:50.262472 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:54:50.263171 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:54:50.264019 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:54:50.264672 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:54:50.440769 [debug] [Thread-4 (]: SQL status: COMMIT in 0.175 seconds
[0m12:54:50.442975 [debug] [Thread-3 (]: SQL status: COMMIT in 0.177 seconds
[0m12:54:50.458810 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:54:50.468983 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:54:50.473633 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:54:50.477996 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:54:50.481702 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:54:50.484039 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:54:50.500987 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.015 seconds
[0m12:54:50.507138 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:54:50.510099 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ea039f5-00bc-440c-8da7-ddcb36f74109', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e532f849af0>]}
[0m12:54:50.513273 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.34s]
[0m12:54:50.516940 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:54:50.695235 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.208 seconds
[0m12:54:50.703470 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:54:50.707091 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ea039f5-00bc-440c-8da7-ddcb36f74109', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e532c753e90>]}
[0m12:54:50.710336 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.54s]
[0m12:54:50.713715 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:54:50.723324 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:50.725952 [debug] [MainThread]: On master: BEGIN
[0m12:54:50.729858 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:54:50.778515 [debug] [MainThread]: SQL status: BEGIN in 0.049 seconds
[0m12:54:50.782612 [debug] [MainThread]: On master: COMMIT
[0m12:54:50.784578 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:50.785943 [debug] [MainThread]: On master: COMMIT
[0m12:54:50.788836 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:54:50.792211 [debug] [MainThread]: On master: Close
[0m12:54:50.796781 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:54:50.799819 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m12:54:50.801850 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:54:50.803513 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:54:50.806866 [info ] [MainThread]: 
[0m12:54:50.809852 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.28 seconds (1.28s).
[0m12:54:50.820675 [debug] [MainThread]: Command end result
[0m12:54:50.916063 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:54:50.919794 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:54:50.931144 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:54:50.931660 [info ] [MainThread]: 
[0m12:54:50.932324 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:54:50.932981 [info ] [MainThread]: 
[0m12:54:50.933841 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:54:50.935410 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.8093145, "process_in_blocks": "0", "process_kernel_time": 0.68244, "process_mem_max_rss": "108148", "process_out_blocks": "3400", "process_user_time": 4.419802}
[0m12:54:50.936201 [debug] [MainThread]: Command `dbt run` succeeded at 12:54:50.936041 after 2.81 seconds
[0m12:54:50.936732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e532fb069f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e53322b36e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e53324bbb30>]}
[0m12:54:50.937269 [debug] [MainThread]: Flushing usage events
[0m12:54:52.399027 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:55:48.518391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53e3cd5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53e1deb020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53e255b8c0>]}


============================== 12:55:48.526594 | 43d10d68-888a-456e-b2fc-fc6de0493e22 ==============================
[0m12:55:48.526594 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:55:48.527302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:55:48.828912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43d10d68-888a-456e-b2fc-fc6de0493e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53e1b3b260>]}
[0m12:55:48.973589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43d10d68-888a-456e-b2fc-fc6de0493e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53e1af0260>]}
[0m12:55:48.975606 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:55:49.153542 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:55:49.359167 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:55:49.359726 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:55:49.414449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43d10d68-888a-456e-b2fc-fc6de0493e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53e02d6d50>]}
[0m12:55:49.544061 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:55:49.549035 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:55:49.586365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43d10d68-888a-456e-b2fc-fc6de0493e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53dffe82c0>]}
[0m12:55:49.587074 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:55:49.587611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43d10d68-888a-456e-b2fc-fc6de0493e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53e1d6ffb0>]}
[0m12:55:49.590299 [info ] [MainThread]: 
[0m12:55:49.590909 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:55:49.591559 [info ] [MainThread]: 
[0m12:55:49.592789 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:55:49.600237 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:55:49.669929 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:55:49.670462 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:55:49.670861 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:55:49.685195 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m12:55:49.687076 [debug] [ThreadPool]: On list_db: Close
[0m12:55:49.689231 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:55:49.697024 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:55:49.697602 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:55:49.698091 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:55:49.721061 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m12:55:49.723022 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:55:49.724928 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:55:49.740822 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.014 seconds
[0m12:55:49.749109 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:55:49.751693 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:55:49.777022 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:49.778633 [debug] [MainThread]: On master: BEGIN
[0m12:55:49.780456 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:55:49.824851 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m12:55:49.826915 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:49.828365 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:55:49.840243 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m12:55:49.843932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43d10d68-888a-456e-b2fc-fc6de0493e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53df469880>]}
[0m12:55:49.846086 [debug] [MainThread]: On master: ROLLBACK
[0m12:55:49.848983 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:49.850601 [debug] [MainThread]: On master: BEGIN
[0m12:55:49.853411 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:55:49.855772 [debug] [MainThread]: On master: COMMIT
[0m12:55:49.857281 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:49.858444 [debug] [MainThread]: On master: COMMIT
[0m12:55:49.860324 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:55:49.862301 [debug] [MainThread]: On master: Close
[0m12:55:49.874576 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m12:55:49.876420 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m12:55:49.879502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m12:55:49.881868 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m12:55:49.908959 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m12:55:49.910404 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m12:55:50.024921 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m12:55:50.026097 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:55:50.026674 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m12:55:50.027190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:55:50.041475 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m12:55:50.042201 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:55:50.042788 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m12:55:50.049186 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m12:55:50.059708 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:55:50.060686 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m12:55:50.062198 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:55:50.067319 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:55:50.068005 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m12:55:50.069522 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:55:50.099760 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:55:50.100453 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:55:50.100916 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:55:50.163140 [debug] [Thread-1 (]: SQL status: COMMIT in 0.062 seconds
[0m12:55:50.173911 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m12:55:50.183761 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:55:50.184860 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m12:55:50.194041 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m12:55:50.203100 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m12:55:50.209092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43d10d68-888a-456e-b2fc-fc6de0493e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53e26a25a0>]}
[0m12:55:50.211781 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.33s]
[0m12:55:50.215589 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m12:55:50.219870 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:55:50.222313 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:55:50.224371 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:55:50.226689 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:55:50.230401 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:55:50.233125 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:55:50.235119 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:55:50.237021 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:55:50.248636 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:55:50.257925 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:55:50.260655 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:55:50.262455 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:55:50.273511 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:55:50.284645 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:55:50.287864 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:55:50.289749 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:55:50.291007 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:55:50.292557 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:55:50.294091 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:55:50.295824 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:55:50.326422 [debug] [Thread-4 (]: SQL status: BEGIN in 0.031 seconds
[0m12:55:50.329070 [debug] [Thread-3 (]: SQL status: BEGIN in 0.035 seconds
[0m12:55:50.331876 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:55:50.334173 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:55:50.335740 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m12:55:50.337769 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m12:55:50.348379 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.009 seconds
[0m12:55:50.356468 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.017 seconds
[0m12:55:50.360212 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:55:50.371020 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:55:50.372622 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:55:50.374224 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:55:50.377053 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:55:50.378385 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:55:50.388562 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:55:50.399239 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:55:50.401061 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:55:50.402786 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:55:50.405612 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:55:50.407083 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:55:50.413554 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:55:50.419029 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:55:50.420814 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:55:50.422436 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:55:50.424084 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:55:50.425488 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:55:50.432418 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m12:55:50.439474 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:55:50.441667 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:55:50.442849 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:55:50.565392 [debug] [Thread-3 (]: SQL status: COMMIT in 0.138 seconds
[0m12:55:50.573144 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:55:50.575292 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.131 seconds
[0m12:55:50.578417 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:55:50.584820 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:55:50.587245 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:55:50.590382 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43d10d68-888a-456e-b2fc-fc6de0493e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53dc092870>]}
[0m12:55:50.594427 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.36s]
[0m12:55:50.599666 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:55:50.609930 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.021 seconds
[0m12:55:50.615596 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:55:50.617653 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43d10d68-888a-456e-b2fc-fc6de0493e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53df3561b0>]}
[0m12:55:50.619521 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.39s]
[0m12:55:50.622112 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:55:50.629524 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:50.631129 [debug] [MainThread]: On master: BEGIN
[0m12:55:50.632459 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:55:50.662496 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m12:55:50.664839 [debug] [MainThread]: On master: COMMIT
[0m12:55:50.666427 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:50.667712 [debug] [MainThread]: On master: COMMIT
[0m12:55:50.669652 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:55:50.671014 [debug] [MainThread]: On master: Close
[0m12:55:50.673183 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:55:50.674621 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m12:55:50.675875 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:55:50.676987 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:55:50.679654 [info ] [MainThread]: 
[0m12:55:50.682030 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.09 seconds (1.09s).
[0m12:55:50.687900 [debug] [MainThread]: Command end result
[0m12:55:50.764078 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:55:50.767212 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:55:50.780353 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:55:50.782658 [info ] [MainThread]: 
[0m12:55:50.785446 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:55:50.785959 [info ] [MainThread]: 
[0m12:55:50.786820 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:55:50.789528 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3469207, "process_in_blocks": "0", "process_kernel_time": 0.555845, "process_mem_max_rss": "108424", "process_out_blocks": "3400", "process_user_time": 3.512301}
[0m12:55:50.793981 [debug] [MainThread]: Command `dbt run` succeeded at 12:55:50.793526 after 2.35 seconds
[0m12:55:50.795600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53e27f3050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53e2273fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53e1bb0ec0>]}
[0m12:55:50.797321 [debug] [MainThread]: Flushing usage events
[0m12:55:52.308083 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:56:49.526580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79751e93d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79751e73ccb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79751e73e870>]}


============================== 12:56:49.538376 | eb447e64-7034-430e-9e0e-828afe027845 ==============================
[0m12:56:49.538376 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:56:49.539174 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:56:49.903785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb447e64-7034-430e-9e0e-828afe027845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79752029b2f0>]}
[0m12:56:49.993464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb447e64-7034-430e-9e0e-828afe027845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79751e3271a0>]}
[0m12:56:49.994485 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:56:50.173419 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:56:50.395848 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:56:50.396745 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:56:50.457406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb447e64-7034-430e-9e0e-828afe027845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79751e7d7470>]}
[0m12:56:50.581583 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:56:50.585347 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:56:50.622243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb447e64-7034-430e-9e0e-828afe027845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79751ca238f0>]}
[0m12:56:50.623028 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:56:50.623795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb447e64-7034-430e-9e0e-828afe027845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79751f054b30>]}
[0m12:56:50.626864 [info ] [MainThread]: 
[0m12:56:50.627913 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:56:50.629047 [info ] [MainThread]: 
[0m12:56:50.630569 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:56:50.637378 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:56:50.707318 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:56:50.707838 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:56:50.708284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:50.723365 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m12:56:50.725273 [debug] [ThreadPool]: On list_db: Close
[0m12:56:50.727661 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:56:50.737221 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:56:50.737737 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:56:50.738151 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:56:50.750692 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m12:56:50.751497 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:56:50.752049 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:56:50.756291 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m12:56:50.758259 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:56:50.759107 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:56:50.770705 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:50.771381 [debug] [MainThread]: On master: BEGIN
[0m12:56:50.771855 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:56:50.784780 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m12:56:50.785597 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:50.786222 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:56:50.790924 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m12:56:50.793463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb447e64-7034-430e-9e0e-828afe027845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79751bc33e60>]}
[0m12:56:50.794352 [debug] [MainThread]: On master: ROLLBACK
[0m12:56:50.795259 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:50.795792 [debug] [MainThread]: On master: BEGIN
[0m12:56:50.797025 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:56:50.797823 [debug] [MainThread]: On master: COMMIT
[0m12:56:50.798341 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:50.798925 [debug] [MainThread]: On master: COMMIT
[0m12:56:50.799791 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:56:50.800278 [debug] [MainThread]: On master: Close
[0m12:56:50.805226 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m12:56:50.806175 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m12:56:50.806908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m12:56:50.807548 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m12:56:50.818443 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m12:56:50.819369 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m12:56:50.879274 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m12:56:50.880247 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:56:50.880731 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m12:56:50.881317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:50.894087 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m12:56:50.895157 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:56:50.896132 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m12:56:50.905794 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m12:56:50.924654 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:56:50.926039 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m12:56:50.928922 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:56:50.937021 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:56:50.938149 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m12:56:50.940227 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:56:50.993822 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:56:50.994586 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:56:50.995156 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:56:51.098443 [debug] [Thread-1 (]: SQL status: COMMIT in 0.102 seconds
[0m12:56:51.158166 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m12:56:51.185403 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:56:51.187082 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m12:56:51.202196 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.013 seconds
[0m12:56:51.212320 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m12:56:51.219896 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb447e64-7034-430e-9e0e-828afe027845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79751ee8df10>]}
[0m12:56:51.222719 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.41s]
[0m12:56:51.226636 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m12:56:51.232101 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:56:51.235343 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:56:51.238009 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:56:51.242022 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:56:51.245832 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:56:51.248770 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:56:51.251264 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:56:51.253863 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:56:51.270575 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:56:51.282508 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:56:51.286384 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:56:51.305665 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:56:51.304221 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:56:51.350170 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:56:51.353546 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:56:51.356545 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:56:51.358905 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:56:51.360522 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:56:51.362656 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:56:51.366345 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:56:51.408473 [debug] [Thread-3 (]: SQL status: BEGIN in 0.047 seconds
[0m12:56:51.412501 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:56:51.415721 [debug] [Thread-4 (]: SQL status: BEGIN in 0.049 seconds
[0m12:56:51.419381 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m12:56:51.422497 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:56:51.426898 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m12:56:51.441983 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.016 seconds
[0m12:56:51.452028 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.022 seconds
[0m12:56:51.460512 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:56:51.474352 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:56:51.476647 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:56:51.478871 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:56:51.482246 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:56:51.484055 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:56:51.502908 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:56:51.509608 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:56:51.511854 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:56:51.514315 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:56:51.518549 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:56:51.520215 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:56:51.529398 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:56:51.536937 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:56:51.539125 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:56:51.541123 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:56:51.543723 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:56:51.546106 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:56:51.626898 [debug] [Thread-3 (]: SQL status: COMMIT in 0.078 seconds
[0m12:56:51.636493 [debug] [Thread-4 (]: SQL status: COMMIT in 0.087 seconds
[0m12:56:51.640184 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:56:51.653035 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:56:51.657942 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:56:51.662165 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:56:51.667307 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:56:51.675967 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:56:51.705417 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.023 seconds
[0m12:56:51.718789 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.038 seconds
[0m12:56:51.720836 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:56:51.725493 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:56:51.728035 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb447e64-7034-430e-9e0e-828afe027845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7975188a9010>]}
[0m12:56:51.730264 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb447e64-7034-430e-9e0e-828afe027845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79751ba772f0>]}
[0m12:56:51.732565 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.48s]
[0m12:56:51.735006 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.49s]
[0m12:56:51.736922 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:56:51.739519 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:56:51.746021 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:51.747075 [debug] [MainThread]: On master: BEGIN
[0m12:56:51.747890 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:56:51.769182 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m12:56:51.770654 [debug] [MainThread]: On master: COMMIT
[0m12:56:51.771776 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:51.772638 [debug] [MainThread]: On master: COMMIT
[0m12:56:51.774185 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:56:51.775112 [debug] [MainThread]: On master: Close
[0m12:56:51.776493 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:56:51.777288 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m12:56:51.778148 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:56:51.779014 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:56:51.780371 [info ] [MainThread]: 
[0m12:56:51.781895 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.15 seconds (1.15s).
[0m12:56:51.786366 [debug] [MainThread]: Command end result
[0m12:56:51.864606 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:56:51.867816 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:56:51.878489 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:56:51.879382 [info ] [MainThread]: 
[0m12:56:51.880228 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:56:51.881086 [info ] [MainThread]: 
[0m12:56:51.881842 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:56:51.884152 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4241197, "process_in_blocks": "0", "process_kernel_time": 0.626808, "process_mem_max_rss": "108388", "process_out_blocks": "3400", "process_user_time": 4.375603}
[0m12:56:51.885015 [debug] [MainThread]: Command `dbt run` succeeded at 12:56:51.884849 after 2.43 seconds
[0m12:56:51.885551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79751e93d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79751ca676e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79751ca65550>]}
[0m12:56:51.886128 [debug] [MainThread]: Flushing usage events
[0m12:56:53.442292 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:57:49.479275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f1eb0be120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f1ea6d1fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f1e99b2c60>]}


============================== 12:57:49.488992 | 6fe0f025-aa0d-4dee-8dd0-cb1e310362f9 ==============================
[0m12:57:49.488992 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:57:49.489855 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:57:49.897034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fe0f025-aa0d-4dee-8dd0-cb1e310362f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f1e7945af0>]}
[0m12:57:50.070592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6fe0f025-aa0d-4dee-8dd0-cb1e310362f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f1e91e7b90>]}
[0m12:57:50.072234 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:57:50.258071 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:57:50.466674 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:57:50.467250 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:57:50.545291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fe0f025-aa0d-4dee-8dd0-cb1e310362f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f1e799bd40>]}
[0m12:57:50.698131 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:57:50.702300 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:57:50.741871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6fe0f025-aa0d-4dee-8dd0-cb1e310362f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f1e76b5910>]}
[0m12:57:50.742529 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:57:50.743181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fe0f025-aa0d-4dee-8dd0-cb1e310362f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f1e91e5b80>]}
[0m12:57:50.747362 [info ] [MainThread]: 
[0m12:57:50.748158 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:57:50.749290 [info ] [MainThread]: 
[0m12:57:50.751501 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:57:50.758233 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:57:50.891102 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:57:50.891925 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:57:50.892532 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:50.908573 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m12:57:50.910672 [debug] [ThreadPool]: On list_db: Close
[0m12:57:50.913241 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:57:50.925779 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:57:50.926753 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:57:50.927640 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:57:50.942132 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m12:57:50.942788 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:57:50.943352 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:57:50.948028 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m12:57:50.952635 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:57:50.954880 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:57:50.964351 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:50.965298 [debug] [MainThread]: On master: BEGIN
[0m12:57:50.965904 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:57:50.980850 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m12:57:50.982967 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:50.985044 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:57:50.991229 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m12:57:50.993540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fe0f025-aa0d-4dee-8dd0-cb1e310362f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f1ea5d7050>]}
[0m12:57:50.994275 [debug] [MainThread]: On master: ROLLBACK
[0m12:57:50.995132 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:50.995673 [debug] [MainThread]: On master: BEGIN
[0m12:57:50.996984 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:57:50.997945 [debug] [MainThread]: On master: COMMIT
[0m12:57:50.998612 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:50.999684 [debug] [MainThread]: On master: COMMIT
[0m12:57:51.000908 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:57:51.001890 [debug] [MainThread]: On master: Close
[0m12:57:51.007201 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m12:57:51.008054 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m12:57:51.008908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m12:57:51.009736 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m12:57:51.023712 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m12:57:51.024640 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m12:57:51.085691 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m12:57:51.087339 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:57:51.087947 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m12:57:51.088615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:51.102341 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m12:57:51.103442 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:57:51.103991 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m12:57:51.108520 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m12:57:51.121378 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:57:51.122112 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m12:57:51.123585 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:57:51.127836 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:57:51.128447 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m12:57:51.129709 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:57:51.167471 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:57:51.168155 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:57:51.169108 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:57:51.181706 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m12:57:51.195584 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m12:57:51.206205 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:57:51.206894 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m12:57:51.213079 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m12:57:51.216479 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m12:57:51.222692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fe0f025-aa0d-4dee-8dd0-cb1e310362f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f1e9d6e0c0>]}
[0m12:57:51.224110 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.21s]
[0m12:57:51.226310 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m12:57:51.228517 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:57:51.229737 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:57:51.230882 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:57:51.232279 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:57:51.233698 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:57:51.235048 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:57:51.235959 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:57:51.237874 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:57:51.244984 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:57:51.248923 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:57:51.250093 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:57:51.257870 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:57:51.258771 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:57:51.263868 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:57:51.264888 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:57:51.265525 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:57:51.266084 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:57:51.266772 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:57:51.267384 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:57:51.268335 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:57:51.281487 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m12:57:51.282523 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m12:57:51.283272 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:57:51.284116 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:57:51.284866 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m12:57:51.285581 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m12:57:51.292536 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m12:57:51.297129 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:57:51.297750 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m12:57:51.298375 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:57:51.302774 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:57:51.304213 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:57:51.305763 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:57:51.314546 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m12:57:51.315523 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:57:51.320213 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:57:51.321724 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:57:51.324447 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:57:51.326676 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:57:51.327789 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:57:51.331096 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:57:51.334343 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:57:51.335112 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:57:51.335744 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:57:51.336425 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:57:51.337146 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:57:51.343528 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m12:57:51.347269 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:57:51.347989 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m12:57:51.349052 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:57:51.353264 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:57:51.354313 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:57:51.357814 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:57:51.370500 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:57:51.377313 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.008 seconds
[0m12:57:51.379774 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:57:51.380758 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fe0f025-aa0d-4dee-8dd0-cb1e310362f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f1e6903770>]}
[0m12:57:51.383118 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.15s]
[0m12:57:51.385201 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:57:51.444372 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.072 seconds
[0m12:57:51.453016 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:57:51.455877 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fe0f025-aa0d-4dee-8dd0-cb1e310362f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f1e6a21ca0>]}
[0m12:57:51.458973 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.22s]
[0m12:57:51.465062 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:57:51.476364 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:51.478242 [debug] [MainThread]: On master: BEGIN
[0m12:57:51.480039 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:57:51.523696 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m12:57:51.526538 [debug] [MainThread]: On master: COMMIT
[0m12:57:51.528835 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:51.531155 [debug] [MainThread]: On master: COMMIT
[0m12:57:51.541242 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:57:51.544578 [debug] [MainThread]: On master: Close
[0m12:57:51.546649 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:57:51.548663 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m12:57:51.550403 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:57:51.551500 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:57:51.553181 [info ] [MainThread]: 
[0m12:57:51.555370 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m12:57:51.558809 [debug] [MainThread]: Command end result
[0m12:57:51.607080 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:57:51.609656 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:57:51.619632 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:57:51.620159 [info ] [MainThread]: 
[0m12:57:51.620763 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:57:51.621260 [info ] [MainThread]: 
[0m12:57:51.621944 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:57:51.623595 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2277331, "process_in_blocks": "0", "process_kernel_time": 0.741133, "process_mem_max_rss": "108340", "process_out_blocks": "3400", "process_user_time": 4.470708}
[0m12:57:51.624357 [debug] [MainThread]: Command `dbt run` succeeded at 12:57:51.624169 after 2.23 seconds
[0m12:57:51.624907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f1e97b6a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f1e9484f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f1e919edb0>]}
[0m12:57:51.625438 [debug] [MainThread]: Flushing usage events
[0m12:57:53.168427 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:58:48.691126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc5963e1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc5963c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc5903dac0>]}


============================== 12:58:48.701123 | 1e94b76f-2e95-48f4-82d0-624efb32a886 ==============================
[0m12:58:48.701123 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:58:48.701914 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:58:49.067334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e94b76f-2e95-48f4-82d0-624efb32a886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc58973e30>]}
[0m12:58:49.226630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e94b76f-2e95-48f4-82d0-624efb32a886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc58921d30>]}
[0m12:58:49.227944 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:58:49.408585 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:58:49.624754 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:58:49.625328 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:58:49.693476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e94b76f-2e95-48f4-82d0-624efb32a886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc57114e60>]}
[0m12:58:49.831346 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:58:49.835426 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:58:49.877731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e94b76f-2e95-48f4-82d0-624efb32a886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc56e1c5f0>]}
[0m12:58:49.879593 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:58:49.881624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e94b76f-2e95-48f4-82d0-624efb32a886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc589236e0>]}
[0m12:58:49.888185 [info ] [MainThread]: 
[0m12:58:49.889757 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:58:49.891429 [info ] [MainThread]: 
[0m12:58:49.894557 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:58:49.910456 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:58:50.018816 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:58:50.019370 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:58:50.019854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:50.035552 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m12:58:50.037723 [debug] [ThreadPool]: On list_db: Close
[0m12:58:50.041610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:58:50.055084 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:58:50.055630 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:58:50.056159 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:58:50.069656 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m12:58:50.070450 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:58:50.070969 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:58:50.077130 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m12:58:50.080926 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:58:50.082259 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:58:50.091036 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:50.092256 [debug] [MainThread]: On master: BEGIN
[0m12:58:50.092859 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:58:50.107296 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m12:58:50.108123 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:50.110512 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:58:50.116843 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m12:58:50.119083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e94b76f-2e95-48f4-82d0-624efb32a886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc56c9fbf0>]}
[0m12:58:50.119821 [debug] [MainThread]: On master: ROLLBACK
[0m12:58:50.120640 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:50.121163 [debug] [MainThread]: On master: BEGIN
[0m12:58:50.122325 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:58:50.123000 [debug] [MainThread]: On master: COMMIT
[0m12:58:50.123547 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:50.124036 [debug] [MainThread]: On master: COMMIT
[0m12:58:50.125046 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:58:50.126094 [debug] [MainThread]: On master: Close
[0m12:58:50.132030 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m12:58:50.132996 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m12:58:50.133753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m12:58:50.134425 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m12:58:50.148932 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m12:58:50.149871 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m12:58:50.217284 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m12:58:50.218455 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:58:50.218954 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m12:58:50.219440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:58:50.232650 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m12:58:50.233708 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:58:50.234227 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m12:58:50.238658 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m12:58:50.251011 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:58:50.251633 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m12:58:50.252749 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:58:50.256561 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:58:50.257078 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m12:58:50.258235 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:58:50.290360 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:58:50.291268 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:58:50.291968 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:58:50.297343 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m12:58:50.309733 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m12:58:50.322474 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:58:50.323144 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m12:58:50.330396 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m12:58:50.334120 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m12:58:50.336832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e94b76f-2e95-48f4-82d0-624efb32a886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc5a8a6480>]}
[0m12:58:50.337872 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.20s]
[0m12:58:50.338945 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m12:58:50.341148 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:58:50.343520 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:58:50.345472 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:58:50.347897 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:58:50.349430 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:58:50.350174 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:58:50.350937 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:58:50.351557 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:58:50.355504 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:58:50.360162 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:58:50.361495 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:58:50.362107 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:58:50.366256 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:58:50.370622 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:58:50.371891 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:58:50.372634 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:58:50.373169 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:58:50.373792 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:58:50.374766 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:58:50.376663 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:58:50.389678 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m12:58:50.390660 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m12:58:50.391600 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:58:50.392619 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:58:50.393319 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m12:58:50.394003 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m12:58:50.398159 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m12:58:50.398911 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m12:58:50.403798 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:58:50.409231 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:58:50.411159 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:58:50.412135 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:58:50.414001 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:58:50.414728 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:58:50.419136 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:58:50.423124 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:58:50.424200 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:58:50.425892 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:58:50.427675 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:58:50.428809 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:58:50.432447 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:58:50.435039 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:58:50.435866 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:58:50.436526 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:58:50.437210 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:58:50.437880 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:58:50.443141 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m12:58:50.448473 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:58:50.449298 [debug] [Thread-3 (]: SQL status: COMMIT in 0.011 seconds
[0m12:58:50.450369 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:58:50.453756 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:58:50.454489 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:58:50.455911 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:58:50.456946 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:58:50.463965 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m12:58:50.464652 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.008 seconds
[0m12:58:50.466769 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:58:50.468846 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:58:50.470175 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e94b76f-2e95-48f4-82d0-624efb32a886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc546cff80>]}
[0m12:58:50.471436 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e94b76f-2e95-48f4-82d0-624efb32a886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc55fba2a0>]}
[0m12:58:50.472426 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.12s]
[0m12:58:50.473719 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.12s]
[0m12:58:50.476105 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:58:50.477901 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:58:50.482445 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:50.483057 [debug] [MainThread]: On master: BEGIN
[0m12:58:50.483517 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:58:50.496554 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m12:58:50.497336 [debug] [MainThread]: On master: COMMIT
[0m12:58:50.497970 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:50.498397 [debug] [MainThread]: On master: COMMIT
[0m12:58:50.499167 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:58:50.499643 [debug] [MainThread]: On master: Close
[0m12:58:50.500447 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:58:50.500860 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m12:58:50.501279 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:58:50.501751 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:58:50.502336 [info ] [MainThread]: 
[0m12:58:50.502866 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m12:58:50.505050 [debug] [MainThread]: Command end result
[0m12:58:50.548478 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:58:50.551895 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:58:50.563049 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:58:50.563567 [info ] [MainThread]: 
[0m12:58:50.564238 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:58:50.564970 [info ] [MainThread]: 
[0m12:58:50.565972 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:58:50.567635 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9620525, "process_in_blocks": "0", "process_kernel_time": 0.674997, "process_mem_max_rss": "108224", "process_out_blocks": "3400", "process_user_time": 4.069952}
[0m12:58:50.568590 [debug] [MainThread]: Command `dbt run` succeeded at 12:58:50.568430 after 1.96 seconds
[0m12:58:50.569114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc59478590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc59499070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edc59498710>]}
[0m12:58:50.569704 [debug] [MainThread]: Flushing usage events
[0m12:58:52.062216 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:59:48.518487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c56288fe8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5628599550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5628598320>]}


============================== 12:59:48.528752 | bb734690-0dba-4f68-93a3-cc4f72c624e6 ==============================
[0m12:59:48.528752 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:59:48.529744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:59:48.955471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb734690-0dba-4f68-93a3-cc4f72c624e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c56285098e0>]}
[0m12:59:49.097693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb734690-0dba-4f68-93a3-cc4f72c624e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5629173ec0>]}
[0m12:59:49.099269 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:59:49.369478 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:59:49.617496 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:59:49.619365 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:59:49.701496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb734690-0dba-4f68-93a3-cc4f72c624e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5626cf0ad0>]}
[0m12:59:49.870850 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:59:49.874940 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:59:49.925848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb734690-0dba-4f68-93a3-cc4f72c624e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c56269d2cf0>]}
[0m12:59:49.926578 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:59:49.927401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb734690-0dba-4f68-93a3-cc4f72c624e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c56269f0c80>]}
[0m12:59:49.932013 [info ] [MainThread]: 
[0m12:59:49.933005 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:59:49.933864 [info ] [MainThread]: 
[0m12:59:49.935214 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:59:49.943120 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:59:50.033701 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:59:50.034257 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:59:50.034758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:50.052463 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.018 seconds
[0m12:59:50.054814 [debug] [ThreadPool]: On list_db: Close
[0m12:59:50.059756 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:59:50.068937 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:59:50.069461 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:59:50.069859 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:59:50.085180 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m12:59:50.086264 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:59:50.086909 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:59:50.091627 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m12:59:50.093966 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:59:50.095134 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:59:50.107534 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:50.108298 [debug] [MainThread]: On master: BEGIN
[0m12:59:50.108800 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:59:50.130084 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m12:59:50.131675 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:50.132481 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:59:50.137509 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m12:59:50.139798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb734690-0dba-4f68-93a3-cc4f72c624e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5626d3d850>]}
[0m12:59:50.140627 [debug] [MainThread]: On master: ROLLBACK
[0m12:59:50.141428 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:50.141896 [debug] [MainThread]: On master: BEGIN
[0m12:59:50.143218 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:59:50.143780 [debug] [MainThread]: On master: COMMIT
[0m12:59:50.144468 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:50.144917 [debug] [MainThread]: On master: COMMIT
[0m12:59:50.146628 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:59:50.148307 [debug] [MainThread]: On master: Close
[0m12:59:50.155869 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m12:59:50.156703 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m12:59:50.157439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m12:59:50.158172 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m12:59:50.170101 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m12:59:50.171255 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m12:59:50.246169 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m12:59:50.248093 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:59:50.248905 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m12:59:50.249541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:50.265218 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m12:59:50.265834 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:59:50.266326 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m12:59:50.270834 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m12:59:50.281960 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:59:50.282926 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m12:59:50.284247 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:59:50.288957 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:59:50.289526 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m12:59:50.290497 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:59:50.323215 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:59:50.323946 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:59:50.324429 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m12:59:50.339742 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m12:59:50.351397 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m12:59:50.368923 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m12:59:50.370097 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m12:59:50.381503 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.009 seconds
[0m12:59:50.391607 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m12:59:50.398981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb734690-0dba-4f68-93a3-cc4f72c624e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c562905e930>]}
[0m12:59:50.401473 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.24s]
[0m12:59:50.405802 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m12:59:50.409130 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:59:50.414325 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:59:50.411419 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:59:50.420645 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:59:50.423427 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:59:50.425401 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:59:50.427537 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:59:50.430136 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:59:50.438848 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:59:50.450668 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:59:50.453910 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:59:50.455219 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:59:50.467684 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:59:50.480289 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:59:50.489907 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:59:50.492571 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:59:50.495335 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:59:50.499845 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:59:50.502827 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:59:50.504655 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:59:50.525162 [debug] [Thread-3 (]: SQL status: BEGIN in 0.030 seconds
[0m12:59:50.527501 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:59:50.530081 [debug] [Thread-4 (]: SQL status: BEGIN in 0.025 seconds
[0m12:59:50.532359 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m12:59:50.535327 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:59:50.537178 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m12:59:50.542902 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m12:59:50.543963 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m12:59:50.555221 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:59:50.566069 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:59:50.567110 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:59:50.568059 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:59:50.569572 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:59:50.570411 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:59:50.576684 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:59:50.585637 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:59:50.588389 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:59:50.590074 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:59:50.592258 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:59:50.593288 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:59:50.597816 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:59:50.601527 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:59:50.602537 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:59:50.603512 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:59:50.604443 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:59:50.605228 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:59:50.610740 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m12:59:50.617005 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:59:50.618462 [debug] [Thread-4 (]: SQL status: COMMIT in 0.012 seconds
[0m12:59:50.620151 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:59:50.624658 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:59:50.625978 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:59:50.628142 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:59:50.629787 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:59:50.636463 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.007 seconds
[0m12:59:50.639305 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:59:50.640193 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.010 seconds
[0m12:59:50.643690 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:59:50.645758 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb734690-0dba-4f68-93a3-cc4f72c624e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c562429f8c0>]}
[0m12:59:50.649242 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb734690-0dba-4f68-93a3-cc4f72c624e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c56242db140>]}
[0m12:59:50.651910 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.22s]
[0m12:59:50.659551 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.22s]
[0m12:59:50.662908 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:59:50.668233 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:59:50.676021 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:50.676577 [debug] [MainThread]: On master: BEGIN
[0m12:59:50.677139 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:59:50.696913 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m12:59:50.697886 [debug] [MainThread]: On master: COMMIT
[0m12:59:50.698432 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:50.698884 [debug] [MainThread]: On master: COMMIT
[0m12:59:50.699730 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:59:50.700247 [debug] [MainThread]: On master: Close
[0m12:59:50.701047 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:59:50.701810 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m12:59:50.702263 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:59:50.702817 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:59:50.703725 [info ] [MainThread]: 
[0m12:59:50.704703 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m12:59:50.707787 [debug] [MainThread]: Command end result
[0m12:59:50.753677 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:59:50.756333 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:59:50.773539 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:59:50.774352 [info ] [MainThread]: 
[0m12:59:50.775302 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:59:50.776159 [info ] [MainThread]: 
[0m12:59:50.777102 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:59:50.779812 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3799808, "process_in_blocks": "0", "process_kernel_time": 0.674139, "process_mem_max_rss": "108216", "process_out_blocks": "3400", "process_user_time": 4.177257}
[0m12:59:50.781291 [debug] [MainThread]: Command `dbt run` succeeded at 12:59:50.780965 after 2.38 seconds
[0m12:59:50.782281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5628599070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c562907c7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c562907d1f0>]}
[0m12:59:50.783961 [debug] [MainThread]: Flushing usage events
[0m12:59:52.286239 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:00:48.861469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7147484170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71469b2f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7146f829c0>]}


============================== 13:00:48.877251 | 0c1cb5a9-955a-47fd-afa2-6eedc5ce57f8 ==============================
[0m13:00:48.877251 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:00:48.878895 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:00:49.432266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c1cb5a9-955a-47fd-afa2-6eedc5ce57f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71469b2f90>]}
[0m13:00:49.574852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c1cb5a9-955a-47fd-afa2-6eedc5ce57f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7144eaa7b0>]}
[0m13:00:49.576603 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:00:49.760534 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:00:50.011867 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:00:50.012601 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:00:50.100311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c1cb5a9-955a-47fd-afa2-6eedc5ce57f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71467319a0>]}
[0m13:00:50.322168 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:00:50.327934 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:00:50.397162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c1cb5a9-955a-47fd-afa2-6eedc5ce57f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7144c2b290>]}
[0m13:00:50.398254 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m13:00:50.399290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c1cb5a9-955a-47fd-afa2-6eedc5ce57f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7146ecade0>]}
[0m13:00:50.415664 [info ] [MainThread]: 
[0m13:00:50.426195 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:00:50.427245 [info ] [MainThread]: 
[0m13:00:50.428709 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:00:50.462350 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m13:00:50.656784 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m13:00:50.657420 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m13:00:50.657874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:50.681322 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.023 seconds
[0m13:00:50.683830 [debug] [ThreadPool]: On list_db: Close
[0m13:00:50.690432 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m13:00:50.705883 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:00:50.707048 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m13:00:50.707915 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:00:50.725588 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m13:00:50.726641 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:00:50.727424 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:00:50.732361 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m13:00:50.737451 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m13:00:50.738886 [debug] [ThreadPool]: On list_db_dev: Close
[0m13:00:50.751977 [debug] [MainThread]: Using postgres connection "master"
[0m13:00:50.752880 [debug] [MainThread]: On master: BEGIN
[0m13:00:50.754075 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:00:50.768988 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m13:00:50.770918 [debug] [MainThread]: Using postgres connection "master"
[0m13:00:50.773131 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:00:50.784717 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m13:00:50.788179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c1cb5a9-955a-47fd-afa2-6eedc5ce57f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7146733680>]}
[0m13:00:50.789212 [debug] [MainThread]: On master: ROLLBACK
[0m13:00:50.790116 [debug] [MainThread]: Using postgres connection "master"
[0m13:00:50.790732 [debug] [MainThread]: On master: BEGIN
[0m13:00:50.791816 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:00:50.792935 [debug] [MainThread]: On master: COMMIT
[0m13:00:50.794148 [debug] [MainThread]: Using postgres connection "master"
[0m13:00:50.795757 [debug] [MainThread]: On master: COMMIT
[0m13:00:50.797170 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:00:50.798028 [debug] [MainThread]: On master: Close
[0m13:00:50.809933 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m13:00:50.812394 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m13:00:50.814457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m13:00:50.815529 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m13:00:50.831630 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m13:00:50.832662 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m13:00:50.918494 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m13:00:50.920671 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m13:00:50.922064 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m13:00:50.923239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:00:50.939729 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:00:50.941742 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m13:00:50.943178 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m13:00:50.948225 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:00:50.962924 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m13:00:50.963674 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m13:00:50.964843 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:00:50.971855 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m13:00:50.973146 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m13:00:50.975642 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:00:51.028984 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m13:00:51.029703 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m13:00:51.030263 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m13:00:51.068138 [debug] [Thread-1 (]: SQL status: COMMIT in 0.037 seconds
[0m13:00:51.089222 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m13:00:51.105543 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m13:00:51.107890 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m13:00:51.116101 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m13:00:51.124593 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m13:00:51.128559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c1cb5a9-955a-47fd-afa2-6eedc5ce57f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71472b6990>]}
[0m13:00:51.129898 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.31s]
[0m13:00:51.131937 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m13:00:51.134772 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m13:00:51.137019 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m13:00:51.139386 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m13:00:51.142962 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m13:00:51.145180 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m13:00:51.146608 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m13:00:51.147570 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m13:00:51.148486 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m13:00:51.157437 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m13:00:51.162564 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m13:00:51.164239 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m13:00:51.164862 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m13:00:51.185956 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m13:00:51.192154 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m13:00:51.194655 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:00:51.195607 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m13:00:51.196237 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:00:51.196868 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:00:51.197560 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m13:00:51.198581 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:00:51.218632 [debug] [Thread-4 (]: SQL status: BEGIN in 0.021 seconds
[0m13:00:51.220518 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:00:51.222843 [debug] [Thread-3 (]: SQL status: BEGIN in 0.023 seconds
[0m13:00:51.224156 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m13:00:51.224915 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:00:51.226021 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m13:00:51.229982 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:00:51.237071 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.009 seconds
[0m13:00:51.238734 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:00:51.248316 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:00:51.249409 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m13:00:51.250223 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m13:00:51.252730 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:00:51.254242 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:00:51.260199 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:00:51.267466 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:00:51.270101 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m13:00:51.275085 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m13:00:51.280801 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:00:51.289083 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m13:00:51.290447 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m13:00:51.294168 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m13:00:51.295195 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:00:51.296063 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:00:51.296717 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m13:00:51.297361 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m13:00:51.422377 [debug] [Thread-4 (]: SQL status: COMMIT in 0.124 seconds
[0m13:00:51.426986 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m13:00:51.427945 [debug] [Thread-3 (]: SQL status: COMMIT in 0.130 seconds
[0m13:00:51.429306 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:00:51.436557 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m13:00:51.437695 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m13:00:51.439468 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:00:51.440556 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m13:00:51.448782 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.008 seconds
[0m13:00:51.452871 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m13:00:51.454701 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.013 seconds
[0m13:00:51.457140 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c1cb5a9-955a-47fd-afa2-6eedc5ce57f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f713cc27ef0>]}
[0m13:00:51.459833 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m13:00:51.461147 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.31s]
[0m13:00:51.463258 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m13:00:51.464238 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c1cb5a9-955a-47fd-afa2-6eedc5ce57f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7144a99f70>]}
[0m13:00:51.466049 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.32s]
[0m13:00:51.467918 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m13:00:51.473835 [debug] [MainThread]: Using postgres connection "master"
[0m13:00:51.474606 [debug] [MainThread]: On master: BEGIN
[0m13:00:51.475091 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:00:51.527798 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m13:00:51.528974 [debug] [MainThread]: On master: COMMIT
[0m13:00:51.529711 [debug] [MainThread]: Using postgres connection "master"
[0m13:00:51.530462 [debug] [MainThread]: On master: COMMIT
[0m13:00:51.531341 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:00:51.531892 [debug] [MainThread]: On master: Close
[0m13:00:51.532722 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:00:51.533242 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m13:00:51.533907 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m13:00:51.534399 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m13:00:51.539290 [info ] [MainThread]: 
[0m13:00:51.543657 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.11 seconds (1.11s).
[0m13:00:51.549898 [debug] [MainThread]: Command end result
[0m13:00:51.616826 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:00:51.620589 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:00:51.644766 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:00:51.645667 [info ] [MainThread]: 
[0m13:00:51.646521 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:00:51.647440 [info ] [MainThread]: 
[0m13:00:51.648668 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:00:51.652093 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.960794, "process_in_blocks": "0", "process_kernel_time": 0.688694, "process_mem_max_rss": "108140", "process_out_blocks": "3400", "process_user_time": 5.038347}
[0m13:00:51.654202 [debug] [MainThread]: Command `dbt run` succeeded at 13:00:51.653801 after 2.96 seconds
[0m13:00:51.656750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7146a6f350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7146f829c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71469ec560>]}
[0m13:00:51.658429 [debug] [MainThread]: Flushing usage events
[0m13:00:53.265894 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:01:48.907033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7702e35426c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7702e3802810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7702e3803cb0>]}


============================== 13:01:48.916358 | aa363afc-fef6-4be3-b1cc-06d54da0dc97 ==============================
[0m13:01:48.916358 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:01:48.917162 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:01:49.423373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa363afc-fef6-4be3-b1cc-06d54da0dc97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7702e32032c0>]}
[0m13:01:49.527147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa363afc-fef6-4be3-b1cc-06d54da0dc97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7702e3b7b320>]}
[0m13:01:49.529256 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:01:49.726043 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:01:49.909004 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:01:49.909718 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:01:49.996888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa363afc-fef6-4be3-b1cc-06d54da0dc97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7702e32e7b00>]}
[0m13:01:50.222518 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:01:50.227710 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:01:50.269656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa363afc-fef6-4be3-b1cc-06d54da0dc97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7702e16d8b60>]}
[0m13:01:50.270411 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m13:01:50.271024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa363afc-fef6-4be3-b1cc-06d54da0dc97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7702e3de54f0>]}
[0m13:01:50.273988 [info ] [MainThread]: 
[0m13:01:50.274682 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:01:50.275443 [info ] [MainThread]: 
[0m13:01:50.278953 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:01:50.289042 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m13:01:50.372877 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m13:01:50.373437 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m13:01:50.373895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:50.395560 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.022 seconds
[0m13:01:50.398136 [debug] [ThreadPool]: On list_db: Close
[0m13:01:50.400715 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m13:01:50.409340 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:01:50.412597 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m13:01:50.413189 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:50.430860 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m13:01:50.431822 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:01:50.432335 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:01:50.436679 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m13:01:50.438869 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m13:01:50.439935 [debug] [ThreadPool]: On list_db_dev: Close
[0m13:01:50.453585 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:50.454578 [debug] [MainThread]: On master: BEGIN
[0m13:01:50.455084 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:01:50.469127 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m13:01:50.469698 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:50.470433 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:01:50.479353 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m13:01:50.482381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa363afc-fef6-4be3-b1cc-06d54da0dc97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7702e095d7f0>]}
[0m13:01:50.484466 [debug] [MainThread]: On master: ROLLBACK
[0m13:01:50.486052 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:50.488245 [debug] [MainThread]: On master: BEGIN
[0m13:01:50.490478 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:01:50.491462 [debug] [MainThread]: On master: COMMIT
[0m13:01:50.492353 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:50.492962 [debug] [MainThread]: On master: COMMIT
[0m13:01:50.494030 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:01:50.495701 [debug] [MainThread]: On master: Close
[0m13:01:50.500676 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m13:01:50.501637 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m13:01:50.503022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m13:01:50.503845 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m13:01:50.521849 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m13:01:50.523295 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m13:01:50.588575 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m13:01:50.589655 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m13:01:50.590143 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m13:01:50.590785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:50.604725 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m13:01:50.605538 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m13:01:50.606129 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m13:01:50.613023 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m13:01:50.627539 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m13:01:50.628331 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m13:01:50.630074 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:01:50.634786 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m13:01:50.635328 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m13:01:50.636664 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:01:50.705637 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m13:01:50.707232 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m13:01:50.708392 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m13:01:50.718460 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m13:01:50.745736 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m13:01:50.761907 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m13:01:50.762824 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m13:01:50.770811 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m13:01:50.776235 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m13:01:50.779739 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa363afc-fef6-4be3-b1cc-06d54da0dc97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7702e3d3a8a0>]}
[0m13:01:50.781072 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.27s]
[0m13:01:50.782672 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m13:01:50.786276 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m13:01:50.787411 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m13:01:50.788666 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m13:01:50.790067 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m13:01:50.792044 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m13:01:50.793472 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m13:01:50.794486 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m13:01:50.795420 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m13:01:50.801757 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m13:01:50.808189 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m13:01:50.810022 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m13:01:50.816520 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m13:01:50.818879 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m13:01:50.832205 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m13:01:50.835555 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:01:50.836796 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:01:50.837708 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m13:01:50.839124 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m13:01:50.840129 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:01:50.841174 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:01:50.861943 [debug] [Thread-4 (]: SQL status: BEGIN in 0.021 seconds
[0m13:01:50.863209 [debug] [Thread-3 (]: SQL status: BEGIN in 0.022 seconds
[0m13:01:50.864244 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:01:50.865167 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:01:50.866154 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m13:01:50.867221 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m13:01:50.873899 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m13:01:50.875478 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m13:01:50.882090 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:01:50.887763 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:01:50.890592 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m13:01:50.892412 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m13:01:50.894650 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:01:50.895688 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:01:50.903713 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:01:50.910486 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:01:50.911473 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m13:01:50.912443 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m13:01:50.914376 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:01:50.915188 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:01:50.918698 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m13:01:50.921816 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m13:01:50.922702 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:01:50.923843 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:01:50.926072 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m13:01:50.927648 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m13:01:51.156518 [debug] [Thread-4 (]: SQL status: COMMIT in 0.227 seconds
[0m13:01:51.164499 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m13:01:51.165934 [debug] [Thread-3 (]: SQL status: COMMIT in 0.237 seconds
[0m13:01:51.168282 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:01:51.181504 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m13:01:51.183107 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m13:01:51.187621 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:01:51.189911 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m13:01:51.197429 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.008 seconds
[0m13:01:51.201700 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m13:01:51.203282 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.012 seconds
[0m13:01:51.209039 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa363afc-fef6-4be3-b1cc-06d54da0dc97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7702e0875250>]}
[0m13:01:51.215714 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m13:01:51.217981 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.41s]
[0m13:01:51.221571 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa363afc-fef6-4be3-b1cc-06d54da0dc97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7702d9743fb0>]}
[0m13:01:51.225537 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m13:01:51.228482 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.43s]
[0m13:01:51.232357 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m13:01:51.238386 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:51.240959 [debug] [MainThread]: On master: BEGIN
[0m13:01:51.242160 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:01:51.269850 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m13:01:51.272192 [debug] [MainThread]: On master: COMMIT
[0m13:01:51.273175 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:51.274749 [debug] [MainThread]: On master: COMMIT
[0m13:01:51.277689 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:01:51.279679 [debug] [MainThread]: On master: Close
[0m13:01:51.282857 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:51.284726 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m13:01:51.286812 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m13:01:51.288741 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m13:01:51.290503 [info ] [MainThread]: 
[0m13:01:51.292123 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.01 seconds (1.01s).
[0m13:01:51.297271 [debug] [MainThread]: Command end result
[0m13:01:51.373670 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:01:51.377316 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:01:51.395639 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:01:51.396332 [info ] [MainThread]: 
[0m13:01:51.397087 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:01:51.398304 [info ] [MainThread]: 
[0m13:01:51.399564 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:01:51.401657 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5953252, "process_in_blocks": "0", "process_kernel_time": 0.762812, "process_mem_max_rss": "108520", "process_out_blocks": "3400", "process_user_time": 4.445078}
[0m13:01:51.402644 [debug] [MainThread]: Command `dbt run` succeeded at 13:01:51.402441 after 2.60 seconds
[0m13:01:51.403277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7702e32742f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7702e3274290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7702e31e1b20>]}
[0m13:01:51.403945 [debug] [MainThread]: Flushing usage events
[0m13:01:52.965037 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:03:55.335058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c83a26321b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c83a1b0d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c83a14038c0>]}


============================== 13:03:55.354629 | 7c4b8447-d206-4f69-8049-5230180026fa ==============================
[0m13:03:55.354629 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:03:55.356343 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:03:56.125327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c4b8447-d206-4f69-8049-5230180026fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c83a07692e0>]}
[0m13:03:56.253478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c4b8447-d206-4f69-8049-5230180026fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c83a1b0d730>]}
[0m13:03:56.254651 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:03:56.435437 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:03:56.824118 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:03:56.824791 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:03:56.873574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c4b8447-d206-4f69-8049-5230180026fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c839ef94e90>]}
[0m13:03:56.989502 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:03:56.994779 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:03:57.046857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c4b8447-d206-4f69-8049-5230180026fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c839ec3f620>]}
[0m13:03:57.047599 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m13:03:57.048250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c4b8447-d206-4f69-8049-5230180026fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c83a1b14620>]}
[0m13:03:57.051532 [info ] [MainThread]: 
[0m13:03:57.052407 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:03:57.053299 [info ] [MainThread]: 
[0m13:03:57.054492 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:03:57.064607 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m13:03:57.236608 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m13:03:57.237787 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m13:03:57.238546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:03:57.260944 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.022 seconds
[0m13:03:57.263435 [debug] [ThreadPool]: On list_db: Close
[0m13:03:57.266272 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m13:03:57.275727 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:03:57.276347 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m13:03:57.276849 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:03:57.290466 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m13:03:57.291604 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:03:57.292295 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:03:57.300331 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m13:03:57.303838 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m13:03:57.305244 [debug] [ThreadPool]: On list_db_dev: Close
[0m13:03:57.313043 [debug] [MainThread]: Using postgres connection "master"
[0m13:03:57.313649 [debug] [MainThread]: On master: BEGIN
[0m13:03:57.314164 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:03:57.338197 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m13:03:57.339003 [debug] [MainThread]: Using postgres connection "master"
[0m13:03:57.339676 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:03:57.344845 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m13:03:57.348442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c4b8447-d206-4f69-8049-5230180026fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c839ec22e40>]}
[0m13:03:57.349669 [debug] [MainThread]: On master: ROLLBACK
[0m13:03:57.351003 [debug] [MainThread]: Using postgres connection "master"
[0m13:03:57.352081 [debug] [MainThread]: On master: BEGIN
[0m13:03:57.353964 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:03:57.354946 [debug] [MainThread]: On master: COMMIT
[0m13:03:57.355709 [debug] [MainThread]: Using postgres connection "master"
[0m13:03:57.356349 [debug] [MainThread]: On master: COMMIT
[0m13:03:57.357393 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:03:57.358056 [debug] [MainThread]: On master: Close
[0m13:03:57.364726 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m13:03:57.367379 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m13:03:57.368928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m13:03:57.369898 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m13:03:57.382917 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m13:03:57.384937 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m13:03:57.450551 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m13:03:57.451489 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m13:03:57.452133 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m13:03:57.452641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:03:57.468051 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m13:03:57.469128 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m13:03:57.469915 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m13:03:57.484441 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.014 seconds
[0m13:03:57.491916 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m13:03:57.492431 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m13:03:57.493879 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:03:57.500187 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m13:03:57.501003 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m13:03:57.502211 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:03:57.533362 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m13:03:57.533949 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m13:03:57.534492 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m13:03:57.539239 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m13:03:57.551225 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m13:03:57.560335 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m13:03:57.560952 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m13:03:57.567080 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m13:03:57.570281 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m13:03:57.572436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c4b8447-d206-4f69-8049-5230180026fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c83a12c27e0>]}
[0m13:03:57.573634 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.20s]
[0m13:03:57.574831 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m13:03:57.577080 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m13:03:57.577977 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m13:03:57.578747 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m13:03:57.579794 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m13:03:57.580637 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m13:03:57.581557 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m13:03:57.582560 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m13:03:57.586846 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m13:03:57.587562 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m13:03:57.592056 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m13:03:57.593123 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m13:03:57.597440 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m13:03:57.598650 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m13:03:57.599466 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:03:57.603269 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m13:03:57.603990 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m13:03:57.605088 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:03:57.606049 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:03:57.606652 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m13:03:57.607127 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:03:57.627645 [debug] [Thread-3 (]: SQL status: BEGIN in 0.022 seconds
[0m13:03:57.628597 [debug] [Thread-4 (]: SQL status: BEGIN in 0.021 seconds
[0m13:03:57.629606 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:03:57.630461 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:03:57.631293 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m13:03:57.632310 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m13:03:57.637885 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:03:57.644546 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:03:57.645421 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.012 seconds
[0m13:03:57.646102 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m13:03:57.650046 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:03:57.650894 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m13:03:57.651461 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:03:57.655713 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:03:57.656518 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m13:03:57.657353 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m13:03:57.662300 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:03:57.663299 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m13:03:57.664086 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:03:57.666651 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m13:03:57.667390 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:03:57.667981 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:03:57.670212 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m13:03:57.670933 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m13:03:57.671617 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:03:57.672936 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m13:03:57.735754 [debug] [Thread-4 (]: SQL status: COMMIT in 0.063 seconds
[0m13:03:57.739118 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m13:03:57.739863 [debug] [Thread-3 (]: SQL status: COMMIT in 0.066 seconds
[0m13:03:57.741058 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:03:57.747923 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m13:03:57.748834 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m13:03:57.749840 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:03:57.750797 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m13:03:57.756916 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m13:03:57.758943 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m13:03:57.759896 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c4b8447-d206-4f69-8049-5230180026fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c839c510c20>]}
[0m13:03:57.761626 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.010 seconds
[0m13:03:57.760878 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.18s]
[0m13:03:57.763901 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m13:03:57.764996 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m13:03:57.766356 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c4b8447-d206-4f69-8049-5230180026fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c839c4d9ee0>]}
[0m13:03:57.767401 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.19s]
[0m13:03:57.768762 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m13:03:57.772587 [debug] [MainThread]: Using postgres connection "master"
[0m13:03:57.773437 [debug] [MainThread]: On master: BEGIN
[0m13:03:57.774082 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:03:57.793849 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m13:03:57.794842 [debug] [MainThread]: On master: COMMIT
[0m13:03:57.796054 [debug] [MainThread]: Using postgres connection "master"
[0m13:03:57.796783 [debug] [MainThread]: On master: COMMIT
[0m13:03:57.797602 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:03:57.798085 [debug] [MainThread]: On master: Close
[0m13:03:57.798871 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:03:57.799430 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m13:03:57.800041 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m13:03:57.800562 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m13:03:57.801377 [info ] [MainThread]: 
[0m13:03:57.802194 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m13:03:57.805461 [debug] [MainThread]: Command end result
[0m13:03:57.850100 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:03:57.852641 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:03:57.867854 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:03:57.868993 [info ] [MainThread]: 
[0m13:03:57.870212 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:03:57.871351 [info ] [MainThread]: 
[0m13:03:57.872680 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:03:57.875365 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.6527662, "process_in_blocks": "904", "process_kernel_time": 1.089938, "process_mem_max_rss": "108268", "process_out_blocks": "3408", "process_user_time": 4.147194}
[0m13:03:57.876467 [debug] [MainThread]: Command `dbt run` succeeded at 13:03:57.876226 after 2.65 seconds
[0m13:03:57.877443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c83a0a7b710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c83a0cd0b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c839ed80800>]}
[0m13:03:57.878439 [debug] [MainThread]: Flushing usage events
[0m13:03:58.667976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7684efd45940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7684f0379520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7684f2a350d0>]}


============================== 13:03:58.680070 | db0803e0-b991-4fd3-8c33-65e991a8498a ==============================
[0m13:03:58.680070 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:03:58.681486 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:03:59.171877 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:03:59.289875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db0803e0-b991-4fd3-8c33-65e991a8498a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7684ef6de240>]}
[0m13:03:59.459205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db0803e0-b991-4fd3-8c33-65e991a8498a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7684efc24f20>]}
[0m13:03:59.460927 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:03:59.662371 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:03:59.811163 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:03:59.812590 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:03:59.874895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db0803e0-b991-4fd3-8c33-65e991a8498a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7684edfac050>]}
[0m13:04:00.013405 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:04:00.017335 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:04:00.129229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db0803e0-b991-4fd3-8c33-65e991a8498a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7684edcf1100>]}
[0m13:04:00.130805 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m13:04:00.132076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db0803e0-b991-4fd3-8c33-65e991a8498a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7684edd6e870>]}
[0m13:04:00.139761 [info ] [MainThread]: 
[0m13:04:00.141027 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:04:00.142043 [info ] [MainThread]: 
[0m13:04:00.143561 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:04:00.159624 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m13:04:00.284780 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m13:04:00.285686 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m13:04:00.286278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:04:00.309006 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.023 seconds
[0m13:04:00.312243 [debug] [ThreadPool]: On list_db: Close
[0m13:04:00.315685 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m13:04:00.326362 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:04:00.326974 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m13:04:00.327468 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:04:00.339845 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m13:04:00.340844 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:04:00.341327 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:04:00.345481 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m13:04:00.347479 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m13:04:00.348389 [debug] [ThreadPool]: On list_db_dev: Close
[0m13:04:00.357035 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:00.357561 [debug] [MainThread]: On master: BEGIN
[0m13:04:00.357984 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:04:00.372146 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m13:04:00.372859 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:00.373510 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:04:00.378228 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m13:04:00.380499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db0803e0-b991-4fd3-8c33-65e991a8498a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7684edc43380>]}
[0m13:04:00.381669 [debug] [MainThread]: On master: ROLLBACK
[0m13:04:00.382533 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:00.383016 [debug] [MainThread]: On master: BEGIN
[0m13:04:00.383807 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:04:00.384506 [debug] [MainThread]: On master: COMMIT
[0m13:04:00.385232 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:00.385714 [debug] [MainThread]: On master: COMMIT
[0m13:04:00.386413 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:04:00.386911 [debug] [MainThread]: On master: Close
[0m13:04:00.391375 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m13:04:00.392306 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m13:04:00.393169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m13:04:00.393707 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m13:04:00.404793 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m13:04:00.405704 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m13:04:00.458975 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m13:04:00.459879 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m13:04:00.460362 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m13:04:00.460907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:04:00.471891 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m13:04:00.472613 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m13:04:00.473141 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m13:04:00.477014 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:04:00.485674 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m13:04:00.486221 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m13:04:00.487181 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:04:00.490533 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m13:04:00.490963 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m13:04:00.491771 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:04:00.515989 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m13:04:00.516546 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m13:04:00.517135 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m13:04:00.522870 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m13:04:00.531253 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m13:04:00.541705 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m13:04:00.542255 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m13:04:00.549226 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m13:04:00.552518 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m13:04:00.554556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db0803e0-b991-4fd3-8c33-65e991a8498a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7684f02f6060>]}
[0m13:04:00.555348 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.16s]
[0m13:04:00.556392 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m13:04:00.557919 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m13:04:00.558480 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m13:04:00.559081 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m13:04:00.560102 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m13:04:00.561255 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m13:04:00.562070 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m13:04:00.562667 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m13:04:00.563282 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m13:04:00.566608 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m13:04:00.569878 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m13:04:00.571143 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m13:04:00.574667 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m13:04:00.575166 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m13:04:00.578654 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m13:04:00.579903 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:04:00.580688 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:04:00.581478 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m13:04:00.582220 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m13:04:00.582884 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:04:00.583507 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:04:00.595501 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m13:04:00.596575 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m13:04:00.597632 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:04:00.598301 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:04:00.598958 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m13:04:00.599629 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m13:04:00.603239 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:04:00.604072 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:04:00.609479 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:04:00.614106 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:04:00.614933 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m13:04:00.615665 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m13:04:00.617355 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:04:00.617954 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:04:00.621370 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:04:00.624415 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:04:00.625159 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m13:04:00.625724 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m13:04:00.626867 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:04:00.627326 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:04:00.630086 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m13:04:00.632287 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m13:04:00.633302 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:04:00.634026 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:04:00.634692 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m13:04:00.635435 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m13:04:00.645452 [debug] [Thread-3 (]: SQL status: COMMIT in 0.009 seconds
[0m13:04:00.648923 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m13:04:00.649685 [debug] [Thread-4 (]: SQL status: COMMIT in 0.013 seconds
[0m13:04:00.650614 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:04:00.653620 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m13:04:00.654505 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m13:04:00.655542 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:04:00.656338 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m13:04:00.662254 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m13:04:00.664145 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m13:04:00.666039 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db0803e0-b991-4fd3-8c33-65e991a8498a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7684ec51bfe0>]}
[0m13:04:00.667161 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.010 seconds
[0m13:04:00.668520 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.10s]
[0m13:04:00.671583 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m13:04:00.672910 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m13:04:00.674343 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db0803e0-b991-4fd3-8c33-65e991a8498a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7684ecee4d40>]}
[0m13:04:00.675790 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.11s]
[0m13:04:00.677237 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m13:04:00.681284 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:00.681783 [debug] [MainThread]: On master: BEGIN
[0m13:04:00.682195 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:04:00.693117 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m13:04:00.694036 [debug] [MainThread]: On master: COMMIT
[0m13:04:00.694824 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:00.695330 [debug] [MainThread]: On master: COMMIT
[0m13:04:00.696155 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:04:00.696558 [debug] [MainThread]: On master: Close
[0m13:04:00.697415 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:04:00.697786 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m13:04:00.698212 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m13:04:00.698633 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m13:04:00.699232 [info ] [MainThread]: 
[0m13:04:00.699803 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m13:04:00.702187 [debug] [MainThread]: Command end result
[0m13:04:00.736581 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:04:00.738950 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:04:00.747143 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:04:00.747642 [info ] [MainThread]: 
[0m13:04:00.748439 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:04:00.749417 [info ] [MainThread]: 
[0m13:04:00.750276 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:04:00.752034 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1598704, "process_in_blocks": "64", "process_kernel_time": 1.43792, "process_mem_max_rss": "108280", "process_out_blocks": "3392", "process_user_time": 4.387625}
[0m13:04:00.752665 [debug] [MainThread]: Command `dbt run` succeeded at 13:04:00.752527 after 2.16 seconds
[0m13:04:00.753175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7684efec6570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7684efda6900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7684edae7a10>]}
[0m13:04:00.753637 [debug] [MainThread]: Flushing usage events
[0m13:04:02.048780 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:04:05.446847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72250aff0350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72250c9dc140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72250b54ab40>]}


============================== 13:04:05.454373 | 4a6588e8-be3e-4825-9619-d434e01bf1eb ==============================
[0m13:04:05.454373 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:04:05.455247 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:04:05.703258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a6588e8-be3e-4825-9619-d434e01bf1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72250c94f230>]}
[0m13:04:05.778524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a6588e8-be3e-4825-9619-d434e01bf1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72250cb84b30>]}
[0m13:04:05.779878 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:04:05.894763 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:04:06.034461 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:04:06.035128 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:04:06.081376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a6588e8-be3e-4825-9619-d434e01bf1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7225091fcd10>]}
[0m13:04:06.185068 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:04:06.188291 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:04:06.221147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a6588e8-be3e-4825-9619-d434e01bf1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72250a984fb0>]}
[0m13:04:06.221840 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m13:04:06.222366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a6588e8-be3e-4825-9619-d434e01bf1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722508ebdcd0>]}
[0m13:04:06.224956 [info ] [MainThread]: 
[0m13:04:06.225616 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:04:06.226406 [info ] [MainThread]: 
[0m13:04:06.227271 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:04:06.233152 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m13:04:06.325475 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m13:04:06.326018 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m13:04:06.326542 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:04:06.339958 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m13:04:06.341743 [debug] [ThreadPool]: On list_db: Close
[0m13:04:06.344826 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m13:04:06.351846 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:04:06.352333 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m13:04:06.352678 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:04:06.364870 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m13:04:06.365681 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:04:06.366159 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:04:06.370351 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m13:04:06.372331 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m13:04:06.373755 [debug] [ThreadPool]: On list_db_dev: Close
[0m13:04:06.382522 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:06.383067 [debug] [MainThread]: On master: BEGIN
[0m13:04:06.383436 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:04:06.396752 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m13:04:06.397727 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:06.398606 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:04:06.404178 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m13:04:06.407238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a6588e8-be3e-4825-9619-d434e01bf1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72250a9f6540>]}
[0m13:04:06.408436 [debug] [MainThread]: On master: ROLLBACK
[0m13:04:06.410114 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:06.410939 [debug] [MainThread]: On master: BEGIN
[0m13:04:06.412221 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:04:06.412793 [debug] [MainThread]: On master: COMMIT
[0m13:04:06.413463 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:06.414179 [debug] [MainThread]: On master: COMMIT
[0m13:04:06.415011 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:04:06.415661 [debug] [MainThread]: On master: Close
[0m13:04:06.421746 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m13:04:06.423151 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m13:04:06.424489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m13:04:06.426064 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m13:04:06.439502 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m13:04:06.440786 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m13:04:06.495023 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m13:04:06.495877 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m13:04:06.496348 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m13:04:06.497067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:04:06.507844 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m13:04:06.508795 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m13:04:06.509505 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m13:04:06.513253 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:04:06.522718 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m13:04:06.523256 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m13:04:06.524242 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:04:06.528391 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m13:04:06.529029 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m13:04:06.530134 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:04:06.553919 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m13:04:06.554447 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m13:04:06.554895 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m13:04:06.560224 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m13:04:06.568219 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m13:04:06.578425 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m13:04:06.578944 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m13:04:06.585488 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m13:04:06.588249 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m13:04:06.590945 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a6588e8-be3e-4825-9619-d434e01bf1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72250b52a120>]}
[0m13:04:06.591884 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.16s]
[0m13:04:06.593217 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m13:04:06.595028 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m13:04:06.595692 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m13:04:06.596287 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m13:04:06.597408 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m13:04:06.598973 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m13:04:06.599747 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m13:04:06.600641 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m13:04:06.601411 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m13:04:06.604960 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m13:04:06.607935 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m13:04:06.609065 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m13:04:06.612595 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m13:04:06.613388 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m13:04:06.617117 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m13:04:06.617679 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:04:06.618328 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m13:04:06.618861 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:04:06.619869 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:04:06.620530 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m13:04:06.621022 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:04:06.630757 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m13:04:06.631843 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:04:06.632614 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m13:04:06.633791 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m13:04:06.634762 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:04:06.635298 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m13:04:06.638729 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:04:06.639612 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:04:06.645185 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:04:06.648571 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:04:06.649406 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m13:04:06.650036 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m13:04:06.651612 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:04:06.652107 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:04:06.655530 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:04:06.659174 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:04:06.659969 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m13:04:06.660784 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m13:04:06.662510 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:04:06.663203 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:04:06.666270 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m13:04:06.668622 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m13:04:06.669560 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:04:06.670301 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:04:06.671049 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m13:04:06.671872 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m13:04:06.677909 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m13:04:06.681395 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m13:04:06.682840 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:04:06.683365 [debug] [Thread-3 (]: SQL status: COMMIT in 0.011 seconds
[0m13:04:06.684075 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m13:04:06.687151 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m13:04:06.688409 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:04:06.689053 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m13:04:06.693588 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m13:04:06.695536 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m13:04:06.696287 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a6588e8-be3e-4825-9619-d434e01bf1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722500f47e90>]}
[0m13:04:06.697853 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.10s]
[0m13:04:06.699060 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.009 seconds
[0m13:04:06.700121 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m13:04:06.702641 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m13:04:06.704346 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a6588e8-be3e-4825-9619-d434e01bf1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722500f003b0>]}
[0m13:04:06.705210 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.11s]
[0m13:04:06.706694 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m13:04:06.710606 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:06.711200 [debug] [MainThread]: On master: BEGIN
[0m13:04:06.711676 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:04:06.723035 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m13:04:06.724119 [debug] [MainThread]: On master: COMMIT
[0m13:04:06.724608 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:06.725104 [debug] [MainThread]: On master: COMMIT
[0m13:04:06.725793 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:04:06.726208 [debug] [MainThread]: On master: Close
[0m13:04:06.726831 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:04:06.727192 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m13:04:06.727572 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m13:04:06.727945 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m13:04:06.728466 [info ] [MainThread]: 
[0m13:04:06.729385 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m13:04:06.731878 [debug] [MainThread]: Command end result
[0m13:04:06.765463 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:04:06.767524 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:04:06.775488 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:04:06.775988 [info ] [MainThread]: 
[0m13:04:06.776676 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:04:06.777440 [info ] [MainThread]: 
[0m13:04:06.778380 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:04:06.780176 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3962108, "process_in_blocks": "0", "process_kernel_time": 0.47325, "process_mem_max_rss": "108424", "process_out_blocks": "3384", "process_user_time": 2.730292}
[0m13:04:06.780844 [debug] [MainThread]: Command `dbt run` succeeded at 13:04:06.780668 after 1.40 seconds
[0m13:04:06.781301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72250ad896d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72250b062330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7225091a2ae0>]}
[0m13:04:06.781853 [debug] [MainThread]: Flushing usage events
[0m13:04:08.074639 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:03:11.764946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c72ab62c110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c72a9c62ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c72a9c612b0>]}


============================== 05:03:11.775426 | fe48e8cd-2131-4f1c-85e9-016ad88bdf42 ==============================
[0m05:03:11.775426 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:03:11.776612 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:03:12.216350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe48e8cd-2131-4f1c-85e9-016ad88bdf42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c72a96435f0>]}
[0m05:03:12.345328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe48e8cd-2131-4f1c-85e9-016ad88bdf42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c72a96d5ca0>]}
[0m05:03:12.346880 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:03:12.499226 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:03:12.688787 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:03:12.689541 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:03:12.753276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe48e8cd-2131-4f1c-85e9-016ad88bdf42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c72a7e21d90>]}
[0m05:03:12.879743 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:03:12.883625 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:03:12.924029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe48e8cd-2131-4f1c-85e9-016ad88bdf42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c72a7aff440>]}
[0m05:03:12.925475 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m05:03:12.926569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe48e8cd-2131-4f1c-85e9-016ad88bdf42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c72a7dfd190>]}
[0m05:03:12.931224 [info ] [MainThread]: 
[0m05:03:12.932462 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:03:12.933508 [info ] [MainThread]: 
[0m05:03:12.934662 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:03:12.942121 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:03:13.014126 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:03:13.014811 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:03:13.015400 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:03:18.734375 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: Temporary failure in name resolution

[0m05:03:22.323616 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:03:22.324628 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m05:03:22.325880 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m05:03:22.326836 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m05:03:22.327708 [debug] [ThreadPool]: On list_db: No close available on handle
[0m05:03:22.329878 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:03:22.330685 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m05:03:22.331523 [info ] [MainThread]: 
[0m05:03:22.332445 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 9.40 seconds (9.40s).
[0m05:03:22.334071 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "db" to address: Name or service not known
  
[0m05:03:22.336512 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.961907, "process_in_blocks": "7256", "process_kernel_time": 0.638823, "process_mem_max_rss": "103628", "process_out_blocks": "2472", "process_user_time": 3.585536}
[0m05:03:22.337967 [debug] [MainThread]: Command `dbt run` failed at 05:03:22.337438 after 12.96 seconds
[0m05:03:22.338915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c72a96d4140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c72a7baa7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c72a7b21670>]}
[0m05:03:22.339805 [debug] [MainThread]: Flushing usage events
[0m05:03:23.752743 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:06:41.896915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a60d19a030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a60bd64500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a60b359400>]}


============================== 05:06:41.906206 | d17bde44-52b8-4b30-b7ff-5bbbaaaae3a7 ==============================
[0m05:06:41.906206 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:06:41.907185 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:06:42.210189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd17bde44-52b8-4b30-b7ff-5bbbaaaae3a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a60b299af0>]}
[0m05:06:42.301918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd17bde44-52b8-4b30-b7ff-5bbbaaaae3a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a60d3dc770>]}
[0m05:06:42.303004 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:06:42.443717 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:06:42.879650 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:06:42.880456 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:06:42.963963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd17bde44-52b8-4b30-b7ff-5bbbaaaae3a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a609a94950>]}
[0m05:06:43.079870 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:06:43.084214 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:06:43.119726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd17bde44-52b8-4b30-b7ff-5bbbaaaae3a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a609790b60>]}
[0m05:06:43.120432 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m05:06:43.121209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd17bde44-52b8-4b30-b7ff-5bbbaaaae3a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a60b3ca540>]}
[0m05:06:43.127713 [info ] [MainThread]: 
[0m05:06:43.129340 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:06:43.130267 [info ] [MainThread]: 
[0m05:06:43.131696 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:06:43.143356 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:06:43.648213 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:06:43.962356 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:06:43.962976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:06:43.972207 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "db" (172.18.0.2), port 5432 failed: FATAL:  the database system is not yet accepting connections
DETAIL:  Consistent recovery state has not been yet reached.

[0m05:06:43.978702 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:06:43.980472 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m05:06:43.981539 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m05:06:43.982429 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m05:06:43.983825 [debug] [ThreadPool]: On list_db: No close available on handle
[0m05:06:43.986604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:06:43.987489 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m05:06:43.988336 [info ] [MainThread]: 
[0m05:06:43.989350 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m05:06:43.991286 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "db" (172.18.0.2), port 5432 failed: FATAL:  the database system is not yet accepting connections
  DETAIL:  Consistent recovery state has not been yet reached.
  
[0m05:06:43.993370 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.1669986, "process_in_blocks": "0", "process_kernel_time": 0.627595, "process_mem_max_rss": "104944", "process_out_blocks": "2480", "process_user_time": 4.017492}
[0m05:06:43.994598 [debug] [MainThread]: Command `dbt run` failed at 05:06:43.994298 after 2.17 seconds
[0m05:06:43.995341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a60b3580e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a60978ffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a609adcb00>]}
[0m05:06:43.996001 [debug] [MainThread]: Flushing usage events
[0m05:06:45.371700 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:08:30.694107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78018fa2b980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78018ffbf5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78018ffbc740>]}


============================== 05:08:30.704482 | 16ab8fdd-54d6-42f9-9746-5bbae0d0a77f ==============================
[0m05:08:30.704482 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:08:30.705561 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:08:31.089384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16ab8fdd-54d6-42f9-9746-5bbae0d0a77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78018fcb9310>]}
[0m05:08:31.186485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16ab8fdd-54d6-42f9-9746-5bbae0d0a77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78018ffbd280>]}
[0m05:08:31.187795 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:08:31.355971 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:08:31.555741 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:08:31.556514 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:08:31.611066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16ab8fdd-54d6-42f9-9746-5bbae0d0a77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78018de9f8f0>]}
[0m05:08:31.736636 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:08:31.740557 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:08:31.773011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16ab8fdd-54d6-42f9-9746-5bbae0d0a77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78018db47ad0>]}
[0m05:08:31.773888 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m05:08:31.774687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16ab8fdd-54d6-42f9-9746-5bbae0d0a77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78018db84740>]}
[0m05:08:31.777215 [info ] [MainThread]: 
[0m05:08:31.777935 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:08:31.778785 [info ] [MainThread]: 
[0m05:08:31.779832 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:08:31.786052 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:08:31.856133 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:08:31.856973 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:08:31.857482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:08:31.882634 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.025 seconds
[0m05:08:31.884826 [debug] [ThreadPool]: On list_db: Close
[0m05:08:31.887422 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m05:08:31.895882 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:08:31.896750 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m05:08:31.897408 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:08:31.912412 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m05:08:31.913393 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:08:31.914244 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m05:08:31.925447 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m05:08:31.927946 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m05:08:31.928943 [debug] [ThreadPool]: On list_db_dev: Close
[0m05:08:31.937198 [debug] [MainThread]: Using postgres connection "master"
[0m05:08:31.937778 [debug] [MainThread]: On master: BEGIN
[0m05:08:31.938588 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:08:31.951724 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m05:08:31.953282 [debug] [MainThread]: Using postgres connection "master"
[0m05:08:31.954821 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:08:31.962620 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m05:08:31.965241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16ab8fdd-54d6-42f9-9746-5bbae0d0a77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78018da03aa0>]}
[0m05:08:31.965949 [debug] [MainThread]: On master: ROLLBACK
[0m05:08:31.966785 [debug] [MainThread]: Using postgres connection "master"
[0m05:08:31.967248 [debug] [MainThread]: On master: BEGIN
[0m05:08:31.968490 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:08:31.969057 [debug] [MainThread]: On master: COMMIT
[0m05:08:31.969553 [debug] [MainThread]: Using postgres connection "master"
[0m05:08:31.970034 [debug] [MainThread]: On master: COMMIT
[0m05:08:31.971093 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:08:31.971865 [debug] [MainThread]: On master: Close
[0m05:08:31.977224 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m05:08:31.978183 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m05:08:31.978988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m05:08:31.979549 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m05:08:31.990485 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m05:08:31.991764 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m05:08:32.043885 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m05:08:32.044921 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:08:32.045665 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m05:08:32.046186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:08:32.059857 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m05:08:32.061038 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:08:32.062042 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m05:08:32.067585 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m05:08:32.075732 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:08:32.076357 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m05:08:32.077598 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:08:32.107108 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:08:32.107830 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:08:32.108491 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:08:32.115340 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m05:08:32.130995 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m05:08:32.142682 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:08:32.143303 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m05:08:32.144821 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m05:08:32.149546 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m05:08:32.154078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16ab8fdd-54d6-42f9-9746-5bbae0d0a77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7801916160f0>]}
[0m05:08:32.155939 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.17s]
[0m05:08:32.157049 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m05:08:32.158822 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m05:08:32.159541 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m05:08:32.160634 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m05:08:32.162290 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m05:08:32.164553 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m05:08:32.165574 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m05:08:32.166335 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m05:08:32.167072 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m05:08:32.175691 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m05:08:32.180744 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m05:08:32.182477 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m05:08:32.186889 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m05:08:32.188257 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m05:08:32.194618 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m05:08:32.195527 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:08:32.196378 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m05:08:32.197169 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:08:32.197749 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:08:32.198638 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m05:08:32.199294 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:08:32.211461 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m05:08:32.212620 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:08:32.213336 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m05:08:32.213952 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m05:08:32.214735 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:08:32.215589 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m05:08:32.219746 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m05:08:32.220473 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m05:08:32.225102 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:08:32.229819 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:08:32.230649 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m05:08:32.231453 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m05:08:32.233004 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:08:32.233967 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:08:32.236543 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:08:32.238837 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:08:32.239577 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:08:32.240461 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:08:32.241323 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:08:32.242153 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:08:32.248123 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m05:08:32.251254 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m05:08:32.251973 [debug] [Thread-3 (]: SQL status: COMMIT in 0.009 seconds
[0m05:08:32.253043 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:08:32.256217 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m05:08:32.257054 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m05:08:32.258139 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:08:32.259096 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m05:08:32.259756 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m05:08:32.262231 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m05:08:32.262789 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m05:08:32.265797 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m05:08:32.266691 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16ab8fdd-54d6-42f9-9746-5bbae0d0a77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78018d9dd5b0>]}
[0m05:08:32.269060 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16ab8fdd-54d6-42f9-9746-5bbae0d0a77f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78018cde4950>]}
[0m05:08:32.268000 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.10s]
[0m05:08:32.270868 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.11s]
[0m05:08:32.272707 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m05:08:32.274025 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m05:08:32.279428 [debug] [MainThread]: Using postgres connection "master"
[0m05:08:32.280037 [debug] [MainThread]: On master: BEGIN
[0m05:08:32.280763 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:08:32.295369 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m05:08:32.296208 [debug] [MainThread]: On master: COMMIT
[0m05:08:32.296744 [debug] [MainThread]: Using postgres connection "master"
[0m05:08:32.297242 [debug] [MainThread]: On master: COMMIT
[0m05:08:32.298301 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:08:32.299112 [debug] [MainThread]: On master: Close
[0m05:08:32.300292 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:08:32.300793 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m05:08:32.301228 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m05:08:32.301661 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m05:08:32.302264 [info ] [MainThread]: 
[0m05:08:32.302871 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m05:08:32.305272 [debug] [MainThread]: Command end result
[0m05:08:32.345145 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:08:32.347492 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:08:32.431821 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:08:32.432633 [info ] [MainThread]: 
[0m05:08:32.433447 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:08:32.434116 [info ] [MainThread]: 
[0m05:08:32.434853 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:08:32.572677 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.995179, "process_in_blocks": "9504", "process_kernel_time": 0.581674, "process_mem_max_rss": "108088", "process_out_blocks": "3392", "process_user_time": 3.571556}
[0m05:08:32.573935 [debug] [MainThread]: Command `dbt run` succeeded at 05:08:32.573725 after 2.00 seconds
[0m05:08:32.574831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7801916a40e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78018da03aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78018dc550a0>]}
[0m05:08:32.575709 [debug] [MainThread]: Flushing usage events
[0m05:08:33.997720 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:17:12.658292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70af9f5f9040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70af9f105880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70af9f33cbc0>]}


============================== 05:17:13.388590 | 31c430a7-3f5b-475f-b3d9-1db8d4c70d92 ==============================
[0m05:17:13.388590 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:17:13.390226 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m05:17:13.837217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31c430a7-3f5b-475f-b3d9-1db8d4c70d92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70af9e99fef0>]}
[0m05:17:13.931762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31c430a7-3f5b-475f-b3d9-1db8d4c70d92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70af9eac6870>]}
[0m05:17:13.933046 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:17:14.082063 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:17:14.252621 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:17:14.253268 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:17:14.307046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31c430a7-3f5b-475f-b3d9-1db8d4c70d92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70af9eac77a0>]}
[0m05:17:14.422778 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:17:14.426352 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:17:14.469678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31c430a7-3f5b-475f-b3d9-1db8d4c70d92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70af9cebc890>]}
[0m05:17:14.470416 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m05:17:14.471026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31c430a7-3f5b-475f-b3d9-1db8d4c70d92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70af9ec1bbf0>]}
[0m05:17:14.474794 [info ] [MainThread]: 
[0m05:17:14.475772 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:17:14.476405 [info ] [MainThread]: 
[0m05:17:14.477546 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:17:14.485168 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:17:14.551146 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:17:14.551744 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:17:14.552266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:17:14.576131 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.024 seconds
[0m05:17:14.578328 [debug] [ThreadPool]: On list_db: Close
[0m05:17:14.581035 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m05:17:14.590733 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:17:14.591352 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m05:17:14.591764 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:17:14.604097 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m05:17:14.605263 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:17:14.606284 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m05:17:14.613688 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m05:17:14.616276 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m05:17:14.617773 [debug] [ThreadPool]: On list_db_dev: Close
[0m05:17:14.628165 [debug] [MainThread]: Using postgres connection "master"
[0m05:17:14.629112 [debug] [MainThread]: On master: BEGIN
[0m05:17:14.629651 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:17:14.644900 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m05:17:14.646407 [debug] [MainThread]: Using postgres connection "master"
[0m05:17:14.647195 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:17:14.653591 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m05:17:14.655865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31c430a7-3f5b-475f-b3d9-1db8d4c70d92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70af9cf88290>]}
[0m05:17:14.656655 [debug] [MainThread]: On master: ROLLBACK
[0m05:17:14.657971 [debug] [MainThread]: Using postgres connection "master"
[0m05:17:14.658738 [debug] [MainThread]: On master: BEGIN
[0m05:17:14.660152 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:17:14.660906 [debug] [MainThread]: On master: COMMIT
[0m05:17:14.661539 [debug] [MainThread]: Using postgres connection "master"
[0m05:17:14.662238 [debug] [MainThread]: On master: COMMIT
[0m05:17:14.663161 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:17:14.663655 [debug] [MainThread]: On master: Close
[0m05:17:14.669341 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m05:17:14.671129 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m05:17:14.672198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m05:17:14.672827 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m05:17:14.688181 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m05:17:14.690038 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m05:17:14.750273 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m05:17:14.751428 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:17:14.752128 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m05:17:14.752643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:14.764975 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m05:17:14.765578 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:17:14.766126 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m05:17:14.771726 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m05:17:14.779850 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:17:14.780617 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m05:17:14.781898 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:17:14.785742 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:17:14.786300 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m05:17:14.787336 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:17:14.812728 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:17:14.813447 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:17:14.813985 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:17:14.819988 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m05:17:14.833623 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m05:17:14.841321 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:17:14.841904 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m05:17:14.848315 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m05:17:14.851870 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m05:17:14.855960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31c430a7-3f5b-475f-b3d9-1db8d4c70d92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70af9f54e990>]}
[0m05:17:14.857273 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.18s]
[0m05:17:14.858614 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m05:17:14.860642 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m05:17:14.861461 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m05:17:14.862456 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m05:17:14.863610 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m05:17:14.865011 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m05:17:14.865879 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m05:17:14.866581 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m05:17:14.867280 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m05:17:14.871868 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m05:17:14.878990 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m05:17:14.880375 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m05:17:14.881244 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m05:17:14.885602 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m05:17:14.889761 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m05:17:14.891327 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:17:14.892319 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m05:17:14.893160 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:17:14.893923 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:17:14.894702 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m05:17:14.895872 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:17:14.909232 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m05:17:14.909963 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:17:14.910805 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m05:17:14.911379 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m05:17:14.912266 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:17:14.913058 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m05:17:14.917280 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m05:17:14.918200 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m05:17:14.922156 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:17:14.926199 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:17:14.927011 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m05:17:14.927720 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m05:17:14.929233 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:17:14.929890 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m05:17:14.935624 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:17:14.939443 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:17:14.940312 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m05:17:14.941096 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m05:17:14.942443 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:17:14.943042 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:17:14.945797 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:17:14.948002 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:17:14.948709 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:17:14.949572 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:17:14.950248 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:17:14.950978 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:17:15.092390 [debug] [Thread-4 (]: SQL status: COMMIT in 0.140 seconds
[0m05:17:15.098526 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m05:17:15.099677 [debug] [Thread-3 (]: SQL status: COMMIT in 0.148 seconds
[0m05:17:15.101054 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:17:15.104095 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m05:17:15.105004 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m05:17:15.106140 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:17:15.107247 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m05:17:15.113093 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m05:17:15.115090 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m05:17:15.115983 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31c430a7-3f5b-475f-b3d9-1db8d4c70d92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70af9c082180>]}
[0m05:17:15.117053 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.25s]
[0m05:17:15.118000 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.010 seconds
[0m05:17:15.118911 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m05:17:15.121230 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m05:17:15.122828 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31c430a7-3f5b-475f-b3d9-1db8d4c70d92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70af9c080b90>]}
[0m05:17:15.123830 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.26s]
[0m05:17:15.124948 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m05:17:15.128695 [debug] [MainThread]: Using postgres connection "master"
[0m05:17:15.129378 [debug] [MainThread]: On master: BEGIN
[0m05:17:15.129952 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:17:15.143529 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m05:17:15.144155 [debug] [MainThread]: On master: COMMIT
[0m05:17:15.145150 [debug] [MainThread]: Using postgres connection "master"
[0m05:17:15.145717 [debug] [MainThread]: On master: COMMIT
[0m05:17:15.146534 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:17:15.147016 [debug] [MainThread]: On master: Close
[0m05:17:15.147805 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:17:15.148281 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m05:17:15.148782 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m05:17:15.149291 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m05:17:15.149971 [info ] [MainThread]: 
[0m05:17:15.150576 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m05:17:15.152497 [debug] [MainThread]: Command end result
[0m05:17:15.187019 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:17:15.189835 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:17:15.200461 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:17:15.201306 [info ] [MainThread]: 
[0m05:17:15.202143 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:17:15.202976 [info ] [MainThread]: 
[0m05:17:15.203725 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:17:15.206302 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.6852667, "process_in_blocks": "9504", "process_kernel_time": 0.67033, "process_mem_max_rss": "107952", "process_out_blocks": "3392", "process_user_time": 3.355395}
[0m05:17:15.207236 [debug] [MainThread]: Command `dbt run` succeeded at 05:17:15.206881 after 2.69 seconds
[0m05:17:15.207803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70af9f33cbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70af9ec1bbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70af9d19b4a0>]}
[0m05:17:15.208348 [debug] [MainThread]: Flushing usage events
[0m05:17:16.667701 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:20:54.026349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa5b7b2870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa5be33f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa5b524bc0>]}


============================== 05:20:54.042622 | 73687ff0-647b-4794-870b-cdb0bdb628d9 ==============================
[0m05:20:54.042622 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:20:54.044262 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:20:54.488566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73687ff0-647b-4794-870b-cdb0bdb628d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa5b19fda0>]}
[0m05:20:54.648000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73687ff0-647b-4794-870b-cdb0bdb628d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa5b19fb00>]}
[0m05:20:54.649967 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:20:54.867354 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:20:55.102847 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:20:55.104224 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:20:55.195467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73687ff0-647b-4794-870b-cdb0bdb628d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa5b2179b0>]}
[0m05:20:55.406425 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:20:55.412863 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:20:55.462387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73687ff0-647b-4794-870b-cdb0bdb628d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa596eacf0>]}
[0m05:20:55.463234 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m05:20:55.464021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73687ff0-647b-4794-870b-cdb0bdb628d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa59730140>]}
[0m05:20:55.467511 [info ] [MainThread]: 
[0m05:20:55.468363 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:20:55.469936 [info ] [MainThread]: 
[0m05:20:55.471223 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:20:55.483571 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:20:55.588376 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:20:55.589067 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:20:55.589673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:20:55.631987 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.042 seconds
[0m05:20:55.635603 [debug] [ThreadPool]: On list_db: Close
[0m05:20:55.638859 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m05:20:55.659397 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:20:55.661137 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m05:20:55.663090 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:20:55.680870 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m05:20:55.682452 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:20:55.683333 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m05:20:55.694246 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m05:20:55.697601 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m05:20:55.698975 [debug] [ThreadPool]: On list_db_dev: Close
[0m05:20:55.713902 [debug] [MainThread]: Using postgres connection "master"
[0m05:20:55.714813 [debug] [MainThread]: On master: BEGIN
[0m05:20:55.715479 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:20:55.740400 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m05:20:55.741691 [debug] [MainThread]: Using postgres connection "master"
[0m05:20:55.743296 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:20:55.756785 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m05:20:55.761360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73687ff0-647b-4794-870b-cdb0bdb628d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa5997df40>]}
[0m05:20:55.762971 [debug] [MainThread]: On master: ROLLBACK
[0m05:20:55.764103 [debug] [MainThread]: Using postgres connection "master"
[0m05:20:55.764778 [debug] [MainThread]: On master: BEGIN
[0m05:20:55.767665 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:20:55.770079 [debug] [MainThread]: On master: COMMIT
[0m05:20:55.771040 [debug] [MainThread]: Using postgres connection "master"
[0m05:20:55.772089 [debug] [MainThread]: On master: COMMIT
[0m05:20:55.773497 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:20:55.774494 [debug] [MainThread]: On master: Close
[0m05:20:55.782337 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m05:20:55.783683 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m05:20:55.784896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m05:20:55.785985 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m05:20:55.808165 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m05:20:55.811646 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m05:20:55.923397 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m05:20:55.927085 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:20:55.928198 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m05:20:55.929008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:20:55.944968 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m05:20:55.946452 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:20:55.948031 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m05:20:55.960893 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.011 seconds
[0m05:20:55.973922 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:20:55.976156 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m05:20:55.979071 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:20:55.986718 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:20:55.987723 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m05:20:55.989169 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:20:56.036804 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:20:56.037428 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:20:56.037937 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:20:56.043400 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m05:20:56.053382 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m05:20:56.064515 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:20:56.065372 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m05:20:56.072109 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m05:20:56.077319 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m05:20:56.080688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73687ff0-647b-4794-870b-cdb0bdb628d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa5bd1dfa0>]}
[0m05:20:56.081609 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.29s]
[0m05:20:56.083056 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m05:20:56.084995 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m05:20:56.085580 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m05:20:56.086554 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m05:20:56.087617 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m05:20:56.089005 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m05:20:56.090773 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m05:20:56.091754 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m05:20:56.092739 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m05:20:56.099655 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m05:20:56.109293 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m05:20:56.111532 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m05:20:56.118311 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m05:20:56.121352 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m05:20:56.127277 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m05:20:56.128703 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:20:56.129315 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m05:20:56.129910 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:20:56.130491 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:20:56.131051 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m05:20:56.131916 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:20:56.143468 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m05:20:56.144434 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:20:56.145378 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m05:20:56.148890 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m05:20:56.149879 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:20:56.150731 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m05:20:56.151891 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m05:20:56.158060 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:20:56.158811 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m05:20:56.159383 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m05:20:56.165960 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m05:20:56.166810 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:20:56.170843 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:20:56.171531 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m05:20:56.172154 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m05:20:56.173467 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:20:56.175557 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m05:20:56.178320 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:20:56.183243 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:20:56.184276 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:20:56.184912 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m05:20:56.185632 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:20:56.187368 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:20:56.191137 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:20:56.192045 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:20:56.192704 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:20:56.342488 [debug] [Thread-4 (]: SQL status: COMMIT in 0.156 seconds
[0m05:20:56.345702 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m05:20:56.346622 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:20:56.347272 [debug] [Thread-3 (]: SQL status: COMMIT in 0.154 seconds
[0m05:20:56.347821 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m05:20:56.350933 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m05:20:56.352707 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:20:56.353305 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m05:20:56.357844 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m05:20:56.360961 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m05:20:56.361896 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.008 seconds
[0m05:20:56.362886 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73687ff0-647b-4794-870b-cdb0bdb628d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa5875bfe0>]}
[0m05:20:56.365038 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m05:20:56.366567 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.27s]
[0m05:20:56.368591 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m05:20:56.369856 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73687ff0-647b-4794-870b-cdb0bdb628d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa58754050>]}
[0m05:20:56.371760 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.28s]
[0m05:20:56.373370 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m05:20:56.377789 [debug] [MainThread]: Using postgres connection "master"
[0m05:20:56.378554 [debug] [MainThread]: On master: BEGIN
[0m05:20:56.379280 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:20:56.395603 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m05:20:56.397269 [debug] [MainThread]: On master: COMMIT
[0m05:20:56.398302 [debug] [MainThread]: Using postgres connection "master"
[0m05:20:56.398953 [debug] [MainThread]: On master: COMMIT
[0m05:20:56.399843 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:20:56.400411 [debug] [MainThread]: On master: Close
[0m05:20:56.401189 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:20:56.401736 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m05:20:56.402341 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m05:20:56.402831 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m05:20:56.403743 [info ] [MainThread]: 
[0m05:20:56.405306 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m05:20:56.409764 [debug] [MainThread]: Command end result
[0m05:20:56.468566 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:20:56.471196 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:20:56.482963 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:20:56.483794 [info ] [MainThread]: 
[0m05:20:56.484718 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:20:56.485582 [info ] [MainThread]: 
[0m05:20:56.486458 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:20:56.488645 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5688722, "process_in_blocks": "1624", "process_kernel_time": 0.638917, "process_mem_max_rss": "108040", "process_out_blocks": "3392", "process_user_time": 4.122826}
[0m05:20:56.490361 [debug] [MainThread]: Command `dbt run` succeeded at 05:20:56.489906 after 2.57 seconds
[0m05:20:56.491607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa5b489850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa5b7478c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fa5b5c26f0>]}
[0m05:20:56.492823 [debug] [MainThread]: Flushing usage events
[0m05:20:57.862811 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:27:22.085905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d17ad19340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d17ad19520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d17ad18200>]}


============================== 05:27:22.095169 | e77a9ca1-eb68-4e04-945e-3cb46c2346e3 ==============================
[0m05:27:22.095169 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:27:22.096210 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:27:22.544128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e77a9ca1-eb68-4e04-945e-3cb46c2346e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d1793bfbc0>]}
[0m05:27:22.663244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e77a9ca1-eb68-4e04-945e-3cb46c2346e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d17cab02c0>]}
[0m05:27:22.664614 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:27:22.850774 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:27:23.061306 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:27:23.062596 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:27:23.120445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e77a9ca1-eb68-4e04-945e-3cb46c2346e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d17945c5f0>]}
[0m05:27:23.303168 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:27:23.308499 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:27:23.347835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e77a9ca1-eb68-4e04-945e-3cb46c2346e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d17aca8da0>]}
[0m05:27:23.348858 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m05:27:23.349673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e77a9ca1-eb68-4e04-945e-3cb46c2346e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d17943fe00>]}
[0m05:27:23.353246 [info ] [MainThread]: 
[0m05:27:23.354105 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:27:23.355003 [info ] [MainThread]: 
[0m05:27:23.356191 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:27:23.366499 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:27:23.444189 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:27:23.444768 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:27:23.445210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:27:23.468412 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.023 seconds
[0m05:27:23.470115 [debug] [ThreadPool]: On list_db: Close
[0m05:27:23.472878 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m05:27:23.485223 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:27:23.485830 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m05:27:23.486411 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:27:23.503578 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m05:27:23.504208 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:27:23.504907 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m05:27:23.510917 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m05:27:23.514174 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m05:27:23.515149 [debug] [ThreadPool]: On list_db_dev: Close
[0m05:27:23.525150 [debug] [MainThread]: Using postgres connection "master"
[0m05:27:23.525782 [debug] [MainThread]: On master: BEGIN
[0m05:27:23.526347 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:27:23.540606 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m05:27:23.541459 [debug] [MainThread]: Using postgres connection "master"
[0m05:27:23.542433 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:27:23.550837 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m05:27:23.552889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e77a9ca1-eb68-4e04-945e-3cb46c2346e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d179143740>]}
[0m05:27:23.553543 [debug] [MainThread]: On master: ROLLBACK
[0m05:27:23.554367 [debug] [MainThread]: Using postgres connection "master"
[0m05:27:23.554853 [debug] [MainThread]: On master: BEGIN
[0m05:27:23.555950 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:27:23.556552 [debug] [MainThread]: On master: COMMIT
[0m05:27:23.557121 [debug] [MainThread]: Using postgres connection "master"
[0m05:27:23.557570 [debug] [MainThread]: On master: COMMIT
[0m05:27:23.558363 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:27:23.558879 [debug] [MainThread]: On master: Close
[0m05:27:23.565347 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m05:27:23.566561 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m05:27:23.567400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m05:27:23.568177 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m05:27:23.579817 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m05:27:23.581553 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m05:27:23.648510 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m05:27:23.650644 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:27:23.651819 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m05:27:23.652706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:27:23.666331 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m05:27:23.667314 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:27:23.668084 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m05:27:23.673489 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m05:27:23.684404 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:27:23.685343 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m05:27:23.686850 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:27:23.690588 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:27:23.691100 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m05:27:23.692062 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:27:23.729414 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:27:23.730120 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:27:23.730653 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:27:23.736572 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m05:27:23.749372 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m05:27:23.762343 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:27:23.763273 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m05:27:23.769449 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m05:27:23.772788 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m05:27:23.775152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e77a9ca1-eb68-4e04-945e-3cb46c2346e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d17b7de4b0>]}
[0m05:27:23.776066 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.21s]
[0m05:27:23.777334 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m05:27:23.779888 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m05:27:23.781131 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m05:27:23.782243 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m05:27:23.783848 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m05:27:23.785414 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m05:27:23.787109 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m05:27:23.788327 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m05:27:23.789403 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m05:27:23.794666 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m05:27:23.799116 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m05:27:23.801309 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m05:27:23.806886 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m05:27:23.807815 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m05:27:23.813717 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m05:27:23.814851 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:27:23.815670 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m05:27:23.816286 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:27:23.817106 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:27:23.817633 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m05:27:23.818135 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:27:23.830334 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m05:27:23.831300 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:27:23.832079 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m05:27:23.832758 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m05:27:23.833805 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:27:23.834778 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m05:27:23.837383 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m05:27:23.843265 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:27:23.844283 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.008 seconds
[0m05:27:23.845331 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m05:27:23.850247 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:27:23.851633 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m05:27:23.852628 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:27:23.857326 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:27:23.857989 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m05:27:23.858842 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m05:27:23.863298 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:27:23.864297 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m05:27:23.864855 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:27:23.867849 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:27:23.868558 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m05:27:23.869271 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:27:23.871810 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:27:23.872637 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:27:23.873423 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:27:23.874338 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:27:23.878701 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m05:27:23.882401 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m05:27:23.883119 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m05:27:23.884185 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:27:23.887424 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m05:27:23.888152 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m05:27:23.889215 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:27:23.890032 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m05:27:23.895272 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.005 seconds
[0m05:27:23.897768 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m05:27:23.899308 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e77a9ca1-eb68-4e04-945e-3cb46c2346e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d1781dfe30>]}
[0m05:27:23.901123 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.11s]
[0m05:27:23.902787 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.012 seconds
[0m05:27:23.903927 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m05:27:23.906624 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m05:27:23.908348 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e77a9ca1-eb68-4e04-945e-3cb46c2346e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d1781dc8f0>]}
[0m05:27:23.909426 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.12s]
[0m05:27:23.910758 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m05:27:23.915050 [debug] [MainThread]: Using postgres connection "master"
[0m05:27:23.915958 [debug] [MainThread]: On master: BEGIN
[0m05:27:23.916861 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:27:23.930426 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m05:27:23.931776 [debug] [MainThread]: On master: COMMIT
[0m05:27:23.932791 [debug] [MainThread]: Using postgres connection "master"
[0m05:27:23.933521 [debug] [MainThread]: On master: COMMIT
[0m05:27:23.934458 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:27:23.935006 [debug] [MainThread]: On master: Close
[0m05:27:23.935763 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:27:23.936179 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m05:27:23.936782 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m05:27:23.937238 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m05:27:23.937938 [info ] [MainThread]: 
[0m05:27:23.938934 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m05:27:23.942743 [debug] [MainThread]: Command end result
[0m05:27:23.982438 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:27:23.984741 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:27:23.993369 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:27:23.993925 [info ] [MainThread]: 
[0m05:27:23.995391 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:27:23.996370 [info ] [MainThread]: 
[0m05:27:23.997250 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:27:23.999357 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0106032, "process_in_blocks": "2480", "process_kernel_time": 0.62082, "process_mem_max_rss": "108248", "process_out_blocks": "3400", "process_user_time": 3.825805}
[0m05:27:24.000626 [debug] [MainThread]: Command `dbt run` succeeded at 05:27:24.000325 after 2.01 seconds
[0m05:27:24.001499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d17b34dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d17b534ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d17ac89970>]}
[0m05:27:24.002416 [debug] [MainThread]: Flushing usage events
[0m05:27:25.449473 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:35:10.065463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ace37f4b0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ace37fd4f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ace37620b00>]}


============================== 05:35:10.304544 | 7e45ae09-515c-4c7e-b13b-dfad8bbe45e2 ==============================
[0m05:35:10.304544 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:35:10.305838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m05:35:12.580012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e45ae09-515c-4c7e-b13b-dfad8bbe45e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ace37762960>]}
[0m05:35:12.727260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e45ae09-515c-4c7e-b13b-dfad8bbe45e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ace3738b2f0>]}
[0m05:35:12.729198 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:35:12.939213 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:35:13.222752 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:35:13.223489 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:35:13.336896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e45ae09-515c-4c7e-b13b-dfad8bbe45e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ace35bc0ec0>]}
[0m05:35:13.531464 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:35:13.538897 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:35:13.595543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e45ae09-515c-4c7e-b13b-dfad8bbe45e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ace358a76e0>]}
[0m05:35:13.596475 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m05:35:13.597188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e45ae09-515c-4c7e-b13b-dfad8bbe45e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ace358c4cb0>]}
[0m05:35:13.602507 [info ] [MainThread]: 
[0m05:35:13.603753 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:35:13.604621 [info ] [MainThread]: 
[0m05:35:13.605768 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:35:13.618831 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:35:13.709548 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:35:13.710758 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:35:13.711809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:35:13.715691 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "db" (172.18.0.3), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m05:35:13.717823 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:35:13.718772 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m05:35:13.719771 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m05:35:13.720518 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m05:35:13.721329 [debug] [ThreadPool]: On list_db: No close available on handle
[0m05:35:13.723025 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:35:13.723710 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m05:35:13.724249 [info ] [MainThread]: 
[0m05:35:13.724989 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m05:35:13.726368 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "db" (172.18.0.3), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m05:35:13.728880 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.7585223, "process_in_blocks": "1384", "process_kernel_time": 0.602219, "process_mem_max_rss": "103892", "process_out_blocks": "2472", "process_user_time": 3.716764}
[0m05:35:13.730334 [debug] [MainThread]: Command `dbt run` failed at 05:35:13.730012 after 3.76 seconds
[0m05:35:13.731483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ace37bace60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ace3929d970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ace358c9940>]}
[0m05:35:13.733654 [debug] [MainThread]: Flushing usage events
[0m05:35:15.247302 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:38:14.669801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4945221c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d494562d880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d49452218e0>]}


============================== 05:38:14.688082 | 0ca844eb-ee36-491a-be35-e7aaccc00399 ==============================
[0m05:38:14.688082 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:38:14.689248 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m05:38:16.845980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ca844eb-ee36-491a-be35-e7aaccc00399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4946c37650>]}
[0m05:38:17.028679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ca844eb-ee36-491a-be35-e7aaccc00399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4945caa810>]}
[0m05:38:17.030123 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:38:15.332353 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:38:15.570867 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:38:15.571463 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:38:15.639271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ca844eb-ee36-491a-be35-e7aaccc00399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4944eebe90>]}
[0m05:38:15.771680 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:38:15.775692 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:38:15.839995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ca844eb-ee36-491a-be35-e7aaccc00399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d49431bcaa0>]}
[0m05:38:15.841143 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m05:38:15.842069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ca844eb-ee36-491a-be35-e7aaccc00399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d49434b6ba0>]}
[0m05:38:15.846504 [info ] [MainThread]: 
[0m05:38:15.847489 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:38:15.848412 [info ] [MainThread]: 
[0m05:38:15.849673 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:38:15.861646 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:38:15.944565 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:38:15.945227 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:38:15.945690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:38:15.981012 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.035 seconds
[0m05:38:15.983631 [debug] [ThreadPool]: On list_db: Close
[0m05:38:15.986411 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m05:38:16.002898 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:38:16.004139 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m05:38:16.004847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:38:16.019392 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m05:38:16.020252 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:38:16.021239 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m05:38:16.026827 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m05:38:16.030161 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m05:38:16.031590 [debug] [ThreadPool]: On list_db_dev: Close
[0m05:38:16.047182 [debug] [MainThread]: Using postgres connection "master"
[0m05:38:16.048449 [debug] [MainThread]: On master: BEGIN
[0m05:38:16.050233 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:38:16.067139 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m05:38:16.068657 [debug] [MainThread]: Using postgres connection "master"
[0m05:38:16.069701 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:38:16.075467 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m05:38:16.078123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ca844eb-ee36-491a-be35-e7aaccc00399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4943288440>]}
[0m05:38:16.079343 [debug] [MainThread]: On master: ROLLBACK
[0m05:38:16.080825 [debug] [MainThread]: Using postgres connection "master"
[0m05:38:16.081514 [debug] [MainThread]: On master: BEGIN
[0m05:38:16.083101 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:38:16.083906 [debug] [MainThread]: On master: COMMIT
[0m05:38:16.084601 [debug] [MainThread]: Using postgres connection "master"
[0m05:38:16.085557 [debug] [MainThread]: On master: COMMIT
[0m05:38:16.087356 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m05:38:16.088268 [debug] [MainThread]: On master: Close
[0m05:38:16.094425 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m05:38:16.095363 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m05:38:16.096088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m05:38:16.096683 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m05:38:16.109659 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m05:38:16.110782 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m05:38:16.166989 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m05:38:16.167968 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:38:16.168504 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m05:38:16.169073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:38:16.183141 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m05:38:16.184230 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:38:16.185195 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m05:38:16.190366 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m05:38:16.199497 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:38:16.200037 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m05:38:16.201044 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:38:16.228053 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:38:16.228712 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:38:16.229229 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:38:16.510465 [debug] [Thread-1 (]: SQL status: COMMIT in 0.281 seconds
[0m05:38:16.521623 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m05:38:16.532132 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:38:16.532790 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m05:38:16.534195 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m05:38:16.540091 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m05:38:16.545730 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ca844eb-ee36-491a-be35-e7aaccc00399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4946c36780>]}
[0m05:38:16.547781 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.45s]
[0m05:38:16.549938 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m05:38:16.553358 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m05:38:16.555041 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m05:38:16.556611 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m05:38:16.559896 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m05:38:16.561998 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m05:38:16.563820 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m05:38:16.565054 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m05:38:16.566311 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m05:38:16.577947 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m05:38:16.582984 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m05:38:16.584682 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m05:38:16.585514 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m05:38:16.590441 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m05:38:16.597384 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m05:38:16.599461 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:38:16.600439 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:38:16.601253 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m05:38:16.602042 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m05:38:16.602877 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:38:16.603590 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:38:16.623067 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m05:38:16.624290 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:38:16.625066 [debug] [Thread-4 (]: SQL status: BEGIN in 0.022 seconds
[0m05:38:16.626150 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m05:38:16.627709 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:38:16.629194 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m05:38:16.635390 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m05:38:16.636352 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m05:38:16.643876 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:38:16.648840 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:38:16.649942 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m05:38:16.651091 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m05:38:16.653052 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:38:16.654137 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m05:38:16.656511 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:38:16.658942 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:38:16.659694 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:38:16.660366 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:38:16.660992 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:38:16.661618 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:38:16.732128 [debug] [Thread-3 (]: SQL status: COMMIT in 0.070 seconds
[0m05:38:16.735523 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m05:38:16.737141 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:38:16.738295 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m05:38:16.739670 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m05:38:16.742005 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m05:38:16.743036 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ca844eb-ee36-491a-be35-e7aaccc00399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d49402200e0>]}
[0m05:38:16.743717 [debug] [Thread-4 (]: SQL status: COMMIT in 0.081 seconds
[0m05:38:16.744791 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.18s]
[0m05:38:16.749525 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m05:38:16.750799 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m05:38:16.752491 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:38:16.754373 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m05:38:16.756211 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m05:38:16.760986 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m05:38:16.762506 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ca844eb-ee36-491a-be35-e7aaccc00399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4940267e60>]}
[0m05:38:16.764147 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.20s]
[0m05:38:16.765938 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m05:38:16.771337 [debug] [MainThread]: Using postgres connection "master"
[0m05:38:16.772465 [debug] [MainThread]: On master: BEGIN
[0m05:38:16.773042 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:38:16.787148 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m05:38:16.788738 [debug] [MainThread]: On master: COMMIT
[0m05:38:16.790342 [debug] [MainThread]: Using postgres connection "master"
[0m05:38:16.791105 [debug] [MainThread]: On master: COMMIT
[0m05:38:16.792151 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:38:16.793061 [debug] [MainThread]: On master: Close
[0m05:38:16.794708 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:38:16.795298 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m05:38:16.796036 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m05:38:16.797123 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m05:38:16.798641 [info ] [MainThread]: 
[0m05:38:16.801022 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m05:38:16.804699 [debug] [MainThread]: Command end result
[0m05:38:16.846841 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:38:16.849724 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:38:16.874441 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:38:16.875199 [info ] [MainThread]: 
[0m05:38:16.876000 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:38:16.876865 [info ] [MainThread]: 
[0m05:38:16.878095 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:38:16.882092 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.6671681, "process_in_blocks": "9504", "process_kernel_time": 0.647409, "process_mem_max_rss": "107540", "process_out_blocks": "3400", "process_user_time": 4.139719}
[0m05:38:16.883551 [debug] [MainThread]: Command `dbt run` succeeded at 05:38:16.883297 after 2.67 seconds
[0m05:38:16.884405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4944d2fc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4944d2fbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d49432f4b30>]}
[0m05:38:16.885139 [debug] [MainThread]: Flushing usage events
[0m05:38:18.400991 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:40:19.866592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723836c8b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723836e3bd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723836c8a660>]}


============================== 05:40:19.886155 | a1183d67-7f4a-4a70-b97f-10010eead99f ==============================
[0m05:40:19.886155 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:40:19.888563 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:40:20.347751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1183d67-7f4a-4a70-b97f-10010eead99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72383624bb90>]}
[0m05:40:20.457146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1183d67-7f4a-4a70-b97f-10010eead99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72383621a7b0>]}
[0m05:40:20.458304 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:40:20.673671 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:40:20.888895 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:40:20.889648 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:40:20.967929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1183d67-7f4a-4a70-b97f-10010eead99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7238348e9a90>]}
[0m05:40:21.113265 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:40:21.120280 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:40:21.180078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1183d67-7f4a-4a70-b97f-10010eead99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7238345f0950>]}
[0m05:40:21.181583 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m05:40:21.182591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1183d67-7f4a-4a70-b97f-10010eead99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72383467d940>]}
[0m05:40:21.186953 [info ] [MainThread]: 
[0m05:40:21.187887 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:40:21.188789 [info ] [MainThread]: 
[0m05:40:21.190227 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:40:21.202632 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:40:21.308643 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:40:21.309461 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:40:21.309923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:40:21.329232 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.019 seconds
[0m05:40:21.331835 [debug] [ThreadPool]: On list_db: Close
[0m05:40:21.335443 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m05:40:21.344634 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:40:21.345381 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m05:40:21.345878 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:40:21.361635 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m05:40:21.362533 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:40:21.363202 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m05:40:21.370479 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m05:40:21.374678 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m05:40:21.375952 [debug] [ThreadPool]: On list_db_dev: Close
[0m05:40:21.386819 [debug] [MainThread]: Using postgres connection "master"
[0m05:40:21.387657 [debug] [MainThread]: On master: BEGIN
[0m05:40:21.388588 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:40:21.404148 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m05:40:21.405544 [debug] [MainThread]: Using postgres connection "master"
[0m05:40:21.406878 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:40:21.415135 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m05:40:21.417845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1183d67-7f4a-4a70-b97f-10010eead99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7238338757f0>]}
[0m05:40:21.418823 [debug] [MainThread]: On master: ROLLBACK
[0m05:40:21.419871 [debug] [MainThread]: Using postgres connection "master"
[0m05:40:21.420492 [debug] [MainThread]: On master: BEGIN
[0m05:40:21.421955 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:40:21.422617 [debug] [MainThread]: On master: COMMIT
[0m05:40:21.423435 [debug] [MainThread]: Using postgres connection "master"
[0m05:40:21.424282 [debug] [MainThread]: On master: COMMIT
[0m05:40:21.425218 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:40:21.425746 [debug] [MainThread]: On master: Close
[0m05:40:21.432094 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m05:40:21.433646 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m05:40:21.435193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m05:40:21.436076 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m05:40:21.450524 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m05:40:21.451516 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m05:40:21.526483 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m05:40:21.528437 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:40:21.529443 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m05:40:21.529989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:40:21.557107 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m05:40:21.558212 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:40:21.558963 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m05:40:21.567735 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m05:40:21.582183 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:40:21.583555 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m05:40:21.586009 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:40:21.595579 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:40:21.596187 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m05:40:21.597700 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:40:21.657319 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:40:21.658364 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:40:21.659211 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:40:21.664898 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m05:40:21.683469 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m05:40:21.700274 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:40:21.701882 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m05:40:21.715955 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.013 seconds
[0m05:40:21.724031 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m05:40:21.727658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1183d67-7f4a-4a70-b97f-10010eead99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72383807e990>]}
[0m05:40:21.730452 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.29s]
[0m05:40:21.733694 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m05:40:21.736717 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m05:40:21.737449 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m05:40:21.738416 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m05:40:21.739686 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m05:40:21.740967 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m05:40:21.741896 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m05:40:21.742547 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m05:40:21.743203 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m05:40:21.747629 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m05:40:21.752683 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m05:40:21.754408 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m05:40:21.755179 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m05:40:21.759867 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m05:40:21.764127 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m05:40:21.765458 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:40:21.766321 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:40:21.766848 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m05:40:21.767468 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m05:40:21.768047 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:40:21.768637 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:40:21.782341 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m05:40:21.783299 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:40:21.784113 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m05:40:21.786314 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m05:40:21.787688 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:40:21.788842 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m05:40:21.790765 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m05:40:21.799327 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:40:21.800759 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.011 seconds
[0m05:40:21.801707 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m05:40:21.807599 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:40:21.809477 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m05:40:21.810767 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m05:40:21.815910 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:40:21.816638 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m05:40:21.817268 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m05:40:21.821469 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:40:21.822392 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m05:40:21.823082 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:40:21.826977 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:40:21.827749 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m05:40:21.828596 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:40:21.833150 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:40:21.834132 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:40:21.834847 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:40:21.836067 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:40:21.839702 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m05:40:21.845353 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m05:40:21.846663 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:40:21.847374 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m05:40:21.865892 [debug] [Thread-4 (]: SQL status: COMMIT in 0.029 seconds
[0m05:40:21.871190 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m05:40:21.872117 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.024 seconds
[0m05:40:21.873234 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:40:21.875513 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m05:40:21.876236 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m05:40:21.877829 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1183d67-7f4a-4a70-b97f-10010eead99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723833827e90>]}
[0m05:40:21.880191 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.14s]
[0m05:40:21.882540 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m05:40:21.884241 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.007 seconds
[0m05:40:21.888195 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m05:40:21.890302 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1183d67-7f4a-4a70-b97f-10010eead99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7238337a42f0>]}
[0m05:40:21.891393 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.15s]
[0m05:40:21.892873 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m05:40:21.897673 [debug] [MainThread]: Using postgres connection "master"
[0m05:40:21.898750 [debug] [MainThread]: On master: BEGIN
[0m05:40:21.899674 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:40:21.919100 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m05:40:21.920369 [debug] [MainThread]: On master: COMMIT
[0m05:40:21.921285 [debug] [MainThread]: Using postgres connection "master"
[0m05:40:21.922495 [debug] [MainThread]: On master: COMMIT
[0m05:40:21.923796 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:40:21.924365 [debug] [MainThread]: On master: Close
[0m05:40:21.925478 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:40:21.926425 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m05:40:21.927519 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m05:40:21.928593 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m05:40:21.929996 [info ] [MainThread]: 
[0m05:40:21.931046 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m05:40:21.935484 [debug] [MainThread]: Command end result
[0m05:40:21.982332 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:40:21.985000 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:40:21.998704 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:40:21.999481 [info ] [MainThread]: 
[0m05:40:22.000588 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:40:22.001753 [info ] [MainThread]: 
[0m05:40:22.002776 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:40:22.005957 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2808077, "process_in_blocks": "9504", "process_kernel_time": 0.868563, "process_mem_max_rss": "108344", "process_out_blocks": "3400", "process_user_time": 4.035824}
[0m05:40:22.006900 [debug] [MainThread]: Command `dbt run` succeeded at 05:40:22.006708 after 2.28 seconds
[0m05:40:22.007527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7238361a5760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723836342ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72383621a6f0>]}
[0m05:40:22.008142 [debug] [MainThread]: Flushing usage events
[0m05:40:23.424562 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:40:36.923697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x6ffc851ee7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x6ffc85158890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x6ffc853c6ff0>]}


============================== 05:40:36.933750 | 7153a75a-ae69-4213-acca-e27d230cae6a ==============================
[0m05:40:36.933750 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:40:36.934865 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m05:40:33.470211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7153a75a-ae69-4213-acca-e27d230cae6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x6ffc83be02f0>]}
[0m05:40:33.599402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7153a75a-ae69-4213-acca-e27d230cae6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x6ffc83e6bce0>]}
[0m05:40:33.601415 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:40:33.835577 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:40:34.105137 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:40:34.105718 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:40:34.187296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7153a75a-ae69-4213-acca-e27d230cae6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x6ffc8192bad0>]}
[0m05:40:34.345193 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:40:34.348984 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:40:34.391010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7153a75a-ae69-4213-acca-e27d230cae6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x6ffc817a6360>]}
[0m05:40:34.391760 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m05:40:34.392401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7153a75a-ae69-4213-acca-e27d230cae6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x6ffc8451fa70>]}
[0m05:40:34.398829 [info ] [MainThread]: 
[0m05:40:34.400205 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:40:34.401382 [info ] [MainThread]: 
[0m05:40:34.402953 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:40:34.415161 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:40:34.491116 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:40:34.491719 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:40:34.492215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:40:34.508435 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m05:40:34.510543 [debug] [ThreadPool]: On list_db: Close
[0m05:40:34.514211 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m05:40:34.527045 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:40:34.527812 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m05:40:34.528407 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:40:34.542501 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m05:40:34.543366 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:40:34.544331 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m05:40:34.551214 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m05:40:34.554552 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m05:40:34.555732 [debug] [ThreadPool]: On list_db_dev: Close
[0m05:40:34.569749 [debug] [MainThread]: Using postgres connection "master"
[0m05:40:34.571347 [debug] [MainThread]: On master: BEGIN
[0m05:40:34.572079 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:40:34.584136 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m05:40:34.585904 [debug] [MainThread]: Using postgres connection "master"
[0m05:40:34.587561 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:40:34.593883 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m05:40:34.596274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7153a75a-ae69-4213-acca-e27d230cae6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x6ffc8162e990>]}
[0m05:40:34.597278 [debug] [MainThread]: On master: ROLLBACK
[0m05:40:34.598181 [debug] [MainThread]: Using postgres connection "master"
[0m05:40:34.598732 [debug] [MainThread]: On master: BEGIN
[0m05:40:34.600041 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:40:34.600830 [debug] [MainThread]: On master: COMMIT
[0m05:40:34.601605 [debug] [MainThread]: Using postgres connection "master"
[0m05:40:34.602319 [debug] [MainThread]: On master: COMMIT
[0m05:40:34.604445 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m05:40:34.605733 [debug] [MainThread]: On master: Close
[0m05:40:34.612376 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m05:40:34.613773 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m05:40:34.615218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m05:40:34.616370 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m05:40:34.632286 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m05:40:34.633379 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m05:40:34.720330 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m05:40:34.721936 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:40:34.722783 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m05:40:34.723514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:40:34.738303 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m05:40:34.739333 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:40:34.740000 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m05:40:34.744390 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m05:40:34.758800 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:40:34.759387 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m05:40:34.760829 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:40:34.768403 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:40:34.769819 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m05:40:34.771482 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:40:34.802547 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:40:34.803463 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:40:34.804194 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:40:34.810710 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m05:40:34.823677 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m05:40:34.831850 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:40:34.832915 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m05:40:34.840984 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m05:40:34.845007 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m05:40:34.847618 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7153a75a-ae69-4213-acca-e27d230cae6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x6ffc83cc6630>]}
[0m05:40:34.848906 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.23s]
[0m05:40:34.850344 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m05:40:34.852491 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m05:40:34.853537 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m05:40:34.854304 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m05:40:34.857087 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m05:40:34.858760 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m05:40:34.859693 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m05:40:34.860561 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m05:40:34.861382 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m05:40:34.865885 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m05:40:34.870772 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m05:40:34.872479 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m05:40:34.874084 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m05:40:34.881007 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m05:40:34.886493 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m05:40:34.888303 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:40:34.889344 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:40:34.890155 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m05:40:34.891200 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m05:40:34.893558 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:40:34.895552 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:40:34.916931 [debug] [Thread-4 (]: SQL status: BEGIN in 0.021 seconds
[0m05:40:34.918341 [debug] [Thread-3 (]: SQL status: BEGIN in 0.025 seconds
[0m05:40:34.919350 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:40:34.920184 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:40:34.920996 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m05:40:34.921851 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m05:40:34.926655 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m05:40:34.934241 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:40:34.934992 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.012 seconds
[0m05:40:34.936148 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m05:40:34.940996 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:40:34.942027 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m05:40:34.942675 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:40:34.949452 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m05:40:34.951189 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:40:34.955636 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:40:34.956542 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m05:40:34.957326 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m05:40:34.958689 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:40:34.959257 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:40:34.961824 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:40:34.966144 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:40:34.967129 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:40:34.967882 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:40:34.968625 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:40:34.969534 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:40:34.975445 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m05:40:34.979252 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m05:40:34.980032 [debug] [Thread-4 (]: SQL status: COMMIT in 0.010 seconds
[0m05:40:34.981294 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:40:34.987593 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m05:40:34.988671 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m05:40:34.989875 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:40:34.990871 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m05:40:34.996341 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m05:40:34.998689 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m05:40:35.000453 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7153a75a-ae69-4213-acca-e27d230cae6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x6ffc807f1eb0>]}
[0m05:40:35.002030 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.010 seconds
[0m05:40:35.003906 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.14s]
[0m05:40:35.006733 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m05:40:35.007739 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m05:40:35.009051 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7153a75a-ae69-4213-acca-e27d230cae6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x6ffc80703530>]}
[0m05:40:35.009955 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.15s]
[0m05:40:35.011132 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m05:40:35.014219 [debug] [MainThread]: Using postgres connection "master"
[0m05:40:35.014794 [debug] [MainThread]: On master: BEGIN
[0m05:40:35.015269 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:40:35.028636 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m05:40:35.029518 [debug] [MainThread]: On master: COMMIT
[0m05:40:35.030185 [debug] [MainThread]: Using postgres connection "master"
[0m05:40:35.031004 [debug] [MainThread]: On master: COMMIT
[0m05:40:35.032019 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:40:35.032552 [debug] [MainThread]: On master: Close
[0m05:40:35.033308 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:40:35.033746 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m05:40:35.034199 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m05:40:35.034872 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m05:40:35.036252 [info ] [MainThread]: 
[0m05:40:35.038093 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m05:40:35.041699 [debug] [MainThread]: Command end result
[0m05:40:35.078919 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:40:35.081437 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:40:35.092967 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:40:35.093559 [info ] [MainThread]: 
[0m05:40:35.094497 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:40:35.095514 [info ] [MainThread]: 
[0m05:40:35.096638 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:40:35.098962 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1383839, "process_in_blocks": "160", "process_kernel_time": 0.548504, "process_mem_max_rss": "108296", "process_out_blocks": "3400", "process_user_time": 3.835823}
[0m05:40:35.099854 [debug] [MainThread]: Command `dbt run` succeeded at 05:40:35.099633 after 2.14 seconds
[0m05:40:35.100675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x6ffc83cc7bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x6ffc83ce4f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x6ffc833c49b0>]}
[0m05:40:35.101393 [debug] [MainThread]: Flushing usage events
[0m05:40:36.635842 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:40:58.286414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713480032000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71347e1afdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713480168680>]}


============================== 05:40:58.297754 | 75d22353-7b52-4fb0-86c0-36ff3db76c6d ==============================
[0m05:40:58.297754 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:40:58.299011 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:40:58.702124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75d22353-7b52-4fb0-86c0-36ff3db76c6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71347e826300>]}
[0m05:40:58.859473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75d22353-7b52-4fb0-86c0-36ff3db76c6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71347c8a71a0>]}
[0m05:40:58.861127 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:40:59.083263 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:40:59.313918 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:40:59.314651 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:40:59.408814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75d22353-7b52-4fb0-86c0-36ff3db76c6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71347c94d2b0>]}
[0m05:40:59.639970 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:40:59.644240 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:40:59.710442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75d22353-7b52-4fb0-86c0-36ff3db76c6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71347c648860>]}
[0m05:40:59.711383 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m05:40:59.712114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75d22353-7b52-4fb0-86c0-36ff3db76c6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71347e26a660>]}
[0m05:40:59.715596 [info ] [MainThread]: 
[0m05:40:59.716459 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:40:59.717477 [info ] [MainThread]: 
[0m05:40:59.720627 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:40:59.729678 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:40:59.817727 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:40:59.818409 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:40:59.818903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:40:59.835233 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m05:40:59.837426 [debug] [ThreadPool]: On list_db: Close
[0m05:40:59.839811 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m05:40:59.849743 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:40:59.850481 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m05:40:59.850953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:40:59.866434 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m05:40:59.867310 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:40:59.868354 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m05:40:59.874063 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m05:40:59.877827 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m05:40:59.879255 [debug] [ThreadPool]: On list_db_dev: Close
[0m05:40:59.905952 [debug] [MainThread]: Using postgres connection "master"
[0m05:40:59.906814 [debug] [MainThread]: On master: BEGIN
[0m05:40:59.907591 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:40:59.924274 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m05:40:59.925199 [debug] [MainThread]: Using postgres connection "master"
[0m05:40:59.926198 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:40:59.932005 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m05:40:59.935105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75d22353-7b52-4fb0-86c0-36ff3db76c6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71347c9849e0>]}
[0m05:40:59.937401 [debug] [MainThread]: On master: ROLLBACK
[0m05:40:59.939311 [debug] [MainThread]: Using postgres connection "master"
[0m05:40:59.941282 [debug] [MainThread]: On master: BEGIN
[0m05:40:59.942997 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:40:59.943854 [debug] [MainThread]: On master: COMMIT
[0m05:40:59.944895 [debug] [MainThread]: Using postgres connection "master"
[0m05:40:59.945494 [debug] [MainThread]: On master: COMMIT
[0m05:40:59.946285 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:40:59.946799 [debug] [MainThread]: On master: Close
[0m05:40:59.951640 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m05:40:59.953104 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m05:40:59.956951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m05:40:59.959009 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m05:40:59.973754 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m05:40:59.976369 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m05:41:00.055269 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m05:41:00.057369 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:41:00.058770 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m05:41:00.060826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:41:00.082519 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m05:41:00.083716 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:41:00.084861 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m05:41:00.092842 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m05:41:00.119723 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:41:00.123297 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m05:41:00.126238 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:41:00.141195 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:41:00.142238 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m05:41:00.143564 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:41:00.187102 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:41:00.189856 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:41:00.190943 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:41:00.197245 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m05:41:00.211307 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m05:41:00.220980 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:41:00.221730 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m05:41:00.229268 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m05:41:00.234140 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m05:41:00.237228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75d22353-7b52-4fb0-86c0-36ff3db76c6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71347ecb6870>]}
[0m05:41:00.238354 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.28s]
[0m05:41:00.239572 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m05:41:00.241807 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m05:41:00.243633 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m05:41:00.245351 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m05:41:00.248268 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m05:41:00.250416 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m05:41:00.251518 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m05:41:00.252249 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m05:41:00.253100 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m05:41:00.258785 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m05:41:00.267914 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m05:41:00.269731 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m05:41:00.270690 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m05:41:00.276571 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m05:41:00.285284 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m05:41:00.288278 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:41:00.289635 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:41:00.291271 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m05:41:00.292444 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m05:41:00.294076 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:41:00.295093 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:41:00.316317 [debug] [Thread-3 (]: SQL status: BEGIN in 0.021 seconds
[0m05:41:00.320011 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:41:00.324302 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m05:41:00.326627 [debug] [Thread-4 (]: SQL status: BEGIN in 0.033 seconds
[0m05:41:00.328296 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:41:00.329790 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m05:41:00.335729 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m05:41:00.337698 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m05:41:00.346998 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:41:00.356161 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:41:00.357514 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m05:41:00.358718 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m05:41:00.360615 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:41:00.361437 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m05:41:00.366085 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:41:00.375452 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:41:00.377150 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m05:41:00.378182 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m05:41:00.380230 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:41:00.382247 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m05:41:00.388294 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:41:00.396174 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:41:00.398037 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:41:00.399685 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:41:00.401649 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:41:00.403090 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:41:00.411620 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m05:41:00.418966 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m05:41:00.420277 [debug] [Thread-4 (]: SQL status: COMMIT in 0.013 seconds
[0m05:41:00.421754 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:41:00.426572 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m05:41:00.427453 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m05:41:00.428605 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:41:00.429713 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m05:41:00.436830 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.007 seconds
[0m05:41:00.439684 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m05:41:00.441009 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.010 seconds
[0m05:41:00.443012 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75d22353-7b52-4fb0-86c0-36ff3db76c6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71347b7f9cd0>]}
[0m05:41:00.446359 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m05:41:00.448299 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.19s]
[0m05:41:00.451142 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m05:41:00.452182 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75d22353-7b52-4fb0-86c0-36ff3db76c6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71347b7e2390>]}
[0m05:41:00.453812 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.20s]
[0m05:41:00.455151 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m05:41:00.458982 [debug] [MainThread]: Using postgres connection "master"
[0m05:41:00.461085 [debug] [MainThread]: On master: BEGIN
[0m05:41:00.462271 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:41:00.480316 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m05:41:00.482597 [debug] [MainThread]: On master: COMMIT
[0m05:41:00.483519 [debug] [MainThread]: Using postgres connection "master"
[0m05:41:00.484276 [debug] [MainThread]: On master: COMMIT
[0m05:41:00.485325 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:41:00.485928 [debug] [MainThread]: On master: Close
[0m05:41:00.487298 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:41:00.488187 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m05:41:00.489362 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m05:41:00.490511 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m05:41:00.491754 [info ] [MainThread]: 
[0m05:41:00.492816 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m05:41:00.497567 [debug] [MainThread]: Command end result
[0m05:41:00.575648 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:41:00.580138 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:41:00.601556 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:41:00.602810 [info ] [MainThread]: 
[0m05:41:00.611292 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:41:00.612902 [info ] [MainThread]: 
[0m05:41:00.614259 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:41:00.617410 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4563386, "process_in_blocks": "0", "process_kernel_time": 0.726134, "process_mem_max_rss": "107956", "process_out_blocks": "3408", "process_user_time": 4.360509}
[0m05:41:00.619376 [debug] [MainThread]: Command `dbt run` succeeded at 05:41:00.618972 after 2.46 seconds
[0m05:41:00.623530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71347e4e7980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71347c8dfda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71347e7ee840>]}
[0m05:41:00.625372 [debug] [MainThread]: Flushing usage events
[0m05:41:02.058704 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:41:57.230661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749317d2e240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749319e96900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749317d2ef30>]}


============================== 05:41:57.239783 | 62a2a66b-aebb-4918-8887-74337250e840 ==============================
[0m05:41:57.239783 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:41:57.240889 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m05:41:57.510433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62a2a66b-aebb-4918-8887-74337250e840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749317727740>]}
[0m05:41:57.672062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62a2a66b-aebb-4918-8887-74337250e840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7493176abc20>]}
[0m05:41:57.673405 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:41:57.873368 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:41:58.051815 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:41:58.052311 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:41:58.105178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62a2a66b-aebb-4918-8887-74337250e840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749315f73c50>]}
[0m05:41:58.216037 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:41:58.219697 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:41:58.256138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62a2a66b-aebb-4918-8887-74337250e840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749315c435f0>]}
[0m05:41:58.256846 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m05:41:58.257392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62a2a66b-aebb-4918-8887-74337250e840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749318439400>]}
[0m05:41:58.260392 [info ] [MainThread]: 
[0m05:41:58.261113 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:41:58.262379 [info ] [MainThread]: 
[0m05:41:58.263853 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:41:58.269724 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:41:58.342086 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:41:58.342666 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:41:58.343171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:41:58.358936 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m05:41:58.361103 [debug] [ThreadPool]: On list_db: Close
[0m05:41:58.363993 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m05:41:58.375768 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:41:58.376343 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m05:41:58.376792 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:41:58.388835 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m05:41:58.389736 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:41:58.390787 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m05:41:58.395497 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m05:41:58.399431 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m05:41:58.401007 [debug] [ThreadPool]: On list_db_dev: Close
[0m05:41:58.411398 [debug] [MainThread]: Using postgres connection "master"
[0m05:41:58.413152 [debug] [MainThread]: On master: BEGIN
[0m05:41:58.413869 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:41:58.425984 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m05:41:58.427123 [debug] [MainThread]: Using postgres connection "master"
[0m05:41:58.428346 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:41:58.434867 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m05:41:58.438009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62a2a66b-aebb-4918-8887-74337250e840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7493178004d0>]}
[0m05:41:58.439540 [debug] [MainThread]: On master: ROLLBACK
[0m05:41:58.440637 [debug] [MainThread]: Using postgres connection "master"
[0m05:41:58.441458 [debug] [MainThread]: On master: BEGIN
[0m05:41:58.442995 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:41:58.443714 [debug] [MainThread]: On master: COMMIT
[0m05:41:58.444680 [debug] [MainThread]: Using postgres connection "master"
[0m05:41:58.445839 [debug] [MainThread]: On master: COMMIT
[0m05:41:58.447006 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:41:58.447634 [debug] [MainThread]: On master: Close
[0m05:41:58.453508 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m05:41:58.454515 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m05:41:58.455400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m05:41:58.456487 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m05:41:58.469027 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m05:41:58.469848 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m05:41:58.543438 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m05:41:58.545351 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:41:58.547231 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m05:41:58.548087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:41:58.560542 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m05:41:58.561782 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:41:58.562886 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m05:41:58.567057 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m05:41:58.578152 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:41:58.579498 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m05:41:58.581110 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:41:58.584975 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:41:58.585496 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m05:41:58.586660 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:41:58.616667 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:41:58.617257 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:41:58.617823 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:41:58.623752 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m05:41:58.633012 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m05:41:58.642123 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:41:58.642831 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m05:41:58.649703 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m05:41:58.653005 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m05:41:58.655595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62a2a66b-aebb-4918-8887-74337250e840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7493182c6750>]}
[0m05:41:58.656885 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.20s]
[0m05:41:58.658234 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m05:41:58.660062 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m05:41:58.660813 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m05:41:58.662095 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m05:41:58.663752 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m05:41:58.665693 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m05:41:58.666930 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m05:41:58.667925 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m05:41:58.668652 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m05:41:58.672771 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m05:41:58.677395 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m05:41:58.679716 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m05:41:58.680485 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m05:41:58.684692 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m05:41:58.688484 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m05:41:58.689861 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:41:58.690692 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m05:41:58.691325 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:41:58.691863 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:41:58.692504 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m05:41:58.693682 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:41:58.705521 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m05:41:58.706721 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m05:41:58.707425 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:41:58.708251 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:41:58.709133 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m05:41:58.709818 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m05:41:58.715276 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m05:41:58.721791 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m05:41:58.722530 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:41:58.725980 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:41:58.726922 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m05:41:58.727747 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m05:41:58.730790 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:41:58.731691 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m05:41:58.735328 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:41:58.738746 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:41:58.739472 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m05:41:58.740342 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m05:41:58.741645 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:41:58.742304 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:41:58.745217 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:41:58.748281 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:41:58.748936 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:41:58.749597 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:41:58.750333 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:41:58.750952 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:41:58.756628 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m05:41:58.760283 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m05:41:58.761008 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m05:41:58.762615 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:41:58.765438 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m05:41:58.766120 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m05:41:58.767234 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:41:58.768086 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m05:41:58.774157 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m05:41:58.776816 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m05:41:58.777948 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62a2a66b-aebb-4918-8887-74337250e840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74931450eff0>]}
[0m05:41:58.779075 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.010 seconds
[0m05:41:58.780360 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.11s]
[0m05:41:58.783225 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m05:41:58.784323 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m05:41:58.785735 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62a2a66b-aebb-4918-8887-74337250e840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749314e10980>]}
[0m05:41:58.786907 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.12s]
[0m05:41:58.788491 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m05:41:58.791909 [debug] [MainThread]: Using postgres connection "master"
[0m05:41:58.792410 [debug] [MainThread]: On master: BEGIN
[0m05:41:58.792883 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:41:58.804704 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m05:41:58.805992 [debug] [MainThread]: On master: COMMIT
[0m05:41:58.807208 [debug] [MainThread]: Using postgres connection "master"
[0m05:41:58.807870 [debug] [MainThread]: On master: COMMIT
[0m05:41:58.808797 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:41:58.809378 [debug] [MainThread]: On master: Close
[0m05:41:58.810420 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:41:58.811100 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m05:41:58.811918 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m05:41:58.812546 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m05:41:58.813725 [info ] [MainThread]: 
[0m05:41:58.814686 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m05:41:58.817838 [debug] [MainThread]: Command end result
[0m05:41:58.856883 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:41:58.860070 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:41:58.877675 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:41:58.879377 [info ] [MainThread]: 
[0m05:41:58.880755 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:41:58.881843 [info ] [MainThread]: 
[0m05:41:58.882959 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:41:58.885358 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7273906, "process_in_blocks": "856", "process_kernel_time": 0.574965, "process_mem_max_rss": "108072", "process_out_blocks": "3400", "process_user_time": 3.480661}
[0m05:41:58.886119 [debug] [MainThread]: Command `dbt run` succeeded at 05:41:58.885947 after 1.73 seconds
[0m05:41:58.886731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749317eb5ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749317d2ef30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749317db51f0>]}
[0m05:41:58.887218 [debug] [MainThread]: Flushing usage events
[0m05:42:00.216224 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:42:55.576498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd9e7971d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd9e7940e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd9e794260>]}


============================== 05:42:55.598182 | 9964e1b5-cd4d-4319-aaff-d8e0b46b0e78 ==============================
[0m05:42:55.598182 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:42:55.600228 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:42:56.771209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9964e1b5-cd4d-4319-aaff-d8e0b46b0e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd9f44d2e0>]}
[0m05:42:57.158548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9964e1b5-cd4d-4319-aaff-d8e0b46b0e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd9e6d33e0>]}
[0m05:42:57.161607 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:42:57.671294 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:42:58.153889 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:42:58.156456 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:42:58.299833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9964e1b5-cd4d-4319-aaff-d8e0b46b0e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd9e6d38f0>]}
[0m05:42:58.493909 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:42:58.497862 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:42:58.625098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9964e1b5-cd4d-4319-aaff-d8e0b46b0e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd9e71fcb0>]}
[0m05:42:58.626363 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m05:42:58.627552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9964e1b5-cd4d-4319-aaff-d8e0b46b0e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd9ce39d90>]}
[0m05:42:58.633737 [info ] [MainThread]: 
[0m05:42:58.635112 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:42:58.636229 [info ] [MainThread]: 
[0m05:42:58.638234 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:42:58.651443 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:42:58.749756 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:42:58.750670 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:42:58.751380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:42:58.771004 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.020 seconds
[0m05:42:58.773407 [debug] [ThreadPool]: On list_db: Close
[0m05:42:58.777409 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m05:42:58.790252 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:42:58.791073 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m05:42:58.792367 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:42:58.809333 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m05:42:58.810548 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:42:58.811464 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m05:42:58.874418 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.062 seconds
[0m05:42:58.878244 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m05:42:58.879925 [debug] [ThreadPool]: On list_db_dev: Close
[0m05:42:58.905378 [debug] [MainThread]: Using postgres connection "master"
[0m05:42:59.360293 [debug] [MainThread]: On master: BEGIN
[0m05:42:59.361576 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:42:59.382785 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m05:42:59.384314 [debug] [MainThread]: Using postgres connection "master"
[0m05:42:59.385535 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:42:59.393670 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m05:42:59.399533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9964e1b5-cd4d-4319-aaff-d8e0b46b0e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd9e6ffe60>]}
[0m05:42:59.401488 [debug] [MainThread]: On master: ROLLBACK
[0m05:42:59.403472 [debug] [MainThread]: Using postgres connection "master"
[0m05:42:59.404374 [debug] [MainThread]: On master: BEGIN
[0m05:42:59.406076 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:42:59.407122 [debug] [MainThread]: On master: COMMIT
[0m05:42:59.408209 [debug] [MainThread]: Using postgres connection "master"
[0m05:42:59.408896 [debug] [MainThread]: On master: COMMIT
[0m05:42:59.410389 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m05:42:59.411784 [debug] [MainThread]: On master: Close
[0m05:42:59.420779 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m05:42:59.422052 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m05:42:59.423029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m05:42:59.423800 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m05:42:59.438927 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m05:42:59.632920 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m05:42:59.707248 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m05:42:59.708648 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:42:59.709485 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m05:42:59.710147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:42:59.723577 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m05:42:59.724572 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:42:59.725370 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m05:42:59.738862 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m05:42:59.748834 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:42:59.749916 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m05:42:59.751540 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:42:59.755352 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:42:59.755886 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m05:42:59.757062 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:42:59.788173 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:42:59.788757 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:42:59.789392 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:43:01.372534 [debug] [Thread-1 (]: SQL status: COMMIT in 1.582 seconds
[0m05:43:01.391892 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m05:43:01.416566 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:43:01.419136 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m05:43:01.532424 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.111 seconds
[0m05:43:01.539312 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m05:43:01.546238 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9964e1b5-cd4d-4319-aaff-d8e0b46b0e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd9e953e60>]}
[0m05:43:01.549077 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 2.12s]
[0m05:43:01.554853 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m05:43:01.558042 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m05:43:01.559488 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m05:43:01.562284 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m05:43:01.564465 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m05:43:01.567032 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m05:43:01.568821 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m05:43:01.570365 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m05:43:01.576252 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m05:43:01.588347 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m05:43:01.597349 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m05:43:01.599991 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m05:43:01.601545 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m05:43:01.610725 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m05:43:01.620334 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m05:43:01.622645 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:43:01.623826 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:43:01.625037 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m05:43:01.626270 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m05:43:01.627541 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:43:01.628731 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:43:01.650049 [debug] [Thread-3 (]: SQL status: BEGIN in 0.021 seconds
[0m05:43:01.651398 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:43:01.653604 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m05:43:01.654809 [debug] [Thread-4 (]: SQL status: BEGIN in 0.027 seconds
[0m05:43:01.656076 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:43:01.657112 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m05:43:01.662500 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m05:43:01.670864 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.012 seconds
[0m05:43:01.675690 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:43:01.690484 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:43:01.693694 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m05:43:01.695620 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m05:43:01.698257 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:43:01.699737 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m05:43:01.728156 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:43:01.729540 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:43:01.730791 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m05:43:01.734794 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m05:43:01.738489 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:43:01.745681 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m05:43:01.744884 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:43:01.752070 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:43:01.754118 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:43:01.759675 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:43:01.757455 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:43:01.764019 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:43:01.956960 [debug] [Thread-4 (]: SQL status: COMMIT in 0.195 seconds
[0m05:43:01.979513 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m05:43:01.981054 [debug] [Thread-3 (]: SQL status: COMMIT in 0.215 seconds
[0m05:43:01.983452 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:43:01.989043 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m05:43:01.990515 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m05:43:01.992565 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:43:01.996270 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m05:43:02.002637 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.008 seconds
[0m05:43:02.005399 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m05:43:02.006663 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9964e1b5-cd4d-4319-aaff-d8e0b46b0e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd97d063c0>]}
[0m05:43:02.009141 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.012 seconds
[0m05:43:02.008195 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.44s]
[0m05:43:02.014602 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m05:43:02.015866 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m05:43:02.017787 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9964e1b5-cd4d-4319-aaff-d8e0b46b0e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd97de8a10>]}
[0m05:43:02.019447 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.45s]
[0m05:43:02.021157 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m05:43:02.024808 [debug] [MainThread]: Using postgres connection "master"
[0m05:43:02.025613 [debug] [MainThread]: On master: BEGIN
[0m05:43:02.026125 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:43:02.043764 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m05:43:02.044822 [debug] [MainThread]: On master: COMMIT
[0m05:43:02.046051 [debug] [MainThread]: Using postgres connection "master"
[0m05:43:02.046602 [debug] [MainThread]: On master: COMMIT
[0m05:43:02.047445 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:43:02.048320 [debug] [MainThread]: On master: Close
[0m05:43:02.050925 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:43:02.052075 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m05:43:02.053391 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m05:43:02.054860 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m05:43:02.056786 [info ] [MainThread]: 
[0m05:43:02.058286 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 3.42 seconds (3.42s).
[0m05:43:02.061214 [debug] [MainThread]: Command end result
[0m05:43:02.148844 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:43:02.153831 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:43:02.171015 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:43:02.172360 [info ] [MainThread]: 
[0m05:43:02.173760 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:43:02.174753 [info ] [MainThread]: 
[0m05:43:02.176794 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:43:02.179632 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.8536143, "process_in_blocks": "1600", "process_kernel_time": 1.071356, "process_mem_max_rss": "108208", "process_out_blocks": "3416", "process_user_time": 6.926093}
[0m05:43:02.181256 [debug] [MainThread]: Command `dbt run` succeeded at 05:43:02.180887 after 6.86 seconds
[0m05:43:02.182532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd9e9539e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd9f2a8080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd9f2a86b0>]}
[0m05:43:02.183615 [debug] [MainThread]: Flushing usage events
[0m05:43:03.626004 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:43:57.285253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5f0184ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5efb29fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5efb2b170>]}


============================== 05:43:57.307497 | 66eaac6a-d526-441c-a98c-5f894ea1f6af ==============================
[0m05:43:57.307497 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:43:57.308709 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m05:43:57.712267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66eaac6a-d526-441c-a98c-5f894ea1f6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5ef52b560>]}
[0m05:43:57.827978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66eaac6a-d526-441c-a98c-5f894ea1f6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5ef5517f0>]}
[0m05:43:57.829399 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:43:58.024981 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:43:58.308311 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:43:58.309252 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:43:58.405576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66eaac6a-d526-441c-a98c-5f894ea1f6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5edd84320>]}
[0m05:43:58.547368 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:43:58.553312 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:43:58.607692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66eaac6a-d526-441c-a98c-5f894ea1f6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5eda48590>]}
[0m05:43:58.608777 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m05:43:58.609703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66eaac6a-d526-441c-a98c-5f894ea1f6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5eda465d0>]}
[0m05:43:58.613884 [info ] [MainThread]: 
[0m05:43:58.614985 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:43:58.616234 [info ] [MainThread]: 
[0m05:43:58.617933 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:43:58.628234 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:43:58.707210 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:43:58.707920 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:43:58.708825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:43:58.729615 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.021 seconds
[0m05:43:58.731718 [debug] [ThreadPool]: On list_db: Close
[0m05:43:58.734735 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m05:43:58.743832 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:43:58.744853 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m05:43:58.745456 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:43:58.759592 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m05:43:58.760517 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:43:58.761752 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m05:43:58.771085 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m05:43:58.774666 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m05:43:58.775878 [debug] [ThreadPool]: On list_db_dev: Close
[0m05:43:58.788236 [debug] [MainThread]: Using postgres connection "master"
[0m05:43:58.789115 [debug] [MainThread]: On master: BEGIN
[0m05:43:58.789871 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:43:58.803934 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m05:43:58.805109 [debug] [MainThread]: Using postgres connection "master"
[0m05:43:58.806975 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:43:58.811897 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m05:43:58.814847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66eaac6a-d526-441c-a98c-5f894ea1f6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5f13b85f0>]}
[0m05:43:58.815906 [debug] [MainThread]: On master: ROLLBACK
[0m05:43:58.817591 [debug] [MainThread]: Using postgres connection "master"
[0m05:43:58.818983 [debug] [MainThread]: On master: BEGIN
[0m05:43:58.820720 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:43:58.821923 [debug] [MainThread]: On master: COMMIT
[0m05:43:58.823100 [debug] [MainThread]: Using postgres connection "master"
[0m05:43:58.823665 [debug] [MainThread]: On master: COMMIT
[0m05:43:58.824529 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:43:58.825095 [debug] [MainThread]: On master: Close
[0m05:43:58.831053 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m05:43:58.832256 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m05:43:58.833067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m05:43:58.833973 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m05:43:58.848247 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m05:43:58.849223 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m05:43:58.919811 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m05:43:58.921019 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:43:58.921783 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m05:43:58.922312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:43:58.936109 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m05:43:58.937396 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:43:58.938396 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m05:43:58.945736 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m05:43:58.956715 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:43:58.957369 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m05:43:58.958709 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:43:58.966918 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:43:58.968189 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m05:43:58.969889 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:43:59.008330 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:43:59.009124 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:43:59.009982 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:43:59.016525 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m05:43:59.029769 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m05:43:59.041799 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:43:59.042685 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m05:43:59.049967 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m05:43:59.054195 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m05:43:59.057179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66eaac6a-d526-441c-a98c-5f894ea1f6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5edd42f60>]}
[0m05:43:59.058528 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.22s]
[0m05:43:59.060002 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m05:43:59.062480 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m05:43:59.063231 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m05:43:59.064302 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m05:43:59.065703 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m05:43:59.067126 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m05:43:59.068024 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m05:43:59.068822 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m05:43:59.069601 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m05:43:59.074472 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m05:43:59.079684 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m05:43:59.081837 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m05:43:59.083094 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m05:43:59.088814 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m05:43:59.095077 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m05:43:59.096757 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:43:59.097589 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m05:43:59.098430 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:43:59.099613 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:43:59.100670 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m05:43:59.102198 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:43:59.118719 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m05:43:59.119909 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:43:59.120686 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m05:43:59.121953 [debug] [Thread-4 (]: SQL status: BEGIN in 0.020 seconds
[0m05:43:59.123364 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:43:59.124684 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m05:43:59.130314 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m05:43:59.131680 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m05:43:59.141603 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:43:59.149550 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:43:59.150663 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m05:43:59.151769 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m05:43:59.153704 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:43:59.154767 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m05:43:59.160095 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:43:59.165085 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:43:59.165914 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m05:43:59.166771 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m05:43:59.168338 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:43:59.169295 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:43:59.173097 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:43:59.177683 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:43:59.178939 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:43:59.179838 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:43:59.180660 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:43:59.181351 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:43:59.186893 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m05:43:59.190521 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m05:43:59.191309 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m05:43:59.193100 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:43:59.198454 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m05:43:59.199650 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m05:43:59.201177 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:43:59.202461 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m05:43:59.208309 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m05:43:59.210682 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m05:43:59.212020 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66eaac6a-d526-441c-a98c-5f894ea1f6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5eccc9cd0>]}
[0m05:43:59.212807 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.009 seconds
[0m05:43:59.214605 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.14s]
[0m05:43:59.217451 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m05:43:59.218517 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m05:43:59.219909 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66eaac6a-d526-441c-a98c-5f894ea1f6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5eccc8bc0>]}
[0m05:43:59.221296 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.15s]
[0m05:43:59.222561 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m05:43:59.226171 [debug] [MainThread]: Using postgres connection "master"
[0m05:43:59.226856 [debug] [MainThread]: On master: BEGIN
[0m05:43:59.227347 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:43:59.239487 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m05:43:59.240627 [debug] [MainThread]: On master: COMMIT
[0m05:43:59.241673 [debug] [MainThread]: Using postgres connection "master"
[0m05:43:59.242337 [debug] [MainThread]: On master: COMMIT
[0m05:43:59.243141 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:43:59.243713 [debug] [MainThread]: On master: Close
[0m05:43:59.244503 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:43:59.244972 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m05:43:59.245473 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m05:43:59.245949 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m05:43:59.246742 [info ] [MainThread]: 
[0m05:43:59.247579 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m05:43:59.251099 [debug] [MainThread]: Command end result
[0m05:43:59.291284 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:43:59.294229 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:43:59.305301 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:43:59.306379 [info ] [MainThread]: 
[0m05:43:59.307301 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:43:59.308355 [info ] [MainThread]: 
[0m05:43:59.309383 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:43:59.311759 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1136231, "process_in_blocks": "640", "process_kernel_time": 0.51875, "process_mem_max_rss": "108224", "process_out_blocks": "3408", "process_user_time": 3.672009}
[0m05:43:59.312546 [debug] [MainThread]: Command `dbt run` succeeded at 05:43:59.312364 after 2.11 seconds
[0m05:43:59.313179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5ef7a7f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5ef5e83b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5f0184ef0>]}
[0m05:43:59.313733 [debug] [MainThread]: Flushing usage events
[0m05:44:00.727525 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:44:58.194168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b87bb5de80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b87a9eedb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b879f396a0>]}


============================== 05:44:58.283985 | 6db9cc8d-f43e-401d-aa9c-81ba51e5eb39 ==============================
[0m05:44:58.283985 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:44:58.286788 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:44:58.684535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6db9cc8d-f43e-401d-aa9c-81ba51e5eb39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b879cbb4a0>]}
[0m05:44:58.788968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6db9cc8d-f43e-401d-aa9c-81ba51e5eb39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b87a00b320>]}
[0m05:44:58.790496 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:44:58.962868 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:44:59.124175 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:44:59.124653 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:44:59.183030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6db9cc8d-f43e-401d-aa9c-81ba51e5eb39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b87849d190>]}
[0m05:44:59.285033 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:44:59.288736 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:44:59.319972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6db9cc8d-f43e-401d-aa9c-81ba51e5eb39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b8783a4530>]}
[0m05:44:59.320624 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m05:44:59.321279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6db9cc8d-f43e-401d-aa9c-81ba51e5eb39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b8781e8e90>]}
[0m05:44:59.324442 [info ] [MainThread]: 
[0m05:44:59.325532 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:44:59.326598 [info ] [MainThread]: 
[0m05:44:59.327808 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:44:59.335918 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:44:59.413607 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:44:59.414607 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:44:59.415321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:44:59.435439 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.020 seconds
[0m05:44:59.437053 [debug] [ThreadPool]: On list_db: Close
[0m05:44:59.439545 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m05:44:59.447508 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:44:59.447990 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m05:44:59.448356 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:44:59.461064 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m05:44:59.461890 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:44:59.462608 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m05:44:59.476826 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.013 seconds
[0m05:44:59.479457 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m05:44:59.480666 [debug] [ThreadPool]: On list_db_dev: Close
[0m05:44:59.488042 [debug] [MainThread]: Using postgres connection "master"
[0m05:44:59.488535 [debug] [MainThread]: On master: BEGIN
[0m05:44:59.489025 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:44:59.510238 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m05:44:59.511158 [debug] [MainThread]: Using postgres connection "master"
[0m05:44:59.512197 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:44:59.528064 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m05:44:59.529964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6db9cc8d-f43e-401d-aa9c-81ba51e5eb39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b879c8b4d0>]}
[0m05:44:59.530767 [debug] [MainThread]: On master: ROLLBACK
[0m05:44:59.531795 [debug] [MainThread]: Using postgres connection "master"
[0m05:44:59.532414 [debug] [MainThread]: On master: BEGIN
[0m05:44:59.534678 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:44:59.535997 [debug] [MainThread]: On master: COMMIT
[0m05:44:59.537095 [debug] [MainThread]: Using postgres connection "master"
[0m05:44:59.537660 [debug] [MainThread]: On master: COMMIT
[0m05:44:59.538819 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m05:44:59.539318 [debug] [MainThread]: On master: Close
[0m05:44:59.547110 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m05:44:59.548177 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m05:44:59.549166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m05:44:59.550202 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m05:44:59.561458 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m05:44:59.562569 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m05:44:59.635536 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m05:44:59.636643 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:44:59.637209 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m05:44:59.637863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:44:59.670061 [debug] [Thread-1 (]: SQL status: BEGIN in 0.032 seconds
[0m05:44:59.671451 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:44:59.672672 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m05:44:59.751744 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.078 seconds
[0m05:44:59.771645 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:44:59.772783 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m05:44:59.774836 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:44:59.784294 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:44:59.785347 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m05:44:59.787377 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:44:59.856890 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:44:59.857841 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:44:59.858399 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:45:01.668208 [debug] [Thread-1 (]: SQL status: COMMIT in 1.809 seconds
[0m05:45:01.686752 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m05:45:01.695592 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:45:01.696176 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m05:45:02.296323 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.599 seconds
[0m05:45:02.304179 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m05:45:02.310409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6db9cc8d-f43e-401d-aa9c-81ba51e5eb39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b87a7f23f0>]}
[0m05:45:02.313017 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 2.76s]
[0m05:45:02.316500 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m05:45:02.320241 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m05:45:02.321470 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m05:45:02.323305 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m05:45:02.325188 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m05:45:02.327639 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m05:45:02.329275 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m05:45:02.330696 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m05:45:02.331990 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m05:45:02.340032 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m05:45:02.348213 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m05:45:02.350326 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m05:45:02.351408 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m05:45:02.359575 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m05:45:02.368213 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m05:45:02.370761 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:45:02.371851 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:45:02.372540 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m05:45:02.373314 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m05:45:02.374181 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:45:02.374950 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:45:02.391595 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m05:45:02.392672 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m05:45:02.393565 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:45:02.394655 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:45:02.395659 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m05:45:02.396483 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m05:45:02.401623 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m05:45:02.408491 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m05:45:02.407912 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:45:02.412422 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:45:02.413131 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m05:45:02.413874 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m05:45:02.415258 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:45:02.415790 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:45:02.419996 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:45:02.423915 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:45:02.424583 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m05:45:02.425189 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m05:45:02.426458 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:45:02.427024 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:45:02.429161 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:45:02.431258 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:45:02.432046 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:45:02.432733 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:45:02.433488 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:45:02.434327 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:45:02.562525 [debug] [Thread-4 (]: SQL status: COMMIT in 0.127 seconds
[0m05:45:02.571704 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m05:45:02.573635 [debug] [Thread-3 (]: SQL status: COMMIT in 0.138 seconds
[0m05:45:02.576935 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:45:02.588335 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m05:45:02.590793 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m05:45:02.594151 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:45:02.596459 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m05:45:02.607110 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.011 seconds
[0m05:45:02.610400 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m05:45:02.611246 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.013 seconds
[0m05:45:02.612616 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6db9cc8d-f43e-401d-aa9c-81ba51e5eb39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b877396ff0>]}
[0m05:45:02.615867 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m05:45:02.617476 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.28s]
[0m05:45:02.619879 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m05:45:02.621118 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6db9cc8d-f43e-401d-aa9c-81ba51e5eb39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b8772fe390>]}
[0m05:45:02.623132 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.29s]
[0m05:45:02.624469 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m05:45:02.629451 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:02.630414 [debug] [MainThread]: On master: BEGIN
[0m05:45:02.631169 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:45:02.650554 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m05:45:02.651916 [debug] [MainThread]: On master: COMMIT
[0m05:45:02.653016 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:02.653830 [debug] [MainThread]: On master: COMMIT
[0m05:45:02.655078 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:45:02.655886 [debug] [MainThread]: On master: Close
[0m05:45:02.656999 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:45:02.657792 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m05:45:02.658441 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m05:45:02.659178 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m05:45:02.660312 [info ] [MainThread]: 
[0m05:45:02.661346 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 3.33 seconds (3.33s).
[0m05:45:02.664941 [debug] [MainThread]: Command end result
[0m05:45:02.710089 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:45:02.712290 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:45:02.720160 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:45:02.720647 [info ] [MainThread]: 
[0m05:45:02.721448 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:45:02.722908 [info ] [MainThread]: 
[0m05:45:02.723923 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:45:02.726272 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.61075, "process_in_blocks": "1688", "process_kernel_time": 0.606658, "process_mem_max_rss": "108232", "process_out_blocks": "3400", "process_user_time": 2.909712}
[0m05:45:02.727205 [debug] [MainThread]: Command `dbt run` succeeded at 05:45:02.727048 after 4.61 seconds
[0m05:45:02.727702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b87a120da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b87a51c5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b87a51f440>]}
[0m05:45:02.728197 [debug] [MainThread]: Flushing usage events
[0m05:45:04.240558 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:45:57.435788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc38761ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc372d0bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc368f3b00>]}


============================== 05:45:57.447393 | c92706cc-d892-4c4d-99ea-b9154866e021 ==============================
[0m05:45:57.447393 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:45:57.448522 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:45:57.797485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c92706cc-d892-4c4d-99ea-b9154866e021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc3863b080>]}
[0m05:45:57.916192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c92706cc-d892-4c4d-99ea-b9154866e021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc3696db80>]}
[0m05:45:57.917462 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:45:58.102066 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:45:58.392919 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:45:58.393430 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:45:58.467748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c92706cc-d892-4c4d-99ea-b9154866e021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc34e8f770>]}
[0m05:45:58.622047 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:45:58.627180 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:45:58.673804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c92706cc-d892-4c4d-99ea-b9154866e021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc34b94740>]}
[0m05:45:58.674618 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m05:45:58.675284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c92706cc-d892-4c4d-99ea-b9154866e021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc34b733e0>]}
[0m05:45:58.678152 [info ] [MainThread]: 
[0m05:45:58.679305 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:45:58.681511 [info ] [MainThread]: 
[0m05:45:58.683254 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:45:58.691486 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:45:58.784830 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:45:58.785340 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:45:58.786002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:45:58.809050 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.023 seconds
[0m05:45:58.811556 [debug] [ThreadPool]: On list_db: Close
[0m05:45:58.814924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m05:45:58.828567 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:45:58.829620 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m05:45:58.830954 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:45:58.848778 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m05:45:58.850173 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:45:58.851158 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m05:45:58.856642 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m05:45:58.861819 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m05:45:58.863698 [debug] [ThreadPool]: On list_db_dev: Close
[0m05:45:58.876634 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:58.881193 [debug] [MainThread]: On master: BEGIN
[0m05:45:58.881770 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:45:58.900467 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m05:45:58.902235 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:58.902969 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:45:58.910703 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m05:45:58.916642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c92706cc-d892-4c4d-99ea-b9154866e021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc34b90620>]}
[0m05:45:58.918487 [debug] [MainThread]: On master: ROLLBACK
[0m05:45:58.920066 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:58.921113 [debug] [MainThread]: On master: BEGIN
[0m05:45:58.922666 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:45:58.923525 [debug] [MainThread]: On master: COMMIT
[0m05:45:58.924106 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:58.924710 [debug] [MainThread]: On master: COMMIT
[0m05:45:58.926241 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m05:45:58.926968 [debug] [MainThread]: On master: Close
[0m05:45:58.932976 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m05:45:58.934775 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m05:45:58.936279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m05:45:58.938544 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m05:45:58.956417 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m05:45:58.958053 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m05:45:59.047279 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m05:45:59.049294 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:45:59.050146 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m05:45:59.050711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:45:59.067239 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m05:45:59.069086 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:45:59.070202 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m05:45:59.079755 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m05:45:59.097390 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:45:59.099470 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m05:45:59.100833 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:45:59.105934 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:45:59.106594 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m05:45:59.107948 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:45:59.157266 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:45:59.158235 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:45:59.158948 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:45:59.165085 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m05:45:59.179300 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m05:45:59.192988 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:45:59.194372 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m05:45:59.200629 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m05:45:59.206570 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m05:45:59.209212 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c92706cc-d892-4c4d-99ea-b9154866e021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc37226330>]}
[0m05:45:59.210751 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.27s]
[0m05:45:59.212311 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m05:45:59.214763 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m05:45:59.215575 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m05:45:59.216598 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m05:45:59.218003 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m05:45:59.219391 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m05:45:59.220433 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m05:45:59.222580 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m05:45:59.223461 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m05:45:59.227698 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m05:45:59.232096 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m05:45:59.234344 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m05:45:59.235820 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m05:45:59.244195 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m05:45:59.250537 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m05:45:59.252051 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:45:59.252765 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:45:59.253491 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m05:45:59.254517 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m05:45:59.255414 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:45:59.256503 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:45:59.274477 [debug] [Thread-4 (]: SQL status: BEGIN in 0.018 seconds
[0m05:45:59.277081 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:45:59.278506 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m05:45:59.279740 [debug] [Thread-3 (]: SQL status: BEGIN in 0.024 seconds
[0m05:45:59.280990 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:45:59.282236 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m05:45:59.285537 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m05:45:59.292683 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:45:59.296301 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.012 seconds
[0m05:45:59.299641 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m05:45:59.306149 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:45:59.308337 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m05:45:59.309048 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:45:59.315866 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m05:45:59.317066 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:45:59.321867 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:45:59.322739 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m05:45:59.323412 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m05:45:59.324668 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:45:59.325234 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:45:59.327601 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:45:59.332778 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:45:59.333723 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:45:59.334537 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:45:59.335197 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:45:59.335869 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:45:59.342449 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m05:45:59.346193 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m05:45:59.346950 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m05:45:59.348541 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:45:59.352636 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m05:45:59.353519 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m05:45:59.354724 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:45:59.355521 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m05:45:59.361346 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m05:45:59.363687 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m05:45:59.365062 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c92706cc-d892-4c4d-99ea-b9154866e021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc2fd2e390>]}
[0m05:45:59.367271 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.011 seconds
[0m05:45:59.369183 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.14s]
[0m05:45:59.372614 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m05:45:59.374871 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m05:45:59.376683 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c92706cc-d892-4c4d-99ea-b9154866e021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc2fd2cc80>]}
[0m05:45:59.377925 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.16s]
[0m05:45:59.378999 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m05:45:59.382327 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:59.383680 [debug] [MainThread]: On master: BEGIN
[0m05:45:59.386276 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:45:59.405051 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m05:45:59.406264 [debug] [MainThread]: On master: COMMIT
[0m05:45:59.406815 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:59.407474 [debug] [MainThread]: On master: COMMIT
[0m05:45:59.408364 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:45:59.408986 [debug] [MainThread]: On master: Close
[0m05:45:59.409777 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:45:59.410322 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m05:45:59.410784 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m05:45:59.411301 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m05:45:59.411954 [info ] [MainThread]: 
[0m05:45:59.413239 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m05:45:59.417894 [debug] [MainThread]: Command end result
[0m05:45:59.476716 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:45:59.480004 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:45:59.490667 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:45:59.492053 [info ] [MainThread]: 
[0m05:45:59.493744 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:45:59.495370 [info ] [MainThread]: 
[0m05:45:59.497554 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:45:59.500459 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1537993, "process_in_blocks": "2704", "process_kernel_time": 0.580469, "process_mem_max_rss": "108284", "process_out_blocks": "3400", "process_user_time": 3.895765}
[0m05:45:59.501975 [debug] [MainThread]: Command `dbt run` succeeded at 05:45:59.501654 after 2.16 seconds
[0m05:45:59.503013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc39e9e900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc36f018e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc38761ac0>]}
[0m05:45:59.504043 [debug] [MainThread]: Flushing usage events
[0m05:46:01.011225 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:46:57.189722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798258e9df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798257712840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798257ce7fe0>]}


============================== 05:46:57.197790 | a8d19987-9d15-4ef1-8ca3-687473c9626d ==============================
[0m05:46:57.197790 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:46:57.198972 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:46:57.492109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8d19987-9d15-4ef1-8ca3-687473c9626d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7982573581a0>]}
[0m05:46:57.572457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8d19987-9d15-4ef1-8ca3-687473c9626d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7982570d4d10>]}
[0m05:46:57.573528 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:46:57.707498 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:46:57.869935 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:46:57.870500 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:46:57.916879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8d19987-9d15-4ef1-8ca3-687473c9626d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798255795160>]}
[0m05:46:58.030171 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:46:58.034174 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:46:58.070322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8d19987-9d15-4ef1-8ca3-687473c9626d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79825758aa20>]}
[0m05:46:58.070975 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m05:46:58.071681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8d19987-9d15-4ef1-8ca3-687473c9626d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7982557cf6e0>]}
[0m05:46:58.075076 [info ] [MainThread]: 
[0m05:46:58.076215 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:46:58.077391 [info ] [MainThread]: 
[0m05:46:58.079409 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:46:58.086327 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:46:58.146792 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:46:58.147282 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:46:58.147711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:46:58.162165 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m05:46:58.163868 [debug] [ThreadPool]: On list_db: Close
[0m05:46:58.166468 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m05:46:58.173992 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:46:58.174535 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m05:46:58.174942 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:46:58.186394 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m05:46:58.187454 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:46:58.188431 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m05:46:58.193048 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m05:46:58.194921 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m05:46:58.195903 [debug] [ThreadPool]: On list_db_dev: Close
[0m05:46:58.206875 [debug] [MainThread]: Using postgres connection "master"
[0m05:46:58.207442 [debug] [MainThread]: On master: BEGIN
[0m05:46:58.207901 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:46:58.222903 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m05:46:58.223877 [debug] [MainThread]: Using postgres connection "master"
[0m05:46:58.224945 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:46:58.229771 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m05:46:58.232013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8d19987-9d15-4ef1-8ca3-687473c9626d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7982554b4050>]}
[0m05:46:58.233041 [debug] [MainThread]: On master: ROLLBACK
[0m05:46:58.234269 [debug] [MainThread]: Using postgres connection "master"
[0m05:46:58.234810 [debug] [MainThread]: On master: BEGIN
[0m05:46:58.236400 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:46:58.237417 [debug] [MainThread]: On master: COMMIT
[0m05:46:58.238290 [debug] [MainThread]: Using postgres connection "master"
[0m05:46:58.248071 [debug] [MainThread]: On master: COMMIT
[0m05:46:58.249248 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:46:58.250132 [debug] [MainThread]: On master: Close
[0m05:46:58.256940 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m05:46:58.258452 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m05:46:58.259798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m05:46:58.260782 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m05:46:58.293221 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m05:46:58.294811 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m05:46:58.389620 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m05:46:58.391061 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:46:58.392239 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m05:46:58.392820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:46:58.405995 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m05:46:58.407188 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:46:58.407915 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m05:46:58.412097 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m05:46:58.421451 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:46:58.422202 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m05:46:58.423537 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:46:58.428079 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:46:58.429243 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m05:46:58.430888 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:46:58.458652 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:46:58.459235 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:46:58.459704 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:46:58.465041 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m05:46:58.476956 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m05:46:58.484304 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:46:58.484762 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m05:46:58.491797 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m05:46:58.494760 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m05:46:58.496822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8d19987-9d15-4ef1-8ca3-687473c9626d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798258f5a570>]}
[0m05:46:58.497664 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.24s]
[0m05:46:58.498865 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m05:46:58.500604 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m05:46:58.501246 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m05:46:58.502097 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m05:46:58.503345 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m05:46:58.504595 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m05:46:58.505691 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m05:46:58.506623 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m05:46:58.507502 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m05:46:58.513904 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m05:46:58.519064 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m05:46:58.520611 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m05:46:58.525103 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m05:46:58.525672 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m05:46:58.530162 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m05:46:58.531072 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:46:58.531765 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m05:46:58.532234 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:46:58.532745 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:46:58.533712 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m05:46:58.534500 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:46:58.546708 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m05:46:58.548541 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:46:58.549655 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m05:46:58.550682 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m05:46:58.551425 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:46:58.552570 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m05:46:58.557191 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m05:46:58.558100 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m05:46:58.563754 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:46:58.568032 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:46:58.568797 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m05:46:58.569452 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m05:46:58.570914 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:46:58.571452 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:46:58.574916 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:46:58.578408 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:46:58.579108 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m05:46:58.580047 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m05:46:58.582343 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:46:58.583099 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m05:46:58.585243 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:46:58.587324 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:46:58.588030 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:46:58.588769 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:46:58.589577 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:46:58.590414 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:46:58.596522 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m05:46:58.600787 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m05:46:58.601350 [debug] [Thread-4 (]: SQL status: COMMIT in 0.010 seconds
[0m05:46:58.602325 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:46:58.605025 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m05:46:58.605865 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m05:46:58.606965 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:46:58.607866 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m05:46:58.613944 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m05:46:58.616414 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m05:46:58.617470 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8d19987-9d15-4ef1-8ca3-687473c9626d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798254567fe0>]}
[0m05:46:58.618136 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.010 seconds
[0m05:46:58.619463 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.11s]
[0m05:46:58.622198 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m05:46:58.623230 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m05:46:58.624290 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8d19987-9d15-4ef1-8ca3-687473c9626d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798254716210>]}
[0m05:46:58.625716 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.12s]
[0m05:46:58.627085 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m05:46:58.631247 [debug] [MainThread]: Using postgres connection "master"
[0m05:46:58.631740 [debug] [MainThread]: On master: BEGIN
[0m05:46:58.632182 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:46:58.644444 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m05:46:58.645341 [debug] [MainThread]: On master: COMMIT
[0m05:46:58.646427 [debug] [MainThread]: Using postgres connection "master"
[0m05:46:58.647100 [debug] [MainThread]: On master: COMMIT
[0m05:46:58.647912 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:46:58.648426 [debug] [MainThread]: On master: Close
[0m05:46:58.649185 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:46:58.649644 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m05:46:58.650248 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m05:46:58.650774 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m05:46:58.651371 [info ] [MainThread]: 
[0m05:46:58.652103 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m05:46:58.655179 [debug] [MainThread]: Command end result
[0m05:46:58.689817 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:46:58.692533 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:46:58.700524 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:46:58.701010 [info ] [MainThread]: 
[0m05:46:58.701737 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:46:58.702798 [info ] [MainThread]: 
[0m05:46:58.703670 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:46:58.705572 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5854031, "process_in_blocks": "0", "process_kernel_time": 0.480236, "process_mem_max_rss": "108364", "process_out_blocks": "3400", "process_user_time": 2.795796}
[0m05:46:58.706499 [debug] [MainThread]: Command `dbt run` succeeded at 05:46:58.706356 after 1.59 seconds
[0m05:46:58.706997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79825837fcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79825701bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7982545a81d0>]}
[0m05:46:58.707584 [debug] [MainThread]: Flushing usage events
[0m05:47:00.177573 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:47:57.251352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f9becd2720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f9bd888da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f9bd88aff0>]}


============================== 05:47:57.260744 | 4d150ae4-9825-4d18-8f85-abfde7c5201c ==============================
[0m05:47:57.260744 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:47:57.261748 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:47:57.613249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d150ae4-9825-4d18-8f85-abfde7c5201c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f9bcc56ba0>]}
[0m05:47:57.731832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d150ae4-9825-4d18-8f85-abfde7c5201c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f9bcca4d10>]}
[0m05:47:57.732895 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:47:57.888993 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:47:58.072693 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:47:58.073188 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:47:58.147509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d150ae4-9825-4d18-8f85-abfde7c5201c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f9bb429f10>]}
[0m05:47:58.262843 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:47:58.266066 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:47:58.305378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d150ae4-9825-4d18-8f85-abfde7c5201c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f9bb12b590>]}
[0m05:47:58.306112 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m05:47:58.306717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d150ae4-9825-4d18-8f85-abfde7c5201c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f9bceabb30>]}
[0m05:47:58.310492 [info ] [MainThread]: 
[0m05:47:58.311355 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:47:58.312059 [info ] [MainThread]: 
[0m05:47:58.313151 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:47:58.323034 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:47:58.393247 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:47:58.393896 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:47:58.394403 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:47:58.409844 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m05:47:58.411813 [debug] [ThreadPool]: On list_db: Close
[0m05:47:58.414032 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m05:47:58.423535 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:47:58.424037 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m05:47:58.424506 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:47:58.439163 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m05:47:58.439943 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:47:58.440987 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m05:47:58.447275 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m05:47:58.450402 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m05:47:58.451308 [debug] [ThreadPool]: On list_db_dev: Close
[0m05:47:58.465378 [debug] [MainThread]: Using postgres connection "master"
[0m05:47:58.466417 [debug] [MainThread]: On master: BEGIN
[0m05:47:58.467379 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:47:58.483035 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m05:47:58.483980 [debug] [MainThread]: Using postgres connection "master"
[0m05:47:58.485091 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:47:58.492868 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m05:47:58.496278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d150ae4-9825-4d18-8f85-abfde7c5201c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f9bb445610>]}
[0m05:47:58.496905 [debug] [MainThread]: On master: ROLLBACK
[0m05:47:58.497853 [debug] [MainThread]: Using postgres connection "master"
[0m05:47:58.498255 [debug] [MainThread]: On master: BEGIN
[0m05:47:58.499649 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:47:58.500363 [debug] [MainThread]: On master: COMMIT
[0m05:47:58.501096 [debug] [MainThread]: Using postgres connection "master"
[0m05:47:58.501747 [debug] [MainThread]: On master: COMMIT
[0m05:47:58.504005 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m05:47:58.505236 [debug] [MainThread]: On master: Close
[0m05:47:58.511592 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m05:47:58.512637 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m05:47:58.513475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m05:47:58.514250 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m05:47:58.527939 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m05:47:58.528734 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m05:47:58.590781 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m05:47:58.591744 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:47:58.592266 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m05:47:58.592710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:47:58.606097 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m05:47:58.606883 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:47:58.607780 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m05:47:58.613429 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m05:47:58.624671 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:47:58.625517 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m05:47:58.627028 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:47:58.630745 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:47:58.631225 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m05:47:58.632143 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:47:58.664150 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:47:58.664667 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:47:58.665132 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:47:58.705426 [debug] [Thread-1 (]: SQL status: COMMIT in 0.040 seconds
[0m05:47:58.718256 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m05:47:58.729896 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:47:58.730745 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m05:47:58.737911 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m05:47:58.746480 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m05:47:58.749563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d150ae4-9825-4d18-8f85-abfde7c5201c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f9bd7da120>]}
[0m05:47:58.750815 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.23s]
[0m05:47:58.753325 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m05:47:58.756481 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m05:47:58.757277 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m05:47:58.758179 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m05:47:58.759176 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m05:47:58.760381 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m05:47:58.760997 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m05:47:58.761614 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m05:47:58.762160 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m05:47:58.766148 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m05:47:58.770357 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m05:47:58.771637 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m05:47:58.772114 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m05:47:58.776216 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m05:47:58.779869 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m05:47:58.781186 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:47:58.781834 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:47:58.782385 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m05:47:58.782913 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m05:47:58.783495 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:47:58.784002 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:47:58.797297 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m05:47:58.798594 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m05:47:58.799843 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:47:58.800996 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:47:58.801752 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m05:47:58.802814 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m05:47:58.807454 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m05:47:58.812690 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:47:58.813309 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.010 seconds
[0m05:47:58.813933 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m05:47:58.818274 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:47:58.820008 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m05:47:58.820893 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:47:58.825646 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:47:58.826617 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m05:47:58.827787 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m05:47:58.831995 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:47:58.833727 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m05:47:58.834584 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:47:58.841416 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m05:47:58.843216 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:47:58.846128 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:47:58.847041 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:47:58.848201 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:47:58.849476 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:47:58.850445 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:47:58.857478 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m05:47:58.861377 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m05:47:58.862225 [debug] [Thread-3 (]: SQL status: COMMIT in 0.011 seconds
[0m05:47:58.863555 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:47:58.867048 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m05:47:58.867861 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m05:47:58.869917 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:47:58.870983 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m05:47:58.876612 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m05:47:58.878831 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m05:47:58.880000 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d150ae4-9825-4d18-8f85-abfde7c5201c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f9ba2e4260>]}
[0m05:47:58.880755 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.009 seconds
[0m05:47:58.881791 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.12s]
[0m05:47:58.884507 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m05:47:58.885715 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m05:47:58.887444 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d150ae4-9825-4d18-8f85-abfde7c5201c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f9ba3cfc20>]}
[0m05:47:58.888643 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.13s]
[0m05:47:58.889812 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m05:47:58.893328 [debug] [MainThread]: Using postgres connection "master"
[0m05:47:58.894145 [debug] [MainThread]: On master: BEGIN
[0m05:47:58.894815 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:47:58.908750 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m05:47:58.909588 [debug] [MainThread]: On master: COMMIT
[0m05:47:58.910402 [debug] [MainThread]: Using postgres connection "master"
[0m05:47:58.911373 [debug] [MainThread]: On master: COMMIT
[0m05:47:58.912440 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:47:58.913085 [debug] [MainThread]: On master: Close
[0m05:47:58.914126 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:47:58.914824 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m05:47:58.915459 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m05:47:58.916188 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m05:47:58.917138 [info ] [MainThread]: 
[0m05:47:58.919512 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m05:47:58.922086 [debug] [MainThread]: Command end result
[0m05:47:58.982915 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:47:58.987150 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:47:59.003370 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:47:59.004325 [info ] [MainThread]: 
[0m05:47:59.005441 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:47:59.006355 [info ] [MainThread]: 
[0m05:47:59.007134 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:47:59.009377 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8324997, "process_in_blocks": "0", "process_kernel_time": 0.538044, "process_mem_max_rss": "108228", "process_out_blocks": "3400", "process_user_time": 3.280078}
[0m05:47:59.010863 [debug] [MainThread]: Command `dbt run` succeeded at 05:47:59.010497 after 1.83 seconds
[0m05:47:59.011635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f9bd10db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f9bb3d3320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f9bb3d0650>]}
[0m05:47:59.012545 [debug] [MainThread]: Flushing usage events
[0m05:48:00.371995 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:48:56.918912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e9b955ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e99b0ba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e99bbcf50>]}


============================== 05:48:56.926485 | 792503cf-ed31-4b96-87ac-3ca6a9346bf5 ==============================
[0m05:48:56.926485 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:48:56.927421 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:48:57.193912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '792503cf-ed31-4b96-87ac-3ca6a9346bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e9986b770>]}
[0m05:48:57.354493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '792503cf-ed31-4b96-87ac-3ca6a9346bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e99907ec0>]}
[0m05:48:57.357390 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:48:57.531922 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:48:57.691368 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:48:57.691865 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:48:57.740550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '792503cf-ed31-4b96-87ac-3ca6a9346bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e980a48f0>]}
[0m05:48:57.856175 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:48:57.859286 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:48:57.898128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '792503cf-ed31-4b96-87ac-3ca6a9346bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e980e00e0>]}
[0m05:48:57.899021 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m05:48:57.899851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '792503cf-ed31-4b96-87ac-3ca6a9346bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e97d828d0>]}
[0m05:48:57.903042 [info ] [MainThread]: 
[0m05:48:57.903919 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:48:57.904678 [info ] [MainThread]: 
[0m05:48:57.906039 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:48:57.913647 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:48:57.973432 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:48:57.974035 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:48:57.974774 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:48:57.989150 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m05:48:57.991055 [debug] [ThreadPool]: On list_db: Close
[0m05:48:57.993607 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m05:48:58.001517 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:48:58.002137 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m05:48:58.002548 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:48:58.014333 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m05:48:58.015236 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:48:58.016246 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m05:48:58.020455 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m05:48:58.022750 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m05:48:58.024075 [debug] [ThreadPool]: On list_db_dev: Close
[0m05:48:58.035784 [debug] [MainThread]: Using postgres connection "master"
[0m05:48:58.036441 [debug] [MainThread]: On master: BEGIN
[0m05:48:58.037013 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:48:58.051483 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m05:48:58.052470 [debug] [MainThread]: Using postgres connection "master"
[0m05:48:58.053425 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:48:58.058678 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m05:48:58.062306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '792503cf-ed31-4b96-87ac-3ca6a9346bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e980a5280>]}
[0m05:48:58.063026 [debug] [MainThread]: On master: ROLLBACK
[0m05:48:58.063855 [debug] [MainThread]: Using postgres connection "master"
[0m05:48:58.064326 [debug] [MainThread]: On master: BEGIN
[0m05:48:58.066107 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:48:58.067204 [debug] [MainThread]: On master: COMMIT
[0m05:48:58.068340 [debug] [MainThread]: Using postgres connection "master"
[0m05:48:58.069020 [debug] [MainThread]: On master: COMMIT
[0m05:48:58.070075 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:48:58.070913 [debug] [MainThread]: On master: Close
[0m05:48:58.077156 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m05:48:58.078078 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m05:48:58.078905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m05:48:58.079494 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m05:48:58.092122 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m05:48:58.093325 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m05:48:58.170799 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m05:48:58.171822 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:48:58.172296 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m05:48:58.172702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:48:58.188645 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m05:48:58.189831 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:48:58.191126 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m05:48:58.197590 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m05:48:58.208162 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:48:58.208707 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m05:48:58.210907 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:48:58.216263 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:48:58.217533 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m05:48:58.219295 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:48:58.258014 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:48:58.258717 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:48:58.259259 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:48:58.541046 [debug] [Thread-1 (]: SQL status: COMMIT in 0.281 seconds
[0m05:48:58.576196 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m05:48:58.588442 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:48:58.589226 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m05:48:58.597475 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m05:48:58.603238 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m05:48:58.606279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '792503cf-ed31-4b96-87ac-3ca6a9346bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e9a40e810>]}
[0m05:48:58.607635 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.53s]
[0m05:48:58.609293 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m05:48:58.612018 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m05:48:58.613102 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m05:48:58.614237 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m05:48:58.615890 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m05:48:58.616877 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m05:48:58.618251 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m05:48:58.619627 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m05:48:58.624928 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m05:48:58.625897 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m05:48:58.631052 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m05:48:58.631786 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m05:48:58.636020 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m05:48:58.637088 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:48:58.637804 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m05:48:58.638503 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m05:48:58.643503 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m05:48:58.644407 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:48:58.646338 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:48:58.647136 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m05:48:58.647851 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:48:58.663628 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m05:48:58.665061 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:48:58.666196 [debug] [Thread-4 (]: SQL status: BEGIN in 0.018 seconds
[0m05:48:58.667432 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m05:48:58.668689 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:48:58.670115 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m05:48:58.674778 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m05:48:58.675546 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m05:48:58.681046 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:48:58.687336 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:48:58.688170 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m05:48:58.688931 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m05:48:58.690369 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:48:58.690968 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:48:58.695084 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:48:58.700775 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:48:58.701844 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m05:48:58.702715 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m05:48:58.704240 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:48:58.705012 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:48:58.707164 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:48:58.709329 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:48:58.709946 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:48:58.710656 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:48:58.711263 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:48:58.711909 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:48:58.717099 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m05:48:58.720418 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m05:48:58.721275 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:48:58.721979 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m05:48:58.722499 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m05:48:58.725404 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m05:48:58.726704 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:48:58.727250 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m05:48:58.732392 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m05:48:58.735179 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m05:48:58.736700 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '792503cf-ed31-4b96-87ac-3ca6a9346bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e96f50fb0>]}
[0m05:48:58.737595 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.010 seconds
[0m05:48:58.738762 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.12s]
[0m05:48:58.741430 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m05:48:58.742508 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m05:48:58.743518 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '792503cf-ed31-4b96-87ac-3ca6a9346bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e96f54350>]}
[0m05:48:58.744735 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.12s]
[0m05:48:58.746051 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m05:48:58.749392 [debug] [MainThread]: Using postgres connection "master"
[0m05:48:58.749911 [debug] [MainThread]: On master: BEGIN
[0m05:48:58.750517 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:48:58.762526 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m05:48:58.763458 [debug] [MainThread]: On master: COMMIT
[0m05:48:58.764364 [debug] [MainThread]: Using postgres connection "master"
[0m05:48:58.765306 [debug] [MainThread]: On master: COMMIT
[0m05:48:58.766733 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m05:48:58.767786 [debug] [MainThread]: On master: Close
[0m05:48:58.769083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:48:58.769854 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m05:48:58.770429 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m05:48:58.770914 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m05:48:58.771870 [info ] [MainThread]: 
[0m05:48:58.773447 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m05:48:58.777897 [debug] [MainThread]: Command end result
[0m05:48:58.812505 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:48:58.814946 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:48:58.826608 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:48:58.827141 [info ] [MainThread]: 
[0m05:48:58.827954 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:48:58.828867 [info ] [MainThread]: 
[0m05:48:58.830049 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:48:58.832094 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9877708, "process_in_blocks": "0", "process_kernel_time": 0.449478, "process_mem_max_rss": "107864", "process_out_blocks": "3400", "process_user_time": 3.11207}
[0m05:48:58.832761 [debug] [MainThread]: Command `dbt run` succeeded at 05:48:58.832605 after 1.99 seconds
[0m05:48:58.833230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e9a091be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e99907e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730e97d828d0>]}
[0m05:48:58.833724 [debug] [MainThread]: Flushing usage events
[0m05:49:00.231879 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:49:56.642505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5de27e10a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5de2650470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5de27e1040>]}


============================== 05:49:56.650661 | 6b291aea-3ef4-4f4a-ab25-38cc9bafa2e9 ==============================
[0m05:49:56.650661 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:49:56.651541 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m05:49:56.950336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b291aea-3ef4-4f4a-ab25-38cc9bafa2e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5de1ce2660>]}
[0m05:49:57.031286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b291aea-3ef4-4f4a-ab25-38cc9bafa2e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5de1bb3f50>]}
[0m05:49:57.032343 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:49:57.168604 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:49:57.319781 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:49:57.320373 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:49:57.371176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b291aea-3ef4-4f4a-ab25-38cc9bafa2e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5de03ecc20>]}
[0m05:49:57.473967 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:49:57.477974 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:49:57.508389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b291aea-3ef4-4f4a-ab25-38cc9bafa2e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5de1c02ea0>]}
[0m05:49:57.509237 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m05:49:57.509825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b291aea-3ef4-4f4a-ab25-38cc9bafa2e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5de03b5130>]}
[0m05:49:57.512654 [info ] [MainThread]: 
[0m05:49:57.513210 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:49:57.514313 [info ] [MainThread]: 
[0m05:49:57.515905 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:49:57.521916 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:49:57.584915 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:49:57.585515 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:49:57.585985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:49:57.600980 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m05:49:57.602999 [debug] [ThreadPool]: On list_db: Close
[0m05:49:57.605610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m05:49:57.613702 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:49:57.614256 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m05:49:57.614816 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:49:57.627225 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m05:49:57.628265 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:49:57.628974 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m05:49:57.633603 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m05:49:57.635908 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m05:49:57.637488 [debug] [ThreadPool]: On list_db_dev: Close
[0m05:49:57.647761 [debug] [MainThread]: Using postgres connection "master"
[0m05:49:57.648733 [debug] [MainThread]: On master: BEGIN
[0m05:49:57.649413 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:49:57.665746 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m05:49:57.667008 [debug] [MainThread]: Using postgres connection "master"
[0m05:49:57.668226 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:49:57.675301 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m05:49:57.677712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b291aea-3ef4-4f4a-ab25-38cc9bafa2e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5de27e1580>]}
[0m05:49:57.678507 [debug] [MainThread]: On master: ROLLBACK
[0m05:49:57.679328 [debug] [MainThread]: Using postgres connection "master"
[0m05:49:57.679741 [debug] [MainThread]: On master: BEGIN
[0m05:49:57.680966 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:49:57.681834 [debug] [MainThread]: On master: COMMIT
[0m05:49:57.682877 [debug] [MainThread]: Using postgres connection "master"
[0m05:49:57.683281 [debug] [MainThread]: On master: COMMIT
[0m05:49:57.684064 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:49:57.684490 [debug] [MainThread]: On master: Close
[0m05:49:57.690335 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m05:49:57.692735 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m05:49:57.694206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m05:49:57.695135 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m05:49:57.704416 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m05:49:57.705185 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m05:49:57.757680 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m05:49:57.758806 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:49:57.759513 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m05:49:57.760172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:49:57.776943 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m05:49:57.777964 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:49:57.778676 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m05:49:57.785292 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m05:49:57.795735 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:49:57.796266 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m05:49:57.797418 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:49:57.803240 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:49:57.803795 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m05:49:57.804841 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:49:57.832217 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:49:57.832880 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:49:57.833665 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:49:57.839655 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m05:49:57.853446 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m05:49:57.862016 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:49:57.862972 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m05:49:57.870095 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m05:49:57.873488 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m05:49:57.876221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b291aea-3ef4-4f4a-ab25-38cc9bafa2e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5de27363c0>]}
[0m05:49:57.877265 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.18s]
[0m05:49:57.878698 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m05:49:57.880743 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m05:49:57.881388 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m05:49:57.882048 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m05:49:57.883138 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m05:49:57.884438 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m05:49:57.885161 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m05:49:57.885710 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m05:49:57.886484 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m05:49:57.889883 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m05:49:57.893589 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m05:49:57.894659 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m05:49:57.895311 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m05:49:57.899006 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m05:49:57.902743 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m05:49:57.903937 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:49:57.904606 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:49:57.905031 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m05:49:57.905684 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m05:49:57.906374 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:49:57.907021 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:49:57.921142 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m05:49:57.922062 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m05:49:57.923006 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:49:57.923620 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:49:57.924294 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m05:49:57.924922 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m05:49:57.929389 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m05:49:57.936376 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m05:49:57.935909 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:49:57.940546 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:49:57.941151 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m05:49:57.941975 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m05:49:57.943611 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:49:57.944264 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:49:57.947873 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:49:57.951424 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:49:57.952180 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m05:49:57.953005 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m05:49:57.954346 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:49:57.954866 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:49:57.956967 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:49:57.959016 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:49:57.959670 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:49:57.960240 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:49:57.961191 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:49:57.962002 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:49:57.968227 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m05:49:57.971350 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m05:49:57.972210 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:49:57.972722 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m05:49:57.973236 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m05:49:57.975983 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m05:49:57.977074 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:49:57.977518 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m05:49:57.983008 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m05:49:57.984881 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m05:49:57.985672 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b291aea-3ef4-4f4a-ab25-38cc9bafa2e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5ddc13c590>]}
[0m05:49:57.986692 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.10s]
[0m05:49:57.987506 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.009 seconds
[0m05:49:57.988861 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m05:49:57.991160 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m05:49:57.992454 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b291aea-3ef4-4f4a-ab25-38cc9bafa2e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5ddf25d910>]}
[0m05:49:57.993285 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.11s]
[0m05:49:57.994519 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m05:49:57.998334 [debug] [MainThread]: Using postgres connection "master"
[0m05:49:57.998910 [debug] [MainThread]: On master: BEGIN
[0m05:49:57.999346 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:49:58.011758 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m05:49:58.012923 [debug] [MainThread]: On master: COMMIT
[0m05:49:58.013573 [debug] [MainThread]: Using postgres connection "master"
[0m05:49:58.014286 [debug] [MainThread]: On master: COMMIT
[0m05:49:58.015058 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:49:58.015470 [debug] [MainThread]: On master: Close
[0m05:49:58.016224 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:49:58.016614 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m05:49:58.017079 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m05:49:58.017563 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m05:49:58.018419 [info ] [MainThread]: 
[0m05:49:58.019235 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m05:49:58.022251 [debug] [MainThread]: Command end result
[0m05:49:58.060405 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:49:58.062507 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:49:58.071789 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:49:58.072368 [info ] [MainThread]: 
[0m05:49:58.073011 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:49:58.073886 [info ] [MainThread]: 
[0m05:49:58.074966 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:49:58.076822 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5074239, "process_in_blocks": "0", "process_kernel_time": 0.439341, "process_mem_max_rss": "108608", "process_out_blocks": "3400", "process_user_time": 2.669274}
[0m05:49:58.077516 [debug] [MainThread]: Command `dbt run` succeeded at 05:49:58.077368 after 1.51 seconds
[0m05:49:58.078030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5de1e691c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5de03434a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5de03970b0>]}
[0m05:49:58.078594 [debug] [MainThread]: Flushing usage events
[0m05:49:59.616433 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:50:55.833844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763df45d1e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763df4d00bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763df4d007a0>]}


============================== 05:50:55.841238 | a2b08c6e-1301-4205-8951-ffe14354b292 ==============================
[0m05:50:55.841238 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:50:55.842309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:50:56.093337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2b08c6e-1301-4205-8951-ffe14354b292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763df4b8e030>]}
[0m05:50:56.172893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2b08c6e-1301-4205-8951-ffe14354b292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763df440e780>]}
[0m05:50:56.174003 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:50:56.311273 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:50:56.468037 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:50:56.468555 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:50:56.513244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2b08c6e-1301-4205-8951-ffe14354b292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763df27dafc0>]}
[0m05:50:56.610179 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:50:56.613303 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:50:56.647931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2b08c6e-1301-4205-8951-ffe14354b292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763df539f6e0>]}
[0m05:50:56.648776 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m05:50:56.649461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2b08c6e-1301-4205-8951-ffe14354b292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763df256e630>]}
[0m05:50:56.652382 [info ] [MainThread]: 
[0m05:50:56.653181 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:50:56.654036 [info ] [MainThread]: 
[0m05:50:56.655423 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:50:56.663238 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:50:56.720430 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:50:56.721055 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:50:56.721506 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:50:56.736062 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m05:50:56.737699 [debug] [ThreadPool]: On list_db: Close
[0m05:50:56.740389 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m05:50:56.748173 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:50:56.748650 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m05:50:56.749082 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:50:56.760351 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m05:50:56.761160 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:50:56.761826 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m05:50:56.765689 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m05:50:56.767416 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m05:50:56.768378 [debug] [ThreadPool]: On list_db_dev: Close
[0m05:50:56.776935 [debug] [MainThread]: Using postgres connection "master"
[0m05:50:56.777627 [debug] [MainThread]: On master: BEGIN
[0m05:50:56.778329 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:50:56.790924 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m05:50:56.792597 [debug] [MainThread]: Using postgres connection "master"
[0m05:50:56.794026 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:50:56.800956 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m05:50:56.802702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2b08c6e-1301-4205-8951-ffe14354b292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763df256f8f0>]}
[0m05:50:56.803437 [debug] [MainThread]: On master: ROLLBACK
[0m05:50:56.804219 [debug] [MainThread]: Using postgres connection "master"
[0m05:50:56.804616 [debug] [MainThread]: On master: BEGIN
[0m05:50:56.805838 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:50:56.806545 [debug] [MainThread]: On master: COMMIT
[0m05:50:56.807178 [debug] [MainThread]: Using postgres connection "master"
[0m05:50:56.807937 [debug] [MainThread]: On master: COMMIT
[0m05:50:56.809879 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m05:50:56.810705 [debug] [MainThread]: On master: Close
[0m05:50:56.816583 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m05:50:56.817426 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m05:50:56.818121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m05:50:56.818788 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m05:50:56.830111 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m05:50:56.830886 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m05:50:56.877690 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m05:50:56.879541 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:50:56.880239 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m05:50:56.880741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:50:56.895036 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m05:50:56.895877 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:50:56.896541 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m05:50:56.900915 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m05:50:56.912722 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:50:56.913270 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m05:50:56.914294 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:50:56.917472 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:50:56.917900 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m05:50:56.918738 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:50:56.943456 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:50:56.944174 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:50:56.944771 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:50:56.950511 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m05:50:56.960524 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m05:50:56.968731 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:50:56.969218 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m05:50:56.976003 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m05:50:56.978857 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m05:50:56.980886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2b08c6e-1301-4205-8951-ffe14354b292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763df24def60>]}
[0m05:50:56.981679 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.16s]
[0m05:50:56.982947 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m05:50:56.985071 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m05:50:56.985730 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m05:50:56.986341 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m05:50:56.987787 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m05:50:56.989055 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m05:50:56.990027 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m05:50:56.990649 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m05:50:56.991487 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m05:50:56.994958 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m05:50:56.998169 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m05:50:56.999415 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m05:50:57.000081 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m05:50:57.003494 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m05:50:57.007314 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m05:50:57.008653 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:50:57.009313 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m05:50:57.009830 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:50:57.010457 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:50:57.011330 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m05:50:57.011806 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:50:57.022004 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m05:50:57.023401 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:50:57.024493 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m05:50:57.025265 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m05:50:57.026139 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:50:57.026967 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m05:50:57.032052 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m05:50:57.033374 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m05:50:57.039021 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:50:57.042860 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:50:57.043933 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m05:50:57.044746 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m05:50:57.046144 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:50:57.046706 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:50:57.050277 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:50:57.053596 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:50:57.054244 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m05:50:57.054966 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m05:50:57.056484 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:50:57.057018 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:50:57.058920 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:50:57.061510 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:50:57.062141 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:50:57.062810 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:50:57.063650 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:50:57.064340 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:50:57.070081 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m05:50:57.073136 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m05:50:57.074092 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:50:57.074632 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m05:50:57.075254 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m05:50:57.078258 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m05:50:57.079379 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:50:57.079901 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m05:50:57.084774 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m05:50:57.086659 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m05:50:57.087457 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2b08c6e-1301-4205-8951-ffe14354b292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763df0593590>]}
[0m05:50:57.088660 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.008 seconds
[0m05:50:57.088243 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.10s]
[0m05:50:57.090999 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m05:50:57.091997 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m05:50:57.093118 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2b08c6e-1301-4205-8951-ffe14354b292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763df1686030>]}
[0m05:50:57.094914 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.10s]
[0m05:50:57.096738 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m05:50:57.100228 [debug] [MainThread]: Using postgres connection "master"
[0m05:50:57.100660 [debug] [MainThread]: On master: BEGIN
[0m05:50:57.101166 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:50:57.112293 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m05:50:57.112969 [debug] [MainThread]: On master: COMMIT
[0m05:50:57.113775 [debug] [MainThread]: Using postgres connection "master"
[0m05:50:57.114158 [debug] [MainThread]: On master: COMMIT
[0m05:50:57.114839 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:50:57.115339 [debug] [MainThread]: On master: Close
[0m05:50:57.115978 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:50:57.116349 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m05:50:57.116736 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m05:50:57.117114 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m05:50:57.117730 [info ] [MainThread]: 
[0m05:50:57.118315 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m05:50:57.120397 [debug] [MainThread]: Command end result
[0m05:50:57.153183 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:50:57.155398 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:50:57.164332 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:50:57.164929 [info ] [MainThread]: 
[0m05:50:57.165809 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:50:57.166575 [info ] [MainThread]: 
[0m05:50:57.167638 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:50:57.169419 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3953557, "process_in_blocks": "0", "process_kernel_time": 0.453243, "process_mem_max_rss": "108352", "process_out_blocks": "3400", "process_user_time": 2.699757}
[0m05:50:57.170087 [debug] [MainThread]: Command `dbt run` succeeded at 05:50:57.169944 after 1.40 seconds
[0m05:50:57.170538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763df45d1e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763df24c2a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763df17696a0>]}
[0m05:50:57.170994 [debug] [MainThread]: Flushing usage events
[0m05:50:54.648980 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:51:58.328423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def8578a780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def84d4fa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def84d4d970>]}


============================== 05:51:58.336324 | 23349259-740e-4227-a507-7550041babff ==============================
[0m05:51:58.336324 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:51:58.338256 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:51:58.720578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23349259-740e-4227-a507-7550041babff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def84984fb0>]}
[0m05:51:58.832278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23349259-740e-4227-a507-7550041babff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def865c44a0>]}
[0m05:51:58.833490 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:51:59.013613 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:51:59.253087 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:51:59.253743 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:51:59.322600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23349259-740e-4227-a507-7550041babff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def82fb5190>]}
[0m05:51:59.453458 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:51:59.459213 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:51:59.502942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23349259-740e-4227-a507-7550041babff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def85b38140>]}
[0m05:51:59.503717 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m05:51:59.504357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23349259-740e-4227-a507-7550041babff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def82ccc080>]}
[0m05:51:59.507979 [info ] [MainThread]: 
[0m05:51:59.509053 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:51:59.511157 [info ] [MainThread]: 
[0m05:51:59.513135 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:51:59.521228 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:51:59.607454 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:51:59.608327 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:51:59.609035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:51:59.626075 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.017 seconds
[0m05:51:59.628175 [debug] [ThreadPool]: On list_db: Close
[0m05:51:59.630703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m05:51:59.640046 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:51:59.640538 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m05:51:59.640916 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:51:59.654773 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m05:51:59.656017 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:51:59.656802 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m05:51:59.662682 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m05:51:59.665279 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m05:51:59.666104 [debug] [ThreadPool]: On list_db_dev: Close
[0m05:51:59.676145 [debug] [MainThread]: Using postgres connection "master"
[0m05:51:59.676910 [debug] [MainThread]: On master: BEGIN
[0m05:51:59.677638 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:51:59.692048 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m05:51:59.693184 [debug] [MainThread]: Using postgres connection "master"
[0m05:51:59.694732 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:51:59.700129 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m05:51:59.703112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23349259-740e-4227-a507-7550041babff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def85b38140>]}
[0m05:51:59.703834 [debug] [MainThread]: On master: ROLLBACK
[0m05:51:59.704760 [debug] [MainThread]: Using postgres connection "master"
[0m05:51:59.705182 [debug] [MainThread]: On master: BEGIN
[0m05:51:59.706433 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:51:59.707305 [debug] [MainThread]: On master: COMMIT
[0m05:51:59.708195 [debug] [MainThread]: Using postgres connection "master"
[0m05:51:59.709157 [debug] [MainThread]: On master: COMMIT
[0m05:51:59.710433 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m05:51:59.711168 [debug] [MainThread]: On master: Close
[0m05:51:59.716581 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m05:51:59.717708 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m05:51:59.718529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m05:51:59.719140 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m05:51:59.731284 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m05:51:59.732757 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m05:51:59.787750 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m05:51:59.788757 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:51:59.789239 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m05:51:59.789682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:51:59.802900 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m05:51:59.804314 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:51:59.805411 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m05:51:59.809519 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m05:51:59.819724 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:51:59.820281 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m05:51:59.821640 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:51:59.826296 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:51:59.826896 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m05:51:59.828023 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:51:59.858055 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:51:59.858654 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:51:59.859206 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:51:59.865373 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m05:51:59.879102 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m05:51:59.888256 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:51:59.888874 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m05:51:59.895419 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m05:51:59.898700 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m05:51:59.900972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23349259-740e-4227-a507-7550041babff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def852e6720>]}
[0m05:51:59.901959 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.18s]
[0m05:51:59.903830 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m05:51:59.906168 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m05:51:59.906904 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m05:51:59.907825 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m05:51:59.909134 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m05:51:59.910563 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m05:51:59.911469 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m05:51:59.912078 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m05:51:59.912744 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m05:51:59.916714 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m05:51:59.920878 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m05:51:59.922706 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m05:51:59.923681 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m05:51:59.928851 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m05:51:59.933362 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m05:51:59.934636 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:51:59.935320 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m05:51:59.935888 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:51:59.936439 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:51:59.937146 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m05:51:59.938257 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:51:59.950615 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m05:51:59.952053 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m05:51:59.953670 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:51:59.954508 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:51:59.955414 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m05:51:59.956180 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m05:51:59.961509 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m05:51:59.968027 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m05:51:59.967488 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:51:59.973327 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:51:59.974112 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m05:51:59.974817 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m05:51:59.976481 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:51:59.977016 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:51:59.981454 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:51:59.985528 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:51:59.986280 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m05:51:59.987110 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m05:51:59.988593 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:51:59.989153 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:51:59.991386 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:51:59.993430 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:51:59.994126 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:51:59.994922 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:51:59.996021 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:51:59.996948 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:52:00.003693 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m05:52:00.006728 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m05:52:00.007858 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:52:00.008512 [debug] [Thread-4 (]: SQL status: COMMIT in 0.011 seconds
[0m05:52:00.009162 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m05:52:00.012993 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m05:52:00.014948 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:52:00.015963 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m05:52:00.020921 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.007 seconds
[0m05:52:00.023142 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m05:52:00.023979 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23349259-740e-4227-a507-7550041babff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def81e1e060>]}
[0m05:52:00.025815 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.009 seconds
[0m05:52:00.025056 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.11s]
[0m05:52:00.028590 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m05:52:00.029770 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m05:52:00.030943 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23349259-740e-4227-a507-7550041babff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def8052ffb0>]}
[0m05:52:00.032764 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.12s]
[0m05:52:00.034342 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m05:52:00.039499 [debug] [MainThread]: Using postgres connection "master"
[0m05:52:00.040099 [debug] [MainThread]: On master: BEGIN
[0m05:52:00.040635 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:52:00.054155 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m05:52:00.055260 [debug] [MainThread]: On master: COMMIT
[0m05:52:00.055955 [debug] [MainThread]: Using postgres connection "master"
[0m05:52:00.056807 [debug] [MainThread]: On master: COMMIT
[0m05:52:00.057826 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:52:00.058698 [debug] [MainThread]: On master: Close
[0m05:52:00.059981 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:52:00.060482 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m05:52:00.061257 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m05:52:00.061806 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m05:52:00.062464 [info ] [MainThread]: 
[0m05:52:00.063683 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m05:52:00.067622 [debug] [MainThread]: Command end result
[0m05:52:00.109978 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:52:00.112845 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:52:00.127726 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:52:00.128584 [info ] [MainThread]: 
[0m05:52:00.129630 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:52:00.130683 [info ] [MainThread]: 
[0m05:52:00.131924 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:52:00.134348 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8877758, "process_in_blocks": "2352", "process_kernel_time": 0.603553, "process_mem_max_rss": "108108", "process_out_blocks": "3400", "process_user_time": 3.639833}
[0m05:52:00.135458 [debug] [MainThread]: Command `dbt run` succeeded at 05:52:00.135235 after 1.89 seconds
[0m05:52:00.136270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def82f0f770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def84a9ede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def84a9e990>]}
[0m05:52:00.136928 [debug] [MainThread]: Flushing usage events
[0m05:52:01.593686 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:52:55.803590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7734965728a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773497947020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773496571d90>]}


============================== 05:52:55.812677 | 6f8290f4-c071-4299-8d4e-be206760952a ==============================
[0m05:52:55.812677 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:52:55.813960 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:52:56.093835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f8290f4-c071-4299-8d4e-be206760952a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77349608bb00>]}
[0m05:52:56.196291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f8290f4-c071-4299-8d4e-be206760952a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773495f27d10>]}
[0m05:52:56.198019 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:52:56.359901 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:52:56.511019 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:52:56.511542 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:52:56.562988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f8290f4-c071-4299-8d4e-be206760952a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773494759310>]}
[0m05:52:56.686153 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:52:56.689867 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:52:56.728826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f8290f4-c071-4299-8d4e-be206760952a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77349444cb30>]}
[0m05:52:56.729706 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m05:52:56.730261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f8290f4-c071-4299-8d4e-be206760952a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773494780bc0>]}
[0m05:52:56.732787 [info ] [MainThread]: 
[0m05:52:56.733620 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:52:56.734375 [info ] [MainThread]: 
[0m05:52:56.735734 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:52:56.741977 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:52:56.806956 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:52:56.807503 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:52:56.808037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:52:56.829855 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.022 seconds
[0m05:52:56.832442 [debug] [ThreadPool]: On list_db: Close
[0m05:52:56.835786 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m05:52:56.845037 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:52:56.845834 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m05:52:56.846377 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:52:56.859188 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m05:52:56.860223 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:52:56.860681 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m05:52:56.864683 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m05:52:56.866575 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m05:52:56.867583 [debug] [ThreadPool]: On list_db_dev: Close
[0m05:52:56.878828 [debug] [MainThread]: Using postgres connection "master"
[0m05:52:56.879711 [debug] [MainThread]: On master: BEGIN
[0m05:52:56.880197 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:52:56.893051 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m05:52:56.894562 [debug] [MainThread]: Using postgres connection "master"
[0m05:52:56.895795 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:52:56.900777 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m05:52:56.904204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f8290f4-c071-4299-8d4e-be206760952a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7734946d7e00>]}
[0m05:52:56.904977 [debug] [MainThread]: On master: ROLLBACK
[0m05:52:56.906003 [debug] [MainThread]: Using postgres connection "master"
[0m05:52:56.906410 [debug] [MainThread]: On master: BEGIN
[0m05:52:56.907661 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:52:56.908557 [debug] [MainThread]: On master: COMMIT
[0m05:52:56.909383 [debug] [MainThread]: Using postgres connection "master"
[0m05:52:56.909894 [debug] [MainThread]: On master: COMMIT
[0m05:52:56.910771 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:52:56.912088 [debug] [MainThread]: On master: Close
[0m05:52:56.918782 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m05:52:56.919668 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m05:52:56.920481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m05:52:56.921182 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m05:52:56.932410 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m05:52:56.934057 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m05:52:56.994245 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m05:52:56.995237 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:52:56.995778 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m05:52:56.996207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:52:57.009368 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m05:52:57.010448 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:52:57.011083 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m05:52:57.015462 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m05:52:57.025455 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:52:57.026142 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m05:52:57.027264 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:52:57.030672 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:52:57.031166 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m05:52:57.032340 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:52:57.060800 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:52:57.061389 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:52:57.061852 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:52:57.158947 [debug] [Thread-1 (]: SQL status: COMMIT in 0.096 seconds
[0m05:52:57.170206 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m05:52:57.179159 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:52:57.179797 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m05:52:57.187745 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m05:52:57.190964 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m05:52:57.193963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f8290f4-c071-4299-8d4e-be206760952a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773496aaa750>]}
[0m05:52:57.195453 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.27s]
[0m05:52:57.197734 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m05:52:57.200391 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m05:52:57.201194 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m05:52:57.202103 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m05:52:57.203273 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m05:52:57.204711 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m05:52:57.205911 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m05:52:57.206825 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m05:52:57.207702 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m05:52:57.211892 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m05:52:57.216262 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m05:52:57.217751 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m05:52:57.218552 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m05:52:57.222740 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m05:52:57.227466 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m05:52:57.229137 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:52:57.229849 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:52:57.230581 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m05:52:57.231343 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m05:52:57.232043 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:52:57.232806 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:52:57.248290 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m05:52:57.249660 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m05:52:57.250704 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:52:57.251480 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:52:57.252345 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m05:52:57.253153 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m05:52:57.257197 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m05:52:57.263727 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.010 seconds
[0m05:52:57.263266 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:52:57.267756 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:52:57.268580 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m05:52:57.269291 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m05:52:57.270647 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:52:57.271151 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:52:57.275518 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:52:57.279310 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:52:57.280054 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m05:52:57.280901 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m05:52:57.282317 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:52:57.282941 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:52:57.285182 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:52:57.287299 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:52:57.287998 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:52:57.288796 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:52:57.289552 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:52:57.290689 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:52:57.297536 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m05:52:57.300426 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m05:52:57.301556 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:52:57.302131 [debug] [Thread-4 (]: SQL status: COMMIT in 0.010 seconds
[0m05:52:57.302622 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m05:52:57.305531 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m05:52:57.307109 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:52:57.307843 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m05:52:57.313113 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.007 seconds
[0m05:52:57.314993 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m05:52:57.315827 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f8290f4-c071-4299-8d4e-be206760952a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7734935f0bf0>]}
[0m05:52:57.316867 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.11s]
[0m05:52:57.317920 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.009 seconds
[0m05:52:57.319261 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m05:52:57.321800 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m05:52:57.323370 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f8290f4-c071-4299-8d4e-be206760952a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7734904c9d00>]}
[0m05:52:57.324230 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.12s]
[0m05:52:57.325699 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m05:52:57.329843 [debug] [MainThread]: Using postgres connection "master"
[0m05:52:57.330774 [debug] [MainThread]: On master: BEGIN
[0m05:52:57.331633 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:52:57.344080 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m05:52:57.345215 [debug] [MainThread]: On master: COMMIT
[0m05:52:57.345851 [debug] [MainThread]: Using postgres connection "master"
[0m05:52:57.346324 [debug] [MainThread]: On master: COMMIT
[0m05:52:57.347097 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:52:57.347628 [debug] [MainThread]: On master: Close
[0m05:52:57.348391 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:52:57.348854 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m05:52:57.349464 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m05:52:57.349885 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m05:52:57.350456 [info ] [MainThread]: 
[0m05:52:57.351132 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m05:52:57.353508 [debug] [MainThread]: Command end result
[0m05:52:57.388737 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:52:57.391095 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:52:57.399231 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:52:57.399778 [info ] [MainThread]: 
[0m05:52:57.400474 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:52:57.401490 [info ] [MainThread]: 
[0m05:52:57.402707 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:52:57.404916 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6896832, "process_in_blocks": "0", "process_kernel_time": 0.477181, "process_mem_max_rss": "108056", "process_out_blocks": "3400", "process_user_time": 2.966664}
[0m05:52:57.405615 [debug] [MainThread]: Command `dbt run` succeeded at 05:52:57.405462 after 1.69 seconds
[0m05:52:57.406081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773495fe4290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7734965739e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7734944da780>]}
[0m05:52:57.406594 [debug] [MainThread]: Flushing usage events
[0m05:52:58.834748 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:54:08.257060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd1165e090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd1165eb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd12bfd700>]}


============================== 05:54:08.267462 | 64956e76-5818-4698-a981-859301b83650 ==============================
[0m05:54:08.267462 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:54:08.268568 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m05:54:08.720823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64956e76-5818-4698-a981-859301b83650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd11177d70>]}
[0m05:54:08.848638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64956e76-5818-4698-a981-859301b83650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd11a18fe0>]}
[0m05:54:08.850141 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:54:09.047211 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:54:09.310584 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:54:09.311227 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:54:09.372305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64956e76-5818-4698-a981-859301b83650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd0f830b90>]}
[0m05:54:09.590330 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:54:09.594815 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:54:09.639984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64956e76-5818-4698-a981-859301b83650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd0f534d40>]}
[0m05:54:09.640918 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m05:54:09.641589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64956e76-5818-4698-a981-859301b83650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd1134fbf0>]}
[0m05:54:09.645557 [info ] [MainThread]: 
[0m05:54:09.646740 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:54:09.647655 [info ] [MainThread]: 
[0m05:54:09.649990 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:54:09.663715 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:54:09.755328 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:54:09.756288 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:54:09.757415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:54:09.785525 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.028 seconds
[0m05:54:09.788766 [debug] [ThreadPool]: On list_db: Close
[0m05:54:09.792012 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m05:54:09.803033 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:54:09.803841 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m05:54:09.804309 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:54:09.820144 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m05:54:09.821072 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:54:09.821904 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m05:54:09.830103 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m05:54:09.833635 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m05:54:09.835035 [debug] [ThreadPool]: On list_db_dev: Close
[0m05:54:09.848014 [debug] [MainThread]: Using postgres connection "master"
[0m05:54:09.848986 [debug] [MainThread]: On master: BEGIN
[0m05:54:09.849664 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:54:09.866143 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m05:54:09.867723 [debug] [MainThread]: Using postgres connection "master"
[0m05:54:09.868917 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:54:09.878667 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m05:54:09.881557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64956e76-5818-4698-a981-859301b83650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd0f532120>]}
[0m05:54:09.882756 [debug] [MainThread]: On master: ROLLBACK
[0m05:54:09.884317 [debug] [MainThread]: Using postgres connection "master"
[0m05:54:09.885530 [debug] [MainThread]: On master: BEGIN
[0m05:54:09.887744 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:54:09.889097 [debug] [MainThread]: On master: COMMIT
[0m05:54:09.890490 [debug] [MainThread]: Using postgres connection "master"
[0m05:54:09.891258 [debug] [MainThread]: On master: COMMIT
[0m05:54:09.892309 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:54:09.893336 [debug] [MainThread]: On master: Close
[0m05:54:09.901042 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m05:54:09.902989 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m05:54:09.904561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m05:54:09.905977 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m05:54:09.920728 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m05:54:09.922868 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m05:54:09.994407 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m05:54:09.995483 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:54:09.996071 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m05:54:09.996620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:54:10.010499 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m05:54:10.011342 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:54:10.012023 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m05:54:10.020759 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m05:54:10.032284 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:54:10.033085 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m05:54:10.034594 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:54:10.038953 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:54:10.039524 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m05:54:10.040709 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:54:10.083093 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:54:10.084049 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:54:10.084903 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:54:10.090704 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m05:54:10.101715 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m05:54:10.110575 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:54:10.111265 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m05:54:10.119669 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m05:54:10.123293 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m05:54:10.127490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64956e76-5818-4698-a981-859301b83650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd11b96720>]}
[0m05:54:10.129091 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.22s]
[0m05:54:10.130578 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m05:54:10.132600 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m05:54:10.133231 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m05:54:10.134195 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m05:54:10.136556 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m05:54:10.135304 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m05:54:10.137910 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m05:54:10.139205 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m05:54:10.147092 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m05:54:10.148158 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m05:54:10.153777 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m05:54:10.155529 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m05:54:10.161574 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m05:54:10.162390 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m05:54:10.167213 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m05:54:10.168453 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:54:10.169450 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:54:10.170072 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m05:54:10.170687 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m05:54:10.171417 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:54:10.172140 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:54:10.189570 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m05:54:10.191091 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:54:10.192323 [debug] [Thread-4 (]: SQL status: BEGIN in 0.020 seconds
[0m05:54:10.193032 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m05:54:10.193826 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:54:10.194870 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m05:54:10.200018 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m05:54:10.206999 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.012 seconds
[0m05:54:10.208514 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:54:10.214453 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:54:10.215354 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m05:54:10.216071 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m05:54:10.217491 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:54:10.218483 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m05:54:10.224014 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:54:10.230137 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:54:10.231186 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m05:54:10.231916 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m05:54:10.233421 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:54:10.234401 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:54:10.236869 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:54:10.239497 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:54:10.240194 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:54:10.240965 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:54:10.241643 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:54:10.242542 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:54:10.249174 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m05:54:10.254798 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m05:54:10.256358 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:54:10.257101 [debug] [Thread-3 (]: SQL status: COMMIT in 0.014 seconds
[0m05:54:10.257954 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m05:54:10.262355 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m05:54:10.264597 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:54:10.266193 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m05:54:10.269623 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m05:54:10.272076 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m05:54:10.273134 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64956e76-5818-4698-a981-859301b83650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd0e6d6ae0>]}
[0m05:54:10.274067 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.007 seconds
[0m05:54:10.275602 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.13s]
[0m05:54:10.280168 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m05:54:10.281471 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m05:54:10.283142 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64956e76-5818-4698-a981-859301b83650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd0c5bbef0>]}
[0m05:54:10.284191 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.15s]
[0m05:54:10.285831 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m05:54:10.290540 [debug] [MainThread]: Using postgres connection "master"
[0m05:54:10.291443 [debug] [MainThread]: On master: BEGIN
[0m05:54:10.292100 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:54:10.308208 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m05:54:10.309202 [debug] [MainThread]: On master: COMMIT
[0m05:54:10.309932 [debug] [MainThread]: Using postgres connection "master"
[0m05:54:10.310658 [debug] [MainThread]: On master: COMMIT
[0m05:54:10.311695 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:54:10.312301 [debug] [MainThread]: On master: Close
[0m05:54:10.313310 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:54:10.314198 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m05:54:10.315035 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m05:54:10.316462 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m05:54:10.318664 [info ] [MainThread]: 
[0m05:54:10.320072 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m05:54:10.322441 [debug] [MainThread]: Command end result
[0m05:54:10.366319 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:54:10.368996 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:54:10.379599 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:54:10.380283 [info ] [MainThread]: 
[0m05:54:10.381093 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:54:10.382087 [info ] [MainThread]: 
[0m05:54:10.383136 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:54:10.385563 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2200341, "process_in_blocks": "0", "process_kernel_time": 0.611052, "process_mem_max_rss": "108468", "process_out_blocks": "3400", "process_user_time": 4.18166}
[0m05:54:10.386630 [debug] [MainThread]: Command `dbt run` succeeded at 05:54:10.386297 after 2.22 seconds
[0m05:54:10.387626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd11a18f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd1103f530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd11c40ef0>]}
[0m05:54:10.388811 [debug] [MainThread]: Flushing usage events
[0m05:55:40.047799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751e73378a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751e7460ea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751e736a34d0>]}


============================== 05:55:40.066652 | 14ca6ec0-4176-4fe8-af0d-81ee6189e7bd ==============================
[0m05:55:40.066652 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:55:40.067645 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:55:40.481827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14ca6ec0-4176-4fe8-af0d-81ee6189e7bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751e730a0b90>]}
[0m05:55:40.609302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14ca6ec0-4176-4fe8-af0d-81ee6189e7bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751e73e361b0>]}
[0m05:55:40.610815 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:55:40.462869 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:55:38.750275 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:55:38.751500 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:55:38.849867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14ca6ec0-4176-4fe8-af0d-81ee6189e7bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751e718ffb30>]}
[0m05:55:39.007039 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:55:39.010920 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:55:39.051906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14ca6ec0-4176-4fe8-af0d-81ee6189e7bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751e715c88f0>]}
[0m05:55:39.052641 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m05:55:39.053266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14ca6ec0-4176-4fe8-af0d-81ee6189e7bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751e718d5310>]}
[0m05:55:39.056685 [info ] [MainThread]: 
[0m05:55:39.057338 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:55:39.058079 [info ] [MainThread]: 
[0m05:55:39.059654 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:55:39.073513 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:55:39.166732 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:55:39.168080 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:55:39.169083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:55:39.197430 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.028 seconds
[0m05:55:39.199771 [debug] [ThreadPool]: On list_db: Close
[0m05:55:39.203690 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m05:55:39.213275 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:55:39.213897 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m05:55:39.214499 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:55:39.227582 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m05:55:39.228615 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:55:39.229484 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m05:55:39.234453 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m05:55:39.236717 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m05:55:39.237850 [debug] [ThreadPool]: On list_db_dev: Close
[0m05:55:39.250341 [debug] [MainThread]: Using postgres connection "master"
[0m05:55:39.251071 [debug] [MainThread]: On master: BEGIN
[0m05:55:39.251607 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:55:39.270146 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m05:55:39.271171 [debug] [MainThread]: Using postgres connection "master"
[0m05:55:39.273165 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:55:39.285520 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m05:55:39.288453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14ca6ec0-4176-4fe8-af0d-81ee6189e7bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751e74f14530>]}
[0m05:55:39.289642 [debug] [MainThread]: On master: ROLLBACK
[0m05:55:39.290775 [debug] [MainThread]: Using postgres connection "master"
[0m05:55:39.291798 [debug] [MainThread]: On master: BEGIN
[0m05:55:39.294587 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:55:39.295791 [debug] [MainThread]: On master: COMMIT
[0m05:55:39.296550 [debug] [MainThread]: Using postgres connection "master"
[0m05:55:39.297243 [debug] [MainThread]: On master: COMMIT
[0m05:55:39.298096 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:55:39.299086 [debug] [MainThread]: On master: Close
[0m05:55:39.305656 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m05:55:39.306991 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m05:55:39.307986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m05:55:39.308867 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m05:55:39.329832 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m05:55:39.331552 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m05:55:39.403864 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m05:55:39.404971 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:55:39.405638 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m05:55:39.406245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:55:39.419567 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m05:55:39.420312 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:55:39.421448 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m05:55:39.431740 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m05:55:39.443460 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:55:39.444238 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m05:55:39.445529 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:55:39.449496 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:55:39.450074 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m05:55:39.451263 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:55:39.488115 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:55:39.489347 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:55:39.489960 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:55:39.497339 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m05:55:39.514678 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m05:55:39.523545 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:55:39.524189 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m05:55:39.533262 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m05:55:39.537321 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m05:55:39.540057 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14ca6ec0-4176-4fe8-af0d-81ee6189e7bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751e7505a390>]}
[0m05:55:39.541078 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.23s]
[0m05:55:39.542482 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m05:55:39.545666 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m05:55:39.546997 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m05:55:39.548335 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m05:55:39.550058 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m05:55:39.552062 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m05:55:39.553634 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m05:55:39.554731 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m05:55:39.555621 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m05:55:39.565667 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m05:55:39.575171 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m05:55:39.576924 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m05:55:39.577763 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m05:55:39.586978 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m05:55:39.594026 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m05:55:39.596185 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:55:39.597340 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:55:39.598574 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m05:55:39.599725 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m05:55:39.601077 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:55:39.602014 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:55:39.623470 [debug] [Thread-4 (]: SQL status: BEGIN in 0.021 seconds
[0m05:55:39.624886 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:55:39.626250 [debug] [Thread-3 (]: SQL status: BEGIN in 0.025 seconds
[0m05:55:39.627268 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m05:55:39.628442 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:55:39.629979 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m05:55:39.634354 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m05:55:39.640734 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:55:39.641953 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m05:55:39.643038 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m05:55:39.648297 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:55:39.649329 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m05:55:39.650002 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:55:39.657202 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m05:55:39.656627 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:55:39.665277 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:55:39.666444 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m05:55:39.667453 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m05:55:39.669040 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:55:39.670027 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m05:55:39.674878 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:55:39.678884 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:55:39.679834 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:55:39.680893 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:55:39.681904 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:55:39.683234 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:55:39.689668 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m05:55:39.694918 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m05:55:39.696363 [debug] [Thread-4 (]: SQL status: COMMIT in 0.012 seconds
[0m05:55:39.698795 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:55:39.703390 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m05:55:39.704191 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m05:55:39.705291 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:55:39.706416 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m05:55:39.713071 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.007 seconds
[0m05:55:39.715487 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m05:55:39.716490 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14ca6ec0-4176-4fe8-af0d-81ee6189e7bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751e70640110>]}
[0m05:55:39.717177 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.010 seconds
[0m05:55:39.718152 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.16s]
[0m05:55:39.721106 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m05:55:39.722047 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m05:55:39.723396 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14ca6ec0-4176-4fe8-af0d-81ee6189e7bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751e70640830>]}
[0m05:55:39.725446 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.17s]
[0m05:55:39.727337 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m05:55:39.732241 [debug] [MainThread]: Using postgres connection "master"
[0m05:55:39.733095 [debug] [MainThread]: On master: BEGIN
[0m05:55:39.733626 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:55:39.747778 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m05:55:39.748710 [debug] [MainThread]: On master: COMMIT
[0m05:55:39.749619 [debug] [MainThread]: Using postgres connection "master"
[0m05:55:39.750430 [debug] [MainThread]: On master: COMMIT
[0m05:55:39.751797 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:55:39.752706 [debug] [MainThread]: On master: Close
[0m05:55:39.753787 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:55:39.754534 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m05:55:39.755195 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m05:55:39.755836 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m05:55:39.756819 [info ] [MainThread]: 
[0m05:55:39.758452 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m05:55:39.761496 [debug] [MainThread]: Command end result
[0m05:55:39.822671 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:55:39.826411 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:55:39.840196 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:55:39.840844 [info ] [MainThread]: 
[0m05:55:39.841630 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:55:39.842470 [info ] [MainThread]: 
[0m05:55:39.843447 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:55:39.846063 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.209228, "process_in_blocks": "0", "process_kernel_time": 0.665929, "process_mem_max_rss": "108340", "process_out_blocks": "3400", "process_user_time": 3.943781}
[0m05:55:39.847563 [debug] [MainThread]: Command `dbt run` succeeded at 05:55:39.847341 after 2.21 seconds
[0m05:55:39.848347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751e7460ea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751e733dad20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751e73322780>]}
[0m05:55:39.849004 [debug] [MainThread]: Flushing usage events
[0m05:55:41.314495 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:56:35.145097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e701f54e060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e702010c5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e701f54e210>]}


============================== 05:56:35.159815 | 59063fb3-3ec6-4d96-9700-936da65632bf ==============================
[0m05:56:35.159815 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:56:35.160887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:56:35.524058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59063fb3-3ec6-4d96-9700-936da65632bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e701ef93da0>]}
[0m05:56:35.624250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59063fb3-3ec6-4d96-9700-936da65632bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e701f07b230>]}
[0m05:56:35.625620 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:56:35.810232 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:56:35.966782 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:56:35.967558 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:56:36.042267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59063fb3-3ec6-4d96-9700-936da65632bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e701d6f2e10>]}
[0m05:56:36.199884 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:56:36.205833 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:56:36.248748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59063fb3-3ec6-4d96-9700-936da65632bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e701ef70890>]}
[0m05:56:36.249850 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m05:56:36.251071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59063fb3-3ec6-4d96-9700-936da65632bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e701d5b9940>]}
[0m05:56:36.253989 [info ] [MainThread]: 
[0m05:56:36.254814 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:56:36.255733 [info ] [MainThread]: 
[0m05:56:36.257354 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:56:36.263446 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:56:36.329722 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:56:36.330231 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:56:36.330690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:56:36.344831 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m05:56:36.346747 [debug] [ThreadPool]: On list_db: Close
[0m05:56:36.350504 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m05:56:36.358794 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:56:36.359355 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m05:56:36.359770 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:56:36.371427 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m05:56:36.372249 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:56:36.373075 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m05:56:36.377393 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m05:56:36.379340 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m05:56:36.380235 [debug] [ThreadPool]: On list_db_dev: Close
[0m05:56:36.389085 [debug] [MainThread]: Using postgres connection "master"
[0m05:56:36.390357 [debug] [MainThread]: On master: BEGIN
[0m05:56:36.391211 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:56:36.405497 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m05:56:36.406800 [debug] [MainThread]: Using postgres connection "master"
[0m05:56:36.407998 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:56:36.412669 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m05:56:36.415631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59063fb3-3ec6-4d96-9700-936da65632bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e701d469fa0>]}
[0m05:56:36.416704 [debug] [MainThread]: On master: ROLLBACK
[0m05:56:36.417742 [debug] [MainThread]: Using postgres connection "master"
[0m05:56:36.418787 [debug] [MainThread]: On master: BEGIN
[0m05:56:36.421118 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:56:36.422582 [debug] [MainThread]: On master: COMMIT
[0m05:56:36.423468 [debug] [MainThread]: Using postgres connection "master"
[0m05:56:36.424006 [debug] [MainThread]: On master: COMMIT
[0m05:56:36.425515 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m05:56:36.426689 [debug] [MainThread]: On master: Close
[0m05:56:36.432551 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m05:56:36.433485 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m05:56:36.434232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m05:56:36.434883 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m05:56:36.446821 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m05:56:36.449192 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m05:56:36.520044 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m05:56:36.521352 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:56:36.522106 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m05:56:36.522866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:56:36.539152 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m05:56:36.540362 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:56:36.541522 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m05:56:36.547081 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m05:56:36.563163 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:56:36.564280 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m05:56:36.566221 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:56:36.575424 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:56:36.576502 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m05:56:36.578974 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:56:36.647192 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:56:36.648668 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:56:36.654889 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:56:36.727440 [debug] [Thread-1 (]: SQL status: COMMIT in 0.071 seconds
[0m05:56:36.738356 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m05:56:36.754804 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:56:36.755505 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m05:56:36.761918 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m05:56:36.766357 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m05:56:36.769659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59063fb3-3ec6-4d96-9700-936da65632bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e701fafa570>]}
[0m05:56:36.608128 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.33s]
[0m05:56:36.610149 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m05:56:36.612361 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m05:56:36.613231 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m05:56:36.614000 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m05:56:36.615633 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m05:56:36.617190 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m05:56:36.618157 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m05:56:36.618948 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m05:56:36.619659 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m05:56:36.624944 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m05:56:36.629425 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m05:56:36.630617 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m05:56:36.631224 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m05:56:36.636024 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m05:56:36.640696 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m05:56:36.642017 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:56:36.642638 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:56:36.643210 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m05:56:36.643932 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m05:56:36.644495 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:56:36.645115 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:56:36.659890 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m05:56:36.660942 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:56:36.661856 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m05:56:36.662651 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m05:56:36.663541 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:56:36.664645 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m05:56:36.669266 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m05:56:36.676079 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.012 seconds
[0m05:56:36.677198 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:56:36.681241 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:56:36.682005 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m05:56:36.682736 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m05:56:36.684398 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:56:36.684936 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:56:36.692256 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:56:36.696228 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:56:36.697021 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m05:56:36.697657 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m05:56:36.698905 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:56:36.699461 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:56:36.702117 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:56:36.704995 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:56:36.705783 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:56:36.706441 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:56:36.707129 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:56:36.707876 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:56:36.713530 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m05:56:36.716927 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m05:56:36.717981 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:56:36.718645 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m05:56:36.719307 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m05:56:36.723331 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m05:56:36.724742 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:56:36.725299 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m05:56:36.729998 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m05:56:36.732075 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m05:56:36.733203 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59063fb3-3ec6-4d96-9700-936da65632bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e701c698290>]}
[0m05:56:36.734955 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.009 seconds
[0m05:56:36.734311 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.12s]
[0m05:56:36.737842 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m05:56:36.739930 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m05:56:36.741713 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59063fb3-3ec6-4d96-9700-936da65632bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e701c6e8320>]}
[0m05:56:36.743423 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.12s]
[0m05:56:36.744797 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m05:56:36.749253 [debug] [MainThread]: Using postgres connection "master"
[0m05:56:36.749761 [debug] [MainThread]: On master: BEGIN
[0m05:56:36.750218 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:56:36.763205 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m05:56:36.764286 [debug] [MainThread]: On master: COMMIT
[0m05:56:36.765066 [debug] [MainThread]: Using postgres connection "master"
[0m05:56:36.765856 [debug] [MainThread]: On master: COMMIT
[0m05:56:36.766768 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:56:36.767246 [debug] [MainThread]: On master: Close
[0m05:56:36.768409 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:56:36.768864 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m05:56:36.769381 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m05:56:36.769892 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m05:56:36.770608 [info ] [MainThread]: 
[0m05:56:36.771665 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m05:56:36.774977 [debug] [MainThread]: Command end result
[0m05:56:36.813121 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:56:36.815502 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:56:36.824613 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:56:36.825109 [info ] [MainThread]: 
[0m05:56:36.825834 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:56:36.826556 [info ] [MainThread]: 
[0m05:56:36.827802 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:56:36.829894 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9275321, "process_in_blocks": "0", "process_kernel_time": 0.617162, "process_mem_max_rss": "108460", "process_out_blocks": "3392", "process_user_time": 3.823394}
[0m05:56:36.830763 [debug] [MainThread]: Command `dbt run` succeeded at 05:56:36.830594 after 1.93 seconds
[0m05:56:36.831347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e701fb18230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e701fb19130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e701f4f2720>]}
[0m05:56:36.831995 [debug] [MainThread]: Flushing usage events
[0m05:56:36.372255 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:56:41.602757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7992c622c9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7992c7132540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7992c634e4b0>]}


============================== 05:56:41.709399 | e208b33f-fd69-4bc0-a4fe-2e72dd31f2e8 ==============================
[0m05:56:41.709399 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:56:41.710505 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:56:42.044067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e208b33f-fd69-4bc0-a4fe-2e72dd31f2e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7992c5c0fdd0>]}
[0m05:56:42.141115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e208b33f-fd69-4bc0-a4fe-2e72dd31f2e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7992c4344440>]}
[0m05:56:42.142397 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:56:42.285241 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:56:42.441555 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:56:42.442067 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:56:42.520138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e208b33f-fd69-4bc0-a4fe-2e72dd31f2e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7992c43e4a40>]}
[0m05:56:42.634821 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:56:42.639191 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:56:42.694346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e208b33f-fd69-4bc0-a4fe-2e72dd31f2e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7992c424bb90>]}
[0m05:56:42.695335 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m05:56:42.696199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e208b33f-fd69-4bc0-a4fe-2e72dd31f2e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7992c40e82f0>]}
[0m05:56:42.700215 [info ] [MainThread]: 
[0m05:56:42.701125 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:56:42.702099 [info ] [MainThread]: 
[0m05:56:42.703598 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:56:42.711778 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:56:42.780075 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:56:42.780663 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:56:42.781394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:56:42.798121 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.017 seconds
[0m05:56:42.800286 [debug] [ThreadPool]: On list_db: Close
[0m05:56:42.803918 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m05:56:42.814193 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:56:42.814809 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m05:56:42.815268 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:56:42.827819 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m05:56:42.828587 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:56:42.829495 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m05:56:42.834485 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m05:56:42.837024 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m05:56:42.838437 [debug] [ThreadPool]: On list_db_dev: Close
[0m05:56:42.848217 [debug] [MainThread]: Using postgres connection "master"
[0m05:56:42.848731 [debug] [MainThread]: On master: BEGIN
[0m05:56:42.849279 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:56:42.862725 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m05:56:42.863751 [debug] [MainThread]: Using postgres connection "master"
[0m05:56:42.864823 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:56:42.871460 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m05:56:42.874382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e208b33f-fd69-4bc0-a4fe-2e72dd31f2e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7992c441c620>]}
[0m05:56:42.875467 [debug] [MainThread]: On master: ROLLBACK
[0m05:56:42.876917 [debug] [MainThread]: Using postgres connection "master"
[0m05:56:42.877761 [debug] [MainThread]: On master: BEGIN
[0m05:56:42.879755 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:56:42.880897 [debug] [MainThread]: On master: COMMIT
[0m05:56:42.881803 [debug] [MainThread]: Using postgres connection "master"
[0m05:56:42.882268 [debug] [MainThread]: On master: COMMIT
[0m05:56:42.883120 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:56:42.883559 [debug] [MainThread]: On master: Close
[0m05:56:42.889465 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m05:56:42.891166 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m05:56:42.892334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m05:56:42.893228 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m05:56:42.902668 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m05:56:42.903755 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m05:56:42.965714 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m05:56:42.966767 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:56:42.967309 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m05:56:42.967832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:56:42.982113 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m05:56:42.983019 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:56:42.983847 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m05:56:42.988517 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m05:56:42.998911 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:56:42.999480 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m05:56:43.000534 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:56:43.004011 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:56:43.004517 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m05:56:43.005637 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:56:43.034913 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:56:43.035928 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:56:43.036530 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:56:43.512602 [debug] [Thread-1 (]: SQL status: COMMIT in 0.475 seconds
[0m05:56:43.523593 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m05:56:43.531412 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:56:43.532060 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m05:56:43.538555 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m05:56:43.541658 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m05:56:43.543840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e208b33f-fd69-4bc0-a4fe-2e72dd31f2e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7992c7b7e540>]}
[0m05:56:43.544738 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.65s]
[0m05:56:43.546349 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m05:56:43.548419 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m05:56:43.549150 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m05:56:43.550205 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m05:56:43.551242 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m05:56:43.552678 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m05:56:43.553859 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m05:56:43.554980 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m05:56:43.555814 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m05:56:43.560509 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m05:56:43.565166 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m05:56:43.567395 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m05:56:43.571746 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m05:56:43.572491 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m05:56:43.577634 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m05:56:43.578644 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:56:43.579362 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m05:56:43.580209 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:56:43.580992 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:56:43.582327 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m05:56:43.583180 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:56:43.597142 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m05:56:43.598330 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:56:43.599674 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m05:56:43.600555 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m05:56:43.601587 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:56:43.602409 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m05:56:43.605995 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m05:56:43.613510 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:56:43.615058 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.012 seconds
[0m05:56:43.616326 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m05:56:43.620784 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:56:43.621884 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m05:56:43.622537 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:56:43.626835 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:56:43.627892 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m05:56:43.629478 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m05:56:43.634545 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:56:43.635623 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m05:56:43.636433 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:56:43.639045 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:56:43.639794 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m05:56:43.640879 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:56:43.643317 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:56:43.644063 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:56:43.644936 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:56:43.647284 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:56:43.652933 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m05:56:43.656963 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m05:56:43.657923 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m05:56:43.658985 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:56:43.662985 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m05:56:43.664919 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m05:56:43.666707 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:56:43.667560 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m05:56:43.673493 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m05:56:43.675866 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m05:56:43.677470 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e208b33f-fd69-4bc0-a4fe-2e72dd31f2e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7992c01607d0>]}
[0m05:56:43.678770 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.010 seconds
[0m05:56:43.681546 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.12s]
[0m05:56:43.686379 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m05:56:43.687861 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m05:56:43.689583 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e208b33f-fd69-4bc0-a4fe-2e72dd31f2e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7992c01612b0>]}
[0m05:56:43.691287 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.14s]
[0m05:56:43.692829 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m05:56:43.697637 [debug] [MainThread]: Using postgres connection "master"
[0m05:56:43.698862 [debug] [MainThread]: On master: BEGIN
[0m05:56:43.699781 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:56:43.715440 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m05:56:43.716389 [debug] [MainThread]: On master: COMMIT
[0m05:56:43.717428 [debug] [MainThread]: Using postgres connection "master"
[0m05:56:43.718412 [debug] [MainThread]: On master: COMMIT
[0m05:56:43.719196 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:56:43.719629 [debug] [MainThread]: On master: Close
[0m05:56:43.720344 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:56:43.720821 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m05:56:43.722780 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m05:56:43.724036 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m05:56:43.726388 [info ] [MainThread]: 
[0m05:56:43.727727 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m05:56:43.736339 [debug] [MainThread]: Command end result
[0m05:56:43.833021 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:56:43.835403 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:56:43.844467 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:56:43.845298 [info ] [MainThread]: 
[0m05:56:43.846252 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:56:43.847463 [info ] [MainThread]: 
[0m05:56:43.848292 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:56:43.850175 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3261805, "process_in_blocks": "0", "process_kernel_time": 0.570899, "process_mem_max_rss": "108304", "process_out_blocks": "3384", "process_user_time": 3.328963}
[0m05:56:43.850995 [debug] [MainThread]: Command `dbt run` succeeded at 05:56:43.850836 after 2.33 seconds
[0m05:56:43.851547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7992c7132540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7992c6fc3170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7992c61ce210>]}
[0m05:56:43.852097 [debug] [MainThread]: Flushing usage events
[0m05:56:45.257185 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:56:54.956496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7611ac34d670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7611ae5aa900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7611adce83e0>]}


============================== 05:56:54.966667 | e35cca8b-a31d-4d5f-ad5a-e884b322a72a ==============================
[0m05:56:54.966667 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:56:54.967596 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:56:55.307861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e35cca8b-a31d-4d5f-ad5a-e884b322a72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7611abe57440>]}
[0m05:56:55.396689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e35cca8b-a31d-4d5f-ad5a-e884b322a72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7611abf140e0>]}
[0m05:56:55.397742 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:56:55.536299 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:56:55.772732 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:56:55.774046 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:56:55.965523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e35cca8b-a31d-4d5f-ad5a-e884b322a72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7611aa6a8080>]}
[0m05:56:56.104856 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:56:56.110428 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:56:56.148621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e35cca8b-a31d-4d5f-ad5a-e884b322a72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7611aa378590>]}
[0m05:56:56.149428 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m05:56:56.150224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e35cca8b-a31d-4d5f-ad5a-e884b322a72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7611ac339280>]}
[0m05:56:56.153106 [info ] [MainThread]: 
[0m05:56:56.154030 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:56:56.154794 [info ] [MainThread]: 
[0m05:56:56.156314 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:56:56.163672 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:56:56.224781 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:56:56.225311 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:56:56.225738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:56:56.243952 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.018 seconds
[0m05:56:56.245849 [debug] [ThreadPool]: On list_db: Close
[0m05:56:56.249712 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m05:56:56.260880 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:56:56.261775 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m05:56:56.262186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:56:56.276062 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m05:56:56.277128 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:56:56.277975 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m05:56:56.282325 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m05:56:56.284251 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m05:56:56.285347 [debug] [ThreadPool]: On list_db_dev: Close
[0m05:56:56.299477 [debug] [MainThread]: Using postgres connection "master"
[0m05:56:56.300272 [debug] [MainThread]: On master: BEGIN
[0m05:56:56.300730 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:56:56.315807 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m05:56:56.316638 [debug] [MainThread]: Using postgres connection "master"
[0m05:56:56.317440 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:56:56.322326 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m05:56:56.326181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e35cca8b-a31d-4d5f-ad5a-e884b322a72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7611abe575c0>]}
[0m05:56:56.327393 [debug] [MainThread]: On master: ROLLBACK
[0m05:56:56.328569 [debug] [MainThread]: Using postgres connection "master"
[0m05:56:56.329074 [debug] [MainThread]: On master: BEGIN
[0m05:56:56.330570 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:56:56.331437 [debug] [MainThread]: On master: COMMIT
[0m05:56:56.332001 [debug] [MainThread]: Using postgres connection "master"
[0m05:56:56.332743 [debug] [MainThread]: On master: COMMIT
[0m05:56:56.333543 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:56:56.334020 [debug] [MainThread]: On master: Close
[0m05:56:56.340146 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m05:56:56.341857 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m05:56:56.343444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m05:56:56.344379 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m05:56:56.358671 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m05:56:56.359816 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m05:56:56.417565 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m05:56:56.418825 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:56:56.419320 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m05:56:56.419835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:56:56.431218 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m05:56:56.432276 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:56:56.433174 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m05:56:56.437822 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m05:56:56.447848 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:56:56.448453 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m05:56:56.449565 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:56:56.453917 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:56:56.454423 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m05:56:56.455440 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:56:56.481741 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:56:56.482295 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:56:56.482736 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:56:56.497233 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m05:56:56.507867 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m05:56:56.516912 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:56:56.517504 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m05:56:56.646836 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.129 seconds
[0m05:56:56.652980 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m05:56:56.665869 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e35cca8b-a31d-4d5f-ad5a-e884b322a72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7611ac9da6c0>]}
[0m05:56:56.670648 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.31s]
[0m05:56:56.675024 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m05:56:56.680757 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m05:56:56.681675 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m05:56:56.682957 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m05:56:56.684664 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m05:56:56.687635 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m05:56:56.689120 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m05:56:56.690119 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m05:56:56.690922 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m05:56:56.696098 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m05:56:56.699907 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m05:56:56.701568 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m05:56:56.702412 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m05:56:56.714733 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m05:56:56.715725 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m05:56:56.717680 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:56:56.718391 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:56:56.719118 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m05:56:56.719800 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m05:56:56.720686 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:56:56.722185 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:56:56.736392 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m05:56:56.738211 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:56:56.739312 [debug] [Thread-4 (]: SQL status: BEGIN in 0.019 seconds
[0m05:56:56.740549 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m05:56:56.741935 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:56:56.743326 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m05:56:56.748362 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m05:56:56.749463 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m05:56:56.754603 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:56:56.759840 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:56:56.760651 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m05:56:56.761518 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m05:56:56.762943 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:56:56.763616 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:56:56.767407 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:56:56.771074 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:56:56.771860 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m05:56:56.772639 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m05:56:56.774210 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:56:56.775142 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:56:56.777819 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:56:56.780007 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:56:56.780718 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:56:56.781504 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:56:56.782155 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:56:56.782780 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:56:56.821530 [debug] [Thread-4 (]: SQL status: COMMIT in 0.038 seconds
[0m05:56:56.826402 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m05:56:56.827415 [debug] [Thread-3 (]: SQL status: COMMIT in 0.044 seconds
[0m05:56:56.828849 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:56:56.832962 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m05:56:56.833712 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m05:56:56.834749 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:56:56.835571 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m05:56:56.841788 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m05:56:56.843684 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m05:56:56.844498 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e35cca8b-a31d-4d5f-ad5a-e884b322a72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7611a9525940>]}
[0m05:56:56.846092 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.010 seconds
[0m05:56:56.845516 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.16s]
[0m05:56:56.848992 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m05:56:56.850233 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m05:56:56.851315 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e35cca8b-a31d-4d5f-ad5a-e884b322a72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7611a95154c0>]}
[0m05:56:56.852597 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.16s]
[0m05:56:56.853611 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m05:56:56.856682 [debug] [MainThread]: Using postgres connection "master"
[0m05:56:56.857217 [debug] [MainThread]: On master: BEGIN
[0m05:56:56.857687 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:56:56.871047 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m05:56:56.872018 [debug] [MainThread]: On master: COMMIT
[0m05:56:56.872995 [debug] [MainThread]: Using postgres connection "master"
[0m05:56:56.873909 [debug] [MainThread]: On master: COMMIT
[0m05:56:56.874718 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:56:56.875140 [debug] [MainThread]: On master: Close
[0m05:56:56.875897 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:56:56.876315 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m05:56:56.876789 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m05:56:56.877399 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m05:56:56.878262 [info ] [MainThread]: 
[0m05:56:56.878997 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m05:56:56.881980 [debug] [MainThread]: Command end result
[0m05:56:56.919835 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:56:56.922693 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:56:56.931109 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:56:56.931643 [info ] [MainThread]: 
[0m05:56:56.932432 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:56:56.933432 [info ] [MainThread]: 
[0m05:56:56.934467 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:56:56.936817 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0726454, "process_in_blocks": "0", "process_kernel_time": 0.703482, "process_mem_max_rss": "108356", "process_out_blocks": "3400", "process_user_time": 4.10923}
[0m05:56:56.938284 [debug] [MainThread]: Command `dbt run` succeeded at 05:56:56.937908 after 2.07 seconds
[0m05:56:56.939286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7611aa35b2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7611abf142c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7611abed3c20>]}
[0m05:56:56.939929 [debug] [MainThread]: Flushing usage events
[0m05:56:58.372455 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:57:42.890043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fa1bd59c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fa1ba90ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fa1bd5a780>]}


============================== 05:57:42.899614 | b88f3fdd-9917-4aa8-8667-9ca110da2a21 ==============================
[0m05:57:42.899614 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:57:42.900747 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:57:43.219224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b88f3fdd-9917-4aa8-8667-9ca110da2a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fa1b8227e0>]}
[0m05:57:43.316594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b88f3fdd-9917-4aa8-8667-9ca110da2a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fa1b977fb0>]}
[0m05:57:43.317741 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:57:43.474944 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:57:43.674555 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:57:43.675211 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:57:43.748662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b88f3fdd-9917-4aa8-8667-9ca110da2a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fa19f59400>]}
[0m05:57:43.947001 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:57:43.950577 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:57:43.991836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b88f3fdd-9917-4aa8-8667-9ca110da2a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fa19d69580>]}
[0m05:57:43.992550 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m05:57:43.993110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b88f3fdd-9917-4aa8-8667-9ca110da2a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fa19c18b60>]}
[0m05:57:43.996081 [info ] [MainThread]: 
[0m05:57:43.996770 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:57:43.997527 [info ] [MainThread]: 
[0m05:57:43.999087 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:57:44.005015 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:57:44.076053 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:57:44.076569 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:57:44.077169 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:57:44.095242 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.018 seconds
[0m05:57:44.097230 [debug] [ThreadPool]: On list_db: Close
[0m05:57:44.101299 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m05:57:44.110271 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:57:44.110927 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m05:57:44.111345 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:57:44.125473 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m05:57:44.126279 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:57:44.127498 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m05:57:44.132395 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m05:57:44.135027 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m05:57:44.136440 [debug] [ThreadPool]: On list_db_dev: Close
[0m05:57:44.148457 [debug] [MainThread]: Using postgres connection "master"
[0m05:57:44.149058 [debug] [MainThread]: On master: BEGIN
[0m05:57:44.149522 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:57:44.163491 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m05:57:44.164488 [debug] [MainThread]: Using postgres connection "master"
[0m05:57:44.165329 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:57:44.170432 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m05:57:44.173789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b88f3fdd-9917-4aa8-8667-9ca110da2a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fa1d5883b0>]}
[0m05:57:44.174864 [debug] [MainThread]: On master: ROLLBACK
[0m05:57:44.175873 [debug] [MainThread]: Using postgres connection "master"
[0m05:57:44.176460 [debug] [MainThread]: On master: BEGIN
[0m05:57:44.177806 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:57:44.178758 [debug] [MainThread]: On master: COMMIT
[0m05:57:44.179802 [debug] [MainThread]: Using postgres connection "master"
[0m05:57:44.180663 [debug] [MainThread]: On master: COMMIT
[0m05:57:44.181621 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:57:44.182238 [debug] [MainThread]: On master: Close
[0m05:57:44.188674 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m05:57:44.190219 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m05:57:44.191402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m05:57:44.192123 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m05:57:44.202689 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m05:57:44.203497 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m05:57:44.268766 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m05:57:44.269905 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:57:44.270775 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m05:57:44.271359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:57:44.286748 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m05:57:44.288019 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:57:44.289042 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m05:57:44.294001 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m05:57:44.306238 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:57:44.307098 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m05:57:44.308187 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:57:44.311840 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:57:44.312325 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m05:57:44.313410 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:57:44.345547 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:57:44.346088 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:57:44.346785 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:57:45.258432 [debug] [Thread-1 (]: SQL status: COMMIT in 0.910 seconds
[0m05:57:45.295989 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m05:57:45.308703 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:57:45.309785 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m05:57:45.318150 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m05:57:45.323161 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m05:57:45.327362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b88f3fdd-9917-4aa8-8667-9ca110da2a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fa1c2a9f40>]}
[0m05:57:45.329309 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 1.13s]
[0m05:57:45.330642 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m05:57:45.332506 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m05:57:45.334124 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m05:57:45.335221 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m05:57:45.336529 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m05:57:45.337818 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m05:57:45.338742 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m05:57:45.339474 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m05:57:45.340252 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m05:57:45.345453 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m05:57:45.349805 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m05:57:45.351382 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m05:57:45.352010 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m05:57:45.355985 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m05:57:45.359871 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m05:57:45.361178 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:57:45.362653 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:57:45.363417 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m05:57:45.364179 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m05:57:45.364895 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:57:45.365608 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:57:45.378763 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m05:57:45.379836 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:57:45.380781 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m05:57:45.382410 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m05:57:45.383488 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:57:45.384420 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m05:57:45.388418 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m05:57:45.395136 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:57:45.395708 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m05:57:45.396476 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m05:57:45.402843 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:57:45.403773 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m05:57:45.404543 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:57:45.408895 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:57:45.409497 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m05:57:45.410061 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m05:57:45.414018 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:57:45.415090 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m05:57:45.416098 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:57:45.419543 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:57:45.420152 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m05:57:45.420723 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:57:45.422933 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:57:45.423622 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:57:45.424444 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:57:45.425328 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:57:45.431414 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m05:57:45.435317 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m05:57:45.435960 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m05:57:45.436917 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:57:45.439865 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m05:57:45.440561 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m05:57:45.441537 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:57:45.442430 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m05:57:45.449717 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.007 seconds
[0m05:57:45.451795 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m05:57:45.453317 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b88f3fdd-9917-4aa8-8667-9ca110da2a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fa184cf020>]}
[0m05:57:45.454682 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.011 seconds
[0m05:57:45.456143 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.11s]
[0m05:57:45.459071 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m05:57:45.460028 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m05:57:45.461548 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b88f3fdd-9917-4aa8-8667-9ca110da2a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fa18e99e50>]}
[0m05:57:45.462679 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.12s]
[0m05:57:45.463864 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m05:57:45.467567 [debug] [MainThread]: Using postgres connection "master"
[0m05:57:45.468045 [debug] [MainThread]: On master: BEGIN
[0m05:57:45.468445 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:57:45.482010 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m05:57:45.482931 [debug] [MainThread]: On master: COMMIT
[0m05:57:45.483669 [debug] [MainThread]: Using postgres connection "master"
[0m05:57:45.484476 [debug] [MainThread]: On master: COMMIT
[0m05:57:45.485514 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:57:45.486024 [debug] [MainThread]: On master: Close
[0m05:57:45.486796 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:57:45.487366 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m05:57:45.487847 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m05:57:45.488758 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m05:57:45.489876 [info ] [MainThread]: 
[0m05:57:45.491540 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.49 seconds (1.49s).
[0m05:57:45.494759 [debug] [MainThread]: Command end result
[0m05:57:45.538025 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:57:45.540388 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:57:45.553335 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:57:45.553859 [info ] [MainThread]: 
[0m05:57:45.554598 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:57:45.555425 [info ] [MainThread]: 
[0m05:57:45.556629 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:57:45.558763 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.7421243, "process_in_blocks": "0", "process_kernel_time": 0.493555, "process_mem_max_rss": "108600", "process_out_blocks": "3400", "process_user_time": 3.165436}
[0m05:57:45.559455 [debug] [MainThread]: Command `dbt run` succeeded at 05:57:45.559294 after 2.74 seconds
[0m05:57:45.559960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fa19bdad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fa19d142f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fa1b9c0da0>]}
[0m05:57:45.561166 [debug] [MainThread]: Flushing usage events
[0m05:57:47.000563 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:58:44.741372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f72f6e540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f72c44d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f734d5100>]}


============================== 05:58:44.753618 | 96d15001-5600-4e48-a7ba-bbf4700b29a0 ==============================
[0m05:58:44.753618 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:58:44.754704 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:58:45.131905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96d15001-5600-4e48-a7ba-bbf4700b29a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f72aefd40>]}
[0m05:58:45.229755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96d15001-5600-4e48-a7ba-bbf4700b29a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f7298f710>]}
[0m05:58:45.230853 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:58:45.400947 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:58:45.579381 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:58:45.579917 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:58:45.637175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96d15001-5600-4e48-a7ba-bbf4700b29a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f7118f4d0>]}
[0m05:58:45.750294 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:58:45.755245 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:58:45.787725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96d15001-5600-4e48-a7ba-bbf4700b29a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f70e8f2f0>]}
[0m05:58:45.789015 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m05:58:45.789940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96d15001-5600-4e48-a7ba-bbf4700b29a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f70efa450>]}
[0m05:58:45.792899 [info ] [MainThread]: 
[0m05:58:45.793715 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:58:45.794694 [info ] [MainThread]: 
[0m05:58:45.796198 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:58:45.802058 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:58:45.866308 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:58:45.866823 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:58:45.867212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:58:45.882133 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m05:58:45.883865 [debug] [ThreadPool]: On list_db: Close
[0m05:58:45.886609 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m05:58:45.894435 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:58:45.895026 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m05:58:45.895495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:58:45.909618 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m05:58:45.910525 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:58:45.911151 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m05:58:45.917387 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m05:58:45.919492 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m05:58:45.920519 [debug] [ThreadPool]: On list_db_dev: Close
[0m05:58:45.929506 [debug] [MainThread]: Using postgres connection "master"
[0m05:58:45.930261 [debug] [MainThread]: On master: BEGIN
[0m05:58:45.930754 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:58:45.948119 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m05:58:45.949424 [debug] [MainThread]: Using postgres connection "master"
[0m05:58:45.950917 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:58:45.957402 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m05:58:45.960276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96d15001-5600-4e48-a7ba-bbf4700b29a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f72a48b90>]}
[0m05:58:45.961465 [debug] [MainThread]: On master: ROLLBACK
[0m05:58:45.962681 [debug] [MainThread]: Using postgres connection "master"
[0m05:58:45.963113 [debug] [MainThread]: On master: BEGIN
[0m05:58:45.964721 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:58:45.965682 [debug] [MainThread]: On master: COMMIT
[0m05:58:45.966533 [debug] [MainThread]: Using postgres connection "master"
[0m05:58:45.967039 [debug] [MainThread]: On master: COMMIT
[0m05:58:45.967861 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:58:45.968327 [debug] [MainThread]: On master: Close
[0m05:58:45.977270 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m05:58:45.978139 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m05:58:45.979207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m05:58:45.979840 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m05:58:45.993546 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m05:58:45.994381 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m05:58:46.049108 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m05:58:46.050201 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:58:46.050764 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m05:58:46.051218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:58:46.065091 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m05:58:46.066122 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:58:46.066703 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m05:58:46.070700 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m05:58:46.081730 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:58:46.082268 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m05:58:46.083549 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:58:46.087061 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:58:46.087504 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m05:58:46.088496 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:58:46.119432 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:58:46.120112 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:58:46.120890 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:58:46.126937 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m05:58:46.150197 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m05:58:46.169823 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:58:46.170559 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m05:58:46.178116 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m05:58:46.181703 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m05:58:46.184357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96d15001-5600-4e48-a7ba-bbf4700b29a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f7493a8a0>]}
[0m05:58:46.186295 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.20s]
[0m05:58:46.188344 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m05:58:46.190603 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m05:58:46.191207 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m05:58:46.192065 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m05:58:46.193263 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m05:58:46.194473 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m05:58:46.195500 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m05:58:46.196785 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m05:58:46.197849 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m05:58:46.202083 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m05:58:46.207614 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m05:58:46.209459 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m05:58:46.210223 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m05:58:46.214413 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m05:58:46.218680 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m05:58:46.220138 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:58:46.221084 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:58:46.222320 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m05:58:46.223184 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m05:58:46.223891 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:58:46.224736 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:58:46.239754 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m05:58:46.241116 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m05:58:46.242372 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:58:46.243409 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:58:46.244299 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m05:58:46.245395 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m05:58:46.250428 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m05:58:46.252176 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m05:58:46.259794 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:58:46.266385 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:58:46.267182 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m05:58:46.267987 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m05:58:46.269424 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:58:46.270183 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:58:46.274011 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:58:46.279814 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:58:46.280869 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m05:58:46.281642 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m05:58:46.283086 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:58:46.283799 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:58:46.286267 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:58:46.288481 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:58:46.289302 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:58:46.289987 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:58:46.290674 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:58:46.291337 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:58:46.297968 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m05:58:46.301136 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m05:58:46.302545 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:58:46.303132 [debug] [Thread-4 (]: SQL status: COMMIT in 0.011 seconds
[0m05:58:46.303655 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m05:58:46.306555 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m05:58:46.307728 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:58:46.308226 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m05:58:46.313614 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m05:58:46.316100 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m05:58:46.317342 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96d15001-5600-4e48-a7ba-bbf4700b29a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f68f46870>]}
[0m05:58:46.318720 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.009 seconds
[0m05:58:46.320872 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.12s]
[0m05:58:46.326656 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m05:58:46.329853 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m05:58:46.332196 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96d15001-5600-4e48-a7ba-bbf4700b29a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f68f18560>]}
[0m05:58:46.334522 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.14s]
[0m05:58:46.336030 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m05:58:46.341523 [debug] [MainThread]: Using postgres connection "master"
[0m05:58:46.342275 [debug] [MainThread]: On master: BEGIN
[0m05:58:46.342860 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:58:46.356084 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m05:58:46.357136 [debug] [MainThread]: On master: COMMIT
[0m05:58:46.357891 [debug] [MainThread]: Using postgres connection "master"
[0m05:58:46.358777 [debug] [MainThread]: On master: COMMIT
[0m05:58:46.359731 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:58:46.360493 [debug] [MainThread]: On master: Close
[0m05:58:46.361507 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:58:46.361952 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m05:58:46.362420 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m05:58:46.362849 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m05:58:46.363468 [info ] [MainThread]: 
[0m05:58:46.364342 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m05:58:46.367980 [debug] [MainThread]: Command end result
[0m05:58:46.404307 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:58:46.406975 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:58:46.415532 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:58:46.416042 [info ] [MainThread]: 
[0m05:58:46.416831 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:58:46.417761 [info ] [MainThread]: 
[0m05:58:46.418796 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:58:46.421683 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7588739, "process_in_blocks": "4504", "process_kernel_time": 0.550339, "process_mem_max_rss": "108236", "process_out_blocks": "3400", "process_user_time": 3.041743}
[0m05:58:46.423004 [debug] [MainThread]: Command `dbt run` succeeded at 05:58:46.422766 after 1.76 seconds
[0m05:58:46.423552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f72d168a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f711380e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793f70efa1b0>]}
[0m05:58:46.424055 [debug] [MainThread]: Flushing usage events
[0m05:58:47.910156 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:59:44.471679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798348560080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798348561c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7983485600e0>]}


============================== 05:59:44.482433 | 4080cdcf-b3f5-464c-b472-c8b4571a3806 ==============================
[0m05:59:44.482433 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:59:44.483562 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:59:44.915163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4080cdcf-b3f5-464c-b472-c8b4571a3806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798349edb410>]}
[0m05:59:45.238036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4080cdcf-b3f5-464c-b472-c8b4571a3806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7983481c8980>]}
[0m05:59:45.241102 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:59:45.459659 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:59:45.649090 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:59:45.649997 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:59:45.734575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4080cdcf-b3f5-464c-b472-c8b4571a3806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79834671a090>]}
[0m05:59:45.996702 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:59:46.003674 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:59:46.068125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4080cdcf-b3f5-464c-b472-c8b4571a3806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7983463e3a40>]}
[0m05:59:46.069004 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m05:59:46.069778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4080cdcf-b3f5-464c-b472-c8b4571a3806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798346421be0>]}
[0m05:59:46.074055 [info ] [MainThread]: 
[0m05:59:46.074975 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:59:46.075605 [info ] [MainThread]: 
[0m05:59:46.076604 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:59:46.089996 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:59:46.207787 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:59:46.210017 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:59:46.211122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:59:46.233017 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.022 seconds
[0m05:59:46.236053 [debug] [ThreadPool]: On list_db: Close
[0m05:59:46.241212 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m05:59:46.264959 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:59:46.266131 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m05:59:46.266883 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:59:46.281083 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m05:59:46.282048 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:59:46.282972 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m05:59:46.288425 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m05:59:46.292795 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m05:59:46.294675 [debug] [ThreadPool]: On list_db_dev: Close
[0m05:59:46.320516 [debug] [MainThread]: Using postgres connection "master"
[0m05:59:46.321549 [debug] [MainThread]: On master: BEGIN
[0m05:59:46.322312 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:59:46.339128 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m05:59:46.339988 [debug] [MainThread]: Using postgres connection "master"
[0m05:59:46.340922 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:59:46.346251 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m05:59:46.349302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4080cdcf-b3f5-464c-b472-c8b4571a3806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798349d90380>]}
[0m05:59:46.352422 [debug] [MainThread]: On master: ROLLBACK
[0m05:59:46.354984 [debug] [MainThread]: Using postgres connection "master"
[0m05:59:46.355928 [debug] [MainThread]: On master: BEGIN
[0m05:59:46.357308 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:59:46.357943 [debug] [MainThread]: On master: COMMIT
[0m05:59:46.358707 [debug] [MainThread]: Using postgres connection "master"
[0m05:59:46.359246 [debug] [MainThread]: On master: COMMIT
[0m05:59:46.360019 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:59:46.360510 [debug] [MainThread]: On master: Close
[0m05:59:46.365790 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m05:59:46.367279 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m05:59:46.369621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m05:59:46.372962 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m05:59:46.384315 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m05:59:46.385996 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m05:59:46.480591 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m05:59:46.482255 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:59:46.483391 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m05:59:46.483992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:59:46.499599 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m05:59:46.500806 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:59:46.501492 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m05:59:46.506343 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m05:59:46.523075 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:59:46.523839 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m05:59:46.524937 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:59:46.529043 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:59:46.530222 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m05:59:46.532558 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:59:46.576247 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:59:46.576878 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:59:46.577372 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m05:59:46.582665 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m05:59:46.597851 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m05:59:46.613210 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m05:59:46.614149 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m05:59:46.622524 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m05:59:46.628060 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m05:59:46.630726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4080cdcf-b3f5-464c-b472-c8b4571a3806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798348ab1f40>]}
[0m05:59:46.632311 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.26s]
[0m05:59:46.633995 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m05:59:46.636246 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m05:59:46.637024 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m05:59:46.638242 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m05:59:46.641535 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m05:59:46.644050 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m05:59:46.645397 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m05:59:46.646490 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m05:59:46.647505 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m05:59:46.656678 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m05:59:46.665039 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m05:59:46.666965 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m05:59:46.668016 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m05:59:46.672776 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m05:59:46.687065 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m05:59:46.689264 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:59:46.690382 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:59:46.691137 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m05:59:46.693558 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m05:59:46.697865 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:59:46.699994 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:59:46.716647 [debug] [Thread-4 (]: SQL status: BEGIN in 0.019 seconds
[0m05:59:46.717974 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m05:59:46.718775 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:59:46.719410 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:59:46.720019 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m05:59:46.720665 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m05:59:46.726113 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m05:59:46.733141 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m05:59:46.735839 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:59:46.740997 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:59:46.743458 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m05:59:46.744810 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m05:59:46.747230 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:59:46.748577 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m05:59:46.758181 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:59:46.762985 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:59:46.763719 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m05:59:46.764975 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m05:59:46.768426 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:59:46.769192 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m05:59:46.772077 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:59:46.774472 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:59:46.775268 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:59:46.775849 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:59:46.776456 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m05:59:46.777059 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m05:59:46.828059 [debug] [Thread-4 (]: SQL status: COMMIT in 0.050 seconds
[0m05:59:46.831220 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m05:59:46.831814 [debug] [Thread-3 (]: SQL status: COMMIT in 0.054 seconds
[0m05:59:46.832677 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m05:59:46.840571 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m05:59:46.843039 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m05:59:46.845118 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m05:59:46.846685 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m05:59:46.853239 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.007 seconds
[0m05:59:46.857999 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m05:59:46.860013 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.012 seconds
[0m05:59:46.862935 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m05:59:46.863845 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4080cdcf-b3f5-464c-b472-c8b4571a3806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7983456563c0>]}
[0m05:59:46.866232 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4080cdcf-b3f5-464c-b472-c8b4571a3806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7983456502c0>]}
[0m05:59:46.865196 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.22s]
[0m05:59:46.868590 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.22s]
[0m05:59:46.870377 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m05:59:46.871993 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m05:59:46.877652 [debug] [MainThread]: Using postgres connection "master"
[0m05:59:46.879920 [debug] [MainThread]: On master: BEGIN
[0m05:59:46.880711 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:59:46.898875 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m05:59:46.899726 [debug] [MainThread]: On master: COMMIT
[0m05:59:46.900457 [debug] [MainThread]: Using postgres connection "master"
[0m05:59:46.900953 [debug] [MainThread]: On master: COMMIT
[0m05:59:46.901725 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:59:46.902221 [debug] [MainThread]: On master: Close
[0m05:59:46.903065 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:59:46.903573 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m05:59:46.904064 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m05:59:46.904643 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m05:59:46.905310 [info ] [MainThread]: 
[0m05:59:46.906202 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m05:59:46.917100 [debug] [MainThread]: Command end result
[0m05:59:46.967722 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:59:46.970697 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:59:46.981348 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:59:46.983482 [info ] [MainThread]: 
[0m05:59:46.986936 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:59:46.988523 [info ] [MainThread]: 
[0m05:59:46.990136 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:59:46.992301 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.6102214, "process_in_blocks": "0", "process_kernel_time": 0.531026, "process_mem_max_rss": "107960", "process_out_blocks": "3400", "process_user_time": 3.709759}
[0m05:59:46.993213 [debug] [MainThread]: Command `dbt run` succeeded at 05:59:46.993016 after 2.61 seconds
[0m05:59:46.993878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798348181eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798348ad1130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798348ad0650>]}
[0m05:59:46.994471 [debug] [MainThread]: Flushing usage events
[0m05:59:48.449341 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:00:43.877609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8047999dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b804681e390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b80477cf020>]}


============================== 06:00:43.890376 | 2b833aa7-e49d-4732-bdde-bf7bec4664fa ==============================
[0m06:00:43.890376 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:00:43.891530 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:00:44.317772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b833aa7-e49d-4732-bdde-bf7bec4664fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b80442238f0>]}
[0m06:00:44.430291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b833aa7-e49d-4732-bdde-bf7bec4664fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8045b23b30>]}
[0m06:00:44.431912 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:00:44.685455 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:00:44.872153 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:00:44.872843 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:00:44.943808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b833aa7-e49d-4732-bdde-bf7bec4664fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b80442dbbc0>]}
[0m06:00:46.720855 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:00:46.725095 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:00:46.800739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b833aa7-e49d-4732-bdde-bf7bec4664fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b804412ba40>]}
[0m06:00:46.801443 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:00:46.802016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b833aa7-e49d-4732-bdde-bf7bec4664fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b80440cf770>]}
[0m06:00:46.805292 [info ] [MainThread]: 
[0m06:00:46.806198 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:00:46.807027 [info ] [MainThread]: 
[0m06:00:46.808102 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:00:46.815052 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:00:46.901174 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:00:46.902202 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:00:46.903033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:00:45.009948 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.034 seconds
[0m06:00:45.012589 [debug] [ThreadPool]: On list_db: Close
[0m06:00:45.015716 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:00:45.033450 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:00:45.034209 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:00:45.034799 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:00:45.053295 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m06:00:45.054036 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:00:45.054957 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:00:45.060604 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m06:00:45.064263 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:00:45.065606 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:00:45.080418 [debug] [MainThread]: Using postgres connection "master"
[0m06:00:45.081879 [debug] [MainThread]: On master: BEGIN
[0m06:00:45.086533 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:00:45.104099 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m06:00:45.105064 [debug] [MainThread]: Using postgres connection "master"
[0m06:00:45.105643 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:00:45.110540 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m06:00:45.113060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b833aa7-e49d-4732-bdde-bf7bec4664fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8043fab500>]}
[0m06:00:45.114336 [debug] [MainThread]: On master: ROLLBACK
[0m06:00:45.115783 [debug] [MainThread]: Using postgres connection "master"
[0m06:00:45.116458 [debug] [MainThread]: On master: BEGIN
[0m06:00:45.118044 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:00:45.119065 [debug] [MainThread]: On master: COMMIT
[0m06:00:45.119759 [debug] [MainThread]: Using postgres connection "master"
[0m06:00:45.120294 [debug] [MainThread]: On master: COMMIT
[0m06:00:45.121280 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:00:45.121817 [debug] [MainThread]: On master: Close
[0m06:00:45.129324 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:00:45.131063 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:00:45.132385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:00:45.133172 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:00:45.145169 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:00:45.146445 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:00:45.232273 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:00:45.233798 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:00:45.234311 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:00:45.234848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:45.256431 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m06:00:45.257202 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:00:45.257865 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m06:00:45.263943 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m06:00:45.274300 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:00:45.274925 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:00:45.276769 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:00:45.282672 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:00:45.283486 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:00:45.284715 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:00:45.312182 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:00:45.312855 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:00:45.313364 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:00:45.318821 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m06:00:45.330172 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:00:45.337828 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:00:45.338357 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:00:45.353542 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.015 seconds
[0m06:00:45.356834 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:00:45.359325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b833aa7-e49d-4732-bdde-bf7bec4664fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b804662a180>]}
[0m06:00:45.360841 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.23s]
[0m06:00:45.362223 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:00:45.364729 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m06:00:45.365434 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:00:45.366413 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m06:00:45.367695 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:00:45.369156 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m06:00:45.370102 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:00:45.370794 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m06:00:45.371508 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:00:45.375242 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m06:00:45.378768 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:00:45.380099 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m06:00:45.383894 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m06:00:45.384504 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:00:45.388957 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:00:45.390156 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:00:45.391207 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:00:45.392130 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m06:00:45.392925 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:00:45.393669 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:00:45.394389 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:00:45.411794 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m06:00:45.413090 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:00:45.414082 [debug] [Thread-3 (]: SQL status: BEGIN in 0.020 seconds
[0m06:00:45.415079 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m06:00:45.416049 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:00:45.417022 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:00:45.423126 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m06:00:45.424061 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m06:00:45.430393 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:00:45.435902 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:00:45.436842 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:00:45.437657 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m06:00:45.439335 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:00:45.440093 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:00:45.445395 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:00:45.450726 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:00:45.451627 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m06:00:45.452666 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:00:45.454057 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:00:45.454622 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:00:45.457557 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:00:45.460270 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:00:45.461025 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:00:45.461739 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:00:45.462445 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:00:45.463135 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:00:45.472097 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m06:00:45.475972 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m06:00:45.476797 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:00:45.477271 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m06:00:45.478589 [debug] [Thread-4 (]: SQL status: COMMIT in 0.014 seconds
[0m06:00:45.482730 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:00:45.483927 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:00:45.484426 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:00:45.486843 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.009 seconds
[0m06:00:45.488933 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m06:00:45.489826 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b833aa7-e49d-4732-bdde-bf7bec4664fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8043171a30>]}
[0m06:00:45.491924 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.007 seconds
[0m06:00:45.491131 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.12s]
[0m06:00:45.495623 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:00:45.497263 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m06:00:45.499053 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b833aa7-e49d-4732-bdde-bf7bec4664fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8043171730>]}
[0m06:00:45.500474 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.13s]
[0m06:00:45.501652 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:00:45.505084 [debug] [MainThread]: Using postgres connection "master"
[0m06:00:45.505715 [debug] [MainThread]: On master: BEGIN
[0m06:00:45.506184 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:00:45.518809 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m06:00:45.519934 [debug] [MainThread]: On master: COMMIT
[0m06:00:45.520811 [debug] [MainThread]: Using postgres connection "master"
[0m06:00:45.521500 [debug] [MainThread]: On master: COMMIT
[0m06:00:45.522374 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:00:45.522867 [debug] [MainThread]: On master: Close
[0m06:00:45.523935 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:00:45.524396 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:00:45.524933 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m06:00:45.525373 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:00:45.526040 [info ] [MainThread]: 
[0m06:00:45.527404 [info ] [MainThread]: Finished running 3 table models in -1 hours 59 minutes and 58.72 seconds (-1.28s).
[0m06:00:45.530441 [debug] [MainThread]: Command end result
[0m06:00:45.565669 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:00:45.568157 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:00:45.628865 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:00:45.629790 [info ] [MainThread]: 
[0m06:00:45.631063 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:00:45.632170 [info ] [MainThread]: 
[0m06:00:45.633220 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:00:45.637087 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2414758, "process_in_blocks": "928", "process_kernel_time": 0.582212, "process_mem_max_rss": "108256", "process_out_blocks": "3408", "process_user_time": 3.915007}
[0m06:00:45.639092 [debug] [MainThread]: Command `dbt run` succeeded at 06:00:45.638722 after 2.24 seconds
[0m06:00:45.640531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b80442540b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8043e4fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b804662a180>]}
[0m06:00:45.641545 [debug] [MainThread]: Flushing usage events
[0m06:00:47.101831 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:01:42.738798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3a1846f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3a195eddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3a1846c8f0>]}


============================== 06:01:42.746362 | be2ee00d-511c-48c8-bf52-a1909595f987 ==============================
[0m06:01:42.746362 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:01:42.747572 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:01:42.373658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be2ee00d-511c-48c8-bf52-a1909595f987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3a15e7c530>]}
[0m06:01:42.457828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be2ee00d-511c-48c8-bf52-a1909595f987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3a179e0f20>]}
[0m06:01:42.458999 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:01:42.597139 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:01:43.008828 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:01:43.009488 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:01:43.054902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be2ee00d-511c-48c8-bf52-a1909595f987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3a177a39b0>]}
[0m06:01:43.159109 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:01:43.162429 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:01:43.205692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be2ee00d-511c-48c8-bf52-a1909595f987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3a15c78c50>]}
[0m06:01:43.206501 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:01:43.207088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be2ee00d-511c-48c8-bf52-a1909595f987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3a15c30ef0>]}
[0m06:01:43.210030 [info ] [MainThread]: 
[0m06:01:43.210752 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:01:43.211733 [info ] [MainThread]: 
[0m06:01:43.213239 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:01:43.219465 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:01:43.283687 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:01:43.284427 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:01:43.284887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:01:43.844366 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.559 seconds
[0m06:01:43.845983 [debug] [ThreadPool]: On list_db: Close
[0m06:01:43.848650 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:01:43.856736 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:01:43.857172 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:01:43.857549 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:01:43.874105 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m06:01:43.875143 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:01:43.875769 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:01:43.886380 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m06:01:43.889403 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:01:43.891126 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:01:43.899769 [debug] [MainThread]: Using postgres connection "master"
[0m06:01:43.900394 [debug] [MainThread]: On master: BEGIN
[0m06:01:43.900814 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:01:43.912869 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m06:01:43.914345 [debug] [MainThread]: Using postgres connection "master"
[0m06:01:43.914879 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:01:43.919883 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m06:01:43.922017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be2ee00d-511c-48c8-bf52-a1909595f987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3a15c30290>]}
[0m06:01:43.922886 [debug] [MainThread]: On master: ROLLBACK
[0m06:01:43.923904 [debug] [MainThread]: Using postgres connection "master"
[0m06:01:43.924369 [debug] [MainThread]: On master: BEGIN
[0m06:01:43.925538 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:01:43.926082 [debug] [MainThread]: On master: COMMIT
[0m06:01:43.926871 [debug] [MainThread]: Using postgres connection "master"
[0m06:01:43.927404 [debug] [MainThread]: On master: COMMIT
[0m06:01:43.928171 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:01:43.928677 [debug] [MainThread]: On master: Close
[0m06:01:43.934417 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:01:43.936148 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:01:43.937107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:01:43.937903 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:01:43.948239 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:01:43.949528 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:01:44.018012 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:01:44.179131 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:01:44.180615 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:01:44.181504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:01:44.215452 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m06:01:44.217381 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:01:44.218378 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m06:01:44.231767 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.012 seconds
[0m06:01:44.240268 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:01:44.240954 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:01:44.242055 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:01:44.245536 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:01:44.246071 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:01:44.247146 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:01:44.271578 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:01:44.272487 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:01:44.273041 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:01:45.280686 [debug] [Thread-1 (]: SQL status: COMMIT in 1.007 seconds
[0m06:01:45.313914 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:01:45.327349 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:01:45.328089 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:01:45.565076 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.235 seconds
[0m06:01:45.572895 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:01:45.578849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be2ee00d-511c-48c8-bf52-a1909595f987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3a182aa060>]}
[0m06:01:45.580675 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 1.64s]
[0m06:01:45.582948 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:01:45.586480 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m06:01:45.587771 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:01:45.590523 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m06:01:45.593153 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:01:45.595469 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m06:01:45.597300 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:01:45.598611 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m06:01:45.599988 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:01:45.604597 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m06:01:45.607940 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:01:45.609415 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m06:01:45.613474 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m06:01:45.614012 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:01:45.617768 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:01:45.618706 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:01:45.619216 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m06:01:45.620055 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:01:45.620967 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:01:45.621746 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:01:45.622321 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:01:45.634913 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m06:01:45.636231 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:01:45.637138 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m06:01:45.638004 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:01:45.638711 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:01:45.639566 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m06:01:45.644447 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m06:01:45.649849 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:01:45.650448 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m06:01:45.651114 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:01:45.654815 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:01:45.655735 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m06:01:45.656533 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:01:45.660636 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:01:45.661286 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m06:01:45.661841 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:01:45.665688 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:01:45.666601 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m06:01:45.667194 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:01:45.669912 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:01:45.670494 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m06:01:45.671020 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:01:45.673158 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:01:45.673861 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:01:45.674605 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:01:45.675451 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:01:45.726945 [debug] [Thread-3 (]: SQL status: COMMIT in 0.051 seconds
[0m06:01:45.727709 [debug] [Thread-4 (]: SQL status: COMMIT in 0.052 seconds
[0m06:01:45.730610 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m06:01:45.733399 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:01:45.734307 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:01:45.735182 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:01:45.735827 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m06:01:45.736426 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:01:45.743211 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m06:01:45.745194 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m06:01:45.746010 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be2ee00d-511c-48c8-bf52-a1909595f987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3a144b63c0>]}
[0m06:01:45.746794 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.15s]
[0m06:01:45.748182 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m06:01:45.757387 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.020 seconds
[0m06:01:45.759102 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:01:45.760032 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be2ee00d-511c-48c8-bf52-a1909595f987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3a14da96a0>]}
[0m06:01:45.761183 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.16s]
[0m06:01:45.762436 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:01:45.765758 [debug] [MainThread]: Using postgres connection "master"
[0m06:01:45.766332 [debug] [MainThread]: On master: BEGIN
[0m06:01:45.766821 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:01:45.779418 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m06:01:45.780146 [debug] [MainThread]: On master: COMMIT
[0m06:01:45.780706 [debug] [MainThread]: Using postgres connection "master"
[0m06:01:45.781214 [debug] [MainThread]: On master: COMMIT
[0m06:01:45.782003 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:01:45.782517 [debug] [MainThread]: On master: Close
[0m06:01:45.783248 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:01:45.783702 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:01:45.784223 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m06:01:45.784638 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:01:45.785288 [info ] [MainThread]: 
[0m06:01:45.786008 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.57 seconds (2.57s).
[0m06:01:45.788946 [debug] [MainThread]: Command end result
[0m06:01:45.825087 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:01:45.827214 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:01:45.835753 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:01:45.836530 [info ] [MainThread]: 
[0m06:01:45.837463 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:01:45.838476 [info ] [MainThread]: 
[0m06:01:45.839490 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:01:45.841411 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.8117146, "process_in_blocks": "5464", "process_kernel_time": 0.461036, "process_mem_max_rss": "108384", "process_out_blocks": "3408", "process_user_time": 2.728738}
[0m06:01:45.842300 [debug] [MainThread]: Command `dbt run` succeeded at 06:01:45.842132 after 3.81 seconds
[0m06:01:45.842786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3a177a3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3a15ebb6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3a195eddc0>]}
[0m06:01:45.843302 [debug] [MainThread]: Flushing usage events
[0m06:01:47.262506 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:02:44.465137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eb9a8f4770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eb9ba65c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eb9a4717f0>]}


============================== 06:02:44.701070 | 458e50e9-09e6-42ba-b8e1-65d26be136b5 ==============================
[0m06:02:44.701070 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:02:44.702776 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:45.260750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '458e50e9-09e6-42ba-b8e1-65d26be136b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eb99c71fd0>]}
[0m06:02:45.401626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '458e50e9-09e6-42ba-b8e1-65d26be136b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eb9b522480>]}
[0m06:02:45.403694 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:02:45.583341 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:02:45.926026 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:02:45.927223 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:02:46.011273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '458e50e9-09e6-42ba-b8e1-65d26be136b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eb983ac320>]}
[0m06:02:46.246113 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:02:46.250750 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:02:46.298933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '458e50e9-09e6-42ba-b8e1-65d26be136b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eb980476e0>]}
[0m06:02:46.299637 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:02:46.300258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '458e50e9-09e6-42ba-b8e1-65d26be136b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eb98360c50>]}
[0m06:02:46.303069 [info ] [MainThread]: 
[0m06:02:46.303944 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:02:46.304825 [info ] [MainThread]: 
[0m06:02:46.305864 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:02:46.313147 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:02:46.391537 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:02:46.392061 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:02:46.392501 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:46.414905 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.022 seconds
[0m06:02:46.417574 [debug] [ThreadPool]: On list_db: Close
[0m06:02:46.420832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:02:46.433685 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:02:46.434967 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:02:46.435899 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:46.462022 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m06:02:46.464001 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:02:46.465089 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:02:46.477720 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.011 seconds
[0m06:02:46.483206 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:02:46.484542 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:02:46.500990 [debug] [MainThread]: Using postgres connection "master"
[0m06:02:46.502059 [debug] [MainThread]: On master: BEGIN
[0m06:02:46.502984 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:46.516250 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m06:02:46.517503 [debug] [MainThread]: Using postgres connection "master"
[0m06:02:46.518420 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:02:46.524048 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m06:02:46.528938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '458e50e9-09e6-42ba-b8e1-65d26be136b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eb98067a10>]}
[0m06:02:46.530377 [debug] [MainThread]: On master: ROLLBACK
[0m06:02:46.532082 [debug] [MainThread]: Using postgres connection "master"
[0m06:02:46.532711 [debug] [MainThread]: On master: BEGIN
[0m06:02:46.534054 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:02:46.534954 [debug] [MainThread]: On master: COMMIT
[0m06:02:46.535694 [debug] [MainThread]: Using postgres connection "master"
[0m06:02:46.536360 [debug] [MainThread]: On master: COMMIT
[0m06:02:46.537143 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:02:46.537661 [debug] [MainThread]: On master: Close
[0m06:02:46.542453 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:02:46.544007 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:02:46.545465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:02:46.546629 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:02:46.559058 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:02:46.560213 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:02:46.670340 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:02:46.671568 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:02:46.672264 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:02:46.672776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:46.685380 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m06:02:46.686565 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:02:46.687304 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m06:02:46.694878 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m06:02:46.712555 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:02:46.713640 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:02:46.715213 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:02:46.721195 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:02:46.721993 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:02:46.723531 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:02:46.772324 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:02:46.773576 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:02:46.774733 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:02:46.780951 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m06:02:46.795066 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:02:46.810951 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:02:46.811675 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:02:46.821486 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.009 seconds
[0m06:02:46.827009 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:02:46.830802 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '458e50e9-09e6-42ba-b8e1-65d26be136b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eb9a6fa420>]}
[0m06:02:46.832559 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.28s]
[0m06:02:46.834434 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:02:46.837272 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m06:02:46.838771 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:02:46.840144 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m06:02:46.841817 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:02:46.843767 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m06:02:46.845044 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:02:46.846240 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m06:02:46.847644 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:02:46.852726 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m06:02:46.864302 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:02:46.866774 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m06:02:46.868503 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:02:46.884745 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m06:02:46.967641 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:02:46.970013 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:02:46.971123 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m06:02:46.971963 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:02:46.997241 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:02:46.998482 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:02:46.999720 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:02:47.002925 [debug] [Thread-3 (]: SQL status: BEGIN in 0.031 seconds
[0m06:02:47.004916 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:02:47.006729 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:02:47.034891 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.027 seconds
[0m06:02:47.036287 [debug] [Thread-4 (]: SQL status: BEGIN in 0.037 seconds
[0m06:02:47.067271 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:02:47.068802 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:02:47.070433 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m06:02:47.071794 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m06:02:47.074663 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:02:47.086056 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:02:47.086898 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.013 seconds
[0m06:02:47.087721 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m06:02:47.096447 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:02:47.097844 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:02:47.099090 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:02:47.104479 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:02:47.105534 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m06:02:47.106762 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:02:47.115463 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:02:47.116612 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:02:47.117641 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:02:47.121937 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m06:02:47.127011 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:02:47.128290 [debug] [Thread-3 (]: SQL status: COMMIT in 0.009 seconds
[0m06:02:47.129493 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:02:47.138080 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m06:02:47.139053 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:02:47.141343 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:02:47.143049 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m06:02:47.150012 [debug] [Thread-4 (]: SQL status: COMMIT in 0.007 seconds
[0m06:02:47.157642 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:02:47.158562 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.015 seconds
[0m06:02:47.160363 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:02:47.163465 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m06:02:47.164238 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:02:47.166404 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '458e50e9-09e6-42ba-b8e1-65d26be136b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eb9411b0e0>]}
[0m06:02:47.167886 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.32s]
[0m06:02:47.169742 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m06:02:47.177369 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.010 seconds
[0m06:02:47.181562 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:02:47.184402 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '458e50e9-09e6-42ba-b8e1-65d26be136b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eb97ed0560>]}
[0m06:02:47.186384 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.34s]
[0m06:02:47.198738 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:02:47.203258 [debug] [MainThread]: Using postgres connection "master"
[0m06:02:47.204377 [debug] [MainThread]: On master: BEGIN
[0m06:02:47.214792 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:47.240037 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m06:02:47.248162 [debug] [MainThread]: On master: COMMIT
[0m06:02:47.249031 [debug] [MainThread]: Using postgres connection "master"
[0m06:02:47.250000 [debug] [MainThread]: On master: COMMIT
[0m06:02:47.251638 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:02:47.252627 [debug] [MainThread]: On master: Close
[0m06:02:47.254257 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:47.255585 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:02:47.257564 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m06:02:47.258668 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:02:47.259703 [info ] [MainThread]: 
[0m06:02:47.265450 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m06:02:47.270934 [debug] [MainThread]: Command end result
[0m06:02:47.388508 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:02:47.395521 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:02:47.423022 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:02:47.423914 [info ] [MainThread]: 
[0m06:02:47.424947 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:47.426764 [info ] [MainThread]: 
[0m06:02:47.428943 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:02:47.434182 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.6419988, "process_in_blocks": "3816", "process_kernel_time": 0.718827, "process_mem_max_rss": "108548", "process_out_blocks": "3408", "process_user_time": 4.474901}
[0m06:02:47.435335 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:47.435087 after 3.64 seconds
[0m06:02:47.436572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eb99c09700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eb9a719010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eb9a7180e0>]}
[0m06:02:47.438135 [debug] [MainThread]: Flushing usage events
[0m06:02:48.844065 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:03:44.882220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b5d3dee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b5ee46900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b5d386c30>]}


============================== 06:03:44.902860 | 52d89158-35be-4fef-88c4-a2c408f14dd3 ==============================
[0m06:03:44.902860 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:03:44.904809 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:03:45.482052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52d89158-35be-4fef-88c4-a2c408f14dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b5ceba810>]}
[0m06:03:45.654977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52d89158-35be-4fef-88c4-a2c408f14dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b5cfeec00>]}
[0m06:03:45.656846 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:03:45.885531 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:03:46.169944 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:03:46.170545 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:03:46.319040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52d89158-35be-4fef-88c4-a2c408f14dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b5b5baf90>]}
[0m06:03:46.490960 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:03:46.495554 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:03:46.540940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52d89158-35be-4fef-88c4-a2c408f14dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b5b342c30>]}
[0m06:03:46.541945 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:03:46.543455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52d89158-35be-4fef-88c4-a2c408f14dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b5b5e41a0>]}
[0m06:03:46.546968 [info ] [MainThread]: 
[0m06:03:46.547809 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:03:46.548654 [info ] [MainThread]: 
[0m06:03:46.550021 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:03:46.557008 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:03:46.637395 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:03:46.638225 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:03:46.638844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:03:46.657652 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.019 seconds
[0m06:03:46.660193 [debug] [ThreadPool]: On list_db: Close
[0m06:03:46.664116 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:03:46.679460 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:03:46.680251 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:03:46.680770 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:46.698254 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m06:03:46.699163 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:03:46.699853 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:03:46.706873 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m06:03:46.709955 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:03:46.711357 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:03:46.723817 [debug] [MainThread]: Using postgres connection "master"
[0m06:03:46.724635 [debug] [MainThread]: On master: BEGIN
[0m06:03:46.725119 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:03:46.737404 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m06:03:46.738288 [debug] [MainThread]: Using postgres connection "master"
[0m06:03:46.739321 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:03:46.755669 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m06:03:46.757974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52d89158-35be-4fef-88c4-a2c408f14dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b5b2b0d10>]}
[0m06:03:46.758883 [debug] [MainThread]: On master: ROLLBACK
[0m06:03:46.760845 [debug] [MainThread]: Using postgres connection "master"
[0m06:03:46.761806 [debug] [MainThread]: On master: BEGIN
[0m06:03:46.763722 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:03:46.764632 [debug] [MainThread]: On master: COMMIT
[0m06:03:46.765243 [debug] [MainThread]: Using postgres connection "master"
[0m06:03:46.765769 [debug] [MainThread]: On master: COMMIT
[0m06:03:46.766534 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:03:46.767027 [debug] [MainThread]: On master: Close
[0m06:03:46.771849 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:03:46.773475 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:03:46.775037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:03:46.776098 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:03:46.788695 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:03:46.789742 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:03:46.866057 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:03:46.867479 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:03:46.868481 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:03:46.869297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:46.893283 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m06:03:46.894499 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:03:46.895139 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m06:03:46.907487 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.011 seconds
[0m06:03:46.926588 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:03:46.927389 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:03:46.928841 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:03:46.933464 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:03:46.934016 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:03:46.934983 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:03:46.988101 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:03:46.989802 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:03:46.991104 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:03:47.972362 [debug] [Thread-1 (]: SQL status: COMMIT in 0.980 seconds
[0m06:03:47.999573 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:03:48.013911 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:03:48.014984 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:03:48.153023 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.137 seconds
[0m06:03:48.161350 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:03:48.167684 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52d89158-35be-4fef-88c4-a2c408f14dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b5d916780>]}
[0m06:03:48.172411 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 1.39s]
[0m06:03:48.174782 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:03:48.177877 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m06:03:48.179343 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:03:48.181013 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m06:03:48.182539 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:03:48.183951 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m06:03:48.185164 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:03:48.186571 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m06:03:48.187850 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:03:48.193149 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m06:03:48.200337 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:03:48.201677 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m06:03:48.208079 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:03:48.208663 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m06:03:48.213972 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:03:48.215771 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:03:48.216688 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:03:48.217376 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m06:03:48.218049 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:03:48.218853 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:03:48.219636 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:03:48.241811 [debug] [Thread-4 (]: SQL status: BEGIN in 0.022 seconds
[0m06:03:48.243124 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:03:48.244321 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m06:03:48.246508 [debug] [Thread-3 (]: SQL status: BEGIN in 0.027 seconds
[0m06:03:48.247817 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:03:48.249293 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:03:48.250724 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m06:03:48.260927 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:03:48.261966 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.010 seconds
[0m06:03:48.262819 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:03:48.268998 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:03:48.269922 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m06:03:48.270429 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:03:48.275109 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:03:48.276351 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m06:03:48.277202 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:03:48.282162 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:03:48.283198 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m06:03:48.283840 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:03:48.286370 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:03:48.286897 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m06:03:48.287640 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:03:48.290168 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:03:48.290857 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:03:48.291610 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:03:48.292539 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:03:48.584238 [debug] [Thread-4 (]: SQL status: COMMIT in 0.291 seconds
[0m06:03:48.592414 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:03:48.594763 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:03:48.596083 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:03:48.739137 [debug] [Thread-3 (]: SQL status: COMMIT in 0.445 seconds
[0m06:03:48.752226 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.154 seconds
[0m06:03:48.755516 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m06:03:48.760609 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:03:48.762763 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:03:48.765258 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m06:03:48.767115 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52d89158-35be-4fef-88c4-a2c408f14dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b5a44dbe0>]}
[0m06:03:48.769579 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.58s]
[0m06:03:48.772034 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:03:48.896442 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.128 seconds
[0m06:03:48.898587 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m06:03:48.899828 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52d89158-35be-4fef-88c4-a2c408f14dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b5835bfb0>]}
[0m06:03:48.901479 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.72s]
[0m06:03:48.903452 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m06:03:48.907212 [debug] [MainThread]: Using postgres connection "master"
[0m06:03:48.908378 [debug] [MainThread]: On master: BEGIN
[0m06:03:48.908871 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:03:48.926669 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m06:03:48.927430 [debug] [MainThread]: On master: COMMIT
[0m06:03:48.928170 [debug] [MainThread]: Using postgres connection "master"
[0m06:03:48.928648 [debug] [MainThread]: On master: COMMIT
[0m06:03:48.929486 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:03:48.929999 [debug] [MainThread]: On master: Close
[0m06:03:48.930752 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:03:48.931206 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:03:48.931666 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m06:03:48.932253 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:03:48.932875 [info ] [MainThread]: 
[0m06:03:48.933517 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.38 seconds (2.38s).
[0m06:03:48.935629 [debug] [MainThread]: Command end result
[0m06:03:48.974334 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:03:48.978809 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:03:48.996682 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:03:48.997583 [info ] [MainThread]: 
[0m06:03:48.998632 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:03:48.999746 [info ] [MainThread]: 
[0m06:03:49.000928 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:03:49.004728 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.268008, "process_in_blocks": "1712", "process_kernel_time": 0.531962, "process_mem_max_rss": "108368", "process_out_blocks": "3416", "process_user_time": 3.976129}
[0m06:03:49.005915 [debug] [MainThread]: Command `dbt run` succeeded at 06:03:49.005675 after 4.27 seconds
[0m06:03:49.006714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b5d1b8da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b5b37e630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716b5b37c2f0>]}
[0m06:03:49.007576 [debug] [MainThread]: Flushing usage events
[0m06:03:50.470220 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:04:44.497564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e983826b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e983827a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e983827e60>]}


============================== 06:04:44.520638 | 58e2637b-667b-4d1e-ac11-b517c40675ab ==============================
[0m06:04:44.520638 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:04:44.522402 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:04:44.992338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58e2637b-667b-4d1e-ac11-b517c40675ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e983807ce0>]}
[0m06:04:45.123813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58e2637b-667b-4d1e-ac11-b517c40675ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e982ee6fc0>]}
[0m06:04:45.124888 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:04:45.330776 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:04:45.708503 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:04:45.709111 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:04:45.771549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58e2637b-667b-4d1e-ac11-b517c40675ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e982caf680>]}
[0m06:04:45.914148 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:04:45.918308 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:04:45.966592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58e2637b-667b-4d1e-ac11-b517c40675ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e9811ded80>]}
[0m06:04:45.967487 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:04:45.968154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58e2637b-667b-4d1e-ac11-b517c40675ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e98405bd70>]}
[0m06:04:45.971488 [info ] [MainThread]: 
[0m06:04:45.972402 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:04:45.973529 [info ] [MainThread]: 
[0m06:04:45.975348 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:04:45.984129 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:04:46.182580 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:04:46.183195 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:04:46.183825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:04:46.207117 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.023 seconds
[0m06:04:46.211246 [debug] [ThreadPool]: On list_db: Close
[0m06:04:46.216810 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:04:46.231631 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:04:46.232775 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:04:46.233337 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:04:46.251114 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m06:04:46.252024 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:04:46.253350 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:04:46.358347 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.104 seconds
[0m06:04:46.361254 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:04:46.362261 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:04:46.372543 [debug] [MainThread]: Using postgres connection "master"
[0m06:04:46.373550 [debug] [MainThread]: On master: BEGIN
[0m06:04:46.374450 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:04:46.401641 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m06:04:46.402755 [debug] [MainThread]: Using postgres connection "master"
[0m06:04:46.403496 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:04:46.456091 [debug] [MainThread]: SQL status: SELECT 0 in 0.052 seconds
[0m06:04:46.458785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58e2637b-667b-4d1e-ac11-b517c40675ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e98116b530>]}
[0m06:04:46.460137 [debug] [MainThread]: On master: ROLLBACK
[0m06:04:46.461383 [debug] [MainThread]: Using postgres connection "master"
[0m06:04:46.462054 [debug] [MainThread]: On master: BEGIN
[0m06:04:46.463975 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:04:46.465192 [debug] [MainThread]: On master: COMMIT
[0m06:04:46.465777 [debug] [MainThread]: Using postgres connection "master"
[0m06:04:46.466353 [debug] [MainThread]: On master: COMMIT
[0m06:04:46.467333 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:04:46.467876 [debug] [MainThread]: On master: Close
[0m06:04:46.474305 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:04:46.476698 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:04:46.479535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:04:46.480642 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:04:46.496950 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:04:46.499083 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:04:46.581801 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:04:46.582820 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:04:46.583581 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:04:46.584058 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:04:46.598555 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m06:04:46.600172 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:04:46.601483 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m06:04:46.608900 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m06:04:46.620859 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:04:46.621433 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:04:46.622540 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:04:46.629202 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:04:46.630253 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:04:46.631739 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:04:46.666867 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:04:46.667839 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:04:46.668625 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:04:46.674725 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m06:04:46.686885 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:04:46.695511 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:04:46.696743 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:04:46.704715 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m06:04:46.707985 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:04:46.710492 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58e2637b-667b-4d1e-ac11-b517c40675ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e984c26540>]}
[0m06:04:46.711722 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.23s]
[0m06:04:46.712881 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:04:46.715900 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m06:04:46.716806 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:04:46.717960 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m06:04:46.719055 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:04:46.720198 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m06:04:46.721051 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:04:46.721734 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m06:04:46.722429 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:04:46.726582 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m06:04:46.730294 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:04:46.731469 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m06:04:46.736242 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m06:04:46.736875 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:04:46.741534 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:04:46.742552 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:04:46.743252 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m06:04:46.743793 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:04:46.744343 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:04:46.744977 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:04:46.746006 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:04:46.760111 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m06:04:46.761257 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:04:46.762346 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m06:04:46.763157 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:04:46.764078 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:04:46.764964 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m06:04:46.774091 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.008 seconds
[0m06:04:46.774722 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.010 seconds
[0m06:04:46.778889 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:04:46.783156 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:04:46.784061 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:04:46.784802 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m06:04:46.786403 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:04:46.791875 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:04:46.792433 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m06:04:46.792975 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m06:04:46.797659 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:04:46.798717 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:04:46.799655 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:04:46.802200 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:04:46.803117 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:04:46.804297 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m06:04:46.805214 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:04:46.808007 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:04:46.808934 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:04:46.809508 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:04:46.813764 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m06:04:46.818311 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m06:04:46.819485 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:04:46.820368 [debug] [Thread-4 (]: SQL status: COMMIT in 0.010 seconds
[0m06:04:46.820908 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m06:04:46.825714 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:04:46.827702 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:04:46.828706 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:04:46.833791 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.007 seconds
[0m06:04:46.835985 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m06:04:46.836882 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58e2637b-667b-4d1e-ac11-b517c40675ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e980237ec0>]}
[0m06:04:46.837772 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.12s]
[0m06:04:46.838775 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.009 seconds
[0m06:04:46.839956 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m06:04:46.844210 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:04:46.846710 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58e2637b-667b-4d1e-ac11-b517c40675ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e980204a40>]}
[0m06:04:46.847909 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.13s]
[0m06:04:46.850206 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:04:46.853873 [debug] [MainThread]: Using postgres connection "master"
[0m06:04:46.854369 [debug] [MainThread]: On master: BEGIN
[0m06:04:46.854832 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:04:46.872131 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m06:04:46.873051 [debug] [MainThread]: On master: COMMIT
[0m06:04:46.873829 [debug] [MainThread]: Using postgres connection "master"
[0m06:04:46.874307 [debug] [MainThread]: On master: COMMIT
[0m06:04:46.875236 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:04:46.875827 [debug] [MainThread]: On master: Close
[0m06:04:46.876715 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:04:46.877410 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:04:46.878543 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m06:04:46.879653 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:04:46.880321 [info ] [MainThread]: 
[0m06:04:46.882668 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m06:04:46.886863 [debug] [MainThread]: Command end result
[0m06:04:46.938389 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:04:46.940845 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:04:46.951062 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:04:46.951911 [info ] [MainThread]: 
[0m06:04:46.952873 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:04:46.954171 [info ] [MainThread]: 
[0m06:04:46.955021 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:04:46.957406 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.578053, "process_in_blocks": "1552", "process_kernel_time": 0.824739, "process_mem_max_rss": "108644", "process_out_blocks": "3408", "process_user_time": 3.908881}
[0m06:04:46.958258 [debug] [MainThread]: Command `dbt run` succeeded at 06:04:46.958081 after 2.58 seconds
[0m06:04:46.958846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e984ca05c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e98116b560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e98116b740>]}
[0m06:04:46.959484 [debug] [MainThread]: Flushing usage events
[0m06:04:48.427075 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:05:44.983774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdcc9d25310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdccac2f590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdccbb661b0>]}


============================== 06:05:44.992996 | 3030f08e-e6d5-48ba-b5d3-9773bae13845 ==============================
[0m06:05:44.992996 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:05:44.994147 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:05:45.357492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3030f08e-e6d5-48ba-b5d3-9773bae13845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdcca41e930>]}
[0m06:05:45.510299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3030f08e-e6d5-48ba-b5d3-9773bae13845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdcca024200>]}
[0m06:05:45.512018 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:05:45.765340 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:05:46.128100 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:05:46.129678 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:05:46.255810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3030f08e-e6d5-48ba-b5d3-9773bae13845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdcc8443d40>]}
[0m06:05:46.477832 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:05:46.484420 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:05:46.552127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3030f08e-e6d5-48ba-b5d3-9773bae13845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdccb074d10>]}
[0m06:05:46.552929 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:05:46.553598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3030f08e-e6d5-48ba-b5d3-9773bae13845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdcc9f29010>]}
[0m06:05:46.556352 [info ] [MainThread]: 
[0m06:05:46.556952 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:05:46.558606 [info ] [MainThread]: 
[0m06:05:46.560519 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:05:46.567288 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:05:46.666092 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:05:46.666857 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:05:46.667423 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:05:46.733793 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.066 seconds
[0m06:05:46.736508 [debug] [ThreadPool]: On list_db: Close
[0m06:05:46.740338 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:05:46.756299 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:05:46.757070 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:05:46.757672 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:05:46.778213 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m06:05:46.779126 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:05:46.779909 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:05:46.804761 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.024 seconds
[0m06:05:46.810713 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:05:46.812286 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:05:46.829883 [debug] [MainThread]: Using postgres connection "master"
[0m06:05:46.832408 [debug] [MainThread]: On master: BEGIN
[0m06:05:46.834080 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:05:46.853731 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m06:05:46.854517 [debug] [MainThread]: Using postgres connection "master"
[0m06:05:46.855377 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:05:46.871912 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m06:05:46.874991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3030f08e-e6d5-48ba-b5d3-9773bae13845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdcc849ce30>]}
[0m06:05:46.876514 [debug] [MainThread]: On master: ROLLBACK
[0m06:05:46.878074 [debug] [MainThread]: Using postgres connection "master"
[0m06:05:46.878890 [debug] [MainThread]: On master: BEGIN
[0m06:05:46.880278 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:05:46.881421 [debug] [MainThread]: On master: COMMIT
[0m06:05:46.882633 [debug] [MainThread]: Using postgres connection "master"
[0m06:05:46.883489 [debug] [MainThread]: On master: COMMIT
[0m06:05:46.884478 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:05:46.885083 [debug] [MainThread]: On master: Close
[0m06:05:46.890963 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:05:46.891836 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:05:46.892998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:05:46.894329 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:05:46.905743 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:05:46.906636 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:05:46.970595 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:05:46.971720 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:05:46.972290 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:05:46.972864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:05:46.991918 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m06:05:46.993188 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:05:46.994459 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m06:05:47.005367 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m06:05:47.014423 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:05:47.015032 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:05:47.016175 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:05:47.020391 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:05:47.021215 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:05:47.022386 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:05:47.057602 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:05:47.058206 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:05:47.058677 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:05:48.015604 [debug] [Thread-1 (]: SQL status: COMMIT in 0.956 seconds
[0m06:05:48.035495 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:05:48.047234 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:05:48.048204 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:05:48.256023 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.207 seconds
[0m06:05:48.260522 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:05:48.263452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3030f08e-e6d5-48ba-b5d3-9773bae13845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdcca816690>]}
[0m06:05:48.264595 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 1.37s]
[0m06:05:48.266301 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:05:48.268834 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m06:05:48.269596 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:05:48.270408 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m06:05:48.271883 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:05:48.273663 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m06:05:48.275562 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:05:48.276870 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m06:05:48.278261 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:05:48.286901 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m06:05:48.294227 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:05:48.295866 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m06:05:48.302777 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:05:48.307751 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m06:05:48.314687 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:05:48.316151 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:05:48.316793 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:05:48.317624 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:05:48.318630 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m06:05:48.320053 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:05:48.321045 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:05:48.337353 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m06:05:48.338416 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:05:48.339452 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:05:48.344394 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m06:05:48.349025 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:05:48.349777 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m06:05:48.350746 [debug] [Thread-4 (]: SQL status: BEGIN in 0.031 seconds
[0m06:05:48.351653 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:05:48.352387 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:05:48.359400 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:05:48.360411 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m06:05:48.361586 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m06:05:48.363196 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:05:48.366250 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:05:48.366949 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:05:48.367521 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:05:48.371871 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.010 seconds
[0m06:05:48.377405 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:05:48.378050 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m06:05:48.378597 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:05:48.381382 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m06:05:48.382688 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:05:48.383287 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:05:48.383819 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m06:05:48.387343 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:05:48.388317 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:05:48.389329 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:05:48.391858 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:05:48.392363 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:05:48.392829 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:05:48.540952 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.153 seconds
[0m06:05:48.545461 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m06:05:48.546876 [debug] [Thread-4 (]: SQL status: COMMIT in 0.153 seconds
[0m06:05:48.554715 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3030f08e-e6d5-48ba-b5d3-9773bae13845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdcc738e2a0>]}
[0m06:05:48.556646 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:05:48.558991 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.28s]
[0m06:05:48.562030 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:05:48.564299 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m06:05:48.565893 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:05:48.577243 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.009 seconds
[0m06:05:48.581682 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:05:48.584719 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3030f08e-e6d5-48ba-b5d3-9773bae13845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdcc730f8f0>]}
[0m06:05:48.587219 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.31s]
[0m06:05:48.591005 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:05:48.598083 [debug] [MainThread]: Using postgres connection "master"
[0m06:05:48.599297 [debug] [MainThread]: On master: BEGIN
[0m06:05:48.600396 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:05:48.626562 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m06:05:48.628102 [debug] [MainThread]: On master: COMMIT
[0m06:05:48.629375 [debug] [MainThread]: Using postgres connection "master"
[0m06:05:48.630534 [debug] [MainThread]: On master: COMMIT
[0m06:05:48.631938 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m06:05:48.632464 [debug] [MainThread]: On master: Close
[0m06:05:48.633216 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:05:48.633731 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:05:48.634165 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m06:05:48.634589 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:05:48.635227 [info ] [MainThread]: 
[0m06:05:48.636141 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.08 seconds (2.08s).
[0m06:05:48.638786 [debug] [MainThread]: Command end result
[0m06:05:48.672382 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:05:48.674752 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:05:48.684349 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:05:48.684931 [info ] [MainThread]: 
[0m06:05:48.685790 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:05:48.686733 [info ] [MainThread]: 
[0m06:05:48.687827 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:05:48.690459 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.7985299, "process_in_blocks": "6016", "process_kernel_time": 0.624124, "process_mem_max_rss": "108040", "process_out_blocks": "3408", "process_user_time": 3.95156}
[0m06:05:48.691241 [debug] [MainThread]: Command `dbt run` succeeded at 06:05:48.691083 after 3.80 seconds
[0m06:05:48.691733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdcca25f110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdcca25e330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdcca25ea20>]}
[0m06:05:48.692242 [debug] [MainThread]: Flushing usage events
[0m06:05:50.255001 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:06:44.009964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cb1ee8ef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cb1e779fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cb1efe1d90>]}


============================== 06:06:44.025346 | d057837c-cd1b-4345-afb2-df64010e7d94 ==============================
[0m06:06:44.025346 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:06:44.026547 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:06:44.415823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd057837c-cd1b-4345-afb2-df64010e7d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cb1e986d80>]}
[0m06:06:44.525731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd057837c-cd1b-4345-afb2-df64010e7d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cb1e549520>]}
[0m06:06:44.527288 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:06:44.741133 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:06:45.024527 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:06:45.025232 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:06:45.094577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd057837c-cd1b-4345-afb2-df64010e7d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cb1cb04ef0>]}
[0m06:06:45.246552 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:06:45.250345 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:06:45.306670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd057837c-cd1b-4345-afb2-df64010e7d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cb1c800ad0>]}
[0m06:06:45.307379 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:06:45.307998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd057837c-cd1b-4345-afb2-df64010e7d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cb1c7c2cf0>]}
[0m06:06:45.311979 [info ] [MainThread]: 
[0m06:06:45.313269 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:06:45.314110 [info ] [MainThread]: 
[0m06:06:45.315761 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:06:45.323978 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:06:45.433613 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:06:45.434255 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:06:45.434947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:06:45.461488 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.026 seconds
[0m06:06:45.463523 [debug] [ThreadPool]: On list_db: Close
[0m06:06:45.465834 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:06:45.474081 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:06:45.474736 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:06:45.475164 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:06:45.500970 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m06:06:45.501994 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:06:45.502742 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:06:45.508765 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m06:06:45.514110 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:06:45.515512 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:06:45.524853 [debug] [MainThread]: Using postgres connection "master"
[0m06:06:45.525492 [debug] [MainThread]: On master: BEGIN
[0m06:06:45.525988 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:06:45.548925 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m06:06:45.550285 [debug] [MainThread]: Using postgres connection "master"
[0m06:06:45.550946 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:06:45.561509 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m06:06:45.564525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd057837c-cd1b-4345-afb2-df64010e7d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cb1e54a690>]}
[0m06:06:45.565707 [debug] [MainThread]: On master: ROLLBACK
[0m06:06:45.566833 [debug] [MainThread]: Using postgres connection "master"
[0m06:06:45.567767 [debug] [MainThread]: On master: BEGIN
[0m06:06:45.569216 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:06:45.570151 [debug] [MainThread]: On master: COMMIT
[0m06:06:45.570923 [debug] [MainThread]: Using postgres connection "master"
[0m06:06:45.571515 [debug] [MainThread]: On master: COMMIT
[0m06:06:45.572339 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:06:45.572876 [debug] [MainThread]: On master: Close
[0m06:06:45.578470 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:06:45.579369 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:06:45.580304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:06:45.581140 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:06:45.596125 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:06:45.596966 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:06:45.680558 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:06:45.681846 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:06:45.682528 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:06:45.683060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:06:45.700532 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m06:06:45.702629 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:06:45.704295 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m06:06:45.715710 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m06:06:45.737149 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:06:45.738414 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:06:45.740516 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:06:45.749087 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:06:45.750169 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:06:45.752560 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:06:45.794130 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:06:45.794789 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:06:45.795307 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:06:45.800570 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m06:06:45.811080 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:06:45.820874 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:06:45.821519 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:06:45.827855 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m06:06:45.831423 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:06:45.834056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd057837c-cd1b-4345-afb2-df64010e7d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cb202a6570>]}
[0m06:06:45.836225 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.25s]
[0m06:06:45.837561 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:06:45.840193 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m06:06:45.841038 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:06:45.841945 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m06:06:45.842911 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:06:45.844232 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m06:06:45.845183 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:06:45.845823 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m06:06:45.846463 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:06:45.850937 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m06:06:45.856161 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:06:45.857588 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m06:06:45.858235 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:06:45.862671 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m06:06:45.866856 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:06:45.868094 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:06:45.868703 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:06:45.869217 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m06:06:45.869934 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:06:45.870757 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:06:45.871810 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:06:45.884814 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m06:06:45.885670 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:06:45.886620 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:06:45.887236 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m06:06:45.888761 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:06:45.889761 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m06:06:45.896413 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m06:06:45.901441 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:06:45.902151 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.014 seconds
[0m06:06:45.902697 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:06:45.906812 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:06:45.908353 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m06:06:45.909353 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:06:45.914916 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:06:45.915515 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m06:06:45.916155 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:06:45.921018 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:06:45.921852 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m06:06:45.922399 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:06:45.926328 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:06:45.928030 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m06:06:45.928705 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:06:45.931179 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:06:45.931808 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:06:45.932426 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:06:45.933166 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:06:45.937999 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m06:06:45.941447 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:06:45.942673 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:06:45.944394 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m06:06:45.945045 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:06:45.949526 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m06:06:45.951175 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:06:45.951925 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m06:06:45.956516 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m06:06:45.958669 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:06:45.959594 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd057837c-cd1b-4345-afb2-df64010e7d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cb1ba33860>]}
[0m06:06:45.962143 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.009 seconds
[0m06:06:45.960830 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.11s]
[0m06:06:45.965243 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m06:06:45.966387 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:06:45.967897 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd057837c-cd1b-4345-afb2-df64010e7d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cb188797c0>]}
[0m06:06:45.969303 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.12s]
[0m06:06:45.970618 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m06:06:45.973698 [debug] [MainThread]: Using postgres connection "master"
[0m06:06:45.974225 [debug] [MainThread]: On master: BEGIN
[0m06:06:45.974660 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:06:45.987273 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m06:06:45.988228 [debug] [MainThread]: On master: COMMIT
[0m06:06:45.989015 [debug] [MainThread]: Using postgres connection "master"
[0m06:06:45.989466 [debug] [MainThread]: On master: COMMIT
[0m06:06:45.990204 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:06:45.990677 [debug] [MainThread]: On master: Close
[0m06:06:45.991452 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:06:45.991923 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:06:45.992321 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m06:06:45.992708 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:06:45.993258 [info ] [MainThread]: 
[0m06:06:45.993879 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m06:06:45.996741 [debug] [MainThread]: Command end result
[0m06:06:46.035640 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:06:46.038393 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:06:46.047174 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:06:46.047964 [info ] [MainThread]: 
[0m06:06:46.048897 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:06:46.050561 [info ] [MainThread]: 
[0m06:06:46.051718 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:06:46.054661 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1318307, "process_in_blocks": "1984", "process_kernel_time": 0.770318, "process_mem_max_rss": "107800", "process_out_blocks": "3392", "process_user_time": 3.587377}
[0m06:06:46.056217 [debug] [MainThread]: Command `dbt run` succeeded at 06:06:46.055913 after 2.13 seconds
[0m06:06:46.057157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cb1e779fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cb1ca97290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cb1ca96f00>]}
[0m06:06:46.058103 [debug] [MainThread]: Flushing usage events
[0m06:06:47.594467 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:07:43.317500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcc5c67afc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcc5c67b3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcc5c67a300>]}


============================== 06:07:43.439532 | 5e504917-f667-49b7-b3f9-6beb652cf6cc ==============================
[0m06:07:43.439532 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:07:43.442373 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:07:44.669594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e504917-f667-49b7-b3f9-6beb652cf6cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcc5c1b0aa0>]}
[0m06:07:44.796633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e504917-f667-49b7-b3f9-6beb652cf6cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcc5c063350>]}
[0m06:07:44.797847 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:07:44.945565 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:07:45.154293 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:07:45.154788 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:07:45.216281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e504917-f667-49b7-b3f9-6beb652cf6cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcc5a87e4b0>]}
[0m06:07:45.329837 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:07:45.332839 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:07:45.738616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e504917-f667-49b7-b3f9-6beb652cf6cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcc5a557260>]}
[0m06:07:45.739303 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:07:45.739874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e504917-f667-49b7-b3f9-6beb652cf6cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcc5a574bc0>]}
[0m06:07:45.743074 [info ] [MainThread]: 
[0m06:07:45.743803 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:07:45.744828 [info ] [MainThread]: 
[0m06:07:45.745845 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:07:45.751692 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:07:46.372766 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:07:46.373444 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:07:46.373970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:07:46.407093 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.033 seconds
[0m06:07:46.409477 [debug] [ThreadPool]: On list_db: Close
[0m06:07:46.411878 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:07:46.419883 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:07:46.420616 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:07:46.421190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:07:46.434406 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m06:07:46.435548 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:07:46.436466 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:07:46.440352 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m06:07:46.442425 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:07:46.444345 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:07:46.455880 [debug] [MainThread]: Using postgres connection "master"
[0m06:07:46.456897 [debug] [MainThread]: On master: BEGIN
[0m06:07:46.457681 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:07:46.470446 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m06:07:46.471518 [debug] [MainThread]: Using postgres connection "master"
[0m06:07:46.473087 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:07:46.479992 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m06:07:46.482507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e504917-f667-49b7-b3f9-6beb652cf6cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcc5c2ffbf0>]}
[0m06:07:46.483293 [debug] [MainThread]: On master: ROLLBACK
[0m06:07:46.484266 [debug] [MainThread]: Using postgres connection "master"
[0m06:07:46.484814 [debug] [MainThread]: On master: BEGIN
[0m06:07:46.486034 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:07:46.486825 [debug] [MainThread]: On master: COMMIT
[0m06:07:46.487473 [debug] [MainThread]: Using postgres connection "master"
[0m06:07:46.488419 [debug] [MainThread]: On master: COMMIT
[0m06:07:46.489643 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m06:07:46.490392 [debug] [MainThread]: On master: Close
[0m06:07:46.497875 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:07:46.498885 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:07:46.499727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:07:46.500369 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:07:46.513602 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:07:46.514657 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:07:46.848287 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:07:46.850610 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:07:46.851598 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:07:46.853023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:46.874069 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m06:07:46.875164 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:07:46.875878 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m06:07:46.885443 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m06:07:46.899670 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:07:46.900773 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:07:46.902260 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:07:46.907752 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:07:46.908635 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:07:46.910259 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:07:46.958365 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:07:46.959380 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:07:46.962868 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:07:47.318281 [debug] [Thread-1 (]: SQL status: COMMIT in 0.354 seconds
[0m06:07:47.337447 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:07:47.353503 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:07:47.354843 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:07:47.362820 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m06:07:47.367119 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:07:47.370422 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e504917-f667-49b7-b3f9-6beb652cf6cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcc5cc320c0>]}
[0m06:07:47.373017 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.87s]
[0m06:07:47.375757 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:07:47.379328 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m06:07:47.380582 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:07:47.381961 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m06:07:47.383618 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:07:47.385422 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m06:07:47.386897 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:07:47.388102 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m06:07:47.389058 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:07:47.393534 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m06:07:47.397823 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:07:47.399103 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m06:07:47.404590 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m06:07:47.405541 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:07:47.409866 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:07:47.411342 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:07:47.412486 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m06:07:47.413422 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:07:47.414049 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:07:47.414823 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:07:47.415904 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:07:47.428178 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m06:07:47.429132 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:07:47.429713 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m06:07:47.535709 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.105 seconds
[0m06:07:47.542403 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:07:47.543085 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:07:47.544294 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:07:47.548246 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:07:47.548918 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:07:47.549920 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:07:47.552078 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:07:47.552537 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:07:47.553051 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:07:47.668790 [debug] [Thread-3 (]: SQL status: BEGIN in 0.254 seconds
[0m06:07:47.669976 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:07:47.670953 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:07:47.673590 [debug] [Thread-4 (]: SQL status: COMMIT in 0.120 seconds
[0m06:07:47.680679 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:07:47.683230 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:07:47.685115 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:07:47.686496 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.014 seconds
[0m06:07:47.693368 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:07:47.693989 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.008 seconds
[0m06:07:47.694506 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m06:07:47.696726 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:07:47.698371 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e504917-f667-49b7-b3f9-6beb652cf6cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcc598e5a60>]}
[0m06:07:47.699474 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:07:47.701351 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.31s]
[0m06:07:47.709481 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:07:47.711274 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:07:47.712389 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m06:07:47.714695 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:07:47.717663 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:07:47.718472 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:07:47.719055 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:07:47.840227 [debug] [Thread-3 (]: SQL status: COMMIT in 0.120 seconds
[0m06:07:47.843863 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m06:07:47.844708 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:07:47.845257 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m06:07:47.851146 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.005 seconds
[0m06:07:47.854347 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m06:07:47.855961 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e504917-f667-49b7-b3f9-6beb652cf6cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcc597f12e0>]}
[0m06:07:47.857968 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.47s]
[0m06:07:47.859441 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m06:07:47.862217 [debug] [MainThread]: Using postgres connection "master"
[0m06:07:47.862751 [debug] [MainThread]: On master: BEGIN
[0m06:07:47.863176 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:07:47.884615 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m06:07:47.885213 [debug] [MainThread]: On master: COMMIT
[0m06:07:47.885707 [debug] [MainThread]: Using postgres connection "master"
[0m06:07:47.886132 [debug] [MainThread]: On master: COMMIT
[0m06:07:47.886860 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:07:47.887398 [debug] [MainThread]: On master: Close
[0m06:07:47.888168 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:07:47.888772 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:07:47.889226 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m06:07:47.889673 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:07:47.890952 [info ] [MainThread]: 
[0m06:07:47.893161 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.15 seconds (2.15s).
[0m06:07:47.900235 [debug] [MainThread]: Command end result
[0m06:07:47.945844 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:07:47.948197 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:07:47.957983 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:07:47.958754 [info ] [MainThread]: 
[0m06:07:47.959833 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:07:47.961068 [info ] [MainThread]: 
[0m06:07:47.962471 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:07:47.964734 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.8897786, "process_in_blocks": "1624", "process_kernel_time": 1.427921, "process_mem_max_rss": "108360", "process_out_blocks": "3408", "process_user_time": 4.519878}
[0m06:07:47.965492 [debug] [MainThread]: Command `dbt run` succeeded at 06:07:47.965304 after 4.89 seconds
[0m06:07:47.966011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcc5c140140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcc5cc320c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dcc5cc51010>]}
[0m06:07:47.966540 [debug] [MainThread]: Flushing usage events
[0m06:07:51.208799 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:08:44.210560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773a40d15e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773a3f84cda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773a3f648ce0>]}


============================== 06:08:44.218303 | 461cc820-f591-4afe-9f7a-31897114ade9 ==============================
[0m06:08:44.218303 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:08:44.219733 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:08:44.569068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '461cc820-f591-4afe-9f7a-31897114ade9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773a3ed2a5a0>]}
[0m06:08:44.685879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '461cc820-f591-4afe-9f7a-31897114ade9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773a3ee2ecf0>]}
[0m06:08:44.687330 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:08:44.881774 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:08:45.111461 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:08:45.112731 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:08:45.233499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '461cc820-f591-4afe-9f7a-31897114ade9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773a3f03e990>]}
[0m06:08:45.396031 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:08:45.399492 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:08:45.469284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '461cc820-f591-4afe-9f7a-31897114ade9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773a3d1e75f0>]}
[0m06:08:45.469980 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:08:45.470566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '461cc820-f591-4afe-9f7a-31897114ade9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773a3d515a60>]}
[0m06:08:45.473787 [info ] [MainThread]: 
[0m06:08:45.474612 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:08:45.475431 [info ] [MainThread]: 
[0m06:08:45.477115 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:08:45.485484 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:08:45.565268 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:08:45.566071 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:08:45.566516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:08:45.580961 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m06:08:45.583134 [debug] [ThreadPool]: On list_db: Close
[0m06:08:45.585884 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:08:45.594458 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:08:45.594902 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:08:45.595281 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:08:45.617267 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m06:08:45.618456 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:08:45.619186 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:08:45.635059 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.015 seconds
[0m06:08:45.637128 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:08:45.638115 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:08:45.646124 [debug] [MainThread]: Using postgres connection "master"
[0m06:08:45.647232 [debug] [MainThread]: On master: BEGIN
[0m06:08:45.647816 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:08:45.662664 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m06:08:45.663636 [debug] [MainThread]: Using postgres connection "master"
[0m06:08:45.664475 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:08:45.676122 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m06:08:45.679561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '461cc820-f591-4afe-9f7a-31897114ade9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773a400e7200>]}
[0m06:08:45.680344 [debug] [MainThread]: On master: ROLLBACK
[0m06:08:45.681238 [debug] [MainThread]: Using postgres connection "master"
[0m06:08:45.681876 [debug] [MainThread]: On master: BEGIN
[0m06:08:45.683636 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:08:45.684638 [debug] [MainThread]: On master: COMMIT
[0m06:08:45.685619 [debug] [MainThread]: Using postgres connection "master"
[0m06:08:45.686242 [debug] [MainThread]: On master: COMMIT
[0m06:08:45.687118 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:08:45.687813 [debug] [MainThread]: On master: Close
[0m06:08:45.695471 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:08:45.698563 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:08:45.700277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:08:45.701411 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:08:45.713826 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:08:45.714897 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:08:45.778587 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:08:45.780131 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:08:45.780845 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:08:45.781449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:08:45.809120 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m06:08:45.810477 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:08:45.811253 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m06:08:45.818051 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m06:08:45.834264 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:08:45.835136 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:08:45.836811 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:08:45.842551 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:08:45.843522 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:08:45.845541 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:08:45.881505 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:08:45.882259 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:08:45.882835 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:08:45.889012 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m06:08:45.902035 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:08:45.913161 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:08:45.914061 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:08:45.921873 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m06:08:45.927602 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:08:45.931619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '461cc820-f591-4afe-9f7a-31897114ade9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773a3f8825d0>]}
[0m06:08:45.933682 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.23s]
[0m06:08:45.935430 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:08:45.937964 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m06:08:45.940750 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:08:45.939652 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m06:08:45.942620 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:08:45.944097 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m06:08:45.945078 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:08:45.945909 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m06:08:45.946636 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:08:45.954385 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m06:08:45.958332 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:08:45.959718 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:08:45.960365 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m06:08:45.964466 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:08:45.968282 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m06:08:45.969767 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:08:45.970567 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:08:45.971200 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:08:45.971771 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m06:08:45.972477 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:08:45.973135 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:08:45.986559 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m06:08:45.987549 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:08:45.988563 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m06:08:45.989359 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m06:08:45.990074 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:08:45.990937 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:08:45.995449 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m06:08:45.996594 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m06:08:46.001900 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:08:46.006200 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:08:46.006908 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m06:08:46.007598 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:08:46.008853 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:08:46.009444 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:08:46.013034 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:08:46.018285 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:08:46.019050 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m06:08:46.019786 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:08:46.020986 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:08:46.023356 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:08:46.023916 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m06:08:46.024457 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:08:46.026850 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:08:46.027529 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:08:46.028149 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:08:46.028989 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:08:46.033800 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m06:08:46.037777 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m06:08:46.038408 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m06:08:46.039485 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:08:46.043835 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:08:46.044550 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m06:08:46.045619 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:08:46.046478 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:08:46.052539 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m06:08:46.055075 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m06:08:46.055966 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '461cc820-f591-4afe-9f7a-31897114ade9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773a3c2d3a70>]}
[0m06:08:46.057125 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.11s]
[0m06:08:46.058107 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.011 seconds
[0m06:08:46.059450 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m06:08:46.061604 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:08:46.063066 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '461cc820-f591-4afe-9f7a-31897114ade9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773a3c28c1d0>]}
[0m06:08:46.064002 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.12s]
[0m06:08:46.065164 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:08:46.069189 [debug] [MainThread]: Using postgres connection "master"
[0m06:08:46.070019 [debug] [MainThread]: On master: BEGIN
[0m06:08:46.070489 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:08:46.082855 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m06:08:46.083762 [debug] [MainThread]: On master: COMMIT
[0m06:08:46.084422 [debug] [MainThread]: Using postgres connection "master"
[0m06:08:46.084845 [debug] [MainThread]: On master: COMMIT
[0m06:08:46.085770 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:08:46.086200 [debug] [MainThread]: On master: Close
[0m06:08:46.087009 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:08:46.087562 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:08:46.088045 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m06:08:46.088509 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:08:46.089617 [info ] [MainThread]: 
[0m06:08:46.090853 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m06:08:46.093943 [debug] [MainThread]: Command end result
[0m06:08:46.127511 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:08:46.130513 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:08:46.139148 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:08:46.140184 [info ] [MainThread]: 
[0m06:08:46.141079 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:08:46.142320 [info ] [MainThread]: 
[0m06:08:46.143422 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:08:46.145403 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0036561, "process_in_blocks": "2296", "process_kernel_time": 0.657023, "process_mem_max_rss": "108180", "process_out_blocks": "3408", "process_user_time": 3.672497}
[0m06:08:46.146250 [debug] [MainThread]: Command `dbt run` succeeded at 06:08:46.146082 after 2.00 seconds
[0m06:08:46.146720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773a40d15e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773a3f5511f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773a3ed7bd40>]}
[0m06:08:46.147210 [debug] [MainThread]: Flushing usage events
[0m06:08:47.593905 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:09:44.554963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7716c7a86120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7716c95c8350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7716c7b3cbf0>]}


============================== 06:09:44.570364 | a19bed14-0d7d-4162-99d7-16e5e6543f1f ==============================
[0m06:09:44.570364 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:09:44.571823 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:09:45.224742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a19bed14-0d7d-4162-99d7-16e5e6543f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7716c91ab350>]}
[0m06:09:45.340920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a19bed14-0d7d-4162-99d7-16e5e6543f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7716c7957470>]}
[0m06:09:45.342882 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:09:45.581991 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:09:45.821092 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:09:45.821585 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:09:45.880617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a19bed14-0d7d-4162-99d7-16e5e6543f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7716c751b410>]}
[0m06:09:45.985251 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:09:45.988369 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:09:45.739173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a19bed14-0d7d-4162-99d7-16e5e6543f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7716c56f0bc0>]}
[0m06:09:45.739889 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:09:45.740633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a19bed14-0d7d-4162-99d7-16e5e6543f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7716c577d430>]}
[0m06:09:45.743042 [info ] [MainThread]: 
[0m06:09:45.743598 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:09:45.744353 [info ] [MainThread]: 
[0m06:09:45.745517 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:09:45.752554 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:09:45.838044 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:09:45.838528 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:09:45.838871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:09:45.907390 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.068 seconds
[0m06:09:45.909548 [debug] [ThreadPool]: On list_db: Close
[0m06:09:45.912083 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:09:45.922745 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:09:45.923454 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:09:45.924130 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:09:44.025612 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m06:09:44.117891 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:09:44.118822 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:09:44.128453 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m06:09:44.130349 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:09:44.131095 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:09:44.137964 [debug] [MainThread]: Using postgres connection "master"
[0m06:09:44.138393 [debug] [MainThread]: On master: BEGIN
[0m06:09:44.138728 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:09:44.149944 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m06:09:44.150879 [debug] [MainThread]: Using postgres connection "master"
[0m06:09:44.151959 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:09:44.157153 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m06:09:44.160194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a19bed14-0d7d-4162-99d7-16e5e6543f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7716c577d430>]}
[0m06:09:44.161402 [debug] [MainThread]: On master: ROLLBACK
[0m06:09:44.162726 [debug] [MainThread]: Using postgres connection "master"
[0m06:09:44.163187 [debug] [MainThread]: On master: BEGIN
[0m06:09:44.164404 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:09:44.164990 [debug] [MainThread]: On master: COMMIT
[0m06:09:44.165693 [debug] [MainThread]: Using postgres connection "master"
[0m06:09:44.166122 [debug] [MainThread]: On master: COMMIT
[0m06:09:44.166729 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:09:44.167132 [debug] [MainThread]: On master: Close
[0m06:09:44.172384 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:09:44.173852 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:09:44.174848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:09:44.176089 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:09:44.185383 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:09:44.186457 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:09:44.238622 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:09:44.239536 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:09:44.240098 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:09:44.240479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:09:44.253663 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m06:09:44.254671 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:09:44.255552 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m06:09:44.264025 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m06:09:44.277042 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:09:44.277705 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:09:44.278794 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:09:44.286909 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:09:44.287815 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:09:44.288930 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:09:44.321022 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:09:44.321500 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:09:44.321987 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:09:44.581661 [debug] [Thread-1 (]: SQL status: COMMIT in 0.259 seconds
[0m06:09:44.598905 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:09:44.613988 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:09:44.614649 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:09:44.623840 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m06:09:44.628234 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:09:44.630774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a19bed14-0d7d-4162-99d7-16e5e6543f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7716c7d826c0>]}
[0m06:09:44.632705 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.45s]
[0m06:09:44.635702 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:09:44.638048 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m06:09:44.638692 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:09:44.639518 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m06:09:44.640493 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:09:44.641743 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m06:09:44.642776 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:09:44.643412 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m06:09:44.644090 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:09:44.648554 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m06:09:44.655348 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:09:44.657311 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m06:09:44.663291 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:09:44.665403 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m06:09:44.670608 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:09:44.672196 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:09:44.672950 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m06:09:44.673561 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:09:44.674205 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:09:44.674938 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:09:44.676130 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:09:44.693367 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m06:09:44.695421 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:09:44.696360 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:09:44.698797 [debug] [Thread-4 (]: SQL status: BEGIN in 0.022 seconds
[0m06:09:44.701356 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:09:44.702206 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m06:09:44.713119 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.015 seconds
[0m06:09:44.718086 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:09:44.718744 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.016 seconds
[0m06:09:44.719838 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m06:09:44.726685 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:09:44.728238 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:09:44.729999 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:09:44.737988 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m06:09:44.742418 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:09:44.747515 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:09:44.748402 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m06:09:44.748982 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:09:44.749968 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:09:44.750456 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:09:44.752665 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:09:44.757666 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:09:44.758373 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:09:44.758944 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:09:44.759765 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:09:44.760459 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:09:44.791309 [debug] [Thread-3 (]: SQL status: COMMIT in 0.030 seconds
[0m06:09:44.795417 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m06:09:44.796305 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:09:44.796728 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m06:09:44.797606 [debug] [Thread-4 (]: SQL status: COMMIT in 0.036 seconds
[0m06:09:44.803328 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:09:44.805129 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:09:44.805842 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:09:44.809368 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.012 seconds
[0m06:09:44.811272 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m06:09:44.812447 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a19bed14-0d7d-4162-99d7-16e5e6543f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7716c4972870>]}
[0m06:09:44.813469 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.17s]
[0m06:09:44.814500 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m06:09:44.943238 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.137 seconds
[0m06:09:44.946576 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:09:44.947733 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a19bed14-0d7d-4162-99d7-16e5e6543f1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7716c4888080>]}
[0m06:09:44.948871 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.30s]
[0m06:09:44.951137 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:09:44.956489 [debug] [MainThread]: Using postgres connection "master"
[0m06:09:44.957710 [debug] [MainThread]: On master: BEGIN
[0m06:09:44.958959 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:09:45.112338 [debug] [MainThread]: SQL status: BEGIN in 0.153 seconds
[0m06:09:45.113651 [debug] [MainThread]: On master: COMMIT
[0m06:09:45.114861 [debug] [MainThread]: Using postgres connection "master"
[0m06:09:45.116069 [debug] [MainThread]: On master: COMMIT
[0m06:09:45.117487 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:09:45.118554 [debug] [MainThread]: On master: Close
[0m06:09:45.120577 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:09:45.122742 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:09:45.123925 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m06:09:45.125176 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:09:45.126246 [info ] [MainThread]: 
[0m06:09:45.128251 [info ] [MainThread]: Finished running 3 table models in -1 hours 59 minutes and 59.38 seconds (-0.62s).
[0m06:09:45.130677 [debug] [MainThread]: Command end result
[0m06:09:45.166978 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:09:45.169529 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:09:45.422369 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:09:45.422865 [info ] [MainThread]: 
[0m06:09:45.423595 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:09:45.424550 [info ] [MainThread]: 
[0m06:09:45.425569 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:09:45.429530 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.1743963, "process_in_blocks": "5792", "process_kernel_time": 0.784302, "process_mem_max_rss": "108172", "process_out_blocks": "3400", "process_user_time": 3.86949}
[0m06:09:45.430593 [debug] [MainThread]: Command `dbt run` succeeded at 06:09:45.430420 after 3.18 seconds
[0m06:09:45.431243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7716c7e9b680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7716c7a86120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7716c7da0200>]}
[0m06:09:45.432166 [debug] [MainThread]: Flushing usage events
[0m06:09:46.664359 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:10:42.094369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7617dc5bf470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7617ddf405f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7617dcbb36e0>]}


============================== 06:10:42.106387 | f3c9d891-175f-4caf-9048-f21e71c7311d ==============================
[0m06:10:42.106387 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:10:42.107465 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:10:42.424245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3c9d891-175f-4caf-9048-f21e71c7311d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7617dc233710>]}
[0m06:10:42.522015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3c9d891-175f-4caf-9048-f21e71c7311d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7617dc98ca10>]}
[0m06:10:42.523232 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:10:42.655451 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:10:42.849003 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:10:42.849857 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:10:42.911835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3c9d891-175f-4caf-9048-f21e71c7311d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7617dc8d2360>]}
[0m06:10:43.037599 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:10:43.041449 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:10:43.072827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3c9d891-175f-4caf-9048-f21e71c7311d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7617da7119d0>]}
[0m06:10:43.073785 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:10:43.074797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3c9d891-175f-4caf-9048-f21e71c7311d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7617da4073e0>]}
[0m06:10:43.077762 [info ] [MainThread]: 
[0m06:10:43.078589 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:10:43.079675 [info ] [MainThread]: 
[0m06:10:43.080973 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:10:43.087712 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:10:43.164312 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:10:43.164904 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:10:43.165623 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:10:43.181139 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m06:10:43.183060 [debug] [ThreadPool]: On list_db: Close
[0m06:10:43.185802 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:10:43.193082 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:10:43.193721 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:10:43.194154 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:10:43.206989 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m06:10:43.207870 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:10:43.208675 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:10:43.213524 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m06:10:43.215367 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:10:43.216384 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:10:43.226916 [debug] [MainThread]: Using postgres connection "master"
[0m06:10:43.227525 [debug] [MainThread]: On master: BEGIN
[0m06:10:43.228002 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:10:43.241873 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m06:10:43.242866 [debug] [MainThread]: Using postgres connection "master"
[0m06:10:43.243532 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:10:43.249083 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m06:10:43.253385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3c9d891-175f-4caf-9048-f21e71c7311d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7617da407b60>]}
[0m06:10:43.254623 [debug] [MainThread]: On master: ROLLBACK
[0m06:10:43.255714 [debug] [MainThread]: Using postgres connection "master"
[0m06:10:43.256473 [debug] [MainThread]: On master: BEGIN
[0m06:10:43.258362 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:10:43.259340 [debug] [MainThread]: On master: COMMIT
[0m06:10:43.260042 [debug] [MainThread]: Using postgres connection "master"
[0m06:10:43.260547 [debug] [MainThread]: On master: COMMIT
[0m06:10:43.261626 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m06:10:43.262158 [debug] [MainThread]: On master: Close
[0m06:10:43.269357 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:10:43.270886 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:10:43.272261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:10:43.273073 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:10:43.284098 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:10:43.285054 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:10:43.339520 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:10:43.341199 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:10:43.341833 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:10:43.342324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:10:43.357140 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m06:10:43.358258 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:10:43.358976 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m06:10:43.370813 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.011 seconds
[0m06:10:43.379736 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:10:43.380248 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:10:43.381782 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:10:43.386046 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:10:43.386649 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:10:43.388329 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:10:43.420822 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:10:43.421924 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:10:43.422513 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:10:43.427940 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m06:10:43.439856 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:10:43.446714 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:10:43.447199 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:10:43.453860 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m06:10:43.456999 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:10:43.459395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3c9d891-175f-4caf-9048-f21e71c7311d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7617dca9a090>]}
[0m06:10:43.460625 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.19s]
[0m06:10:43.461876 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:10:43.464176 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m06:10:43.465359 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:10:43.466650 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m06:10:43.467935 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:10:43.469487 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m06:10:43.470607 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:10:43.471393 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m06:10:43.472192 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:10:43.476625 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m06:10:43.480029 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:10:43.481640 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m06:10:43.486063 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m06:10:43.486754 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:10:43.491198 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:10:43.492722 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:10:43.494016 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m06:10:43.494873 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:10:43.495658 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:10:43.496895 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:10:43.497840 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:10:43.513037 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m06:10:43.514223 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:10:43.515424 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:10:43.516270 [debug] [Thread-4 (]: SQL status: BEGIN in 0.018 seconds
[0m06:10:43.517507 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:10:43.518414 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m06:10:43.523817 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m06:10:43.524909 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.008 seconds
[0m06:10:43.530331 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:10:43.534463 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:10:43.535377 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:10:43.536083 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m06:10:43.537746 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:10:43.538696 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:10:43.543770 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:10:43.548365 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:10:43.549296 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m06:10:43.550357 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:10:43.551837 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:10:43.552503 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:10:43.555280 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:10:43.558524 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:10:43.559604 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:10:43.560618 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:10:43.561834 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:10:43.562778 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:10:43.701221 [debug] [Thread-3 (]: SQL status: COMMIT in 0.137 seconds
[0m06:10:43.709376 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m06:10:43.710497 [debug] [Thread-4 (]: SQL status: COMMIT in 0.147 seconds
[0m06:10:43.711996 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:10:43.715810 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:10:43.716663 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m06:10:43.717893 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:10:43.718904 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:10:43.726434 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.008 seconds
[0m06:10:43.730764 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m06:10:43.732566 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3c9d891-175f-4caf-9048-f21e71c7311d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7617d84bfa40>]}
[0m06:10:43.734273 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.26s]
[0m06:10:43.735988 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m06:10:43.852431 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.133 seconds
[0m06:10:43.854794 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:10:43.855730 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3c9d891-175f-4caf-9048-f21e71c7311d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7617d95ce6f0>]}
[0m06:10:43.856628 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.39s]
[0m06:10:43.857620 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:10:43.861109 [debug] [MainThread]: Using postgres connection "master"
[0m06:10:43.861688 [debug] [MainThread]: On master: BEGIN
[0m06:10:43.862148 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:10:43.877308 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m06:10:43.878055 [debug] [MainThread]: On master: COMMIT
[0m06:10:43.878671 [debug] [MainThread]: Using postgres connection "master"
[0m06:10:43.879139 [debug] [MainThread]: On master: COMMIT
[0m06:10:43.879875 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:10:43.880374 [debug] [MainThread]: On master: Close
[0m06:10:43.881101 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:10:43.881613 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:10:43.882041 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m06:10:43.882459 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:10:43.883043 [info ] [MainThread]: 
[0m06:10:43.883664 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m06:10:43.887539 [debug] [MainThread]: Command end result
[0m06:10:43.922932 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:10:43.925648 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:10:43.934071 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:10:43.934703 [info ] [MainThread]: 
[0m06:10:43.935609 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:10:43.936651 [info ] [MainThread]: 
[0m06:10:43.937831 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:10:43.939915 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.917764, "process_in_blocks": "1728", "process_kernel_time": 0.639652, "process_mem_max_rss": "108528", "process_out_blocks": "3400", "process_user_time": 3.932537}
[0m06:10:43.940614 [debug] [MainThread]: Command `dbt run` succeeded at 06:10:43.940455 after 1.92 seconds
[0m06:10:43.941158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7617dc652330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7617dc914f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7617ddf405f0>]}
[0m06:10:43.941724 [debug] [MainThread]: Flushing usage events
[0m06:10:45.478677 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:11:46.063704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73147663e420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731475c5ce30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731477cb1760>]}


============================== 06:11:46.074161 | fc21a303-8c61-4631-8d7f-cfd00720880e ==============================
[0m06:11:46.074161 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:11:46.075072 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:11:46.426651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc21a303-8c61-4631-8d7f-cfd00720880e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731475b4f410>]}
[0m06:11:46.551485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc21a303-8c61-4631-8d7f-cfd00720880e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73147663c0b0>]}
[0m06:11:46.552759 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:11:46.726756 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:11:46.960405 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:11:46.962778 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:11:47.036343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc21a303-8c61-4631-8d7f-cfd00720880e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7314740c1520>]}
[0m06:11:47.168752 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:11:47.175760 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:11:47.240496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc21a303-8c61-4631-8d7f-cfd00720880e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731473d9b5c0>]}
[0m06:11:47.241274 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:11:47.242188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc21a303-8c61-4631-8d7f-cfd00720880e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7314740c1640>]}
[0m06:11:47.246404 [info ] [MainThread]: 
[0m06:11:47.247457 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:11:47.248304 [info ] [MainThread]: 
[0m06:11:47.251165 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:11:47.257705 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:11:47.354922 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:11:47.355628 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:11:47.356355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:11:47.373736 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.017 seconds
[0m06:11:47.375684 [debug] [ThreadPool]: On list_db: Close
[0m06:11:47.378552 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:11:47.386396 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:11:47.388270 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:11:47.388845 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:11:47.400781 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m06:11:47.401634 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:11:47.402503 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:11:47.415206 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.012 seconds
[0m06:11:47.417085 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:11:47.418082 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:11:47.427814 [debug] [MainThread]: Using postgres connection "master"
[0m06:11:47.428511 [debug] [MainThread]: On master: BEGIN
[0m06:11:47.429106 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:11:47.457737 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m06:11:47.459379 [debug] [MainThread]: Using postgres connection "master"
[0m06:11:47.460212 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:11:47.474274 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m06:11:47.476494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc21a303-8c61-4631-8d7f-cfd00720880e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73147400a510>]}
[0m06:11:47.477188 [debug] [MainThread]: On master: ROLLBACK
[0m06:11:47.478130 [debug] [MainThread]: Using postgres connection "master"
[0m06:11:47.478540 [debug] [MainThread]: On master: BEGIN
[0m06:11:47.479591 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:11:47.480545 [debug] [MainThread]: On master: COMMIT
[0m06:11:47.481631 [debug] [MainThread]: Using postgres connection "master"
[0m06:11:47.482410 [debug] [MainThread]: On master: COMMIT
[0m06:11:47.483514 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m06:11:47.483994 [debug] [MainThread]: On master: Close
[0m06:11:47.492112 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:11:47.494242 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:11:47.495787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:11:47.496547 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:11:47.507722 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:11:47.508518 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:11:47.566853 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:11:47.567833 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:11:47.568349 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:11:47.568764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:11:47.587444 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m06:11:47.588260 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:11:47.588890 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m06:11:47.600568 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.011 seconds
[0m06:11:47.647426 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:11:47.649305 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:11:47.652721 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:11:47.676435 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:11:47.678840 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:11:47.691539 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:11:47.725437 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:11:47.727513 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:11:47.729042 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:11:47.740639 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m06:11:47.754369 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:11:47.763631 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:11:47.764228 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:11:47.773385 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.009 seconds
[0m06:11:47.779486 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:11:47.782117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc21a303-8c61-4631-8d7f-cfd00720880e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731476476900>]}
[0m06:11:47.783137 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.29s]
[0m06:11:47.784590 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:11:47.787060 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m06:11:47.787905 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:11:47.788687 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m06:11:47.790178 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:11:47.791592 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m06:11:47.792456 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:11:47.793144 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m06:11:47.793997 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:11:47.799946 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m06:11:47.803761 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:11:47.805030 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:11:47.805669 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m06:11:47.814577 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:11:47.818968 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m06:11:47.820184 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:11:47.821138 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:11:47.821862 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:11:47.823137 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:11:47.824344 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m06:11:47.825716 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:11:47.838558 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m06:11:47.839722 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:11:47.840529 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m06:11:47.842729 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m06:11:47.844242 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:11:47.847547 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:11:47.848661 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m06:11:47.855364 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:11:47.855973 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m06:11:47.856957 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:11:47.865532 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:11:47.867170 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m06:11:47.868418 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:11:47.875498 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m06:11:47.877407 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:11:47.883614 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:11:47.884452 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:11:47.885271 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m06:11:47.886883 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:11:47.887751 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:11:47.891735 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:11:47.894200 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:11:47.894894 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:11:47.895541 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:11:47.896466 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:11:47.897959 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:11:47.903343 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m06:11:47.907568 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:11:47.908491 [debug] [Thread-3 (]: SQL status: COMMIT in 0.009 seconds
[0m06:11:47.909865 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:11:47.916281 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m06:11:47.917501 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:11:47.920579 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:11:47.932058 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m06:11:47.943492 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.009 seconds
[0m06:11:47.949957 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m06:11:47.962841 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc21a303-8c61-4631-8d7f-cfd00720880e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731473038620>]}
[0m06:11:47.966955 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.17s]
[0m06:11:47.969515 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m06:11:47.974436 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.043 seconds
[0m06:11:47.981600 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:11:47.996223 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc21a303-8c61-4631-8d7f-cfd00720880e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73147305ffb0>]}
[0m06:11:47.998945 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.20s]
[0m06:11:48.002248 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:11:48.018044 [debug] [MainThread]: Using postgres connection "master"
[0m06:11:48.021162 [debug] [MainThread]: On master: BEGIN
[0m06:11:48.022782 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:11:48.060457 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m06:11:48.062665 [debug] [MainThread]: On master: COMMIT
[0m06:11:48.063781 [debug] [MainThread]: Using postgres connection "master"
[0m06:11:48.064506 [debug] [MainThread]: On master: COMMIT
[0m06:11:48.065533 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:11:48.066913 [debug] [MainThread]: On master: Close
[0m06:11:48.068731 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:11:48.070154 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:11:48.071400 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m06:11:48.072592 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:11:48.075089 [info ] [MainThread]: 
[0m06:11:48.076838 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m06:11:48.079860 [debug] [MainThread]: Command end result
[0m06:11:48.118043 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:11:48.121503 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:11:48.136033 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:11:48.136886 [info ] [MainThread]: 
[0m06:11:48.137940 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:11:48.138926 [info ] [MainThread]: 
[0m06:11:48.140100 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:11:48.142713 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1783957, "process_in_blocks": "560", "process_kernel_time": 0.998057, "process_mem_max_rss": "108352", "process_out_blocks": "3400", "process_user_time": 5.198393}
[0m06:11:48.144263 [debug] [MainThread]: Command `dbt run` succeeded at 06:11:48.143834 after 2.18 seconds
[0m06:11:48.145098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731473db8ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7314790d6900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731473ee4440>]}
[0m06:11:48.146249 [debug] [MainThread]: Flushing usage events
[0m06:11:49.552361 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:12:44.962186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727029baacf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7270297d03b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727029a09100>]}


============================== 06:12:44.977154 | dad1f8de-fd61-4688-b638-2e6f297a774a ==============================
[0m06:12:44.977154 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:12:44.978323 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:12:45.349395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dad1f8de-fd61-4688-b638-2e6f297a774a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7270294382c0>]}
[0m06:12:45.463507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dad1f8de-fd61-4688-b638-2e6f297a774a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727028fdbe00>]}
[0m06:12:45.464956 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:12:45.633505 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:12:45.850558 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:12:45.851074 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:12:45.915389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dad1f8de-fd61-4688-b638-2e6f297a774a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727027811430>]}
[0m06:12:46.288804 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:12:46.293160 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:12:46.335886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dad1f8de-fd61-4688-b638-2e6f297a774a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7270274af710>]}
[0m06:12:46.336917 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:12:46.337863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dad1f8de-fd61-4688-b638-2e6f297a774a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7270274d1f40>]}
[0m06:12:46.341677 [info ] [MainThread]: 
[0m06:12:46.342644 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:12:46.343486 [info ] [MainThread]: 
[0m06:12:46.344688 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:12:46.351317 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:12:46.432188 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:12:46.433252 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:12:46.434172 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:12:46.452475 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.018 seconds
[0m06:12:46.455241 [debug] [ThreadPool]: On list_db: Close
[0m06:12:46.458862 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:12:46.470629 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:12:46.471277 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:12:46.472009 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:12:46.489889 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m06:12:46.491367 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:12:46.491957 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:12:46.543638 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.051 seconds
[0m06:12:46.546905 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:12:46.548160 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:12:46.563269 [debug] [MainThread]: Using postgres connection "master"
[0m06:12:46.564014 [debug] [MainThread]: On master: BEGIN
[0m06:12:46.564548 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:12:46.578653 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m06:12:46.580258 [debug] [MainThread]: Using postgres connection "master"
[0m06:12:46.581988 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:12:46.589806 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m06:12:46.593033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dad1f8de-fd61-4688-b638-2e6f297a774a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727027624da0>]}
[0m06:12:46.596458 [debug] [MainThread]: On master: ROLLBACK
[0m06:12:46.598528 [debug] [MainThread]: Using postgres connection "master"
[0m06:12:46.600209 [debug] [MainThread]: On master: BEGIN
[0m06:12:46.601767 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:12:46.602556 [debug] [MainThread]: On master: COMMIT
[0m06:12:46.603376 [debug] [MainThread]: Using postgres connection "master"
[0m06:12:46.603895 [debug] [MainThread]: On master: COMMIT
[0m06:12:46.604796 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:12:46.605265 [debug] [MainThread]: On master: Close
[0m06:12:46.613515 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:12:46.615220 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:12:46.616462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:12:46.617767 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:12:46.630081 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:12:46.632707 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:12:46.725995 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:12:46.727584 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:12:46.728273 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:12:46.728814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:12:46.747195 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m06:12:46.748674 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:12:46.749327 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m06:12:46.754595 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m06:12:46.772492 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:12:46.773086 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:12:46.775592 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:12:46.780037 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:12:46.780524 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:12:46.781642 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:12:46.823517 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:12:46.824594 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:12:46.825655 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:12:47.467864 [debug] [Thread-1 (]: SQL status: COMMIT in 0.641 seconds
[0m06:12:47.489579 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:12:47.504926 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:12:47.506223 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:12:48.176402 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.670 seconds
[0m06:12:48.180246 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:12:48.184852 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dad1f8de-fd61-4688-b638-2e6f297a774a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727029b8a000>]}
[0m06:12:48.186042 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 1.57s]
[0m06:12:48.187177 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:12:48.189432 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m06:12:48.190384 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:12:48.191361 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m06:12:48.192542 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:12:48.194483 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m06:12:48.195260 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:12:48.195902 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m06:12:48.196477 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:12:48.201679 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m06:12:48.207316 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:12:48.208615 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:12:48.209642 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m06:12:48.213699 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:12:48.217874 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m06:12:48.221602 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:12:48.222348 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m06:12:48.223108 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:12:48.223946 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:12:48.225048 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:12:48.225865 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:12:48.245923 [debug] [Thread-4 (]: SQL status: BEGIN in 0.020 seconds
[0m06:12:48.247298 [debug] [Thread-3 (]: SQL status: BEGIN in 0.024 seconds
[0m06:12:48.248195 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:12:48.248780 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:12:48.249661 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m06:12:48.250316 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:12:48.254911 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m06:12:48.265578 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:12:48.266299 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:12:48.267422 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:12:48.271130 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:12:48.271591 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:12:48.273036 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:12:48.276473 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:12:48.277065 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:12:48.277605 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:12:48.436725 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.185 seconds
[0m06:12:48.441700 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:12:48.442383 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m06:12:48.443655 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:12:48.447797 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:12:48.448342 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m06:12:48.449391 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:12:48.451576 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:12:48.452184 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:12:48.452679 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:12:48.943710 [debug] [Thread-3 (]: SQL status: COMMIT in 0.490 seconds
[0m06:12:48.944701 [debug] [Thread-4 (]: SQL status: COMMIT in 0.666 seconds
[0m06:12:48.949211 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m06:12:48.953638 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:12:48.954709 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:12:48.955611 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:12:48.956221 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m06:12:48.956898 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:12:48.967006 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.009 seconds
[0m06:12:48.967684 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.010 seconds
[0m06:12:48.970044 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m06:12:48.971889 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:12:48.973042 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dad1f8de-fd61-4688-b638-2e6f297a774a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727024594b90>]}
[0m06:12:48.974158 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dad1f8de-fd61-4688-b638-2e6f297a774a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727026731d00>]}
[0m06:12:48.975443 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.78s]
[0m06:12:48.977222 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.78s]
[0m06:12:48.980502 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m06:12:48.981760 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:12:48.987140 [debug] [MainThread]: Using postgres connection "master"
[0m06:12:48.987769 [debug] [MainThread]: On master: BEGIN
[0m06:12:48.988195 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:12:49.002613 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m06:12:49.003744 [debug] [MainThread]: On master: COMMIT
[0m06:12:49.004367 [debug] [MainThread]: Using postgres connection "master"
[0m06:12:49.004974 [debug] [MainThread]: On master: COMMIT
[0m06:12:49.006069 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m06:12:49.006717 [debug] [MainThread]: On master: Close
[0m06:12:49.007478 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:12:49.007950 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:12:49.008390 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m06:12:49.008816 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:12:49.009643 [info ] [MainThread]: 
[0m06:12:49.010379 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.67 seconds (2.67s).
[0m06:12:49.015862 [debug] [MainThread]: Command end result
[0m06:12:49.080080 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:12:49.084059 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:12:49.100184 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:12:49.101011 [info ] [MainThread]: 
[0m06:12:49.102191 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:12:49.105998 [info ] [MainThread]: 
[0m06:12:49.106881 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:12:49.110769 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.251132, "process_in_blocks": "1496", "process_kernel_time": 0.640778, "process_mem_max_rss": "108428", "process_out_blocks": "3408", "process_user_time": 3.863081}
[0m06:12:49.111941 [debug] [MainThread]: Command `dbt run` succeeded at 06:12:49.111688 after 4.25 seconds
[0m06:12:49.112782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72702a3eb7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727029322840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72702929c560>]}
[0m06:12:49.113679 [debug] [MainThread]: Flushing usage events
[0m06:12:50.653868 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:13:44.444235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7275a5f41ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7275a62043b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7275a7a327e0>]}


============================== 06:13:44.460771 | b5d6062b-3fee-4a9d-bb4f-e947cd12efa1 ==============================
[0m06:13:44.460771 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:13:44.462329 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:13:44.841135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5d6062b-3fee-4a9d-bb4f-e947cd12efa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7275a5a740e0>]}
[0m06:13:44.964924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5d6062b-3fee-4a9d-bb4f-e947cd12efa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7275a5d39a30>]}
[0m06:13:44.966526 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:13:45.147746 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:13:45.376422 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:13:45.378477 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:13:45.576741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5d6062b-3fee-4a9d-bb4f-e947cd12efa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7275a6274140>]}
[0m06:13:45.783749 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:13:45.787753 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:13:45.834888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5d6062b-3fee-4a9d-bb4f-e947cd12efa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7275a3f334d0>]}
[0m06:13:45.836138 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:13:45.837987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5d6062b-3fee-4a9d-bb4f-e947cd12efa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7275a41abaa0>]}
[0m06:13:45.844022 [info ] [MainThread]: 
[0m06:13:45.846352 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:13:45.847478 [info ] [MainThread]: 
[0m06:13:45.848959 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:13:45.859930 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:13:45.966771 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:13:45.967879 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:13:45.968686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:13:46.002195 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.031 seconds
[0m06:13:46.005657 [debug] [ThreadPool]: On list_db: Close
[0m06:13:46.010252 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:13:46.028430 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:13:46.029504 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:13:46.030296 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:13:46.051255 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m06:13:46.053504 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:13:46.054723 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:13:46.067470 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.011 seconds
[0m06:13:46.074961 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:13:46.076313 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:13:46.093074 [debug] [MainThread]: Using postgres connection "master"
[0m06:13:46.094261 [debug] [MainThread]: On master: BEGIN
[0m06:13:46.096033 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:13:46.111400 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m06:13:46.113145 [debug] [MainThread]: Using postgres connection "master"
[0m06:13:46.117202 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:13:46.140033 [debug] [MainThread]: SQL status: SELECT 0 in 0.017 seconds
[0m06:13:46.142636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5d6062b-3fee-4a9d-bb4f-e947cd12efa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7275a41dec30>]}
[0m06:13:46.144065 [debug] [MainThread]: On master: ROLLBACK
[0m06:13:46.145670 [debug] [MainThread]: Using postgres connection "master"
[0m06:13:46.146648 [debug] [MainThread]: On master: BEGIN
[0m06:13:46.148144 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:13:46.148900 [debug] [MainThread]: On master: COMMIT
[0m06:13:46.149546 [debug] [MainThread]: Using postgres connection "master"
[0m06:13:46.150161 [debug] [MainThread]: On master: COMMIT
[0m06:13:46.150875 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:13:46.151446 [debug] [MainThread]: On master: Close
[0m06:13:46.156053 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:13:46.157108 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:13:46.158067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:13:46.158878 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:13:46.172232 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:13:46.173241 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:13:46.244367 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:13:46.245457 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:13:46.245949 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:13:46.246427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:13:46.261674 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m06:13:46.262583 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:13:46.263358 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m06:13:46.269756 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m06:13:46.282175 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:13:46.282858 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:13:46.284079 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:13:46.290548 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:13:46.292394 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:13:46.294208 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:13:46.336385 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:13:46.337192 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:13:46.337881 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:13:46.344212 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m06:13:46.359962 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:13:46.375376 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:13:46.376011 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:13:46.383662 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m06:13:46.387886 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:13:46.390496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5d6062b-3fee-4a9d-bb4f-e947cd12efa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7275a65ce8a0>]}
[0m06:13:46.391717 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.23s]
[0m06:13:46.393295 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:13:46.395589 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m06:13:46.398154 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:13:46.400382 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m06:13:46.403170 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:13:46.404818 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m06:13:46.405947 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:13:46.406742 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m06:13:46.407450 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:13:46.411809 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m06:13:46.421007 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:13:46.423460 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m06:13:46.427951 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m06:13:46.428735 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:13:46.436280 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:13:46.437295 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:13:46.438103 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m06:13:46.438618 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:13:46.439941 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:13:46.440897 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:13:46.441405 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:13:46.456303 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m06:13:46.457883 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:13:46.458939 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:13:46.462252 [debug] [Thread-4 (]: SQL status: BEGIN in 0.021 seconds
[0m06:13:46.463226 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:13:46.464017 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m06:13:46.466009 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m06:13:46.475744 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:13:46.476943 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m06:13:46.480241 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:13:46.485130 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:13:46.486111 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m06:13:46.489234 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:13:46.495141 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:13:46.496032 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:13:46.496672 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:13:46.528173 [debug] [Thread-3 (]: SQL status: COMMIT in 0.031 seconds
[0m06:13:46.532358 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m06:13:46.533062 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.068 seconds
[0m06:13:46.534019 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:13:46.538178 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:13:46.538836 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m06:13:46.539847 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:13:46.542189 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:13:46.546619 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:13:46.547369 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m06:13:46.548044 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:13:46.550503 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m06:13:46.551969 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5d6062b-3fee-4a9d-bb4f-e947cd12efa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7275a3101a30>]}
[0m06:13:46.552606 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:13:46.553592 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.15s]
[0m06:13:46.556625 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:13:46.557865 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m06:13:46.558717 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:13:46.560368 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:13:46.567003 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m06:13:46.570348 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:13:46.571296 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:13:46.571827 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:13:46.578742 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m06:13:46.582315 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:13:46.583391 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5d6062b-3fee-4a9d-bb4f-e947cd12efa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727583f062d0>]}
[0m06:13:46.584404 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.18s]
[0m06:13:46.585737 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:13:46.590275 [debug] [MainThread]: Using postgres connection "master"
[0m06:13:46.590811 [debug] [MainThread]: On master: BEGIN
[0m06:13:46.591546 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:13:46.605593 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m06:13:46.606397 [debug] [MainThread]: On master: COMMIT
[0m06:13:46.607182 [debug] [MainThread]: Using postgres connection "master"
[0m06:13:46.607674 [debug] [MainThread]: On master: COMMIT
[0m06:13:46.608497 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:13:46.609015 [debug] [MainThread]: On master: Close
[0m06:13:46.609763 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:13:46.610232 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:13:46.610683 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m06:13:46.611182 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:13:46.611988 [info ] [MainThread]: 
[0m06:13:46.612907 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m06:13:46.616476 [debug] [MainThread]: Command end result
[0m06:13:46.654023 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:13:46.656654 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:13:46.665388 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:13:46.666289 [info ] [MainThread]: 
[0m06:13:46.668008 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:13:46.669262 [info ] [MainThread]: 
[0m06:13:46.670429 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:13:46.672562 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3429217, "process_in_blocks": "1976", "process_kernel_time": 0.77021, "process_mem_max_rss": "108356", "process_out_blocks": "3408", "process_user_time": 4.318412}
[0m06:13:46.673388 [debug] [MainThread]: Command `dbt run` succeeded at 06:13:46.673218 after 2.34 seconds
[0m06:13:46.673960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7275a5ccfb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7275a65ce8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7275a79da300>]}
[0m06:13:46.674494 [debug] [MainThread]: Flushing usage events
[0m06:13:48.123230 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:14:44.916797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a56d5ed4320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a56d5ed41d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a56d5ed43b0>]}


============================== 06:14:44.930416 | e3f007ff-aa7b-4e99-95d2-f8a2e505a63e ==============================
[0m06:14:44.930416 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:14:44.931415 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:14:46.129660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3f007ff-aa7b-4e99-95d2-f8a2e505a63e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a56d4592b40>]}
[0m06:14:46.265393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3f007ff-aa7b-4e99-95d2-f8a2e505a63e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a56d6b8ff50>]}
[0m06:14:46.267277 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:14:46.514149 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:14:46.821079 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:14:46.821938 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:14:46.930619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3f007ff-aa7b-4e99-95d2-f8a2e505a63e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a56d5d7d3a0>]}
[0m06:14:47.056077 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:14:47.059914 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:14:47.096623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3f007ff-aa7b-4e99-95d2-f8a2e505a63e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a56d43387a0>]}
[0m06:14:47.097270 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:14:47.098005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3f007ff-aa7b-4e99-95d2-f8a2e505a63e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a56d61d1280>]}
[0m06:14:47.100827 [info ] [MainThread]: 
[0m06:14:47.101459 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:14:47.102988 [info ] [MainThread]: 
[0m06:14:47.104856 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:14:47.111360 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:14:47.198358 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:14:47.198846 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:14:47.199304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:14:47.217194 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.018 seconds
[0m06:14:47.219120 [debug] [ThreadPool]: On list_db: Close
[0m06:14:47.221741 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:14:47.232015 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:14:47.232586 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:14:47.232963 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:14:47.247729 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m06:14:47.248933 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:14:47.250024 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:14:47.255330 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m06:14:47.258381 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:14:47.259773 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:14:47.271208 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:47.271828 [debug] [MainThread]: On master: BEGIN
[0m06:14:47.272367 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:14:47.286802 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m06:14:47.287957 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:47.288927 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:14:47.293906 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m06:14:47.296407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3f007ff-aa7b-4e99-95d2-f8a2e505a63e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a56d43383e0>]}
[0m06:14:47.297368 [debug] [MainThread]: On master: ROLLBACK
[0m06:14:47.298640 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:47.299243 [debug] [MainThread]: On master: BEGIN
[0m06:14:47.300761 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:14:47.302078 [debug] [MainThread]: On master: COMMIT
[0m06:14:47.303594 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:47.304640 [debug] [MainThread]: On master: COMMIT
[0m06:14:47.306307 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m06:14:47.307213 [debug] [MainThread]: On master: Close
[0m06:14:47.314390 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:14:47.315391 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:14:47.316403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:14:47.317474 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:14:47.334017 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:14:47.335372 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:14:47.417486 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:14:47.419349 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:14:47.420664 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:14:47.421810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:14:47.442025 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m06:14:47.443350 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:14:47.444241 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m06:14:47.455465 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m06:14:47.472021 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:14:47.472787 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:14:47.474277 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:14:47.478930 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:14:47.479778 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:14:47.481146 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:14:47.521110 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:14:47.523331 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:14:47.524829 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:14:47.633477 [debug] [Thread-1 (]: SQL status: COMMIT in 0.107 seconds
[0m06:14:47.654860 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:14:47.672122 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:14:47.674118 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:14:47.684362 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.009 seconds
[0m06:14:47.689781 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:14:47.692327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3f007ff-aa7b-4e99-95d2-f8a2e505a63e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a56d699a660>]}
[0m06:14:47.693290 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.37s]
[0m06:14:47.694629 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:14:47.696537 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m06:14:47.697202 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:14:47.698652 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m06:14:47.701516 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:14:47.704317 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m06:14:47.705604 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:14:47.706429 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m06:14:47.707061 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:14:47.711427 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m06:14:47.715293 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:14:47.718441 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:14:47.719796 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m06:14:47.725356 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:14:47.730434 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m06:14:47.731794 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:14:47.732442 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:14:47.733040 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m06:14:47.733685 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:14:47.734652 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:14:47.735931 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:14:47.750818 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m06:14:47.752034 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:14:47.754150 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m06:14:47.755490 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m06:14:47.756497 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:14:47.757423 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:14:47.761708 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m06:14:47.766446 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:14:47.767175 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.009 seconds
[0m06:14:47.767799 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:14:47.773740 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:14:47.775174 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m06:14:47.775819 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:14:47.780353 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:14:47.780968 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m06:14:47.781696 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:14:47.786013 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:14:47.786927 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m06:14:47.787518 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:14:47.791911 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:14:47.792691 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m06:14:47.793401 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:14:47.795860 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:14:47.796569 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:14:47.797300 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:14:47.798258 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:14:47.803419 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m06:14:47.807296 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:14:47.808443 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m06:14:47.809796 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:14:47.813287 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m06:14:47.814074 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:14:47.815121 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:14:47.816376 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m06:14:47.822093 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m06:14:47.825017 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:14:47.827109 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3f007ff-aa7b-4e99-95d2-f8a2e505a63e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a56d03dfe30>]}
[0m06:14:47.828040 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.011 seconds
[0m06:14:47.829624 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.12s]
[0m06:14:47.832407 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m06:14:47.833665 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:14:47.835069 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3f007ff-aa7b-4e99-95d2-f8a2e505a63e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a56d34e4bc0>]}
[0m06:14:47.837082 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.13s]
[0m06:14:47.839132 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m06:14:47.842835 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:47.844126 [debug] [MainThread]: On master: BEGIN
[0m06:14:47.845103 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:14:47.860928 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m06:14:47.862396 [debug] [MainThread]: On master: COMMIT
[0m06:14:47.863484 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:47.864286 [debug] [MainThread]: On master: COMMIT
[0m06:14:47.865362 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:14:47.866344 [debug] [MainThread]: On master: Close
[0m06:14:47.867796 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:14:47.868866 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:14:47.869940 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m06:14:47.870837 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:14:47.871842 [info ] [MainThread]: 
[0m06:14:47.872428 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m06:14:47.874668 [debug] [MainThread]: Command end result
[0m06:14:47.916027 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:14:47.919280 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:14:47.929338 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:14:47.929872 [info ] [MainThread]: 
[0m06:14:47.930483 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:14:47.931480 [info ] [MainThread]: 
[0m06:14:47.932464 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:14:47.936389 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.1137514, "process_in_blocks": "1384", "process_kernel_time": 0.539481, "process_mem_max_rss": "108516", "process_out_blocks": "3400", "process_user_time": 3.672193}
[0m06:14:47.937772 [debug] [MainThread]: Command `dbt run` succeeded at 06:14:47.937351 after 3.12 seconds
[0m06:14:47.938693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a56d6153b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a56d5f43650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a56d5e93f80>]}
[0m06:14:47.939779 [debug] [MainThread]: Flushing usage events
[0m06:14:49.411609 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:15:43.610936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7929b864be30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7929b8711a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7929b8710680>]}


============================== 06:15:43.620082 | d9b7315b-2992-43d7-9da4-d3f1789b61d6 ==============================
[0m06:15:43.620082 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:15:43.621590 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:15:43.905939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9b7315b-2992-43d7-9da4-d3f1789b61d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7929b85019a0>]}
[0m06:15:44.145415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9b7315b-2992-43d7-9da4-d3f1789b61d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7929b85026f0>]}
[0m06:15:44.146593 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:15:44.319423 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:15:44.522611 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:15:44.523203 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:15:44.593078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9b7315b-2992-43d7-9da4-d3f1789b61d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7929b8533b90>]}
[0m06:15:44.772717 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:15:44.776233 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:15:44.821858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9b7315b-2992-43d7-9da4-d3f1789b61d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7929b68ecb60>]}
[0m06:15:44.823254 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:15:44.824292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9b7315b-2992-43d7-9da4-d3f1789b61d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7929ba697950>]}
[0m06:15:44.827769 [info ] [MainThread]: 
[0m06:15:44.828481 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:15:44.829459 [info ] [MainThread]: 
[0m06:15:44.830990 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:15:44.841278 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:15:44.923607 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:15:44.924312 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:15:44.924886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:15:45.211427 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.286 seconds
[0m06:15:45.213497 [debug] [ThreadPool]: On list_db: Close
[0m06:15:45.217382 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:15:45.227890 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:15:45.228851 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:15:45.229235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:15:45.244564 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m06:15:45.245557 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:15:45.246452 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:15:45.250364 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m06:15:45.254560 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:15:45.256637 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:15:45.269624 [debug] [MainThread]: Using postgres connection "master"
[0m06:15:45.270408 [debug] [MainThread]: On master: BEGIN
[0m06:15:45.271635 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:15:45.286220 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m06:15:45.287393 [debug] [MainThread]: Using postgres connection "master"
[0m06:15:45.289102 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:15:45.295783 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m06:15:45.298579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9b7315b-2992-43d7-9da4-d3f1789b61d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7929b68ecbc0>]}
[0m06:15:45.299497 [debug] [MainThread]: On master: ROLLBACK
[0m06:15:45.300398 [debug] [MainThread]: Using postgres connection "master"
[0m06:15:45.300885 [debug] [MainThread]: On master: BEGIN
[0m06:15:45.302056 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:15:45.302846 [debug] [MainThread]: On master: COMMIT
[0m06:15:45.303523 [debug] [MainThread]: Using postgres connection "master"
[0m06:15:45.303976 [debug] [MainThread]: On master: COMMIT
[0m06:15:45.304669 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:15:45.305667 [debug] [MainThread]: On master: Close
[0m06:15:45.315258 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:15:45.316405 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:15:45.317451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:15:45.318184 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:15:45.334128 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:15:45.335957 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:15:45.414366 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:15:45.417417 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:15:45.418444 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:15:45.419256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:15:45.436050 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m06:15:45.437282 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:15:45.438005 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m06:15:45.443150 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m06:15:45.458990 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:15:45.459535 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:15:45.461280 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:15:45.464973 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:15:45.465441 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:15:45.466814 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:15:45.507427 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:15:45.508689 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:15:45.509973 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:15:45.703087 [debug] [Thread-1 (]: SQL status: COMMIT in 0.192 seconds
[0m06:15:45.715896 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:15:45.724828 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:15:45.725402 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:15:45.753419 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.027 seconds
[0m06:15:45.771263 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:15:45.784768 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9b7315b-2992-43d7-9da4-d3f1789b61d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7929b83fbe60>]}
[0m06:15:45.786922 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.46s]
[0m06:15:45.788224 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:15:45.790357 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m06:15:45.791678 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:15:45.792617 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m06:15:45.794008 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:15:45.795442 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m06:15:45.796480 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:15:45.797290 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m06:15:45.798148 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:15:45.803462 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m06:15:45.808366 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:15:45.809770 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m06:15:45.810700 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:15:45.822039 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:15:45.816418 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m06:15:45.824032 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:15:45.824795 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:15:45.825574 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:15:45.826279 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:15:45.827194 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m06:15:45.828400 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:15:45.843872 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m06:15:45.845418 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:15:45.846131 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m06:15:45.847276 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m06:15:45.848355 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:15:45.849533 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:15:45.852606 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m06:15:45.859761 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.010 seconds
[0m06:15:45.859400 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:15:45.867295 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:15:45.868205 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:15:45.868924 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m06:15:45.870400 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:15:45.871242 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:15:45.875644 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:15:45.879870 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:15:45.880703 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:15:45.881445 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m06:15:45.883272 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:15:45.883955 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:15:45.890846 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:15:45.896346 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:15:45.898096 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:15:45.898890 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:15:45.899792 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:15:45.900795 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:15:45.955188 [debug] [Thread-4 (]: SQL status: COMMIT in 0.053 seconds
[0m06:15:45.960065 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:15:45.960896 [debug] [Thread-3 (]: SQL status: COMMIT in 0.059 seconds
[0m06:15:45.962423 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:15:45.966016 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m06:15:45.966879 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:15:45.968000 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:15:45.969190 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m06:15:46.044386 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.075 seconds
[0m06:15:46.051591 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:15:46.053422 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9b7315b-2992-43d7-9da4-d3f1789b61d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7929b5ab2570>]}
[0m06:15:46.055176 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.26s]
[0m06:15:46.056572 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.086 seconds
[0m06:15:46.057860 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:15:46.060151 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m06:15:46.062215 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9b7315b-2992-43d7-9da4-d3f1789b61d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7929b5b6c800>]}
[0m06:15:46.063885 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.27s]
[0m06:15:46.066403 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m06:15:46.071462 [debug] [MainThread]: Using postgres connection "master"
[0m06:15:46.073193 [debug] [MainThread]: On master: BEGIN
[0m06:15:46.074262 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:15:46.090856 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m06:15:46.091871 [debug] [MainThread]: On master: COMMIT
[0m06:15:46.092511 [debug] [MainThread]: Using postgres connection "master"
[0m06:15:46.093012 [debug] [MainThread]: On master: COMMIT
[0m06:15:46.093954 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:15:46.094475 [debug] [MainThread]: On master: Close
[0m06:15:46.095264 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:15:46.095706 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:15:46.096115 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m06:15:46.096590 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:15:46.097315 [info ] [MainThread]: 
[0m06:15:46.097951 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.27 seconds (1.27s).
[0m06:15:46.101846 [debug] [MainThread]: Command end result
[0m06:15:46.141771 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:15:46.144183 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:15:46.153916 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:15:46.154510 [info ] [MainThread]: 
[0m06:15:46.155291 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:15:46.155954 [info ] [MainThread]: 
[0m06:15:46.156836 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:15:46.158637 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.6268318, "process_in_blocks": "0", "process_kernel_time": 0.54692, "process_mem_max_rss": "108236", "process_out_blocks": "3400", "process_user_time": 3.325867}
[0m06:15:46.159507 [debug] [MainThread]: Command `dbt run` succeeded at 06:15:46.159332 after 2.63 seconds
[0m06:15:46.160052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7929b935c800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7929b8b4e900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7929b8b4dc40>]}
[0m06:15:46.160581 [debug] [MainThread]: Flushing usage events
[0m06:15:47.729459 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:16:46.398076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784cfa260e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784cfaa47470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784cfa263350>]}


============================== 06:16:46.407623 | 2e2832fb-bceb-48cd-8827-008e8ce96ad2 ==============================
[0m06:16:46.407623 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:16:46.408493 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:16:42.938017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e2832fb-bceb-48cd-8827-008e8ce96ad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784cfa260e30>]}
[0m06:16:43.065350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e2832fb-bceb-48cd-8827-008e8ce96ad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784cf9f17e90>]}
[0m06:16:43.066515 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:16:43.222779 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:16:43.417963 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:16:43.419145 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:16:43.482369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e2832fb-bceb-48cd-8827-008e8ce96ad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784cf84f3ad0>]}
[0m06:16:43.637957 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:16:43.645123 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:16:43.720551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e2832fb-bceb-48cd-8827-008e8ce96ad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784cf8213290>]}
[0m06:16:43.721921 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:16:43.723083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e2832fb-bceb-48cd-8827-008e8ce96ad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784cf9d1d820>]}
[0m06:16:43.728221 [info ] [MainThread]: 
[0m06:16:43.730997 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:16:43.732486 [info ] [MainThread]: 
[0m06:16:43.735958 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:16:43.748356 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:16:44.714323 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:16:44.852980 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:16:44.853733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:16:44.885648 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.032 seconds
[0m06:16:44.887438 [debug] [ThreadPool]: On list_db: Close
[0m06:16:44.890045 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:16:44.900127 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:16:44.901207 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:16:44.901733 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:16:44.915358 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m06:16:44.916887 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:16:44.918805 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:16:44.930150 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.011 seconds
[0m06:16:44.932035 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:16:44.933908 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:16:44.946308 [debug] [MainThread]: Using postgres connection "master"
[0m06:16:44.946812 [debug] [MainThread]: On master: BEGIN
[0m06:16:44.947245 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:16:44.965859 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m06:16:44.966989 [debug] [MainThread]: Using postgres connection "master"
[0m06:16:44.967937 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:16:44.977928 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m06:16:44.980521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e2832fb-bceb-48cd-8827-008e8ce96ad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784cfbb545f0>]}
[0m06:16:44.981388 [debug] [MainThread]: On master: ROLLBACK
[0m06:16:44.982279 [debug] [MainThread]: Using postgres connection "master"
[0m06:16:44.982741 [debug] [MainThread]: On master: BEGIN
[0m06:16:44.983934 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:16:44.984736 [debug] [MainThread]: On master: COMMIT
[0m06:16:44.985480 [debug] [MainThread]: Using postgres connection "master"
[0m06:16:44.986718 [debug] [MainThread]: On master: COMMIT
[0m06:16:44.988791 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m06:16:44.990051 [debug] [MainThread]: On master: Close
[0m06:16:44.996946 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:16:44.997956 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:16:44.998749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:16:44.999274 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:16:45.012425 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:16:45.013733 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:16:45.252449 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:16:45.253543 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:16:45.254128 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:16:45.254675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:16:45.275206 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m06:16:45.276809 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:16:45.278207 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m06:16:45.288592 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m06:16:45.300416 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:16:45.301260 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:16:45.302805 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:16:45.306652 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:16:45.307165 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:16:45.308269 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:16:45.343042 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:16:45.343746 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:16:45.344309 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:16:45.350198 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m06:16:45.364066 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:16:45.375757 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:16:45.376384 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:16:45.383262 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m06:16:45.387472 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:16:45.391632 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e2832fb-bceb-48cd-8827-008e8ce96ad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784cfbca2780>]}
[0m06:16:45.393099 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.39s]
[0m06:16:45.394435 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:16:45.396365 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m06:16:45.398809 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:16:45.397864 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m06:16:45.400393 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:16:45.401810 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m06:16:45.403298 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:16:45.404171 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m06:16:45.404996 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:16:45.411805 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m06:16:45.417147 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:16:45.418509 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m06:16:45.423857 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m06:16:45.424777 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:16:45.430474 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:16:45.431309 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:16:45.432107 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m06:16:45.432794 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:16:45.433679 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:16:45.434540 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:16:45.435077 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:16:45.448372 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m06:16:45.449377 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:16:45.450243 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:16:45.453147 [debug] [Thread-4 (]: SQL status: BEGIN in 0.018 seconds
[0m06:16:45.454136 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:16:45.455135 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m06:16:45.463700 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.013 seconds
[0m06:16:45.465046 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.008 seconds
[0m06:16:45.470467 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:16:45.475373 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:16:45.476302 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m06:16:45.477332 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:16:45.479125 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:16:45.480019 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:16:45.485505 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:16:45.490000 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:16:45.490789 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:16:45.491488 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m06:16:45.493830 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:16:45.494946 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:16:45.498164 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:16:45.501306 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:16:45.502148 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:16:45.502879 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:16:45.503719 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:16:45.504562 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:16:45.546127 [debug] [Thread-4 (]: SQL status: COMMIT in 0.040 seconds
[0m06:16:45.553972 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:16:45.554904 [debug] [Thread-3 (]: SQL status: COMMIT in 0.049 seconds
[0m06:16:45.556346 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:16:45.560757 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m06:16:45.561617 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:16:45.562691 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:16:45.563533 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m06:16:45.571175 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.007 seconds
[0m06:16:45.573840 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:16:45.574902 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e2832fb-bceb-48cd-8827-008e8ce96ad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784cf73b1eb0>]}
[0m06:16:45.575505 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.011 seconds
[0m06:16:45.576507 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.17s]
[0m06:16:45.579131 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m06:16:45.580238 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:16:45.581307 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e2832fb-bceb-48cd-8827-008e8ce96ad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784cf42bbfe0>]}
[0m06:16:45.583079 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.18s]
[0m06:16:45.584853 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m06:16:45.589080 [debug] [MainThread]: Using postgres connection "master"
[0m06:16:45.589849 [debug] [MainThread]: On master: BEGIN
[0m06:16:45.590505 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:16:45.604515 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m06:16:45.605484 [debug] [MainThread]: On master: COMMIT
[0m06:16:45.606146 [debug] [MainThread]: Using postgres connection "master"
[0m06:16:45.606755 [debug] [MainThread]: On master: COMMIT
[0m06:16:45.607658 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:16:45.608196 [debug] [MainThread]: On master: Close
[0m06:16:45.609042 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:16:45.609498 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:16:45.609931 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m06:16:45.610405 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:16:45.611055 [info ] [MainThread]: 
[0m06:16:45.611774 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.88 seconds (1.88s).
[0m06:16:45.614673 [debug] [MainThread]: Command end result
[0m06:16:45.659211 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:16:45.663315 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:16:45.673950 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:16:45.674958 [info ] [MainThread]: 
[0m06:16:45.676131 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:16:45.677105 [info ] [MainThread]: 
[0m06:16:45.677902 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:16:45.680326 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.2259552, "process_in_blocks": "2632", "process_kernel_time": 0.579153, "process_mem_max_rss": "108356", "process_out_blocks": "3408", "process_user_time": 4.132211}
[0m06:16:45.681427 [debug] [MainThread]: Command `dbt run` succeeded at 06:16:45.681173 after 3.23 seconds
[0m06:16:45.682359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784cfaa47470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784cf9d6fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784cf9d6fa70>]}
[0m06:16:45.683074 [debug] [MainThread]: Flushing usage events
[0m06:16:47.080098 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:18:30.506632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3a5eebdf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3a5f2d6fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3a5eebec60>]}


============================== 06:18:30.516713 | 47184d5d-8400-4a3b-8985-93de96cbc27d ==============================
[0m06:18:30.516713 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:18:30.517946 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:18:30.882108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47184d5d-8400-4a3b-8985-93de96cbc27d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3a6087b590>]}
[0m06:18:30.973717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47184d5d-8400-4a3b-8985-93de96cbc27d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3a5f59b890>]}
[0m06:18:30.974764 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:18:31.121434 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:18:31.337469 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:18:31.337933 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:18:31.393898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47184d5d-8400-4a3b-8985-93de96cbc27d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3a5d0fde80>]}
[0m06:18:31.584916 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:18:31.588154 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:18:31.665427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47184d5d-8400-4a3b-8985-93de96cbc27d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3a5cdf0920>]}
[0m06:18:31.666240 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:18:31.666957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47184d5d-8400-4a3b-8985-93de96cbc27d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3a5d1201d0>]}
[0m06:18:31.669292 [info ] [MainThread]: 
[0m06:18:31.669833 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:18:31.670472 [info ] [MainThread]: 
[0m06:18:31.671795 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:18:31.677123 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:18:31.769527 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:18:31.769980 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:18:31.770510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:18:31.785532 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m06:18:31.788525 [debug] [ThreadPool]: On list_db: Close
[0m06:18:31.791610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:18:31.802968 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:18:31.803736 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:18:31.804391 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:18:31.820055 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m06:18:31.821120 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:18:31.822019 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:18:31.826617 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m06:18:31.831255 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:18:31.833045 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:18:31.843112 [debug] [MainThread]: Using postgres connection "master"
[0m06:18:31.844303 [debug] [MainThread]: On master: BEGIN
[0m06:18:31.845636 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:18:31.866494 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m06:18:31.867480 [debug] [MainThread]: Using postgres connection "master"
[0m06:18:31.868473 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:18:31.880195 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m06:18:31.882092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47184d5d-8400-4a3b-8985-93de96cbc27d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3a5e917e00>]}
[0m06:18:31.882780 [debug] [MainThread]: On master: ROLLBACK
[0m06:18:31.883553 [debug] [MainThread]: Using postgres connection "master"
[0m06:18:31.884038 [debug] [MainThread]: On master: BEGIN
[0m06:18:31.885288 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:18:31.886043 [debug] [MainThread]: On master: COMMIT
[0m06:18:31.887219 [debug] [MainThread]: Using postgres connection "master"
[0m06:18:31.888106 [debug] [MainThread]: On master: COMMIT
[0m06:18:31.889028 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:18:31.889479 [debug] [MainThread]: On master: Close
[0m06:18:31.894915 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:18:31.896329 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:18:31.897335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:18:31.898022 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:18:31.907762 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:18:31.908640 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:18:31.961481 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:18:31.963711 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:18:31.964334 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:18:31.964914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:18:32.061885 [debug] [Thread-1 (]: SQL status: BEGIN in 0.097 seconds
[0m06:18:32.062694 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:18:32.063309 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m06:18:32.067723 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m06:18:32.076248 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:18:32.076889 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:18:32.078112 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:18:32.081948 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:18:32.082496 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:18:32.083516 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:18:32.105012 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:18:32.105501 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:18:32.105949 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:18:32.111544 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m06:18:32.119503 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:18:32.127815 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:18:32.128800 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:18:32.135643 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m06:18:32.139137 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:18:32.141169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47184d5d-8400-4a3b-8985-93de96cbc27d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3a5f44e600>]}
[0m06:18:32.142100 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.24s]
[0m06:18:32.143208 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:18:32.145553 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m06:18:32.146671 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:18:32.147469 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m06:18:32.148628 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:18:32.150010 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m06:18:32.151204 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:18:32.152089 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m06:18:32.153552 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:18:32.158152 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m06:18:32.166588 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:18:32.167750 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m06:18:32.168733 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:18:32.172794 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m06:18:32.176565 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:18:32.178887 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:18:32.180116 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m06:18:32.181005 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:18:32.181535 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:18:32.182115 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:18:32.183278 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:18:32.200728 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m06:18:32.201671 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:18:32.202900 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:18:32.203719 [debug] [Thread-4 (]: SQL status: BEGIN in 0.020 seconds
[0m06:18:32.204986 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:18:32.205726 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m06:18:32.214427 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.008 seconds
[0m06:18:32.215212 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m06:18:32.222679 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:18:32.230728 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:18:32.231557 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:18:32.232521 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m06:18:32.234319 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:18:32.235480 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:18:32.240832 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:18:32.246718 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:18:32.247522 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:18:32.248405 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m06:18:32.249912 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:18:32.250593 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:18:32.252964 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:18:32.255675 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:18:32.256363 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:18:32.257102 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:18:32.257719 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:18:32.258447 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:18:32.263874 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m06:18:32.267806 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:18:32.268467 [debug] [Thread-3 (]: SQL status: COMMIT in 0.009 seconds
[0m06:18:32.269599 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:18:32.273024 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m06:18:32.273778 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:18:32.274766 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:18:32.275601 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m06:18:32.282184 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.007 seconds
[0m06:18:32.284071 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:18:32.285032 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47184d5d-8400-4a3b-8985-93de96cbc27d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3a57f39a90>]}
[0m06:18:32.285885 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.13s]
[0m06:18:32.286639 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.010 seconds
[0m06:18:32.288283 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:18:32.290220 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m06:18:32.291779 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47184d5d-8400-4a3b-8985-93de96cbc27d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3a54e14bc0>]}
[0m06:18:32.292632 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.14s]
[0m06:18:32.293915 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m06:18:32.297914 [debug] [MainThread]: Using postgres connection "master"
[0m06:18:32.298539 [debug] [MainThread]: On master: BEGIN
[0m06:18:32.298973 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:18:32.309630 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m06:18:32.311154 [debug] [MainThread]: On master: COMMIT
[0m06:18:32.312402 [debug] [MainThread]: Using postgres connection "master"
[0m06:18:32.313258 [debug] [MainThread]: On master: COMMIT
[0m06:18:32.314082 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:18:32.314647 [debug] [MainThread]: On master: Close
[0m06:18:32.315409 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:18:32.315777 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:18:32.316296 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m06:18:32.316741 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:18:32.317436 [info ] [MainThread]: 
[0m06:18:32.318194 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m06:18:32.321795 [debug] [MainThread]: Command end result
[0m06:18:32.357473 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:18:32.359674 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:18:32.406993 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:18:32.407592 [info ] [MainThread]: 
[0m06:18:32.408225 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:18:32.408804 [info ] [MainThread]: 
[0m06:18:32.409671 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:18:32.643110 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2134864, "process_in_blocks": "3128", "process_kernel_time": 0.653339, "process_mem_max_rss": "108656", "process_out_blocks": "3392", "process_user_time": 3.066284}
[0m06:18:32.644304 [debug] [MainThread]: Command `dbt run` succeeded at 06:18:32.644023 after 2.22 seconds
[0m06:18:32.645131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3a5eb84200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3a5e8f76e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3a5fd3f860>]}
[0m06:18:32.646018 [debug] [MainThread]: Flushing usage events
[0m06:18:34.217856 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:18:45.070132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb282dc1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb2899e570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb28dcdb50>]}


============================== 06:18:45.083031 | 07f0a9b2-373d-4281-b92b-928155104815 ==============================
[0m06:18:45.083031 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:18:45.084020 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:18:45.472029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07f0a9b2-373d-4281-b92b-928155104815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb2a1d33b0>]}
[0m06:18:45.621309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07f0a9b2-373d-4281-b92b-928155104815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb283460f0>]}
[0m06:18:45.622817 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:18:45.855239 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:18:46.223552 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:18:46.224163 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:18:46.288820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07f0a9b2-373d-4281-b92b-928155104815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb26a19400>]}
[0m06:18:46.432051 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:18:46.438025 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:18:46.482674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07f0a9b2-373d-4281-b92b-928155104815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb26714830>]}
[0m06:18:46.483446 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:18:46.484041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07f0a9b2-373d-4281-b92b-928155104815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb28df3da0>]}
[0m06:18:46.488131 [info ] [MainThread]: 
[0m06:18:46.490346 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:18:46.491419 [info ] [MainThread]: 
[0m06:18:46.492916 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:18:46.500405 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:18:46.595409 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:18:46.596962 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:18:46.598733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:18:46.617639 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.019 seconds
[0m06:18:46.620350 [debug] [ThreadPool]: On list_db: Close
[0m06:18:46.624479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:18:46.639908 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:18:46.640572 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:18:46.641054 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:18:46.660121 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m06:18:46.661063 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:18:46.661826 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:18:46.669371 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m06:18:46.673586 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:18:46.675028 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:18:46.691569 [debug] [MainThread]: Using postgres connection "master"
[0m06:18:46.692381 [debug] [MainThread]: On master: BEGIN
[0m06:18:46.693089 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:18:46.711609 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m06:18:46.712520 [debug] [MainThread]: Using postgres connection "master"
[0m06:18:46.713299 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:18:46.721945 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m06:18:46.724990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07f0a9b2-373d-4281-b92b-928155104815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb26a2e8d0>]}
[0m06:18:46.725771 [debug] [MainThread]: On master: ROLLBACK
[0m06:18:46.726907 [debug] [MainThread]: Using postgres connection "master"
[0m06:18:46.727849 [debug] [MainThread]: On master: BEGIN
[0m06:18:46.730188 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:18:46.732242 [debug] [MainThread]: On master: COMMIT
[0m06:18:46.733712 [debug] [MainThread]: Using postgres connection "master"
[0m06:18:46.734786 [debug] [MainThread]: On master: COMMIT
[0m06:18:46.735984 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:18:46.736541 [debug] [MainThread]: On master: Close
[0m06:18:46.746157 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:18:46.747728 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:18:46.749265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:18:46.751980 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:18:46.771374 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:18:46.773513 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:18:46.862164 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:18:46.863230 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:18:46.863781 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:18:46.864580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:18:46.878223 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m06:18:46.879472 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:18:46.880252 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m06:18:46.891413 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m06:18:46.901027 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:18:46.901754 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:18:46.903387 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:18:46.908144 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:18:46.908787 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:18:46.909809 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:18:46.939779 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:18:46.940375 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:18:46.940937 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:18:46.947029 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m06:18:46.957601 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:18:46.967652 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:18:46.968450 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:18:46.975594 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m06:18:46.980554 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:18:46.985137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07f0a9b2-373d-4281-b92b-928155104815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb2a1d2420>]}
[0m06:18:46.987608 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.23s]
[0m06:18:46.989889 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:18:46.993886 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m06:18:46.994615 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:18:46.995794 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m06:18:46.997464 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:18:46.999676 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m06:18:47.000494 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:18:47.001044 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m06:18:47.001560 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:18:47.005169 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m06:18:47.010188 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:18:47.011832 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m06:18:47.012386 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:18:47.016324 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m06:18:47.020222 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:18:47.022043 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:18:47.022937 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m06:18:47.023600 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:18:47.024137 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:18:47.025110 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:18:47.026297 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:18:47.039428 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m06:18:47.040602 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:18:47.041619 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m06:18:47.042832 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:18:47.044330 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:18:47.046015 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m06:18:47.052209 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m06:18:47.052809 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m06:18:47.056617 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:18:47.060335 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:18:47.061282 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:18:47.063635 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m06:18:47.065833 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:18:47.070038 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:18:47.070688 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m06:18:47.071245 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:18:47.074928 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:18:47.075869 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m06:18:47.076614 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:18:47.083647 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m06:18:47.084344 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:18:47.086945 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:18:47.087846 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:18:47.088498 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:18:47.089026 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:18:47.089670 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:18:47.095140 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m06:18:47.099087 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:18:47.100111 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:18:47.100658 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:18:47.226078 [debug] [Thread-3 (]: SQL status: COMMIT in 0.136 seconds
[0m06:18:47.230029 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m06:18:47.231333 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:18:47.231942 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m06:18:47.365326 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.264 seconds
[0m06:18:47.370591 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:18:47.371453 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.139 seconds
[0m06:18:47.375662 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m06:18:47.376780 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07f0a9b2-373d-4281-b92b-928155104815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb2598c050>]}
[0m06:18:47.379365 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07f0a9b2-373d-4281-b92b-928155104815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb25aaa6c0>]}
[0m06:18:47.378216 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.38s]
[0m06:18:47.381419 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.38s]
[0m06:18:47.383331 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:18:47.386748 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m06:18:47.392442 [debug] [MainThread]: Using postgres connection "master"
[0m06:18:47.393625 [debug] [MainThread]: On master: BEGIN
[0m06:18:47.394297 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:18:47.413906 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m06:18:47.415238 [debug] [MainThread]: On master: COMMIT
[0m06:18:47.416481 [debug] [MainThread]: Using postgres connection "master"
[0m06:18:47.417478 [debug] [MainThread]: On master: COMMIT
[0m06:18:47.418761 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:18:47.419486 [debug] [MainThread]: On master: Close
[0m06:18:47.423422 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:18:47.425974 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:18:47.427117 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m06:18:47.428257 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:18:47.429592 [info ] [MainThread]: 
[0m06:18:47.430731 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m06:18:47.434089 [debug] [MainThread]: Command end result
[0m06:18:47.491530 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:18:47.496048 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:18:47.507458 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:18:47.508173 [info ] [MainThread]: 
[0m06:18:47.508947 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:18:47.509843 [info ] [MainThread]: 
[0m06:18:47.512185 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:18:47.514599 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5786703, "process_in_blocks": "4048", "process_kernel_time": 0.781978, "process_mem_max_rss": "108164", "process_out_blocks": "3384", "process_user_time": 3.782067}
[0m06:18:47.515575 [debug] [MainThread]: Command `dbt run` succeeded at 06:18:47.515408 after 2.58 seconds
[0m06:18:47.516255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb28817050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb28346e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bb29e204a0>]}
[0m06:18:47.516804 [debug] [MainThread]: Flushing usage events
[0m06:18:49.004078 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:19:42.186352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782fc04e8f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782fc04e8f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782fc039eb40>]}


============================== 06:19:42.196440 | bda5fbff-2979-4d31-af57-545ef2d9e78c ==============================
[0m06:19:42.196440 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:19:42.197554 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:19:42.570315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bda5fbff-2979-4d31-af57-545ef2d9e78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782fbf906c00>]}
[0m06:19:42.673691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bda5fbff-2979-4d31-af57-545ef2d9e78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782fbff54170>]}
[0m06:19:42.675195 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:19:42.815663 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:19:42.977791 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:19:42.978281 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:19:43.032803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bda5fbff-2979-4d31-af57-545ef2d9e78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782fbe0bd2e0>]}
[0m06:19:43.154904 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:19:43.159786 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:19:43.190687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bda5fbff-2979-4d31-af57-545ef2d9e78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782fbdda35f0>]}
[0m06:19:43.192218 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:19:43.193381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bda5fbff-2979-4d31-af57-545ef2d9e78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782fbf9f2ba0>]}
[0m06:19:43.196563 [info ] [MainThread]: 
[0m06:19:43.197475 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:19:43.198262 [info ] [MainThread]: 
[0m06:19:43.199447 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:19:43.206445 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:19:43.306894 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:19:43.307372 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:19:43.307880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:19:43.324117 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m06:19:43.325976 [debug] [ThreadPool]: On list_db: Close
[0m06:19:43.329261 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:19:43.338804 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:19:43.339315 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:19:43.339710 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:19:43.352459 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m06:19:43.353593 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:19:43.354244 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:19:43.359242 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m06:19:43.362727 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:19:43.363728 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:19:43.371885 [debug] [MainThread]: Using postgres connection "master"
[0m06:19:43.372382 [debug] [MainThread]: On master: BEGIN
[0m06:19:43.372889 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:19:43.386022 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m06:19:43.387056 [debug] [MainThread]: Using postgres connection "master"
[0m06:19:43.388025 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:19:43.393191 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m06:19:43.397005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bda5fbff-2979-4d31-af57-545ef2d9e78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782fc08ea330>]}
[0m06:19:43.397815 [debug] [MainThread]: On master: ROLLBACK
[0m06:19:43.398611 [debug] [MainThread]: Using postgres connection "master"
[0m06:19:43.399002 [debug] [MainThread]: On master: BEGIN
[0m06:19:43.400533 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:19:43.401454 [debug] [MainThread]: On master: COMMIT
[0m06:19:43.402613 [debug] [MainThread]: Using postgres connection "master"
[0m06:19:43.403007 [debug] [MainThread]: On master: COMMIT
[0m06:19:43.403808 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:19:43.404200 [debug] [MainThread]: On master: Close
[0m06:19:43.410203 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:19:43.411819 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:19:43.413433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:19:43.414300 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:19:43.423191 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:19:43.424034 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:19:43.475902 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:19:43.476875 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:19:43.477282 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:19:43.477712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:19:43.490699 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m06:19:43.491958 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:19:43.493026 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m06:19:43.500366 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m06:19:43.511329 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:19:43.511865 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:19:43.512997 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:19:43.517341 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:19:43.520873 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:19:43.521969 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:19:43.558225 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:19:43.559567 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:19:43.561080 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:19:43.567793 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m06:19:43.586047 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:19:43.599515 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:19:43.600069 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:19:43.606887 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m06:19:43.610406 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:19:43.612783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bda5fbff-2979-4d31-af57-545ef2d9e78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782fc043e330>]}
[0m06:19:43.614046 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.20s]
[0m06:19:43.616240 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:19:43.618973 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m06:19:43.619595 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:19:43.620992 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m06:19:43.622662 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:19:43.624297 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m06:19:43.625475 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:19:43.626241 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m06:19:43.626961 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:19:43.630497 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m06:19:43.634438 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:19:43.635873 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m06:19:43.636740 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:19:43.640171 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m06:19:43.645793 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:19:43.647691 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:19:43.648737 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:19:43.650115 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:19:43.651471 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m06:19:43.652165 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:19:43.652870 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:19:43.665703 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m06:19:43.667211 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:19:43.668416 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m06:19:43.669594 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:19:43.670440 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:19:43.671477 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m06:19:43.676186 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m06:19:43.676872 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m06:19:43.681361 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:19:43.687948 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:19:43.689085 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:19:43.690376 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m06:19:43.692451 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:19:43.693833 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:19:43.698403 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:19:43.705752 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:19:43.707088 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:19:43.708257 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m06:19:43.711335 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:19:43.712713 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m06:19:43.716149 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:19:43.720985 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:19:43.722553 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:19:43.724174 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:19:43.725669 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:19:43.726387 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:19:43.731887 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m06:19:43.737271 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m06:19:43.739336 [debug] [Thread-4 (]: SQL status: COMMIT in 0.012 seconds
[0m06:19:43.740834 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:19:43.743659 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:19:43.744355 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m06:19:43.745568 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:19:43.746859 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:19:43.753459 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.007 seconds
[0m06:19:43.756865 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m06:19:43.757564 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.010 seconds
[0m06:19:43.758625 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bda5fbff-2979-4d31-af57-545ef2d9e78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782fbc66ffe0>]}
[0m06:19:43.760560 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:19:43.761999 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.13s]
[0m06:19:43.763820 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m06:19:43.764918 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bda5fbff-2979-4d31-af57-545ef2d9e78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782fbc63d400>]}
[0m06:19:43.767036 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.14s]
[0m06:19:43.768670 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:19:43.773827 [debug] [MainThread]: Using postgres connection "master"
[0m06:19:43.774403 [debug] [MainThread]: On master: BEGIN
[0m06:19:43.774884 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:19:43.788609 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m06:19:43.789418 [debug] [MainThread]: On master: COMMIT
[0m06:19:43.790170 [debug] [MainThread]: Using postgres connection "master"
[0m06:19:43.790701 [debug] [MainThread]: On master: COMMIT
[0m06:19:43.791416 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:19:43.791827 [debug] [MainThread]: On master: Close
[0m06:19:43.792506 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:19:43.793030 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:19:43.793562 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m06:19:43.793932 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:19:43.794471 [info ] [MainThread]: 
[0m06:19:43.795087 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m06:19:43.797883 [debug] [MainThread]: Command end result
[0m06:19:43.844656 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:19:43.846972 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:19:43.860686 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:19:43.861182 [info ] [MainThread]: 
[0m06:19:43.861846 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:19:43.862466 [info ] [MainThread]: 
[0m06:19:43.863014 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:19:43.864765 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7610025, "process_in_blocks": "3600", "process_kernel_time": 0.649564, "process_mem_max_rss": "108260", "process_out_blocks": "3408", "process_user_time": 3.358051}
[0m06:19:43.865540 [debug] [MainThread]: Command `dbt run` succeeded at 06:19:43.865378 after 1.76 seconds
[0m06:19:43.866092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782fbff76570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782fc043e330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782fbff567b0>]}
[0m06:19:43.866698 [debug] [MainThread]: Flushing usage events
[0m06:19:45.282316 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:24:45.689085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b4f9345730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b4f90178f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b4f9120a70>]}


============================== 06:24:45.697067 | 08a53c10-da7e-412d-80bf-627ee036fbe4 ==============================
[0m06:24:45.697067 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:24:45.698235 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:24:46.010032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08a53c10-da7e-412d-80bf-627ee036fbe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b4f8d77c80>]}
[0m06:24:46.105225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08a53c10-da7e-412d-80bf-627ee036fbe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b4f8f5d250>]}
[0m06:24:46.106395 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:24:46.245827 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:24:46.412285 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:24:46.412893 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:24:46.467344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08a53c10-da7e-412d-80bf-627ee036fbe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b4f7510d10>]}
[0m06:24:46.578689 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:24:46.582144 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:24:46.621021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08a53c10-da7e-412d-80bf-627ee036fbe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b4f7204980>]}
[0m06:24:46.621818 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:24:46.622377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08a53c10-da7e-412d-80bf-627ee036fbe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b4f903ade0>]}
[0m06:24:46.625613 [info ] [MainThread]: 
[0m06:24:46.626447 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:24:46.627407 [info ] [MainThread]: 
[0m06:24:46.628739 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:24:46.636356 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:24:46.707577 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:24:46.708087 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:24:46.708487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:24:46.723000 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m06:24:46.725052 [debug] [ThreadPool]: On list_db: Close
[0m06:24:46.727967 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:24:46.736093 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:24:46.736603 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:24:46.737010 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:24:46.749374 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m06:24:46.750324 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:24:46.751201 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:24:46.755862 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m06:24:46.757782 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:24:46.759140 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:24:46.768561 [debug] [MainThread]: Using postgres connection "master"
[0m06:24:46.769168 [debug] [MainThread]: On master: BEGIN
[0m06:24:46.769646 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:24:46.783063 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m06:24:46.784386 [debug] [MainThread]: Using postgres connection "master"
[0m06:24:46.785211 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:24:46.790242 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m06:24:46.793640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08a53c10-da7e-412d-80bf-627ee036fbe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b4f74fcce0>]}
[0m06:24:46.794858 [debug] [MainThread]: On master: ROLLBACK
[0m06:24:46.795927 [debug] [MainThread]: Using postgres connection "master"
[0m06:24:46.796446 [debug] [MainThread]: On master: BEGIN
[0m06:24:46.797760 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:24:46.798453 [debug] [MainThread]: On master: COMMIT
[0m06:24:46.799300 [debug] [MainThread]: Using postgres connection "master"
[0m06:24:46.799976 [debug] [MainThread]: On master: COMMIT
[0m06:24:46.800858 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:24:46.801340 [debug] [MainThread]: On master: Close
[0m06:24:46.807369 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:24:46.808669 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:24:46.809705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:24:46.810365 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:24:46.822657 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:24:46.823832 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:24:46.877756 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:24:46.879000 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:24:46.879802 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:24:46.880278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:24:46.892698 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m06:24:46.893697 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:24:46.894672 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m06:24:46.898633 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m06:24:46.908508 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:24:46.909041 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:24:46.910214 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:24:46.913874 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:24:46.914304 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:24:46.915406 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:24:46.939742 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:24:46.940264 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:24:46.940851 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:24:46.948696 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m06:24:46.960330 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:24:46.968956 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:24:46.969477 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:24:46.976664 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m06:24:46.979794 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:24:46.982148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08a53c10-da7e-412d-80bf-627ee036fbe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b4f987e870>]}
[0m06:24:46.983071 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.17s]
[0m06:24:46.984410 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:24:46.986501 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m06:24:46.987266 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:24:46.987929 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m06:24:46.989385 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:24:46.990829 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m06:24:46.991826 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:24:46.992581 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m06:24:46.993215 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:24:46.997036 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m06:24:47.000436 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:24:47.001591 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m06:24:47.002095 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:24:47.006105 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m06:24:47.010182 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:24:47.011678 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:24:47.012290 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m06:24:47.012843 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:24:47.013372 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:24:47.014038 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:24:47.015182 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:24:47.028484 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m06:24:47.029695 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m06:24:47.030456 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:24:47.031219 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:24:47.031901 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:24:47.032640 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m06:24:47.037517 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m06:24:47.038847 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m06:24:47.043392 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:24:47.046917 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:24:47.047628 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:24:47.048237 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m06:24:47.049631 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:24:47.050163 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:24:47.053829 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:24:47.057296 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:24:47.058003 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m06:24:47.058698 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:24:47.060547 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:24:47.061368 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:24:47.064571 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:24:47.066783 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:24:47.067707 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:24:47.068570 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:24:47.069361 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:24:47.070129 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:24:47.118054 [debug] [Thread-3 (]: SQL status: COMMIT in 0.047 seconds
[0m06:24:47.123699 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m06:24:47.124994 [debug] [Thread-4 (]: SQL status: COMMIT in 0.054 seconds
[0m06:24:47.126447 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:24:47.130933 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:24:47.132233 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m06:24:47.134051 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:24:47.135710 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:24:47.142202 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.007 seconds
[0m06:24:47.145934 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m06:24:47.147449 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.011 seconds
[0m06:24:47.148803 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08a53c10-da7e-412d-80bf-627ee036fbe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b4f42aaed0>]}
[0m06:24:47.152152 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:24:47.153740 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.16s]
[0m06:24:47.155533 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m06:24:47.156631 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08a53c10-da7e-412d-80bf-627ee036fbe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b4f639a5d0>]}
[0m06:24:47.158467 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.16s]
[0m06:24:47.160133 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:24:47.164067 [debug] [MainThread]: Using postgres connection "master"
[0m06:24:47.164673 [debug] [MainThread]: On master: BEGIN
[0m06:24:47.165209 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:24:47.179729 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m06:24:47.180801 [debug] [MainThread]: On master: COMMIT
[0m06:24:47.181581 [debug] [MainThread]: Using postgres connection "master"
[0m06:24:47.182002 [debug] [MainThread]: On master: COMMIT
[0m06:24:47.182883 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:24:47.183512 [debug] [MainThread]: On master: Close
[0m06:24:47.184237 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:24:47.184672 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:24:47.185122 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m06:24:47.185622 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:24:47.186420 [info ] [MainThread]: 
[0m06:24:47.187198 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m06:24:47.190025 [debug] [MainThread]: Command end result
[0m06:24:47.222580 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:24:47.225035 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:24:47.233651 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:24:47.234174 [info ] [MainThread]: 
[0m06:24:47.234995 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:24:47.236054 [info ] [MainThread]: 
[0m06:24:47.237094 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:24:47.239468 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6194279, "process_in_blocks": "1936", "process_kernel_time": 0.458481, "process_mem_max_rss": "108304", "process_out_blocks": "3400", "process_user_time": 2.935762}
[0m06:24:47.240163 [debug] [MainThread]: Command `dbt run` succeeded at 06:24:47.240008 after 1.62 seconds
[0m06:24:47.240694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b4f9034560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b4f8d77b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b4f8d77ad0>]}
[0m06:24:47.241260 [debug] [MainThread]: Flushing usage events
[0m06:24:48.721108 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:29:46.193752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768f1a66a150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768f1aa1bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768f18b30dd0>]}


============================== 06:29:46.213967 | 91b24478-3723-412b-820d-fafa07c2f043 ==============================
[0m06:29:46.213967 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:29:46.214899 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:29:46.539590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91b24478-3723-412b-820d-fafa07c2f043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768f187a1190>]}
[0m06:29:46.629931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91b24478-3723-412b-820d-fafa07c2f043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768f189d3d10>]}
[0m06:29:46.631044 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:29:46.817255 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:29:47.095290 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:29:47.096507 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:29:47.203308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91b24478-3723-412b-820d-fafa07c2f043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768f16f75400>]}
[0m06:29:47.340571 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:29:47.345917 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:29:47.388822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91b24478-3723-412b-820d-fafa07c2f043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768f16c7b620>]}
[0m06:29:47.389510 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m06:29:47.390084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91b24478-3723-412b-820d-fafa07c2f043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768f16dc06b0>]}
[0m06:29:47.392841 [info ] [MainThread]: 
[0m06:29:47.393515 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:29:47.394555 [info ] [MainThread]: 
[0m06:29:47.396112 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:29:47.404552 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:29:47.552283 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:29:47.552826 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:29:47.553248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:29:47.589109 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.036 seconds
[0m06:29:47.591454 [debug] [ThreadPool]: On list_db: Close
[0m06:29:47.594903 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:29:47.603808 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:29:47.604415 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:29:47.604846 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:29:47.622349 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m06:29:47.623039 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:29:47.623591 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:29:47.633126 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m06:29:47.635956 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:29:47.636992 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:29:47.645800 [debug] [MainThread]: Using postgres connection "master"
[0m06:29:47.646417 [debug] [MainThread]: On master: BEGIN
[0m06:29:47.647380 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:29:47.765141 [debug] [MainThread]: SQL status: BEGIN in 0.118 seconds
[0m06:29:47.766207 [debug] [MainThread]: Using postgres connection "master"
[0m06:29:47.767097 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:29:47.859679 [debug] [MainThread]: SQL status: SELECT 0 in 0.092 seconds
[0m06:29:47.861916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91b24478-3723-412b-820d-fafa07c2f043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768f1875a900>]}
[0m06:29:47.862588 [debug] [MainThread]: On master: ROLLBACK
[0m06:29:47.863462 [debug] [MainThread]: Using postgres connection "master"
[0m06:29:47.864121 [debug] [MainThread]: On master: BEGIN
[0m06:29:47.865421 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:29:47.866084 [debug] [MainThread]: On master: COMMIT
[0m06:29:47.866913 [debug] [MainThread]: Using postgres connection "master"
[0m06:29:47.867418 [debug] [MainThread]: On master: COMMIT
[0m06:29:47.868288 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:29:47.868799 [debug] [MainThread]: On master: Close
[0m06:29:47.874139 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:29:47.875223 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m06:29:47.876191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:29:47.876981 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:29:47.887160 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:29:47.888162 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:29:47.987498 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:29:47.988874 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:29:47.989675 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:29:47.990363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:29:48.014302 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m06:29:48.015299 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:29:48.016382 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    
with source as(    
    select *
    from"db"."dev"."raw_weather_data"

),

de_dup as(
    select 
        *,
        row_number() over(partition by time order by inserted_at) as rn 
    from source
)
select
    id,
    city,
    temperature,
    weather_description,
    wind_speed,
    time as weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) as inserted_at_local
from de_dup
where rn=1
  );
  
[0m06:29:48.034213 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m06:29:48.043087 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:29:48.044180 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:29:48.045575 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:29:48.050455 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:29:48.050995 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:29:48.052240 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:29:48.084976 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:29:48.085791 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:29:48.086334 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:29:48.094759 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m06:29:48.113181 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:29:48.126603 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:29:48.127155 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:29:48.135405 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m06:29:48.141237 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:29:48.143750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91b24478-3723-412b-820d-fafa07c2f043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768f192fa5d0>]}
[0m06:29:48.144682 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 1[0m in 0.27s]
[0m06:29:48.145964 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:29:48.148306 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m06:29:48.149269 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m06:29:48.150287 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m06:29:48.151473 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m06:29:48.153327 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m06:29:48.154522 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m06:29:48.155571 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m06:29:48.156443 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m06:29:48.161012 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m06:29:48.167504 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m06:29:48.169530 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m06:29:48.177391 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m06:29:48.178644 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m06:29:48.186291 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m06:29:48.187288 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:29:48.188755 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m06:29:48.189732 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:29:48.191296 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:29:48.192902 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m06:29:48.194143 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:29:48.208980 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m06:29:48.210525 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:29:48.212012 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

select 
    city,
    temperature,
    weather_description,
    wind_speed,
    weather_time_local
from "db"."dev"."staging"
  );
  
[0m06:29:48.221545 [debug] [Thread-3 (]: SQL status: BEGIN in 0.032 seconds
[0m06:29:48.222970 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:29:48.223588 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    date(weather_time_local) as date,
    round(avg(temperature)::numeric,2) as avg_temperature,
    round(avg(wind_speed)::numeric,2) as avg_wind_speed
from"db"."dev"."staging"
group by
    city,
    date(weather_time_local)
order by
    city,
    date(weather_time_local)
  );
  
[0m06:29:48.228750 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.016 seconds
[0m06:29:48.235634 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:29:48.236364 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m06:29:48.238222 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:29:48.243265 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:29:48.244187 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m06:29:48.245328 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:29:48.247714 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:29:48.248342 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.024 seconds
[0m06:29:48.248851 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:29:48.254047 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:29:48.254819 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m06:29:48.255557 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m06:29:48.257150 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:29:48.263017 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:29:48.263927 [debug] [Thread-4 (]: SQL status: COMMIT in 0.007 seconds
[0m06:29:48.264492 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m06:29:48.267429 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m06:29:48.269029 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m06:29:48.269850 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:29:48.270570 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m06:29:48.275362 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:29:48.277122 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:29:48.277847 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m06:29:48.283965 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.007 seconds
[0m06:29:48.287113 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m06:29:48.287995 [debug] [Thread-3 (]: SQL status: COMMIT in 0.009 seconds
[0m06:29:48.294924 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91b24478-3723-412b-820d-fafa07c2f043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768f15e3daf0>]}
[0m06:29:48.294320 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m06:29:48.296635 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.14s]
[0m06:29:48.299072 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m06:29:48.300371 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m06:29:48.301107 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m06:29:48.310208 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.008 seconds
[0m06:29:48.312574 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m06:29:48.313456 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91b24478-3723-412b-820d-fafa07c2f043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768f15ecc590>]}
[0m06:29:48.314788 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.16s]
[0m06:29:48.316349 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m06:29:48.320324 [debug] [MainThread]: Using postgres connection "master"
[0m06:29:48.321095 [debug] [MainThread]: On master: BEGIN
[0m06:29:48.321673 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:29:48.372763 [debug] [MainThread]: SQL status: BEGIN in 0.051 seconds
[0m06:29:48.373509 [debug] [MainThread]: On master: COMMIT
[0m06:29:48.374073 [debug] [MainThread]: Using postgres connection "master"
[0m06:29:48.374547 [debug] [MainThread]: On master: COMMIT
[0m06:29:48.375377 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:29:48.376019 [debug] [MainThread]: On master: Close
[0m06:29:48.376824 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:29:48.377272 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:29:48.377736 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m06:29:48.378172 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m06:29:48.378811 [info ] [MainThread]: 
[0m06:29:48.379652 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.98 seconds (0.98s).
[0m06:29:48.382886 [debug] [MainThread]: Command end result
[0m06:29:48.419469 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:29:48.421836 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:29:48.433129 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:29:48.433875 [info ] [MainThread]: 
[0m06:29:48.434579 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:29:48.435474 [info ] [MainThread]: 
[0m06:29:48.436728 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:29:48.440172 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.7699244, "process_in_blocks": "200", "process_kernel_time": 0.902231, "process_mem_max_rss": "108368", "process_out_blocks": "3408", "process_user_time": 3.633199}
[0m06:29:48.442158 [debug] [MainThread]: Command `dbt run` succeeded at 06:29:48.441667 after 2.77 seconds
[0m06:29:48.443248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768f16dc06b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768f16d2a870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768f19318080>]}
[0m06:29:48.444233 [debug] [MainThread]: Flushing usage events
[0m06:29:49.836936 [debug] [MainThread]: An error was encountered while trying to flush usage events
