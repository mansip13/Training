[0m06:06:07.790568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7baae3c90bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7baae3e30830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7baae3c912e0>]}


============================== 06:06:07.800006 | e4f83848-9ef7-45f2-814a-702c7b951076 ==============================
[0m06:06:07.800006 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:06:07.800994 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:06:07.859095 [info ] [MainThread]: dbt version: 1.9.0
[0m06:06:07.859820 [info ] [MainThread]: python version: 3.12.4
[0m06:06:07.860534 [info ] [MainThread]: python path: /usr/local/bin/python
[0m06:06:07.861816 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m06:06:07.862922 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m06:06:07.863883 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m06:06:07.864667 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m06:06:08.024056 [info ] [MainThread]: Configuration:
[0m06:06:08.025043 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m06:06:08.026043 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m06:06:08.027088 [info ] [MainThread]: Required dependencies:
[0m06:06:08.028240 [debug] [MainThread]: Executing "git --help"
[0m06:06:08.033636 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m06:06:08.034504 [debug] [MainThread]: STDERR: "b''"
[0m06:06:08.035038 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m06:06:08.035798 [info ] [MainThread]: Connection test skipped since no profile was found
[0m06:06:08.036718 [info ] [MainThread]: [31m1 check failed:[0m
[0m06:06:08.037431 [info ] [MainThread]: dbt looked for a profiles.yml file in /root/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m06:06:08.039491 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.3323058, "process_in_blocks": "0", "process_kernel_time": 0.445955, "process_mem_max_rss": "88860", "process_out_blocks": "1480", "process_user_time": 2.06024}
[0m06:06:08.040753 [debug] [MainThread]: Command `dbt debug` failed at 06:06:08.040567 after 0.33 seconds
[0m06:06:08.041613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7baae3c10fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7baae4585070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7baae3e26720>]}
[0m06:06:08.042765 [debug] [MainThread]: Flushing usage events
[0m06:06:09.506848 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:09:25.787316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ef17626960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ef18956a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ef17627650>]}


============================== 06:09:25.799398 | e3ce65ee-c5ac-4c98-80e5-e397da62feea ==============================
[0m06:09:25.799398 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:09:25.801012 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:09:25.882453 [info ] [MainThread]: dbt version: 1.9.0
[0m06:09:25.883327 [info ] [MainThread]: python version: 3.12.4
[0m06:09:25.883997 [info ] [MainThread]: python path: /usr/local/bin/python
[0m06:09:25.888205 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m06:09:26.027310 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m06:09:26.028415 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m06:09:26.029512 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m06:09:26.031938 [info ] [MainThread]: adapter type: postgres
[0m06:09:26.033075 [info ] [MainThread]: adapter version: 1.9.0
[0m06:09:26.288920 [info ] [MainThread]: Configuration:
[0m06:09:26.289685 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m06:09:26.290518 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m06:09:26.291314 [info ] [MainThread]: Required dependencies:
[0m06:09:26.292229 [debug] [MainThread]: Executing "git --help"
[0m06:09:26.297417 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m06:09:26.298222 [debug] [MainThread]: STDERR: "b''"
[0m06:09:26.298967 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m06:09:26.303830 [info ] [MainThread]: Connection:
[0m06:09:26.305196 [info ] [MainThread]:   host: db
[0m06:09:26.307518 [info ] [MainThread]:   port: 5432
[0m06:09:26.311013 [info ] [MainThread]:   user: db_user
[0m06:09:26.312256 [info ] [MainThread]:   database: db
[0m06:09:26.312997 [info ] [MainThread]:   schema: dev
[0m06:09:26.313786 [info ] [MainThread]:   connect_timeout: 10
[0m06:09:26.314621 [info ] [MainThread]:   role: None
[0m06:09:26.316996 [info ] [MainThread]:   search_path: None
[0m06:09:26.322674 [info ] [MainThread]:   keepalives_idle: 0
[0m06:09:26.326246 [info ] [MainThread]:   sslmode: None
[0m06:09:26.327746 [info ] [MainThread]:   sslcert: None
[0m06:09:26.329212 [info ] [MainThread]:   sslkey: None
[0m06:09:26.330618 [info ] [MainThread]:   sslrootcert: None
[0m06:09:26.331507 [info ] [MainThread]:   application_name: dbt
[0m06:09:26.332332 [info ] [MainThread]:   retries: 1
[0m06:09:26.333854 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:09:26.519847 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m06:09:26.594281 [debug] [MainThread]: Using postgres connection "debug"
[0m06:09:26.595215 [debug] [MainThread]: On debug: select 1 as id
[0m06:09:26.597041 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:09:26.621672 [debug] [MainThread]: SQL status: SELECT 1 in 0.025 seconds
[0m06:09:26.623485 [debug] [MainThread]: On debug: Close
[0m06:09:26.624241 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m06:09:26.626412 [info ] [MainThread]: [32mAll checks passed![0m
[0m06:09:26.634703 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.9606682, "process_in_blocks": "0", "process_kernel_time": 0.611889, "process_mem_max_rss": "101648", "process_out_blocks": "1520", "process_user_time": 3.283679}
[0m06:09:26.636157 [debug] [MainThread]: Command `dbt debug` succeeded at 06:09:26.635858 after 0.96 seconds
[0m06:09:26.637189 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m06:09:26.638150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ef16f2fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ef156eb9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ef18fa0320>]}
[0m06:09:26.639403 [debug] [MainThread]: Flushing usage events
[0m06:09:28.103362 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:09:57.244564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771a6fa8fc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771a710fc4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771a6f52cbc0>]}


============================== 06:09:57.254257 | f0835c27-078a-4247-b2b2-d23acaff8988 ==============================
[0m06:09:57.254257 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:09:57.255234 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:09:57.641764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0835c27-078a-4247-b2b2-d23acaff8988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771a6f3e9b80>]}
[0m06:09:57.770777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0835c27-078a-4247-b2b2-d23acaff8988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771a6f326210>]}
[0m06:09:57.772159 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:09:57.971787 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:09:57.973509 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:09:57.974509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f0835c27-078a-4247-b2b2-d23acaff8988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771a6d8d15b0>]}
[0m06:10:01.073569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0835c27-078a-4247-b2b2-d23acaff8988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771a6d42f290>]}
[0m06:10:01.252272 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:10:01.257038 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:10:01.307315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0835c27-078a-4247-b2b2-d23acaff8988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771a6c40b980>]}
[0m06:10:01.308572 [info ] [MainThread]: Found 2 models, 4 data tests, 429 macros
[0m06:10:01.309496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0835c27-078a-4247-b2b2-d23acaff8988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771a6d5a9d60>]}
[0m06:10:01.312789 [info ] [MainThread]: 
[0m06:10:01.313553 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:10:01.314418 [info ] [MainThread]: 
[0m06:10:01.315808 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:10:01.329113 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:10:01.421811 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:10:01.422448 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:10:01.423024 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:10:01.450725 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.027 seconds
[0m06:10:01.453594 [debug] [ThreadPool]: On list_db: Close
[0m06:10:01.456753 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:10:01.471325 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:10:01.472124 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:10:01.472658 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:10:01.488119 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m06:10:01.489512 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:10:01.490663 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:10:01.500798 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m06:10:01.505997 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:10:01.508763 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:10:01.518369 [debug] [MainThread]: Using postgres connection "master"
[0m06:10:01.519481 [debug] [MainThread]: On master: BEGIN
[0m06:10:01.520686 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:10:01.537338 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m06:10:01.538968 [debug] [MainThread]: Using postgres connection "master"
[0m06:10:01.541289 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:10:01.550153 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m06:10:01.552634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0835c27-078a-4247-b2b2-d23acaff8988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771a70f34680>]}
[0m06:10:01.553339 [debug] [MainThread]: On master: ROLLBACK
[0m06:10:01.554293 [debug] [MainThread]: Using postgres connection "master"
[0m06:10:01.555197 [debug] [MainThread]: On master: BEGIN
[0m06:10:01.559658 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:10:01.561230 [debug] [MainThread]: On master: COMMIT
[0m06:10:01.562346 [debug] [MainThread]: Using postgres connection "master"
[0m06:10:01.563082 [debug] [MainThread]: On master: COMMIT
[0m06:10:01.564318 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:10:01.566493 [debug] [MainThread]: On master: Close
[0m06:10:01.573259 [debug] [Thread-1 (]: Began running node model.my_project.my_first_dbt_model
[0m06:10:01.575881 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.my_first_dbt_model ............................ [RUN]
[0m06:10:01.580135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.my_first_dbt_model)
[0m06:10:01.581575 [debug] [Thread-1 (]: Began compiling node model.my_project.my_first_dbt_model
[0m06:10:01.601157 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.my_first_dbt_model"
[0m06:10:01.604122 [debug] [Thread-1 (]: Began executing node model.my_project.my_first_dbt_model
[0m06:10:01.800830 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.my_first_dbt_model"
[0m06:10:01.805573 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m06:10:01.806773 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: BEGIN
[0m06:10:01.807982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:10:01.824436 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m06:10:01.825403 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m06:10:01.826555 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_first_dbt_model"} */

  
    

  create  table "db"."dev"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m06:10:01.834893 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.006 seconds
[0m06:10:01.849797 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m06:10:01.851114 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_first_dbt_model"} */
alter table "db"."dev"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m06:10:01.853886 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:10:01.889248 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: COMMIT
[0m06:10:01.890068 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m06:10:01.890600 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: COMMIT
[0m06:10:01.896052 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m06:10:01.909061 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."my_first_dbt_model__dbt_backup"
[0m06:10:01.920407 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m06:10:01.921324 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_first_dbt_model"} */
drop table if exists "db"."dev"."my_first_dbt_model__dbt_backup" cascade
[0m06:10:01.923658 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m06:10:01.928615 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: Close
[0m06:10:01.931267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0835c27-078a-4247-b2b2-d23acaff8988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771a7107e690>]}
[0m06:10:01.932303 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.my_first_dbt_model ....................... [[32mSELECT 2[0m in 0.35s]
[0m06:10:01.933842 [debug] [Thread-1 (]: Finished running node model.my_project.my_first_dbt_model
[0m06:10:01.939274 [debug] [Thread-3 (]: Began running node model.my_project.my_second_dbt_model
[0m06:10:01.941132 [info ] [Thread-3 (]: 2 of 2 START sql view model dev.my_second_dbt_model ............................ [RUN]
[0m06:10:01.944377 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.my_second_dbt_model'
[0m06:10:01.945271 [debug] [Thread-3 (]: Began compiling node model.my_project.my_second_dbt_model
[0m06:10:01.950894 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.my_second_dbt_model"
[0m06:10:01.953286 [debug] [Thread-3 (]: Began executing node model.my_project.my_second_dbt_model
[0m06:10:01.995732 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.my_second_dbt_model"
[0m06:10:01.998034 [debug] [Thread-3 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m06:10:01.999210 [debug] [Thread-3 (]: On model.my_project.my_second_dbt_model: BEGIN
[0m06:10:01.999813 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:10:02.014890 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m06:10:02.015965 [debug] [Thread-3 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m06:10:02.016519 [debug] [Thread-3 (]: On model.my_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_second_dbt_model"} */

  create view "db"."dev"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "db"."dev"."my_first_dbt_model"
where id = 1
  );
[0m06:10:02.019296 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m06:10:02.024005 [debug] [Thread-3 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m06:10:02.026138 [debug] [Thread-3 (]: On model.my_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_second_dbt_model"} */
alter table "db"."dev"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m06:10:02.030284 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:10:02.033412 [debug] [Thread-3 (]: On model.my_project.my_second_dbt_model: COMMIT
[0m06:10:02.034109 [debug] [Thread-3 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m06:10:02.034665 [debug] [Thread-3 (]: On model.my_project.my_second_dbt_model: COMMIT
[0m06:10:02.039806 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m06:10:02.046102 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."my_second_dbt_model__dbt_backup"
[0m06:10:02.053529 [debug] [Thread-3 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m06:10:02.054230 [debug] [Thread-3 (]: On model.my_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_second_dbt_model"} */
drop view if exists "db"."dev"."my_second_dbt_model__dbt_backup" cascade
[0m06:10:02.055327 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:10:02.057468 [debug] [Thread-3 (]: On model.my_project.my_second_dbt_model: Close
[0m06:10:02.058436 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0835c27-078a-4247-b2b2-d23acaff8988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771a6d9047d0>]}
[0m06:10:02.059474 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dev.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.11s]
[0m06:10:02.064729 [debug] [Thread-3 (]: Finished running node model.my_project.my_second_dbt_model
[0m06:10:02.069519 [debug] [MainThread]: Using postgres connection "master"
[0m06:10:02.070751 [debug] [MainThread]: On master: BEGIN
[0m06:10:02.071894 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:10:02.093936 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m06:10:02.095202 [debug] [MainThread]: On master: COMMIT
[0m06:10:02.096158 [debug] [MainThread]: Using postgres connection "master"
[0m06:10:02.097636 [debug] [MainThread]: On master: COMMIT
[0m06:10:02.100885 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m06:10:02.101813 [debug] [MainThread]: On master: Close
[0m06:10:02.102882 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:10:02.104920 [debug] [MainThread]: Connection 'model.my_project.my_first_dbt_model' was properly closed.
[0m06:10:02.105727 [debug] [MainThread]: Connection 'model.my_project.my_second_dbt_model' was properly closed.
[0m06:10:02.106647 [info ] [MainThread]: 
[0m06:10:02.107763 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m06:10:02.109952 [debug] [MainThread]: Command end result
[0m06:10:02.163226 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:10:02.165953 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:10:02.178977 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:10:02.179588 [info ] [MainThread]: 
[0m06:10:02.180680 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:10:02.181828 [info ] [MainThread]: 
[0m06:10:02.183762 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:10:02.186029 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.0628123, "process_in_blocks": "0", "process_kernel_time": 0.696758, "process_mem_max_rss": "113196", "process_out_blocks": "4208", "process_user_time": 6.778249}
[0m06:10:02.188506 [debug] [MainThread]: Command `dbt run` succeeded at 06:10:02.187211 after 5.06 seconds
[0m06:10:02.190083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771a70d91730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771a6f495070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771a6d8bf680>]}
[0m06:10:02.191335 [debug] [MainThread]: Flushing usage events
[0m06:10:03.631635 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:19:03.435080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7105e4055430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7105e449d220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7105e3e12cc0>]}


============================== 06:19:03.442087 | d83cfc4b-771d-44d7-b931-ee3dfd78815d ==============================
[0m06:19:03.442087 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:19:03.443301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:19:03.693933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd83cfc4b-771d-44d7-b931-ee3dfd78815d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7105e3bea270>]}
[0m06:19:03.777823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd83cfc4b-771d-44d7-b931-ee3dfd78815d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7105e3f8cb00>]}
[0m06:19:03.779031 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:19:03.919657 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:19:04.061477 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m06:19:04.062309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd83cfc4b-771d-44d7-b931-ee3dfd78815d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7105e20f8b00>]}
[0m06:19:05.629216 [error] [MainThread]: Encountered an error:
Compilation Error in model staging (models/staging/staging.sql)
  expected token ',', got 'unique_key'
    line 3
      unique_key='id'
[0m06:19:05.631158 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.3065183, "process_in_blocks": "2520", "process_kernel_time": 0.411082, "process_mem_max_rss": "98692", "process_out_blocks": "8", "process_user_time": 3.60279}
[0m06:19:05.632356 [debug] [MainThread]: Command `dbt run` failed at 06:19:05.632150 after 2.31 seconds
[0m06:19:05.636376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7105e449d220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7105e1f7a3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7105e2263770>]}
[0m06:19:05.637987 [debug] [MainThread]: Flushing usage events
[0m06:19:07.134093 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:19:40.191703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad61631be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad6159c110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad60231e20>]}


============================== 06:19:40.200167 | c4e3092b-87bd-4a0d-96b8-8ae89079e378 ==============================
[0m06:19:40.200167 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:19:40.201210 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:19:40.487654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4e3092b-87bd-4a0d-96b8-8ae89079e378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad60231e20>]}
[0m06:19:40.573631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4e3092b-87bd-4a0d-96b8-8ae89079e378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad60144f50>]}
[0m06:19:40.574715 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:19:40.720576 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:19:40.846429 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m06:19:40.847273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c4e3092b-87bd-4a0d-96b8-8ae89079e378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad5fbb8440>]}
[0m06:19:42.536451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4e3092b-87bd-4a0d-96b8-8ae89079e378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad5da8d220>]}
[0m06:19:42.656176 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:19:42.659434 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:19:42.750232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4e3092b-87bd-4a0d-96b8-8ae89079e378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad5da20590>]}
[0m06:19:42.750992 [info ] [MainThread]: Found 1 model, 2 data tests, 1 source, 429 macros
[0m06:19:42.751560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4e3092b-87bd-4a0d-96b8-8ae89079e378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad60f11550>]}
[0m06:19:42.754872 [info ] [MainThread]: 
[0m06:19:42.755555 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:19:42.756420 [info ] [MainThread]: 
[0m06:19:42.758056 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:19:42.760760 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:19:42.835421 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:19:42.836049 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:19:42.836980 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:19:42.879125 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.042 seconds
[0m06:19:42.881284 [debug] [ThreadPool]: On list_db: Close
[0m06:19:42.883348 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:19:42.899217 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:19:42.900859 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:19:42.901758 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:19:42.925019 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m06:19:42.925679 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:19:42.926261 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:19:42.968948 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.042 seconds
[0m06:19:42.971421 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:19:42.972318 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:19:42.980818 [debug] [MainThread]: Using postgres connection "master"
[0m06:19:42.981546 [debug] [MainThread]: On master: BEGIN
[0m06:19:42.982097 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:19:42.997968 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m06:19:42.998714 [debug] [MainThread]: Using postgres connection "master"
[0m06:19:42.999488 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:19:43.021844 [debug] [MainThread]: SQL status: SELECT 0 in 0.022 seconds
[0m06:19:43.024592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4e3092b-87bd-4a0d-96b8-8ae89079e378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad5d96ae10>]}
[0m06:19:43.025430 [debug] [MainThread]: On master: ROLLBACK
[0m06:19:43.026446 [debug] [MainThread]: Using postgres connection "master"
[0m06:19:43.027072 [debug] [MainThread]: On master: BEGIN
[0m06:19:43.028480 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:19:43.029183 [debug] [MainThread]: On master: COMMIT
[0m06:19:43.029766 [debug] [MainThread]: Using postgres connection "master"
[0m06:19:43.030346 [debug] [MainThread]: On master: COMMIT
[0m06:19:43.031314 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:19:43.032028 [debug] [MainThread]: On master: Close
[0m06:19:43.037760 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:19:43.038825 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging ....................................... [RUN]
[0m06:19:43.039701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:19:43.040408 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:19:43.056707 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:19:43.059627 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:19:43.123202 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:19:43.125563 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:19:43.126101 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:19:43.126588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:19:43.138686 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m06:19:43.139325 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:19:43.139827 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

select * 
from "database"."dev"."raw_beer_data"
  );
  
[0m06:19:43.141049 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "database.dev.raw_beer_data"
LINE 15: from "database"."dev"."raw_beer_data"
              ^

[0m06:19:43.141570 [debug] [Thread-1 (]: On model.my_project.staging: ROLLBACK
[0m06:19:43.142478 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:19:43.147346 [debug] [Thread-1 (]: Database Error in model staging (models/staging/staging.sql)
  cross-database references are not implemented: "database.dev.raw_beer_data"
  LINE 15: from "database"."dev"."raw_beer_data"
                ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m06:19:43.149642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4e3092b-87bd-4a0d-96b8-8ae89079e378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad5d966180>]}
[0m06:19:43.150524 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev.staging .............................. [[31mERROR[0m in 0.11s]
[0m06:19:43.151633 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:19:43.152670 [debug] [Thread-7 (]: Marking all children of 'model.my_project.staging' to be skipped because of status 'error'.  Reason: Database Error in model staging (models/staging/staging.sql)
  cross-database references are not implemented: "database.dev.raw_beer_data"
  LINE 15: from "database"."dev"."raw_beer_data"
                ^
  compiled code at target/run/my_project/models/staging/staging.sql.
[0m06:19:43.156088 [debug] [MainThread]: Using postgres connection "master"
[0m06:19:43.156622 [debug] [MainThread]: On master: BEGIN
[0m06:19:43.157114 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:19:43.171371 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m06:19:43.172088 [debug] [MainThread]: On master: COMMIT
[0m06:19:43.172655 [debug] [MainThread]: Using postgres connection "master"
[0m06:19:43.173147 [debug] [MainThread]: On master: COMMIT
[0m06:19:43.174092 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:19:43.174601 [debug] [MainThread]: On master: Close
[0m06:19:43.175352 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:19:43.175799 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:19:43.176307 [info ] [MainThread]: 
[0m06:19:43.176940 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m06:19:43.179023 [debug] [MainThread]: Command end result
[0m06:19:43.216374 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:19:43.219073 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:19:43.228834 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:19:43.229435 [info ] [MainThread]: 
[0m06:19:43.230164 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:19:43.230977 [info ] [MainThread]: 
[0m06:19:43.232126 [error] [MainThread]:   Database Error in model staging (models/staging/staging.sql)
  cross-database references are not implemented: "database.dev.raw_beer_data"
  LINE 15: from "database"."dev"."raw_beer_data"
                ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m06:19:43.233104 [info ] [MainThread]: 
[0m06:19:43.234139 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m06:19:43.236183 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.1121924, "process_in_blocks": "16", "process_kernel_time": 0.55625, "process_mem_max_rss": "112116", "process_out_blocks": "4160", "process_user_time": 4.121483}
[0m06:19:43.237559 [debug] [MainThread]: Command `dbt run` failed at 06:19:43.237210 after 3.11 seconds
[0m06:19:43.238620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad60111160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad60113560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad5c752180>]}
[0m06:19:43.239592 [debug] [MainThread]: Flushing usage events
[0m06:19:44.651593 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:21:30.843696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd0a4a39e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd0b5475c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd0ae8bec0>]}


============================== 06:21:30.851873 | b7804eb4-e5a9-4f01-833c-fea8ab2aa361 ==============================
[0m06:21:30.851873 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:21:30.852838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:21:31.137589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7804eb4-e5a9-4f01-833c-fea8ab2aa361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd0a3c57f0>]}
[0m06:21:31.221302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7804eb4-e5a9-4f01-833c-fea8ab2aa361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd0a29aa50>]}
[0m06:21:31.222347 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:21:31.364992 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:21:31.531746 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:21:31.532806 [debug] [MainThread]: Partial parsing: updated file: my_project://models/staging/staging.sql
[0m06:21:31.929734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7804eb4-e5a9-4f01-833c-fea8ab2aa361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd0aeaeab0>]}
[0m06:21:32.057786 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:21:32.062711 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:21:32.101115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7804eb4-e5a9-4f01-833c-fea8ab2aa361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd03334950>]}
[0m06:21:32.101808 [info ] [MainThread]: Found 2 data tests, 1 model, 1 source, 429 macros
[0m06:21:32.102357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7804eb4-e5a9-4f01-833c-fea8ab2aa361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd085c4ad0>]}
[0m06:21:32.105042 [info ] [MainThread]: 
[0m06:21:32.105677 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:21:32.106227 [info ] [MainThread]: 
[0m06:21:32.107669 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:21:32.109853 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:21:32.194896 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:21:32.195535 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:21:32.196133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:21:32.220618 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.024 seconds
[0m06:21:32.222651 [debug] [ThreadPool]: On list_db: Close
[0m06:21:32.224729 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:21:32.232904 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:21:32.233436 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:21:32.233858 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:21:32.246988 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m06:21:32.247644 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:21:32.248126 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:21:32.253918 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m06:21:32.255934 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:21:32.256714 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:21:32.265364 [debug] [MainThread]: Using postgres connection "master"
[0m06:21:32.265950 [debug] [MainThread]: On master: BEGIN
[0m06:21:32.266420 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:21:32.279757 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m06:21:32.280354 [debug] [MainThread]: Using postgres connection "master"
[0m06:21:32.280965 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:21:32.287644 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m06:21:32.289931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7804eb4-e5a9-4f01-833c-fea8ab2aa361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd027be8a0>]}
[0m06:21:32.290603 [debug] [MainThread]: On master: ROLLBACK
[0m06:21:32.291425 [debug] [MainThread]: Using postgres connection "master"
[0m06:21:32.291916 [debug] [MainThread]: On master: BEGIN
[0m06:21:32.293078 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:21:32.293595 [debug] [MainThread]: On master: COMMIT
[0m06:21:32.294060 [debug] [MainThread]: Using postgres connection "master"
[0m06:21:32.294512 [debug] [MainThread]: On master: COMMIT
[0m06:21:32.295321 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:21:32.295894 [debug] [MainThread]: On master: Close
[0m06:21:32.300595 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:21:32.301414 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging ....................................... [RUN]
[0m06:21:32.302118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:21:32.302799 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:21:32.314427 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:21:32.315525 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:21:32.373267 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:21:32.374511 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:21:32.375143 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:21:32.375674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:21:32.388186 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m06:21:32.388926 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:21:32.389392 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    


select * 
from "database"."dev"."raw_beer_data"
  );
  
[0m06:21:32.390483 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "database.dev.raw_beer_data"
LINE 16: from "database"."dev"."raw_beer_data"
              ^

[0m06:21:32.390979 [debug] [Thread-1 (]: On model.my_project.staging: ROLLBACK
[0m06:21:32.391832 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:21:32.396366 [debug] [Thread-1 (]: Database Error in model staging (models/staging/staging.sql)
  cross-database references are not implemented: "database.dev.raw_beer_data"
  LINE 16: from "database"."dev"."raw_beer_data"
                ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m06:21:32.398571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7804eb4-e5a9-4f01-833c-fea8ab2aa361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd03336360>]}
[0m06:21:32.399538 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev.staging .............................. [[31mERROR[0m in 0.10s]
[0m06:21:32.400639 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:21:32.401915 [debug] [Thread-7 (]: Marking all children of 'model.my_project.staging' to be skipped because of status 'error'.  Reason: Database Error in model staging (models/staging/staging.sql)
  cross-database references are not implemented: "database.dev.raw_beer_data"
  LINE 16: from "database"."dev"."raw_beer_data"
                ^
  compiled code at target/run/my_project/models/staging/staging.sql.
[0m06:21:32.405434 [debug] [MainThread]: Using postgres connection "master"
[0m06:21:32.405931 [debug] [MainThread]: On master: BEGIN
[0m06:21:32.406358 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:21:32.419407 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m06:21:32.420045 [debug] [MainThread]: On master: COMMIT
[0m06:21:32.420529 [debug] [MainThread]: Using postgres connection "master"
[0m06:21:32.421067 [debug] [MainThread]: On master: COMMIT
[0m06:21:32.421850 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:21:32.422443 [debug] [MainThread]: On master: Close
[0m06:21:32.423169 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:21:32.423618 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:21:32.424140 [info ] [MainThread]: 
[0m06:21:32.424814 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m06:21:32.426265 [debug] [MainThread]: Command end result
[0m06:21:32.461694 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:21:32.464005 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:21:32.474181 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:21:32.474730 [info ] [MainThread]: 
[0m06:21:32.475381 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:21:32.476081 [info ] [MainThread]: 
[0m06:21:32.477245 [error] [MainThread]:   Database Error in model staging (models/staging/staging.sql)
  cross-database references are not implemented: "database.dev.raw_beer_data"
  LINE 16: from "database"."dev"."raw_beer_data"
                ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m06:21:32.478133 [info ] [MainThread]: 
[0m06:21:32.479100 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m06:21:32.481302 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7017362, "process_in_blocks": "0", "process_kernel_time": 0.680319, "process_mem_max_rss": "111512", "process_out_blocks": "4168", "process_user_time": 2.876241}
[0m06:21:32.482792 [debug] [MainThread]: Command `dbt run` failed at 06:21:32.482434 after 1.70 seconds
[0m06:21:32.484287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd0a4f0560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd02705f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd0aae23f0>]}
[0m06:21:32.486571 [debug] [MainThread]: Flushing usage events
[0m06:21:34.002249 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:22:05.858754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767d18a842c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767d18a85580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767d18a843b0>]}


============================== 06:22:05.867579 | b8fcbbf6-437e-4bac-8133-2786788de78e ==============================
[0m06:22:05.867579 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:22:05.868517 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:22:06.166363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8fcbbf6-437e-4bac-8133-2786788de78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767d193ee3c0>]}
[0m06:22:06.255306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8fcbbf6-437e-4bac-8133-2786788de78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767d189f66f0>]}
[0m06:22:06.256556 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:22:06.401802 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:22:06.588422 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:22:06.589392 [debug] [MainThread]: Partial parsing: updated file: my_project://models/sources/sources.yml
[0m06:22:07.283505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8fcbbf6-437e-4bac-8133-2786788de78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767d15cedc10>]}
[0m06:22:07.419495 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:22:07.422914 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:22:07.460792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8fcbbf6-437e-4bac-8133-2786788de78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767d16f5f2c0>]}
[0m06:22:07.461674 [info ] [MainThread]: Found 1 model, 2 data tests, 1 source, 429 macros
[0m06:22:07.462490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8fcbbf6-437e-4bac-8133-2786788de78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767d16fd3830>]}
[0m06:22:07.465865 [info ] [MainThread]: 
[0m06:22:07.466498 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:22:07.467246 [info ] [MainThread]: 
[0m06:22:07.468734 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:22:07.471003 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:22:07.549567 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:22:07.550168 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:22:07.550661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:22:07.575460 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.025 seconds
[0m06:22:07.577497 [debug] [ThreadPool]: On list_db: Close
[0m06:22:07.579827 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:22:07.589103 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:22:07.589714 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:22:07.590142 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:22:07.603821 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m06:22:07.604529 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:22:07.605206 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:22:07.611001 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m06:22:07.613116 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:22:07.613867 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:22:07.620716 [debug] [MainThread]: Using postgres connection "master"
[0m06:22:07.621279 [debug] [MainThread]: On master: BEGIN
[0m06:22:07.621758 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:22:07.634391 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m06:22:07.635032 [debug] [MainThread]: Using postgres connection "master"
[0m06:22:07.635613 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:22:07.641077 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m06:22:07.643244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8fcbbf6-437e-4bac-8133-2786788de78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767d16d3e210>]}
[0m06:22:07.643918 [debug] [MainThread]: On master: ROLLBACK
[0m06:22:07.644796 [debug] [MainThread]: Using postgres connection "master"
[0m06:22:07.645387 [debug] [MainThread]: On master: BEGIN
[0m06:22:07.646565 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:22:07.647087 [debug] [MainThread]: On master: COMMIT
[0m06:22:07.647556 [debug] [MainThread]: Using postgres connection "master"
[0m06:22:07.648017 [debug] [MainThread]: On master: COMMIT
[0m06:22:07.648896 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:22:07.649430 [debug] [MainThread]: On master: Close
[0m06:22:07.654237 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:22:07.655061 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging ....................................... [RUN]
[0m06:22:07.655801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:22:07.656427 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:22:07.667929 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:22:07.669433 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:22:07.727500 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:22:07.728499 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:22:07.729102 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:22:07.729509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:22:07.743354 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m06:22:07.743949 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:22:07.744530 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    


select * 
from "db"."dev"."raw_beer_data"
  );
  
[0m06:22:07.759290 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.014 seconds
[0m06:22:07.769380 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:22:07.769978 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:22:07.771111 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:22:07.795340 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:22:07.795918 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:22:07.796463 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:22:07.929918 [debug] [Thread-1 (]: SQL status: COMMIT in 0.132 seconds
[0m06:22:07.956175 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:22:07.976568 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:22:07.977168 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:22:07.978141 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m06:22:07.981515 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:22:07.983782 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8fcbbf6-437e-4bac-8133-2786788de78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767d14d90620>]}
[0m06:22:07.984685 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.staging .................................. [[32mSELECT 414[0m in 0.33s]
[0m06:22:07.985804 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:22:07.989330 [debug] [MainThread]: Using postgres connection "master"
[0m06:22:07.989903 [debug] [MainThread]: On master: BEGIN
[0m06:22:07.990409 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:22:08.004651 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m06:22:08.005463 [debug] [MainThread]: On master: COMMIT
[0m06:22:08.006022 [debug] [MainThread]: Using postgres connection "master"
[0m06:22:08.006511 [debug] [MainThread]: On master: COMMIT
[0m06:22:08.007402 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:22:08.007943 [debug] [MainThread]: On master: Close
[0m06:22:08.008756 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:22:08.009196 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:22:08.009706 [info ] [MainThread]: 
[0m06:22:08.010263 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m06:22:08.012043 [debug] [MainThread]: Command end result
[0m06:22:08.047302 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:22:08.049846 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:22:08.059715 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:22:08.060365 [info ] [MainThread]: 
[0m06:22:08.061205 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:22:08.061872 [info ] [MainThread]: 
[0m06:22:08.062856 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:22:08.065066 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.289134, "process_in_blocks": "0", "process_kernel_time": 0.491523, "process_mem_max_rss": "114096", "process_out_blocks": "4168", "process_user_time": 3.363636}
[0m06:22:08.065936 [debug] [MainThread]: Command `dbt run` succeeded at 06:22:08.065759 after 2.29 seconds
[0m06:22:08.066628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767d199c1940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767d15bac680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767d16d3c830>]}
[0m06:22:08.067373 [debug] [MainThread]: Flushing usage events
[0m06:22:09.482869 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:27:27.453736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758f915aacc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758f906e75c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758f90b303b0>]}


============================== 06:27:27.458969 | 88710153-f3be-4c08-a836-a242dc7465ec ==============================
[0m06:27:27.458969 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:27:27.459787 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:27:27.720565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88710153-f3be-4c08-a836-a242dc7465ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758f8fc8ae70>]}
[0m06:27:27.807714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88710153-f3be-4c08-a836-a242dc7465ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758f8fc6ff20>]}
[0m06:27:27.808910 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:27:27.946360 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:27:28.120286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:27:28.121810 [debug] [MainThread]: Partial parsing: updated file: my_project://models/staging/staging.sql
[0m06:27:28.528213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88710153-f3be-4c08-a836-a242dc7465ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758f8dff7500>]}
[0m06:27:28.651132 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:27:28.654660 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:27:28.678890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88710153-f3be-4c08-a836-a242dc7465ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758f8dfb14c0>]}
[0m06:27:28.679648 [info ] [MainThread]: Found 2 data tests, 1 model, 1 source, 429 macros
[0m06:27:28.680192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88710153-f3be-4c08-a836-a242dc7465ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758f8e123770>]}
[0m06:27:28.682922 [info ] [MainThread]: 
[0m06:27:28.683533 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:27:28.684187 [info ] [MainThread]: 
[0m06:27:28.685508 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:27:28.687531 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:27:28.772950 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:27:28.773524 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:27:28.773981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:27:28.791110 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.017 seconds
[0m06:27:28.793309 [debug] [ThreadPool]: On list_db: Close
[0m06:27:28.795534 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:27:28.803598 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:27:28.804125 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:27:28.804513 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:27:28.817622 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m06:27:28.818319 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:27:28.818894 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:27:28.825109 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m06:27:28.827354 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:27:28.828208 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:27:28.835403 [debug] [MainThread]: Using postgres connection "master"
[0m06:27:28.836026 [debug] [MainThread]: On master: BEGIN
[0m06:27:28.836584 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:27:28.851095 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m06:27:28.851808 [debug] [MainThread]: Using postgres connection "master"
[0m06:27:28.852391 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:27:28.859397 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m06:27:28.861861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88710153-f3be-4c08-a836-a242dc7465ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758f8c1c0f50>]}
[0m06:27:28.862603 [debug] [MainThread]: On master: ROLLBACK
[0m06:27:28.863493 [debug] [MainThread]: Using postgres connection "master"
[0m06:27:28.863996 [debug] [MainThread]: On master: BEGIN
[0m06:27:28.865200 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:27:28.865774 [debug] [MainThread]: On master: COMMIT
[0m06:27:28.866332 [debug] [MainThread]: Using postgres connection "master"
[0m06:27:28.866790 [debug] [MainThread]: On master: COMMIT
[0m06:27:28.867660 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:27:28.868194 [debug] [MainThread]: On master: Close
[0m06:27:28.873065 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:27:28.873977 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging ....................................... [RUN]
[0m06:27:28.874801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:27:28.875564 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:27:28.888660 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:27:28.889661 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:27:28.953868 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:27:28.954880 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:27:28.955479 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:27:28.956009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:27:28.969655 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m06:27:28.970261 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:27:28.970740 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * 
    from "db"."dev"."raw_beer_data"
)
  );
  
[0m06:27:28.978003 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 18:   );
           ^

[0m06:27:28.978839 [debug] [Thread-1 (]: On model.my_project.staging: ROLLBACK
[0m06:27:28.980040 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:27:28.986296 [debug] [Thread-1 (]: Database Error in model staging (models/staging/staging.sql)
  syntax error at or near ")"
  LINE 18:   );
             ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m06:27:28.989439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88710153-f3be-4c08-a836-a242dc7465ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758f8e0af230>]}
[0m06:27:28.990730 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev.staging .............................. [[31mERROR[0m in 0.11s]
[0m06:27:28.992069 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:27:28.993725 [debug] [Thread-7 (]: Marking all children of 'model.my_project.staging' to be skipped because of status 'error'.  Reason: Database Error in model staging (models/staging/staging.sql)
  syntax error at or near ")"
  LINE 18:   );
             ^
  compiled code at target/run/my_project/models/staging/staging.sql.
[0m06:27:28.997841 [debug] [MainThread]: Using postgres connection "master"
[0m06:27:28.998494 [debug] [MainThread]: On master: BEGIN
[0m06:27:28.999033 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:27:29.014766 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m06:27:29.015955 [debug] [MainThread]: On master: COMMIT
[0m06:27:29.016502 [debug] [MainThread]: Using postgres connection "master"
[0m06:27:29.017014 [debug] [MainThread]: On master: COMMIT
[0m06:27:29.017890 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:27:29.018408 [debug] [MainThread]: On master: Close
[0m06:27:29.019248 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:27:29.020040 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:27:29.020921 [info ] [MainThread]: 
[0m06:27:29.021736 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m06:27:29.024703 [debug] [MainThread]: Command end result
[0m06:27:29.060701 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:27:29.063156 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:27:29.072941 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:27:29.073459 [info ] [MainThread]: 
[0m06:27:29.074154 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:27:29.074839 [info ] [MainThread]: 
[0m06:27:29.076223 [error] [MainThread]:   Database Error in model staging (models/staging/staging.sql)
  syntax error at or near ")"
  LINE 18:   );
             ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m06:27:29.077223 [info ] [MainThread]: 
[0m06:27:29.078354 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m06:27:29.080887 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.740358, "process_in_blocks": "0", "process_kernel_time": 0.525688, "process_mem_max_rss": "110776", "process_out_blocks": "2552", "process_user_time": 2.85214}
[0m06:27:29.082329 [debug] [MainThread]: Command `dbt run` failed at 06:27:29.081987 after 1.74 seconds
[0m06:27:29.083362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758f933b28a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758f9071bdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758f8e01c860>]}
[0m06:27:29.084486 [debug] [MainThread]: Flushing usage events
[0m06:27:30.572395 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:28:02.636716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b610d384530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b610d385430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b610d70d730>]}


============================== 06:28:02.644675 | 749a3740-ee15-4cdf-a1af-29cd1258c103 ==============================
[0m06:28:02.644675 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:28:02.645655 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:28:02.926652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '749a3740-ee15-4cdf-a1af-29cd1258c103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b610ce88980>]}
[0m06:28:03.009212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '749a3740-ee15-4cdf-a1af-29cd1258c103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b610cfa77d0>]}
[0m06:28:03.010521 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:28:03.143650 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:28:03.329146 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:28:03.329942 [debug] [MainThread]: Partial parsing: updated file: my_project://models/staging/staging.sql
[0m06:28:03.712478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '749a3740-ee15-4cdf-a1af-29cd1258c103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b610b1a43e0>]}
[0m06:28:03.830810 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:28:03.834560 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:28:03.870425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '749a3740-ee15-4cdf-a1af-29cd1258c103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b610b48a5d0>]}
[0m06:28:03.871093 [info ] [MainThread]: Found 2 data tests, 1 model, 1 source, 429 macros
[0m06:28:03.871651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '749a3740-ee15-4cdf-a1af-29cd1258c103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b610b2429f0>]}
[0m06:28:03.874250 [info ] [MainThread]: 
[0m06:28:03.874813 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:28:03.875496 [info ] [MainThread]: 
[0m06:28:03.877569 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:28:03.879989 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:28:04.122206 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:28:04.122779 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:28:04.123224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:28:04.149517 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.026 seconds
[0m06:28:04.151652 [debug] [ThreadPool]: On list_db: Close
[0m06:28:04.153738 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:28:04.161955 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:28:04.162490 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:28:04.162916 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:28:04.175630 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m06:28:04.176213 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:28:04.176701 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:28:04.181643 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m06:28:04.184096 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:28:04.185395 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:28:04.194977 [debug] [MainThread]: Using postgres connection "master"
[0m06:28:04.195627 [debug] [MainThread]: On master: BEGIN
[0m06:28:04.196079 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:28:04.208817 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m06:28:04.209411 [debug] [MainThread]: Using postgres connection "master"
[0m06:28:04.209983 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:28:04.215449 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m06:28:04.217615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '749a3740-ee15-4cdf-a1af-29cd1258c103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b610b4cd8e0>]}
[0m06:28:04.218270 [debug] [MainThread]: On master: ROLLBACK
[0m06:28:04.219149 [debug] [MainThread]: Using postgres connection "master"
[0m06:28:04.219658 [debug] [MainThread]: On master: BEGIN
[0m06:28:04.220783 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:28:04.221280 [debug] [MainThread]: On master: COMMIT
[0m06:28:04.221747 [debug] [MainThread]: Using postgres connection "master"
[0m06:28:04.222197 [debug] [MainThread]: On master: COMMIT
[0m06:28:04.222967 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:28:04.223565 [debug] [MainThread]: On master: Close
[0m06:28:04.228218 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:28:04.229062 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging ....................................... [RUN]
[0m06:28:04.229778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:28:04.230291 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:28:04.242144 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:28:04.243297 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:28:04.300927 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:28:04.301854 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:28:04.302322 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:28:04.302729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:28:04.315693 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m06:28:04.316301 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:28:04.316785 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * 
    from "db"."dev"."raw_beer_data"
)

select 
    id,
    beer_id,
    name as beer_name,
    tagline,
    first_brewed,
    description,
    image,
    abv,
    ibu,
    ebc,
    ph,
    brewers_tips,
    contributed_by,
    inserted_at
from source
  );
  
[0m06:28:04.323006 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.006 seconds
[0m06:28:04.331700 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:28:04.332314 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:28:04.333403 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:28:04.337127 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:28:04.337634 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:28:04.338587 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:28:04.365057 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:28:04.365579 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:28:04.366026 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:28:04.377184 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m06:28:04.386503 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:28:04.395272 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:28:04.395870 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:28:04.404407 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m06:28:04.408095 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:28:04.410437 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '749a3740-ee15-4cdf-a1af-29cd1258c103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b610ecfe570>]}
[0m06:28:04.411388 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.staging .................................. [[32mSELECT 414[0m in 0.18s]
[0m06:28:04.412542 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:28:04.415775 [debug] [MainThread]: Using postgres connection "master"
[0m06:28:04.416332 [debug] [MainThread]: On master: BEGIN
[0m06:28:04.416790 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:28:04.430483 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m06:28:04.431523 [debug] [MainThread]: On master: COMMIT
[0m06:28:04.432298 [debug] [MainThread]: Using postgres connection "master"
[0m06:28:04.432871 [debug] [MainThread]: On master: COMMIT
[0m06:28:04.433961 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:28:04.434568 [debug] [MainThread]: On master: Close
[0m06:28:04.435421 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:28:04.435898 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:28:04.436410 [info ] [MainThread]: 
[0m06:28:04.436978 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m06:28:04.439205 [debug] [MainThread]: Command end result
[0m06:28:04.476208 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:28:04.478881 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:28:04.488955 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:28:04.489582 [info ] [MainThread]: 
[0m06:28:04.490290 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:28:04.491030 [info ] [MainThread]: 
[0m06:28:04.492265 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:28:04.495061 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9227656, "process_in_blocks": "0", "process_kernel_time": 0.538009, "process_mem_max_rss": "111304", "process_out_blocks": "4160", "process_user_time": 3.035911}
[0m06:28:04.496025 [debug] [MainThread]: Command `dbt run` succeeded at 06:28:04.495848 after 1.92 seconds
[0m06:28:04.496589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b610d06f800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b610b364dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b610b51c710>]}
[0m06:28:04.497224 [debug] [MainThread]: Flushing usage events
[0m06:28:05.980870 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:34:01.881657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e1e773b860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e1e7b23ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e1e8026690>]}


============================== 06:34:01.887075 | 144eabc9-1278-47c2-ab68-14c45f0e93d1 ==============================
[0m06:34:01.887075 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:34:01.888047 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:34:02.160642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '144eabc9-1278-47c2-ab68-14c45f0e93d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e1e57e1010>]}
[0m06:34:02.246787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '144eabc9-1278-47c2-ab68-14c45f0e93d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e1e9004bc0>]}
[0m06:34:02.247903 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:34:02.399672 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:34:02.585367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m06:34:02.586170 [debug] [MainThread]: Partial parsing: added file: my_project://models/mart/beer_report.sql
[0m06:34:03.002268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '144eabc9-1278-47c2-ab68-14c45f0e93d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e1e54cfcb0>]}
[0m06:34:03.129265 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:34:03.132921 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:34:03.159537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '144eabc9-1278-47c2-ab68-14c45f0e93d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e1e54a9ee0>]}
[0m06:34:03.160275 [info ] [MainThread]: Found 2 data tests, 2 models, 1 source, 429 macros
[0m06:34:03.160859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '144eabc9-1278-47c2-ab68-14c45f0e93d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e1e562f080>]}
[0m06:34:03.164060 [info ] [MainThread]: 
[0m06:34:03.164745 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:34:03.165404 [info ] [MainThread]: 
[0m06:34:03.166660 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:34:03.174711 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:34:03.252712 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:34:03.253289 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:34:03.253745 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:34:03.270969 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.017 seconds
[0m06:34:03.273012 [debug] [ThreadPool]: On list_db: Close
[0m06:34:03.275117 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:34:03.283134 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:34:03.283640 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:34:03.284068 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:34:03.296321 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m06:34:03.296938 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:34:03.297556 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:34:03.302201 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m06:34:03.304116 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:34:03.304973 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:34:03.313346 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:03.314071 [debug] [MainThread]: On master: BEGIN
[0m06:34:03.314577 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:34:03.327343 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m06:34:03.327938 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:03.328709 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:34:03.334139 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m06:34:03.336309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '144eabc9-1278-47c2-ab68-14c45f0e93d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e1e554ff50>]}
[0m06:34:03.337038 [debug] [MainThread]: On master: ROLLBACK
[0m06:34:03.337936 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:03.338460 [debug] [MainThread]: On master: BEGIN
[0m06:34:03.339618 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:34:03.340122 [debug] [MainThread]: On master: COMMIT
[0m06:34:03.340692 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:03.341152 [debug] [MainThread]: On master: COMMIT
[0m06:34:03.341962 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:34:03.342473 [debug] [MainThread]: On master: Close
[0m06:34:03.347384 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:34:03.348316 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.staging ....................................... [RUN]
[0m06:34:03.349194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:34:03.349861 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:34:03.361644 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:34:03.362709 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:34:03.420641 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:34:03.421611 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:34:03.422102 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:34:03.422518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:34:03.435010 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m06:34:03.435598 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:34:03.436073 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * 
    from "db"."dev"."raw_beer_data"
)

select 
    id,
    beer_id,
    name as beer_name,
    tagline,
    first_brewed,
    description,
    image,
    abv,
    ibu,
    ebc,
    ph,
    brewers_tips,
    contributed_by,
    inserted_at
from source
  );
  
[0m06:34:03.441590 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.005 seconds
[0m06:34:03.450399 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:34:03.451022 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:34:03.452529 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:34:03.457637 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:34:03.458244 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:34:03.459361 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:34:03.490315 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:34:03.491037 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:34:03.491542 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:34:03.539456 [debug] [Thread-1 (]: SQL status: COMMIT in 0.047 seconds
[0m06:34:03.549269 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:34:03.558430 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:34:03.559125 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:34:03.567035 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m06:34:03.571306 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:34:03.574343 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '144eabc9-1278-47c2-ab68-14c45f0e93d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e1e8e4a4e0>]}
[0m06:34:03.575420 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.staging .................................. [[32mSELECT 414[0m in 0.22s]
[0m06:34:03.577118 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:34:03.579654 [debug] [Thread-3 (]: Began running node model.my_project.beer_report
[0m06:34:03.580609 [info ] [Thread-3 (]: 2 of 2 START sql table model dev.beer_report ................................... [RUN]
[0m06:34:03.581677 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.beer_report'
[0m06:34:03.582886 [debug] [Thread-3 (]: Began compiling node model.my_project.beer_report
[0m06:34:03.590621 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.beer_report"
[0m06:34:03.592471 [debug] [Thread-3 (]: Began executing node model.my_project.beer_report
[0m06:34:03.600179 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.beer_report"
[0m06:34:03.602185 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m06:34:03.602820 [debug] [Thread-3 (]: On model.my_project.beer_report: BEGIN
[0m06:34:03.603388 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:34:03.620122 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m06:34:03.620912 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m06:34:03.621480 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */

  
    

  create  table "db"."dev"."beer_report__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    count(*) as total_beers,
    round(avg(abv), 2) as avg_abv,
    round(min(abv), 2) as min_abv,
    round(max(abv), 2) as max_abv,
    round(avg(ibu), 2) as avg_ibu,
    round(min(ibu), 2) as min_ibu,
    round(max(ibu), 2) as max_ibu,
    round(avg(ebc), 2) as avg_ebc,
    round(min(ebc), 2) as min_ebc,
    round(max(ebc), 2) as max_ebc,
    round(avg(ph), 2) as avg_ph,
    min(first_brewed) as oldest_brew,
    max(first_brewed) as newest_brew,
    count(distinct contributed_by) as unique_contributors
from beers
  );
  
[0m06:34:03.630797 [debug] [Thread-3 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 20:     round(avg(abv), 2) as avg_abv,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m06:34:03.631993 [debug] [Thread-3 (]: On model.my_project.beer_report: ROLLBACK
[0m06:34:03.633396 [debug] [Thread-3 (]: On model.my_project.beer_report: Close
[0m06:34:03.639490 [debug] [Thread-3 (]: Database Error in model beer_report (models/mart/beer_report.sql)
  function round(double precision, integer) does not exist
  LINE 20:     round(avg(abv), 2) as avg_abv,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/my_project/models/mart/beer_report.sql
[0m06:34:03.640331 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '144eabc9-1278-47c2-ab68-14c45f0e93d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e1c747ed80>]}
[0m06:34:03.641294 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model dev.beer_report .......................... [[31mERROR[0m in 0.06s]
[0m06:34:03.642335 [debug] [Thread-3 (]: Finished running node model.my_project.beer_report
[0m06:34:03.643607 [debug] [Thread-7 (]: Marking all children of 'model.my_project.beer_report' to be skipped because of status 'error'.  Reason: Database Error in model beer_report (models/mart/beer_report.sql)
  function round(double precision, integer) does not exist
  LINE 20:     round(avg(abv), 2) as avg_abv,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/my_project/models/mart/beer_report.sql.
[0m06:34:03.647479 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:03.648139 [debug] [MainThread]: On master: BEGIN
[0m06:34:03.648782 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:34:03.664104 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m06:34:03.664859 [debug] [MainThread]: On master: COMMIT
[0m06:34:03.665353 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:03.665844 [debug] [MainThread]: On master: COMMIT
[0m06:34:03.666613 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:34:03.667175 [debug] [MainThread]: On master: Close
[0m06:34:03.667973 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:34:03.668498 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:34:03.669081 [debug] [MainThread]: Connection 'model.my_project.beer_report' was properly closed.
[0m06:34:03.669810 [info ] [MainThread]: 
[0m06:34:03.670465 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m06:34:03.673902 [debug] [MainThread]: Command end result
[0m06:34:03.720457 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:34:03.723190 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:34:03.733529 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:34:03.734127 [info ] [MainThread]: 
[0m06:34:03.734883 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:34:03.736018 [info ] [MainThread]: 
[0m06:34:03.737506 [error] [MainThread]:   Database Error in model beer_report (models/mart/beer_report.sql)
  function round(double precision, integer) does not exist
  LINE 20:     round(avg(abv), 2) as avg_abv,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/my_project/models/mart/beer_report.sql
[0m06:34:03.738874 [info ] [MainThread]: 
[0m06:34:03.740373 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m06:34:03.743879 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.9776756, "process_in_blocks": "0", "process_kernel_time": 0.456917, "process_mem_max_rss": "111036", "process_out_blocks": "2600", "process_user_time": 3.194705}
[0m06:34:03.745614 [debug] [MainThread]: Command `dbt run` failed at 06:34:03.745248 after 1.98 seconds
[0m06:34:03.746881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e1e90d9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e1e586fd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e1e57843e0>]}
[0m06:34:03.747988 [debug] [MainThread]: Flushing usage events
[0m06:34:05.241368 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:34:53.304190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743267786ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743268b8e3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743267786a50>]}


============================== 06:34:53.309522 | 491b36e4-d30a-4ae9-897d-8cd70854c53d ==============================
[0m06:34:53.309522 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:34:53.310417 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:34:53.579243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '491b36e4-d30a-4ae9-897d-8cd70854c53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743266bd7770>]}
[0m06:34:53.661573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '491b36e4-d30a-4ae9-897d-8cd70854c53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743266ba7050>]}
[0m06:34:53.662769 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:34:53.803047 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:34:53.974047 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:34:53.974934 [debug] [MainThread]: Partial parsing: updated file: my_project://models/mart/beer_report.sql
[0m06:34:54.389980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '491b36e4-d30a-4ae9-897d-8cd70854c53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7432650bbda0>]}
[0m06:34:54.515109 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:34:54.518729 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:34:54.544345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '491b36e4-d30a-4ae9-897d-8cd70854c53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7432640c9e50>]}
[0m06:34:54.545071 [info ] [MainThread]: Found 2 data tests, 2 models, 1 source, 429 macros
[0m06:34:54.545687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '491b36e4-d30a-4ae9-897d-8cd70854c53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743265290710>]}
[0m06:34:54.548671 [info ] [MainThread]: 
[0m06:34:54.549298 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:34:54.549975 [info ] [MainThread]: 
[0m06:34:54.551396 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:34:54.560335 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:34:54.667004 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:34:54.667586 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:34:54.668074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:34:54.685979 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.018 seconds
[0m06:34:54.688185 [debug] [ThreadPool]: On list_db: Close
[0m06:34:54.690789 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:34:54.700364 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:34:54.700947 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:34:54.701369 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:34:54.714459 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m06:34:54.715142 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:34:54.715610 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:34:54.720280 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m06:34:54.722211 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:34:54.723077 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:34:54.730346 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:54.731188 [debug] [MainThread]: On master: BEGIN
[0m06:34:54.731697 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:34:54.745369 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m06:34:54.745968 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:54.746578 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:34:54.752554 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m06:34:54.754806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '491b36e4-d30a-4ae9-897d-8cd70854c53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74326513e9c0>]}
[0m06:34:54.755502 [debug] [MainThread]: On master: ROLLBACK
[0m06:34:54.756359 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:54.756854 [debug] [MainThread]: On master: BEGIN
[0m06:34:54.757972 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:34:54.758510 [debug] [MainThread]: On master: COMMIT
[0m06:34:54.759094 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:54.759550 [debug] [MainThread]: On master: COMMIT
[0m06:34:54.760320 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:34:54.760831 [debug] [MainThread]: On master: Close
[0m06:34:54.765677 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:34:54.766507 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.staging ....................................... [RUN]
[0m06:34:54.767307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:34:54.768115 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:34:54.782135 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:34:54.783303 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:34:54.840113 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:34:54.841073 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:34:54.841635 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:34:54.842082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:34:54.854324 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m06:34:54.855022 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:34:54.855532 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * 
    from "db"."dev"."raw_beer_data"
)

select 
    id,
    beer_id,
    name as beer_name,
    tagline,
    first_brewed,
    description,
    image,
    abv,
    ibu,
    ebc,
    ph,
    brewers_tips,
    contributed_by,
    inserted_at
from source
  );
  
[0m06:34:54.860873 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.005 seconds
[0m06:34:54.869315 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:34:54.869868 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:34:54.870925 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:34:54.874720 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:34:54.875244 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:34:54.876216 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:54.902421 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:34:54.903103 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:34:54.903593 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:34:55.028865 [debug] [Thread-1 (]: SQL status: COMMIT in 0.124 seconds
[0m06:34:55.057456 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:34:55.083571 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:34:55.084276 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:34:55.092326 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m06:34:55.096565 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:34:55.099296 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '491b36e4-d30a-4ae9-897d-8cd70854c53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743268a42540>]}
[0m06:34:55.100359 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.staging .................................. [[32mSELECT 414[0m in 0.33s]
[0m06:34:55.101647 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:34:55.103696 [debug] [Thread-3 (]: Began running node model.my_project.beer_report
[0m06:34:55.104687 [info ] [Thread-3 (]: 2 of 2 START sql table model dev.beer_report ................................... [RUN]
[0m06:34:55.105652 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.beer_report'
[0m06:34:55.106384 [debug] [Thread-3 (]: Began compiling node model.my_project.beer_report
[0m06:34:55.113785 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.beer_report"
[0m06:34:55.114944 [debug] [Thread-3 (]: Began executing node model.my_project.beer_report
[0m06:34:55.120966 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.beer_report"
[0m06:34:55.121964 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m06:34:55.122957 [debug] [Thread-3 (]: On model.my_project.beer_report: BEGIN
[0m06:34:55.123872 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:34:55.139546 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m06:34:55.140229 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m06:34:55.141037 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */

  
    

  create  table "db"."dev"."beer_report__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    count(*) as total_beers,
    round(avg(abv)::numeric, 2) as avg_abv,
    round(min(abv)::numeric, 2) as min_abv,
    round(max(abv)::numeric, 2) as max_abv,
    round(avg(ibu)::numeric, 2) as avg_ibu,
    round(min(ibu)::numeric, 2) as min_ibu,
    round(max(ibu)::numeric, 2) as max_ibu,
    round(avg(ebc)::numeric, 2) as avg_ebc,
    round(min(ebc)::numeric, 2) as min_ebc,
    round(max(ebc)::numeric, 2) as max_ebc,
    round(avg(ph)::numeric, 2) as avg_ph,
    min(first_brewed) as oldest_brew,
    max(first_brewed) as newest_brew,
    count(distinct contributed_by) as unique_contributors
from beers
  );
  
[0m06:34:55.153920 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.012 seconds
[0m06:34:55.158351 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m06:34:55.159250 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report__dbt_tmp" rename to "beer_report"
[0m06:34:55.160589 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:34:55.163218 [debug] [Thread-3 (]: On model.my_project.beer_report: COMMIT
[0m06:34:55.163831 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m06:34:55.164392 [debug] [Thread-3 (]: On model.my_project.beer_report: COMMIT
[0m06:34:55.170569 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m06:34:55.174072 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."beer_report__dbt_backup"
[0m06:34:55.175157 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m06:34:55.175713 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
drop table if exists "db"."dev"."beer_report__dbt_backup" cascade
[0m06:34:55.177184 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m06:34:55.179701 [debug] [Thread-3 (]: On model.my_project.beer_report: Close
[0m06:34:55.180964 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '491b36e4-d30a-4ae9-897d-8cd70854c53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74324f085ca0>]}
[0m06:34:55.182032 [info ] [Thread-3 (]: 2 of 2 OK created sql table model dev.beer_report .............................. [[32mSELECT 1[0m in 0.08s]
[0m06:34:55.183217 [debug] [Thread-3 (]: Finished running node model.my_project.beer_report
[0m06:34:55.186390 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:55.186985 [debug] [MainThread]: On master: BEGIN
[0m06:34:55.187475 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:34:55.201670 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m06:34:55.202301 [debug] [MainThread]: On master: COMMIT
[0m06:34:55.202864 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:55.203342 [debug] [MainThread]: On master: COMMIT
[0m06:34:55.204096 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:34:55.204612 [debug] [MainThread]: On master: Close
[0m06:34:55.205440 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:34:55.205898 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:34:55.206322 [debug] [MainThread]: Connection 'model.my_project.beer_report' was properly closed.
[0m06:34:55.206994 [info ] [MainThread]: 
[0m06:34:55.207574 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m06:34:55.209879 [debug] [MainThread]: Command end result
[0m06:34:55.258628 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:34:55.261346 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:34:55.272173 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:34:55.272811 [info ] [MainThread]: 
[0m06:34:55.273497 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:34:55.274731 [info ] [MainThread]: 
[0m06:34:55.276080 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:34:55.279147 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1134312, "process_in_blocks": "0", "process_kernel_time": 0.446931, "process_mem_max_rss": "110608", "process_out_blocks": "2600", "process_user_time": 3.016788}
[0m06:34:55.280103 [debug] [MainThread]: Command `dbt run` succeeded at 06:34:55.279908 after 2.11 seconds
[0m06:34:55.280877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7432675ba270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743266ef6180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743265154e90>]}
[0m06:34:55.281646 [debug] [MainThread]: Flushing usage events
[0m06:34:56.764690 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:37:25.220496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7384bad18b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7384bad1b860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7384ba73e3c0>]}


============================== 06:37:25.227650 | 0aa07e6f-089f-471d-957f-a29b56dad899 ==============================
[0m06:37:25.227650 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:37:25.229175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:37:25.527524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0aa07e6f-089f-471d-957f-a29b56dad899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7384ba17f8c0>]}
[0m06:37:25.622300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0aa07e6f-089f-471d-957f-a29b56dad899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7384ba10bc20>]}
[0m06:37:25.623593 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:37:25.787582 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:37:25.988842 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:37:25.989508 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:37:26.070761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0aa07e6f-089f-471d-957f-a29b56dad899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7384b87e89b0>]}
[0m06:37:26.223642 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:37:26.227717 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:37:26.252940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0aa07e6f-089f-471d-957f-a29b56dad899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7384b850b380>]}
[0m06:37:26.253729 [info ] [MainThread]: Found 2 data tests, 2 models, 1 source, 429 macros
[0m06:37:26.254445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0aa07e6f-089f-471d-957f-a29b56dad899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7384b87c4860>]}
[0m06:37:26.257708 [info ] [MainThread]: 
[0m06:37:26.258439 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:37:26.259252 [info ] [MainThread]: 
[0m06:37:26.260583 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:37:26.269128 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:37:26.363398 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:37:26.363962 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:37:26.364430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:37:26.382382 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.018 seconds
[0m06:37:26.384828 [debug] [ThreadPool]: On list_db: Close
[0m06:37:26.388258 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:37:26.397053 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:37:26.397633 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:37:26.398056 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:37:26.412204 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m06:37:26.412846 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:37:26.413451 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:37:26.418439 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m06:37:26.420992 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:37:26.422067 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:37:26.435280 [debug] [MainThread]: Using postgres connection "master"
[0m06:37:26.436230 [debug] [MainThread]: On master: BEGIN
[0m06:37:26.437039 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:37:26.451978 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m06:37:26.452653 [debug] [MainThread]: Using postgres connection "master"
[0m06:37:26.453527 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:37:26.463257 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m06:37:26.465434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0aa07e6f-089f-471d-957f-a29b56dad899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7384b7967e60>]}
[0m06:37:26.466149 [debug] [MainThread]: On master: ROLLBACK
[0m06:37:26.467083 [debug] [MainThread]: Using postgres connection "master"
[0m06:37:26.467583 [debug] [MainThread]: On master: BEGIN
[0m06:37:26.468737 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:37:26.469338 [debug] [MainThread]: On master: COMMIT
[0m06:37:26.470021 [debug] [MainThread]: Using postgres connection "master"
[0m06:37:26.470664 [debug] [MainThread]: On master: COMMIT
[0m06:37:26.471547 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:37:26.472127 [debug] [MainThread]: On master: Close
[0m06:37:26.477848 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:37:26.478940 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.staging ....................................... [RUN]
[0m06:37:26.479917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:37:26.480937 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:37:26.493628 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:37:26.495035 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:37:26.555637 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:37:26.556566 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:37:26.557119 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:37:26.557600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:37:26.569959 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m06:37:26.570634 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:37:26.571392 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * 
    from "db"."dev"."raw_beer_data"
)

select 
    id,
    beer_id,
    name as beer_name,
    tagline,
    first_brewed,
    description,
    image,
    abv,
    ibu,
    ebc,
    ph,
    brewers_tips,
    contributed_by,
    inserted_at
from source
  );
  
[0m06:37:26.576987 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.005 seconds
[0m06:37:26.588668 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:37:26.589393 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:37:26.590708 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:37:26.594767 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:37:26.595356 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:37:26.596431 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:37:26.629459 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:37:26.630187 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:37:26.630891 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:37:26.637321 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m06:37:26.647100 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:37:26.655899 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:37:26.656530 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:37:26.663065 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m06:37:26.666729 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:37:26.669256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aa07e6f-089f-471d-957f-a29b56dad899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7384bbdaa390>]}
[0m06:37:26.670337 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.staging .................................. [[32mSELECT 414[0m in 0.19s]
[0m06:37:26.671543 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:37:26.673211 [debug] [Thread-3 (]: Began running node model.my_project.beer_report
[0m06:37:26.674968 [info ] [Thread-3 (]: 2 of 2 START sql table model dev.beer_report ................................... [RUN]
[0m06:37:26.676058 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.beer_report'
[0m06:37:26.677050 [debug] [Thread-3 (]: Began compiling node model.my_project.beer_report
[0m06:37:26.682658 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.beer_report"
[0m06:37:26.683785 [debug] [Thread-3 (]: Began executing node model.my_project.beer_report
[0m06:37:26.692412 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.beer_report"
[0m06:37:26.693711 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m06:37:26.694384 [debug] [Thread-3 (]: On model.my_project.beer_report: BEGIN
[0m06:37:26.694948 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:37:26.711206 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m06:37:26.712469 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m06:37:26.713467 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */

  
    

  create  table "db"."dev"."beer_report__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    count(*) as total_beers,
    round(avg(abv)::numeric, 2) as avg_abv,
    round(min(abv)::numeric, 2) as min_abv,
    round(max(abv)::numeric, 2) as max_abv,
    round(avg(ibu)::numeric, 2) as avg_ibu,
    round(min(ibu)::numeric, 2) as min_ibu,
    round(max(ibu)::numeric, 2) as max_ibu,
    round(avg(ebc)::numeric, 2) as avg_ebc,
    round(min(ebc)::numeric, 2) as min_ebc,
    round(max(ebc)::numeric, 2) as max_ebc,
    round(avg(ph)::numeric, 2) as avg_ph,
    min(first_brewed) as oldest_brew,
    max(first_brewed) as newest_brew,
    count(distinct contributed_by) as unique_contributors
from beers
  );
  
[0m06:37:26.720755 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m06:37:26.725176 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m06:37:26.725805 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report" rename to "beer_report__dbt_backup"
[0m06:37:26.727286 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:37:26.734881 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m06:37:26.736043 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report__dbt_tmp" rename to "beer_report"
[0m06:37:26.737588 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:37:26.740281 [debug] [Thread-3 (]: On model.my_project.beer_report: COMMIT
[0m06:37:26.740938 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m06:37:26.741442 [debug] [Thread-3 (]: On model.my_project.beer_report: COMMIT
[0m06:37:26.901663 [debug] [Thread-3 (]: SQL status: COMMIT in 0.160 seconds
[0m06:37:26.905150 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."beer_report__dbt_backup"
[0m06:37:26.906021 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m06:37:26.906576 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
drop table if exists "db"."dev"."beer_report__dbt_backup" cascade
[0m06:37:26.912809 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m06:37:26.914888 [debug] [Thread-3 (]: On model.my_project.beer_report: Close
[0m06:37:26.915781 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aa07e6f-089f-471d-957f-a29b56dad899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7384b76b77a0>]}
[0m06:37:26.916649 [info ] [Thread-3 (]: 2 of 2 OK created sql table model dev.beer_report .............................. [[32mSELECT 1[0m in 0.24s]
[0m06:37:26.917740 [debug] [Thread-3 (]: Finished running node model.my_project.beer_report
[0m06:37:26.921258 [debug] [MainThread]: Using postgres connection "master"
[0m06:37:26.921811 [debug] [MainThread]: On master: BEGIN
[0m06:37:26.922377 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:37:26.936653 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m06:37:26.938182 [debug] [MainThread]: On master: COMMIT
[0m06:37:26.939131 [debug] [MainThread]: Using postgres connection "master"
[0m06:37:26.939654 [debug] [MainThread]: On master: COMMIT
[0m06:37:26.940598 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:37:26.941171 [debug] [MainThread]: On master: Close
[0m06:37:26.941947 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:37:26.942651 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:37:26.943243 [debug] [MainThread]: Connection 'model.my_project.beer_report' was properly closed.
[0m06:37:26.944374 [info ] [MainThread]: 
[0m06:37:26.945705 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m06:37:26.948947 [debug] [MainThread]: Command end result
[0m06:37:26.987044 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:37:26.989539 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:37:26.999669 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:37:27.000236 [info ] [MainThread]: 
[0m06:37:27.000910 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:37:27.001666 [info ] [MainThread]: 
[0m06:37:27.002651 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:37:27.004886 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9277748, "process_in_blocks": "0", "process_kernel_time": 0.564664, "process_mem_max_rss": "107612", "process_out_blocks": "1768", "process_user_time": 3.250535}
[0m06:37:27.005744 [debug] [MainThread]: Command `dbt run` succeeded at 06:37:27.005573 after 1.93 seconds
[0m06:37:27.006400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7384b7735a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7384ba34e6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7384ba34f320>]}
[0m06:37:27.006985 [debug] [MainThread]: Flushing usage events
[0m06:37:28.465676 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:41:50.599794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8d3039e5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8d311b35f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8d3112f740>]}


============================== 06:41:50.609065 | 19e47b91-6d46-46ed-9885-53976ebb7926 ==============================
[0m06:41:50.609065 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:41:50.610180 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:41:50.950549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19e47b91-6d46-46ed-9885-53976ebb7926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8d2e4fa480>]}
[0m06:41:51.047657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19e47b91-6d46-46ed-9885-53976ebb7926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8d2fe88980>]}
[0m06:41:51.048862 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:41:51.200885 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:41:51.401900 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:41:51.402473 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:41:51.472059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19e47b91-6d46-46ed-9885-53976ebb7926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8d2e56c740>]}
[0m06:41:51.605599 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:41:51.609264 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:41:51.643228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19e47b91-6d46-46ed-9885-53976ebb7926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8d2e2ba540>]}
[0m06:41:51.644082 [info ] [MainThread]: Found 2 data tests, 2 models, 1 source, 429 macros
[0m06:41:51.644695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19e47b91-6d46-46ed-9885-53976ebb7926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8d2fdcfe30>]}
[0m06:41:51.647786 [info ] [MainThread]: 
[0m06:41:51.648431 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:41:51.649174 [info ] [MainThread]: 
[0m06:41:51.650853 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:41:51.658978 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:41:51.739185 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:41:51.739817 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:41:51.740259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:51.764008 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.024 seconds
[0m06:41:51.765972 [debug] [ThreadPool]: On list_db: Close
[0m06:41:51.768707 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:41:51.782672 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:41:51.783525 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:41:51.784141 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:41:51.797468 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m06:41:51.798255 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:41:51.799013 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:41:51.818050 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.018 seconds
[0m06:41:51.820184 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:41:51.821123 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:41:51.831799 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:51.832416 [debug] [MainThread]: On master: BEGIN
[0m06:41:51.832900 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:41:51.846656 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m06:41:51.847605 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:51.848460 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:41:51.867729 [debug] [MainThread]: SQL status: SELECT 0 in 0.018 seconds
[0m06:41:51.870054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19e47b91-6d46-46ed-9885-53976ebb7926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8d2d518770>]}
[0m06:41:51.870792 [debug] [MainThread]: On master: ROLLBACK
[0m06:41:51.871673 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:51.872192 [debug] [MainThread]: On master: BEGIN
[0m06:41:51.873449 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:41:51.874176 [debug] [MainThread]: On master: COMMIT
[0m06:41:51.874773 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:51.875698 [debug] [MainThread]: On master: COMMIT
[0m06:41:51.877132 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:51.878098 [debug] [MainThread]: On master: Close
[0m06:41:51.883493 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:41:51.884466 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.staging ....................................... [RUN]
[0m06:41:51.885468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:41:51.886284 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:41:51.899045 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:41:51.900036 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:41:51.967105 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:41:51.968349 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:41:51.969097 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:41:51.969789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:41:51.984139 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m06:41:51.985380 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:41:51.986200 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * 
    from "db"."dev"."raw_beer_data"
)

select 
    id,
    beer_id,
    name as beer_name,
    tagline,
    first_brewed,
    description,
    image,
    abv,
    ibu,
    ebc,
    ph,
    brewers_tips,
    contributed_by,
    inserted_at
from source
  );
  
[0m06:41:51.999279 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.012 seconds
[0m06:41:52.009741 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:41:52.010382 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:41:52.011585 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:41:52.015698 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:41:52.016303 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:41:52.017475 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:41:52.049221 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:41:52.049935 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:41:52.050566 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:41:52.058641 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m06:41:52.069535 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:41:52.079334 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:41:52.080024 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:41:52.093164 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.012 seconds
[0m06:41:52.096635 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:41:52.099162 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19e47b91-6d46-46ed-9885-53976ebb7926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8d308d6900>]}
[0m06:41:52.100123 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.staging .................................. [[32mSELECT 414[0m in 0.21s]
[0m06:41:52.101495 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:41:52.103464 [debug] [Thread-3 (]: Began running node model.my_project.beer_report
[0m06:41:52.104273 [info ] [Thread-3 (]: 2 of 2 START sql table model dev.beer_report ................................... [RUN]
[0m06:41:52.105373 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.beer_report'
[0m06:41:52.106368 [debug] [Thread-3 (]: Began compiling node model.my_project.beer_report
[0m06:41:52.113934 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.beer_report"
[0m06:41:52.114960 [debug] [Thread-3 (]: Began executing node model.my_project.beer_report
[0m06:41:52.124052 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.beer_report"
[0m06:41:52.125419 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m06:41:52.126290 [debug] [Thread-3 (]: On model.my_project.beer_report: BEGIN
[0m06:41:52.127038 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:41:52.142987 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m06:41:52.143871 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m06:41:52.144481 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */

  
    

  create  table "db"."dev"."beer_report__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    count(*) as total_beers,
    round(avg(abv)::numeric, 2) as avg_abv,
    round(min(abv)::numeric, 2) as min_abv,
    round(max(abv)::numeric, 2) as max_abv,
    round(avg(ibu)::numeric, 2) as avg_ibu,
    round(min(ibu)::numeric, 2) as min_ibu,
    round(max(ibu)::numeric, 2) as max_ibu,
    round(avg(ebc)::numeric, 2) as avg_ebc,
    round(min(ebc)::numeric, 2) as min_ebc,
    round(max(ebc)::numeric, 2) as max_ebc,
    round(avg(ph)::numeric, 2) as avg_ph,
    min(first_brewed) as oldest_brew,
    max(first_brewed) as newest_brew,
    count(distinct contributed_by) as unique_contributors
from beers
  );
  
[0m06:41:52.153302 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.008 seconds
[0m06:41:52.157675 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m06:41:52.158252 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report" rename to "beer_report__dbt_backup"
[0m06:41:52.159416 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:41:52.163556 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m06:41:52.164447 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report__dbt_tmp" rename to "beer_report"
[0m06:41:52.166114 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:41:52.169365 [debug] [Thread-3 (]: On model.my_project.beer_report: COMMIT
[0m06:41:52.170080 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m06:41:52.170806 [debug] [Thread-3 (]: On model.my_project.beer_report: COMMIT
[0m06:41:52.176212 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m06:41:52.179620 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."beer_report__dbt_backup"
[0m06:41:52.180759 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m06:41:52.181332 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
drop table if exists "db"."dev"."beer_report__dbt_backup" cascade
[0m06:41:52.212960 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.031 seconds
[0m06:41:52.215233 [debug] [Thread-3 (]: On model.my_project.beer_report: Close
[0m06:41:52.216198 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19e47b91-6d46-46ed-9885-53976ebb7926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8d2e282060>]}
[0m06:41:52.217152 [info ] [Thread-3 (]: 2 of 2 OK created sql table model dev.beer_report .............................. [[32mSELECT 1[0m in 0.11s]
[0m06:41:52.218909 [debug] [Thread-3 (]: Finished running node model.my_project.beer_report
[0m06:41:52.223372 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:52.224003 [debug] [MainThread]: On master: BEGIN
[0m06:41:52.224508 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:41:52.239026 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m06:41:52.240362 [debug] [MainThread]: On master: COMMIT
[0m06:41:52.241544 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:52.242233 [debug] [MainThread]: On master: COMMIT
[0m06:41:52.243221 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:52.243763 [debug] [MainThread]: On master: Close
[0m06:41:52.244521 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:41:52.245058 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:41:52.245522 [debug] [MainThread]: Connection 'model.my_project.beer_report' was properly closed.
[0m06:41:52.246125 [info ] [MainThread]: 
[0m06:41:52.246670 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m06:41:52.250035 [debug] [MainThread]: Command end result
[0m06:41:52.287402 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:41:52.290230 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:41:52.301559 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:41:52.302165 [info ] [MainThread]: 
[0m06:41:52.302949 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:41:52.303839 [info ] [MainThread]: 
[0m06:41:52.304847 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:41:52.307091 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7818599, "process_in_blocks": "904", "process_kernel_time": 0.556156, "process_mem_max_rss": "108104", "process_out_blocks": "3384", "process_user_time": 3.177508}
[0m06:41:52.308197 [debug] [MainThread]: Command `dbt run` succeeded at 06:41:52.307919 after 1.78 seconds
[0m06:41:52.309022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8d308d6900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8d2e2f8230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8d2d5868d0>]}
[0m06:41:52.309657 [debug] [MainThread]: Flushing usage events
[0m06:41:53.786750 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:47:23.373349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509b574af90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509b51f3b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509b574aa80>]}


============================== 06:47:23.384552 | 9fa567ad-30c1-4bf4-8c70-9f7f6289601c ==============================
[0m06:47:23.384552 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:47:23.385665 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:47:23.779660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fa567ad-30c1-4bf4-8c70-9f7f6289601c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509b4b8b440>]}
[0m06:47:23.923422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9fa567ad-30c1-4bf4-8c70-9f7f6289601c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509b4edc980>]}
[0m06:47:23.925089 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:47:24.321292 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:47:24.631998 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:47:24.632690 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:47:24.738484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fa567ad-30c1-4bf4-8c70-9f7f6289601c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509b33a9190>]}
[0m06:47:24.936301 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:47:24.940541 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:47:24.988320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fa567ad-30c1-4bf4-8c70-9f7f6289601c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509b30d21b0>]}
[0m06:47:24.989168 [info ] [MainThread]: Found 2 data tests, 2 models, 1 source, 429 macros
[0m06:47:24.989779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fa567ad-30c1-4bf4-8c70-9f7f6289601c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509b3096990>]}
[0m06:47:24.993097 [info ] [MainThread]: 
[0m06:47:24.993805 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:47:24.994656 [info ] [MainThread]: 
[0m06:47:24.999465 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:47:25.012781 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:47:25.106675 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:47:25.107569 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:47:25.108032 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:47:25.131087 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.023 seconds
[0m06:47:25.133109 [debug] [ThreadPool]: On list_db: Close
[0m06:47:25.135558 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:47:25.148370 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:47:25.149309 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:47:25.151085 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:47:25.167768 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m06:47:25.168590 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:47:25.169268 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:47:25.175097 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m06:47:25.180259 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:47:25.181456 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:47:25.193136 [debug] [MainThread]: Using postgres connection "master"
[0m06:47:25.193774 [debug] [MainThread]: On master: BEGIN
[0m06:47:25.194452 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:47:25.213341 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m06:47:25.216755 [debug] [MainThread]: Using postgres connection "master"
[0m06:47:25.217502 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:47:25.226633 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m06:47:25.229167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fa567ad-30c1-4bf4-8c70-9f7f6289601c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509b3334500>]}
[0m06:47:25.229999 [debug] [MainThread]: On master: ROLLBACK
[0m06:47:25.231489 [debug] [MainThread]: Using postgres connection "master"
[0m06:47:25.234224 [debug] [MainThread]: On master: BEGIN
[0m06:47:25.237021 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:47:25.239271 [debug] [MainThread]: On master: COMMIT
[0m06:47:25.240052 [debug] [MainThread]: Using postgres connection "master"
[0m06:47:25.240589 [debug] [MainThread]: On master: COMMIT
[0m06:47:25.241413 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:47:25.241953 [debug] [MainThread]: On master: Close
[0m06:47:25.247069 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:47:25.248104 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.staging ....................................... [RUN]
[0m06:47:25.249655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:47:25.251472 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:47:25.265710 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:47:25.268928 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:47:25.340623 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:47:25.341984 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:47:25.342660 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:47:25.343281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:47:25.356875 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m06:47:25.358664 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:47:25.360448 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * 
    from "db"."dev"."raw_beer_data"
)

select 
    id,
    beer_id,
    name as beer_name,
    tagline,
    first_brewed,
    description,
    image,
    abv,
    ibu,
    ebc,
    ph,
    brewers_tips,
    contributed_by,
    inserted_at
from source
  );
  
[0m06:47:25.369768 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.008 seconds
[0m06:47:25.384783 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:47:25.385758 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:47:25.387068 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:47:25.391189 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:47:25.391778 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:47:25.393312 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:47:25.433057 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:47:25.434091 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:47:25.434694 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:47:25.565200 [debug] [Thread-1 (]: SQL status: COMMIT in 0.129 seconds
[0m06:47:25.579716 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:47:25.590343 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:47:25.591016 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:47:25.600425 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.009 seconds
[0m06:47:25.604189 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:47:25.606763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fa567ad-30c1-4bf4-8c70-9f7f6289601c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509b572a6f0>]}
[0m06:47:25.607828 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.staging .................................. [[32mSELECT 414[0m in 0.36s]
[0m06:47:25.609155 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:47:25.612233 [debug] [Thread-3 (]: Began running node model.my_project.beer_report
[0m06:47:25.613704 [info ] [Thread-3 (]: 2 of 2 START sql table model dev.beer_report ................................... [RUN]
[0m06:47:25.615583 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.beer_report'
[0m06:47:25.617360 [debug] [Thread-3 (]: Began compiling node model.my_project.beer_report
[0m06:47:25.623135 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.beer_report"
[0m06:47:25.624935 [debug] [Thread-3 (]: Began executing node model.my_project.beer_report
[0m06:47:25.634923 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.beer_report"
[0m06:47:25.636560 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m06:47:25.637475 [debug] [Thread-3 (]: On model.my_project.beer_report: BEGIN
[0m06:47:25.638114 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:47:25.654175 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m06:47:25.656616 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m06:47:25.657437 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */

  
    

  create  table "db"."dev"."beer_report__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    count(*) as total_beers,
    round(avg(abv)::numeric, 2) as avg_abv,
    round(min(abv)::numeric, 2) as min_abv,
    round(max(abv)::numeric, 2) as max_abv,
    round(avg(ibu)::numeric, 2) as avg_ibu,
    round(min(ibu)::numeric, 2) as min_ibu,
    round(max(ibu)::numeric, 2) as max_ibu,
    round(avg(ebc)::numeric, 2) as avg_ebc,
    round(min(ebc)::numeric, 2) as min_ebc,
    round(max(ebc)::numeric, 2) as max_ebc,
    round(avg(ph)::numeric, 2) as avg_ph,
    min(first_brewed) as oldest_brew,
    max(first_brewed) as newest_brew,
    count(distinct contributed_by) as unique_contributors
from beers
  );
  
[0m06:47:25.664784 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m06:47:25.673926 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m06:47:25.674924 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report" rename to "beer_report__dbt_backup"
[0m06:47:25.676271 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:47:25.680612 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m06:47:25.681209 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report__dbt_tmp" rename to "beer_report"
[0m06:47:25.683805 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:47:25.688188 [debug] [Thread-3 (]: On model.my_project.beer_report: COMMIT
[0m06:47:25.688910 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m06:47:25.690077 [debug] [Thread-3 (]: On model.my_project.beer_report: COMMIT
[0m06:47:25.695901 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m06:47:25.699201 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."beer_report__dbt_backup"
[0m06:47:25.701878 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m06:47:25.703420 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
drop table if exists "db"."dev"."beer_report__dbt_backup" cascade
[0m06:47:25.711159 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m06:47:25.713466 [debug] [Thread-3 (]: On model.my_project.beer_report: Close
[0m06:47:25.714442 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fa567ad-30c1-4bf4-8c70-9f7f6289601c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509b0147e30>]}
[0m06:47:25.715450 [info ] [Thread-3 (]: 2 of 2 OK created sql table model dev.beer_report .............................. [[32mSELECT 1[0m in 0.10s]
[0m06:47:25.716528 [debug] [Thread-3 (]: Finished running node model.my_project.beer_report
[0m06:47:25.721542 [debug] [MainThread]: Using postgres connection "master"
[0m06:47:25.722676 [debug] [MainThread]: On master: BEGIN
[0m06:47:25.723439 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:47:25.743960 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m06:47:25.745263 [debug] [MainThread]: On master: COMMIT
[0m06:47:25.746632 [debug] [MainThread]: Using postgres connection "master"
[0m06:47:25.747520 [debug] [MainThread]: On master: COMMIT
[0m06:47:25.748416 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:47:25.748938 [debug] [MainThread]: On master: Close
[0m06:47:25.749720 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:47:25.750226 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:47:25.750687 [debug] [MainThread]: Connection 'model.my_project.beer_report' was properly closed.
[0m06:47:25.751484 [info ] [MainThread]: 
[0m06:47:25.752407 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m06:47:25.758105 [debug] [MainThread]: Command end result
[0m06:47:25.807519 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:47:25.813866 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:47:25.825734 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:47:25.827562 [info ] [MainThread]: 
[0m06:47:25.829811 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:47:25.831213 [info ] [MainThread]: 
[0m06:47:25.833089 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:47:25.835799 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5604098, "process_in_blocks": "0", "process_kernel_time": 0.685608, "process_mem_max_rss": "108360", "process_out_blocks": "3384", "process_user_time": 4.544608}
[0m06:47:25.836719 [debug] [MainThread]: Command `dbt run` succeeded at 06:47:25.836531 after 2.56 seconds
[0m06:47:25.837399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509b6bbc140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509b572a6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509b6a85be0>]}
[0m06:47:25.838126 [debug] [MainThread]: Flushing usage events
[0m06:47:27.339932 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:54:02.658163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762801054290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762802ab7f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762800f8af90>]}


============================== 06:54:02.668321 | 276ae673-2d55-4158-b9e1-88daa3966bcf ==============================
[0m06:54:02.668321 [info ] [MainThread]: Running with dbt=1.9.0
[0m06:54:02.669374 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:54:02.994831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '276ae673-2d55-4158-b9e1-88daa3966bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762800cc4650>]}
[0m06:54:03.092421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '276ae673-2d55-4158-b9e1-88daa3966bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7628016c2a80>]}
[0m06:54:03.093550 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:54:03.243552 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m06:54:03.458114 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:54:03.458727 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:54:03.533766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '276ae673-2d55-4158-b9e1-88daa3966bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7627ff4c83b0>]}
[0m06:54:03.671320 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:54:03.675464 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:54:03.715698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '276ae673-2d55-4158-b9e1-88daa3966bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7627ff446ab0>]}
[0m06:54:03.716832 [info ] [MainThread]: Found 2 data tests, 2 models, 1 source, 429 macros
[0m06:54:03.717744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '276ae673-2d55-4158-b9e1-88daa3966bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7627ff2b7260>]}
[0m06:54:03.722083 [info ] [MainThread]: 
[0m06:54:03.723176 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:54:03.723915 [info ] [MainThread]: 
[0m06:54:03.725295 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:54:03.733995 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m06:54:03.811582 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m06:54:03.812177 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m06:54:03.812650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:54:03.834327 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.022 seconds
[0m06:54:03.836565 [debug] [ThreadPool]: On list_db: Close
[0m06:54:03.839144 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m06:54:03.848260 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:54:03.848977 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m06:54:03.849567 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:54:03.863736 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m06:54:03.864860 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m06:54:03.865852 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:54:03.873861 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m06:54:03.876758 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m06:54:03.877899 [debug] [ThreadPool]: On list_db_dev: Close
[0m06:54:03.886161 [debug] [MainThread]: Using postgres connection "master"
[0m06:54:03.887137 [debug] [MainThread]: On master: BEGIN
[0m06:54:03.888174 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:54:03.902122 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m06:54:03.902811 [debug] [MainThread]: Using postgres connection "master"
[0m06:54:03.903676 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:54:03.910169 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m06:54:03.913917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '276ae673-2d55-4158-b9e1-88daa3966bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762800dd3320>]}
[0m06:54:03.915224 [debug] [MainThread]: On master: ROLLBACK
[0m06:54:03.916392 [debug] [MainThread]: Using postgres connection "master"
[0m06:54:03.916970 [debug] [MainThread]: On master: BEGIN
[0m06:54:03.918009 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:54:03.918809 [debug] [MainThread]: On master: COMMIT
[0m06:54:03.919585 [debug] [MainThread]: Using postgres connection "master"
[0m06:54:03.920153 [debug] [MainThread]: On master: COMMIT
[0m06:54:03.920906 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:54:03.921426 [debug] [MainThread]: On master: Close
[0m06:54:03.927926 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m06:54:03.929705 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.staging ....................................... [RUN]
[0m06:54:03.931330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m06:54:03.932743 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m06:54:03.953682 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m06:54:03.955144 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m06:54:04.022963 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m06:54:04.024049 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:54:04.024656 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m06:54:04.025154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:04.038146 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m06:54:04.038969 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:54:04.039544 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * 
    from "db"."dev"."raw_beer_data"
)

select 
    id,
    beer_id,
    name as beer_name,
    tagline,
    first_brewed,
    description,
    image,
    abv,
    ibu,
    ebc,
    ph,
    brewers_tips,
    contributed_by,
    inserted_at
from source
  );
  
[0m06:54:04.046356 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.006 seconds
[0m06:54:04.056962 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:54:04.057624 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m06:54:04.058823 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:54:04.063140 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:54:04.063725 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m06:54:04.064951 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:54:04.097797 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:54:04.098488 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:54:04.099113 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m06:54:04.107444 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m06:54:04.118703 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m06:54:04.128348 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m06:54:04.129112 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m06:54:04.158619 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.029 seconds
[0m06:54:04.162407 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m06:54:04.165247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '276ae673-2d55-4158-b9e1-88daa3966bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76280181e510>]}
[0m06:54:04.166260 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.staging .................................. [[32mSELECT 414[0m in 0.23s]
[0m06:54:04.167639 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m06:54:04.169871 [debug] [Thread-3 (]: Began running node model.my_project.beer_report
[0m06:54:04.171396 [info ] [Thread-3 (]: 2 of 2 START sql table model dev.beer_report ................................... [RUN]
[0m06:54:04.172539 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.beer_report'
[0m06:54:04.173495 [debug] [Thread-3 (]: Began compiling node model.my_project.beer_report
[0m06:54:04.181612 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.beer_report"
[0m06:54:04.183149 [debug] [Thread-3 (]: Began executing node model.my_project.beer_report
[0m06:54:04.190292 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.beer_report"
[0m06:54:04.191637 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m06:54:04.192322 [debug] [Thread-3 (]: On model.my_project.beer_report: BEGIN
[0m06:54:04.192876 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:54:04.208743 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m06:54:04.209791 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m06:54:04.210485 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */

  
    

  create  table "db"."dev"."beer_report__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    count(*) as total_beers,
    round(avg(abv)::numeric, 2) as avg_abv,
    round(min(abv)::numeric, 2) as min_abv,
    round(max(abv)::numeric, 2) as max_abv,
    round(avg(ibu)::numeric, 2) as avg_ibu,
    round(min(ibu)::numeric, 2) as min_ibu,
    round(max(ibu)::numeric, 2) as max_ibu,
    round(avg(ebc)::numeric, 2) as avg_ebc,
    round(min(ebc)::numeric, 2) as min_ebc,
    round(max(ebc)::numeric, 2) as max_ebc,
    round(avg(ph)::numeric, 2) as avg_ph,
    min(first_brewed) as oldest_brew,
    max(first_brewed) as newest_brew,
    count(distinct contributed_by) as unique_contributors
from beers
  );
  
[0m06:54:04.219178 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m06:54:04.225798 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m06:54:04.226703 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report" rename to "beer_report__dbt_backup"
[0m06:54:04.228226 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:54:04.234232 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m06:54:04.235052 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report__dbt_tmp" rename to "beer_report"
[0m06:54:04.236299 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:54:04.238675 [debug] [Thread-3 (]: On model.my_project.beer_report: COMMIT
[0m06:54:04.239400 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m06:54:04.240108 [debug] [Thread-3 (]: On model.my_project.beer_report: COMMIT
[0m06:54:04.245905 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m06:54:04.250212 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."beer_report__dbt_backup"
[0m06:54:04.251671 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m06:54:04.252279 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
drop table if exists "db"."dev"."beer_report__dbt_backup" cascade
[0m06:54:04.258774 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m06:54:04.261076 [debug] [Thread-3 (]: On model.my_project.beer_report: Close
[0m06:54:04.262102 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '276ae673-2d55-4158-b9e1-88daa3966bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7627fc24a3c0>]}
[0m06:54:04.263100 [info ] [Thread-3 (]: 2 of 2 OK created sql table model dev.beer_report .............................. [[32mSELECT 1[0m in 0.09s]
[0m06:54:04.264327 [debug] [Thread-3 (]: Finished running node model.my_project.beer_report
[0m06:54:04.268703 [debug] [MainThread]: Using postgres connection "master"
[0m06:54:04.269370 [debug] [MainThread]: On master: BEGIN
[0m06:54:04.269837 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:54:04.286044 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m06:54:04.287390 [debug] [MainThread]: On master: COMMIT
[0m06:54:04.288066 [debug] [MainThread]: Using postgres connection "master"
[0m06:54:04.288544 [debug] [MainThread]: On master: COMMIT
[0m06:54:04.289466 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:54:04.289998 [debug] [MainThread]: On master: Close
[0m06:54:04.290835 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:54:04.291328 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m06:54:04.291770 [debug] [MainThread]: Connection 'model.my_project.beer_report' was properly closed.
[0m06:54:04.292484 [info ] [MainThread]: 
[0m06:54:04.293118 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m06:54:04.296608 [debug] [MainThread]: Command end result
[0m06:54:04.342896 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m06:54:04.345809 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m06:54:04.356131 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m06:54:04.357203 [info ] [MainThread]: 
[0m06:54:04.358066 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:54:04.358910 [info ] [MainThread]: 
[0m06:54:04.359892 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:54:04.362361 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7805185, "process_in_blocks": "0", "process_kernel_time": 0.623597, "process_mem_max_rss": "107828", "process_out_blocks": "3384", "process_user_time": 3.461148}
[0m06:54:04.363202 [debug] [MainThread]: Command `dbt run` succeeded at 06:54:04.363028 after 1.78 seconds
[0m06:54:04.363807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762802b08470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762800fdb1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762800ce7890>]}
[0m06:54:04.364375 [debug] [MainThread]: Flushing usage events
[0m06:54:05.803061 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:01:13.136889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e724ca19d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e724b083b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e7265a9f40>]}


============================== 07:01:13.253197 | 8a8e6bdc-e5ee-45b4-baa8-128f9c7bac7d ==============================
[0m07:01:13.253197 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:01:13.254758 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:01:13.751425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a8e6bdc-e5ee-45b4-baa8-128f9c7bac7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e724927f20>]}
[0m07:01:13.861216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a8e6bdc-e5ee-45b4-baa8-128f9c7bac7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e72468b0b0>]}
[0m07:01:13.862384 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:01:14.012229 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:01:14.357983 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:01:14.358727 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:01:14.448339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a8e6bdc-e5ee-45b4-baa8-128f9c7bac7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e722ee1310>]}
[0m07:01:14.665352 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:01:14.669181 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:01:14.710180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a8e6bdc-e5ee-45b4-baa8-128f9c7bac7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e725ac2ea0>]}
[0m07:01:14.710913 [info ] [MainThread]: Found 2 data tests, 2 models, 1 source, 429 macros
[0m07:01:14.711712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a8e6bdc-e5ee-45b4-baa8-128f9c7bac7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e722b84b60>]}
[0m07:01:14.714761 [info ] [MainThread]: 
[0m07:01:14.715877 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:01:14.716461 [info ] [MainThread]: 
[0m07:01:14.717425 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:01:14.724016 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m07:01:14.834090 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m07:01:14.834707 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:01:14.835185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:01:14.860453 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.025 seconds
[0m07:01:14.862749 [debug] [ThreadPool]: On list_db: Close
[0m07:01:14.865406 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m07:01:14.874288 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:01:14.874883 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m07:01:14.875327 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:01:14.889181 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m07:01:14.889782 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:01:14.890252 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:01:14.903222 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.012 seconds
[0m07:01:14.905351 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m07:01:14.906234 [debug] [ThreadPool]: On list_db_dev: Close
[0m07:01:14.914884 [debug] [MainThread]: Using postgres connection "master"
[0m07:01:14.915561 [debug] [MainThread]: On master: BEGIN
[0m07:01:14.916119 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:01:14.929862 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m07:01:14.930929 [debug] [MainThread]: Using postgres connection "master"
[0m07:01:14.931709 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:01:14.939143 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m07:01:14.941496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a8e6bdc-e5ee-45b4-baa8-128f9c7bac7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e722dea810>]}
[0m07:01:14.942201 [debug] [MainThread]: On master: ROLLBACK
[0m07:01:14.943043 [debug] [MainThread]: Using postgres connection "master"
[0m07:01:14.943574 [debug] [MainThread]: On master: BEGIN
[0m07:01:14.944759 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:01:14.945268 [debug] [MainThread]: On master: COMMIT
[0m07:01:14.945793 [debug] [MainThread]: Using postgres connection "master"
[0m07:01:14.946254 [debug] [MainThread]: On master: COMMIT
[0m07:01:14.947036 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:01:14.947656 [debug] [MainThread]: On master: Close
[0m07:01:14.952883 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m07:01:14.953789 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.staging ....................................... [RUN]
[0m07:01:14.954583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m07:01:14.955137 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m07:01:14.965793 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m07:01:14.966845 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m07:01:15.023122 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m07:01:15.024138 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:01:15.024652 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m07:01:15.025123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:01:15.037581 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m07:01:15.038336 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:01:15.039293 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * 
    from "db"."dev"."raw_beer_data"
)

select 
    id,
    beer_id,
    name as beer_name,
    tagline,
    first_brewed,
    description,
    image,
    abv,
    ibu,
    ebc,
    ph,
    brewers_tips,
    contributed_by,
    inserted_at
from source
  );
  
[0m07:01:15.098570 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.058 seconds
[0m07:01:15.118682 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:01:15.119968 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m07:01:15.122326 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:01:15.131158 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:01:15.132470 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m07:01:15.134333 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:01:15.164990 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:01:15.166028 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:01:15.166594 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:01:15.231758 [debug] [Thread-1 (]: SQL status: COMMIT in 0.065 seconds
[0m07:01:15.243095 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m07:01:15.252086 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:01:15.252746 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m07:01:15.387633 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.134 seconds
[0m07:01:15.393589 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m07:01:15.396604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a8e6bdc-e5ee-45b4-baa8-128f9c7bac7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e72525a4b0>]}
[0m07:01:15.397888 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.staging .................................. [[32mSELECT 414[0m in 0.44s]
[0m07:01:15.400559 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m07:01:15.402979 [debug] [Thread-3 (]: Began running node model.my_project.beer_report
[0m07:01:15.404550 [info ] [Thread-3 (]: 2 of 2 START sql table model dev.beer_report ................................... [RUN]
[0m07:01:15.406042 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.beer_report'
[0m07:01:15.407235 [debug] [Thread-3 (]: Began compiling node model.my_project.beer_report
[0m07:01:15.412976 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.beer_report"
[0m07:01:15.413920 [debug] [Thread-3 (]: Began executing node model.my_project.beer_report
[0m07:01:15.419859 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.beer_report"
[0m07:01:15.421379 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:01:15.422376 [debug] [Thread-3 (]: On model.my_project.beer_report: BEGIN
[0m07:01:15.423283 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:01:15.439094 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m07:01:15.440052 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:01:15.440707 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */

  
    

  create  table "db"."dev"."beer_report__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    count(*) as total_beers,
    round(avg(abv)::numeric, 2) as avg_abv,
    round(min(abv)::numeric, 2) as min_abv,
    round(max(abv)::numeric, 2) as max_abv,
    round(avg(ibu)::numeric, 2) as avg_ibu,
    round(min(ibu)::numeric, 2) as min_ibu,
    round(max(ibu)::numeric, 2) as max_ibu,
    round(avg(ebc)::numeric, 2) as avg_ebc,
    round(min(ebc)::numeric, 2) as min_ebc,
    round(max(ebc)::numeric, 2) as max_ebc,
    round(avg(ph)::numeric, 2) as avg_ph,
    min(first_brewed) as oldest_brew,
    max(first_brewed) as newest_brew,
    count(distinct contributed_by) as unique_contributors
from beers
  );
  
[0m07:01:15.556104 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.114 seconds
[0m07:01:15.560016 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:01:15.560525 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report" rename to "beer_report__dbt_backup"
[0m07:01:15.561580 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:01:15.565341 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:01:15.565855 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report__dbt_tmp" rename to "beer_report"
[0m07:01:15.566857 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:01:15.568971 [debug] [Thread-3 (]: On model.my_project.beer_report: COMMIT
[0m07:01:15.569546 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:01:15.570219 [debug] [Thread-3 (]: On model.my_project.beer_report: COMMIT
[0m07:01:15.681966 [debug] [Thread-3 (]: SQL status: COMMIT in 0.111 seconds
[0m07:01:15.684921 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."beer_report__dbt_backup"
[0m07:01:15.685978 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:01:15.686474 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
drop table if exists "db"."dev"."beer_report__dbt_backup" cascade
[0m07:01:15.817982 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.131 seconds
[0m07:01:15.820577 [debug] [Thread-3 (]: On model.my_project.beer_report: Close
[0m07:01:15.822117 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a8e6bdc-e5ee-45b4-baa8-128f9c7bac7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e722e350d0>]}
[0m07:01:15.823496 [info ] [Thread-3 (]: 2 of 2 OK created sql table model dev.beer_report .............................. [[32mSELECT 1[0m in 0.42s]
[0m07:01:15.824660 [debug] [Thread-3 (]: Finished running node model.my_project.beer_report
[0m07:01:15.827765 [debug] [MainThread]: Using postgres connection "master"
[0m07:01:15.828408 [debug] [MainThread]: On master: BEGIN
[0m07:01:15.828985 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:01:15.844741 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m07:01:15.845612 [debug] [MainThread]: On master: COMMIT
[0m07:01:15.846172 [debug] [MainThread]: Using postgres connection "master"
[0m07:01:15.846721 [debug] [MainThread]: On master: COMMIT
[0m07:01:15.847616 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:01:15.848143 [debug] [MainThread]: On master: Close
[0m07:01:15.848898 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:01:15.849407 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m07:01:15.850247 [debug] [MainThread]: Connection 'model.my_project.beer_report' was properly closed.
[0m07:01:15.851108 [info ] [MainThread]: 
[0m07:01:15.851948 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 1.13 seconds (1.13s).
[0m07:01:15.853673 [debug] [MainThread]: Command end result
[0m07:01:15.890578 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:01:15.893230 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:01:15.906805 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:01:15.907800 [info ] [MainThread]: 
[0m07:01:15.909390 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:01:15.910162 [info ] [MainThread]: 
[0m07:01:15.911220 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:01:15.914020 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.8585658, "process_in_blocks": "888", "process_kernel_time": 0.747479, "process_mem_max_rss": "108172", "process_out_blocks": "3384", "process_user_time": 3.960829}
[0m07:01:15.915583 [debug] [MainThread]: Command `dbt run` succeeded at 07:01:15.915195 after 2.86 seconds
[0m07:01:15.916338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e725456c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e722c1aab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e722c1bef0>]}
[0m07:01:15.916991 [debug] [MainThread]: Flushing usage events
[0m07:01:17.372487 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:01:26.415736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7503b38fa180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7503b22e2600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7503b1f73b30>]}


============================== 07:01:26.423567 | 7b01c2d0-bd06-4919-b8f9-3fae484fe76f ==============================
[0m07:01:26.423567 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:01:26.425313 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m07:01:26.767870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b01c2d0-bd06-4919-b8f9-3fae484fe76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7503b185f2f0>]}
[0m07:01:26.907615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b01c2d0-bd06-4919-b8f9-3fae484fe76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7503b2c8a0f0>]}
[0m07:01:26.909177 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:01:27.094798 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:01:27.305625 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:01:27.306137 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:01:27.409960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b01c2d0-bd06-4919-b8f9-3fae484fe76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7503affd3440>]}
[0m07:01:27.552683 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:01:27.556286 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:01:27.579633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b01c2d0-bd06-4919-b8f9-3fae484fe76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7503afcd70b0>]}
[0m07:01:27.580487 [info ] [MainThread]: Found 2 data tests, 2 models, 1 source, 429 macros
[0m07:01:27.581095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b01c2d0-bd06-4919-b8f9-3fae484fe76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7503afdd69c0>]}
[0m07:01:27.584375 [info ] [MainThread]: 
[0m07:01:27.585054 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:01:27.585836 [info ] [MainThread]: 
[0m07:01:27.587018 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:01:27.595924 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m07:01:27.721742 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m07:01:27.722265 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:01:27.722702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:01:27.740333 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.018 seconds
[0m07:01:27.742392 [debug] [ThreadPool]: On list_db: Close
[0m07:01:27.744864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m07:01:27.753609 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:01:27.754237 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m07:01:27.754662 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:01:27.767595 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m07:01:27.768379 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:01:27.769071 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:01:27.773763 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m07:01:27.775958 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m07:01:27.777118 [debug] [ThreadPool]: On list_db_dev: Close
[0m07:01:27.785643 [debug] [MainThread]: Using postgres connection "master"
[0m07:01:27.786367 [debug] [MainThread]: On master: BEGIN
[0m07:01:27.787198 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:01:27.801658 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m07:01:27.802478 [debug] [MainThread]: Using postgres connection "master"
[0m07:01:27.803377 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:01:27.808630 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m07:01:27.810897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b01c2d0-bd06-4919-b8f9-3fae484fe76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7503afd8e5a0>]}
[0m07:01:27.812512 [debug] [MainThread]: On master: ROLLBACK
[0m07:01:27.813609 [debug] [MainThread]: Using postgres connection "master"
[0m07:01:27.814196 [debug] [MainThread]: On master: BEGIN
[0m07:01:27.815500 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:01:27.816497 [debug] [MainThread]: On master: COMMIT
[0m07:01:27.817361 [debug] [MainThread]: Using postgres connection "master"
[0m07:01:27.817987 [debug] [MainThread]: On master: COMMIT
[0m07:01:27.819078 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:01:27.819971 [debug] [MainThread]: On master: Close
[0m07:01:27.825725 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m07:01:27.826712 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.staging ....................................... [RUN]
[0m07:01:27.827632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m07:01:27.828729 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m07:01:27.842321 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m07:01:27.843247 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m07:01:27.902697 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m07:01:27.903823 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:01:27.904430 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m07:01:27.905001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:01:27.918646 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m07:01:27.919941 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:01:27.920552 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * 
    from "db"."dev"."raw_beer_data"
)

select 
    id,
    beer_id,
    name as beer_name,
    tagline,
    first_brewed,
    description,
    image,
    abv,
    ibu,
    ebc,
    ph,
    brewers_tips,
    contributed_by,
    inserted_at
from source
  );
  
[0m07:01:27.926893 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.006 seconds
[0m07:01:27.937858 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:01:27.938534 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m07:01:27.940147 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:01:27.944786 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:01:27.945386 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m07:01:27.946518 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:01:27.981565 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:01:27.982672 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:01:27.983561 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:01:27.990499 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m07:01:28.000014 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m07:01:28.008907 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:01:28.009522 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m07:01:28.015924 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m07:01:28.019533 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m07:01:28.021989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b01c2d0-bd06-4919-b8f9-3fae484fe76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7503af04f050>]}
[0m07:01:28.022942 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.staging .................................. [[32mSELECT 414[0m in 0.19s]
[0m07:01:28.024207 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m07:01:28.025954 [debug] [Thread-3 (]: Began running node model.my_project.beer_report
[0m07:01:28.027374 [info ] [Thread-3 (]: 2 of 2 START sql table model dev.beer_report ................................... [RUN]
[0m07:01:28.028598 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.beer_report'
[0m07:01:28.029457 [debug] [Thread-3 (]: Began compiling node model.my_project.beer_report
[0m07:01:28.034584 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.beer_report"
[0m07:01:28.036065 [debug] [Thread-3 (]: Began executing node model.my_project.beer_report
[0m07:01:28.045779 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.beer_report"
[0m07:01:28.047799 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:01:28.048955 [debug] [Thread-3 (]: On model.my_project.beer_report: BEGIN
[0m07:01:28.049926 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:01:28.064661 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m07:01:28.066558 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:01:28.067418 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */

  
    

  create  table "db"."dev"."beer_report__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    count(*) as total_beers,
    round(avg(abv)::numeric, 2) as avg_abv,
    round(min(abv)::numeric, 2) as min_abv,
    round(max(abv)::numeric, 2) as max_abv,
    round(avg(ibu)::numeric, 2) as avg_ibu,
    round(min(ibu)::numeric, 2) as min_ibu,
    round(max(ibu)::numeric, 2) as max_ibu,
    round(avg(ebc)::numeric, 2) as avg_ebc,
    round(min(ebc)::numeric, 2) as min_ebc,
    round(max(ebc)::numeric, 2) as max_ebc,
    round(avg(ph)::numeric, 2) as avg_ph,
    min(first_brewed) as oldest_brew,
    max(first_brewed) as newest_brew,
    count(distinct contributed_by) as unique_contributors
from beers
  );
  
[0m07:01:28.073202 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m07:01:28.077837 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:01:28.078410 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report" rename to "beer_report__dbt_backup"
[0m07:01:28.079538 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:01:28.084302 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:01:28.085094 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report__dbt_tmp" rename to "beer_report"
[0m07:01:28.086447 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:01:28.089294 [debug] [Thread-3 (]: On model.my_project.beer_report: COMMIT
[0m07:01:28.089883 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:01:28.090377 [debug] [Thread-3 (]: On model.my_project.beer_report: COMMIT
[0m07:01:28.095615 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m07:01:28.098826 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."beer_report__dbt_backup"
[0m07:01:28.099778 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:01:28.100351 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
drop table if exists "db"."dev"."beer_report__dbt_backup" cascade
[0m07:01:28.108044 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.007 seconds
[0m07:01:28.110242 [debug] [Thread-3 (]: On model.my_project.beer_report: Close
[0m07:01:28.111150 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b01c2d0-bd06-4919-b8f9-3fae484fe76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7503aee912e0>]}
[0m07:01:28.112128 [info ] [Thread-3 (]: 2 of 2 OK created sql table model dev.beer_report .............................. [[32mSELECT 1[0m in 0.08s]
[0m07:01:28.113475 [debug] [Thread-3 (]: Finished running node model.my_project.beer_report
[0m07:01:28.117236 [debug] [MainThread]: Using postgres connection "master"
[0m07:01:28.117882 [debug] [MainThread]: On master: BEGIN
[0m07:01:28.118752 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:01:28.132602 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m07:01:28.133450 [debug] [MainThread]: On master: COMMIT
[0m07:01:28.134163 [debug] [MainThread]: Using postgres connection "master"
[0m07:01:28.134775 [debug] [MainThread]: On master: COMMIT
[0m07:01:28.135579 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:01:28.136238 [debug] [MainThread]: On master: Close
[0m07:01:28.137604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:01:28.138540 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m07:01:28.139203 [debug] [MainThread]: Connection 'model.my_project.beer_report' was properly closed.
[0m07:01:28.140402 [info ] [MainThread]: 
[0m07:01:28.141452 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m07:01:28.144226 [debug] [MainThread]: Command end result
[0m07:01:28.180906 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:01:28.183546 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:01:28.193788 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:01:28.194453 [info ] [MainThread]: 
[0m07:01:28.195269 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:01:28.196103 [info ] [MainThread]: 
[0m07:01:28.197016 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:01:28.199557 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9403633, "process_in_blocks": "0", "process_kernel_time": 0.667847, "process_mem_max_rss": "107532", "process_out_blocks": "1776", "process_user_time": 3.732086}
[0m07:01:28.200849 [debug] [MainThread]: Command `dbt run` succeeded at 07:01:28.200552 after 1.94 seconds
[0m07:01:28.201490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7503b1d53c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7503afd8e8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7503b226d7f0>]}
[0m07:01:28.202135 [debug] [MainThread]: Flushing usage events
[0m07:01:29.648354 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:02:58.672909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74112780be30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741127db4bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7411281e8dd0>]}


============================== 07:02:58.681902 | 83529b00-e76b-43cd-8d85-41c19cae3378 ==============================
[0m07:02:58.681902 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:02:58.682920 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:02:58.998730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83529b00-e76b-43cd-8d85-41c19cae3378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74112764e5a0>]}
[0m07:02:59.100101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83529b00-e76b-43cd-8d85-41c19cae3378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741128997e90>]}
[0m07:02:59.101371 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:02:59.250403 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:02:59.471294 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:02:59.471991 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:02:59.542030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83529b00-e76b-43cd-8d85-41c19cae3378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741125db8230>]}
[0m07:02:59.677499 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:02:59.681271 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:02:59.716159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83529b00-e76b-43cd-8d85-41c19cae3378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741125ace2a0>]}
[0m07:02:59.716955 [info ] [MainThread]: Found 2 data tests, 2 models, 1 source, 429 macros
[0m07:02:59.717710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83529b00-e76b-43cd-8d85-41c19cae3378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741125a969f0>]}
[0m07:02:59.721248 [info ] [MainThread]: 
[0m07:02:59.722017 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:02:59.722698 [info ] [MainThread]: 
[0m07:02:59.724043 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:02:59.736180 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m07:02:59.817340 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m07:02:59.817928 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:02:59.818374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:02:59.927026 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.109 seconds
[0m07:02:59.929110 [debug] [ThreadPool]: On list_db: Close
[0m07:02:59.931621 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m07:02:59.940119 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:02:59.940914 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m07:02:59.941574 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:02:59.955264 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m07:02:59.956249 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:02:59.957113 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:02:59.962908 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m07:02:59.965339 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m07:02:59.966359 [debug] [ThreadPool]: On list_db_dev: Close
[0m07:02:59.976052 [debug] [MainThread]: Using postgres connection "master"
[0m07:02:59.976654 [debug] [MainThread]: On master: BEGIN
[0m07:02:59.977234 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:02:59.990952 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m07:02:59.991762 [debug] [MainThread]: Using postgres connection "master"
[0m07:02:59.992644 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:02:59.998827 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m07:03:00.001331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83529b00-e76b-43cd-8d85-41c19cae3378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741125a8e510>]}
[0m07:03:00.002178 [debug] [MainThread]: On master: ROLLBACK
[0m07:03:00.003240 [debug] [MainThread]: Using postgres connection "master"
[0m07:03:00.004192 [debug] [MainThread]: On master: BEGIN
[0m07:03:00.006516 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:03:00.008059 [debug] [MainThread]: On master: COMMIT
[0m07:03:00.009161 [debug] [MainThread]: Using postgres connection "master"
[0m07:03:00.009692 [debug] [MainThread]: On master: COMMIT
[0m07:03:00.010610 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:03:00.011186 [debug] [MainThread]: On master: Close
[0m07:03:00.016636 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m07:03:00.017588 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.staging ....................................... [RUN]
[0m07:03:00.018448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m07:03:00.019172 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m07:03:00.033211 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m07:03:00.034174 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m07:03:00.095121 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m07:03:00.096255 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:03:00.096806 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m07:03:00.097274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:03:00.110632 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m07:03:00.111655 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:03:00.112527 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * 
    from "db"."dev"."raw_beer_data"
)

select 
    id,
    beer_id,
    name as beer_name,
    tagline,
    first_brewed,
    description,
    image,
    abv,
    ibu,
    ebc,
    ph,
    brewers_tips,
    contributed_by,
    inserted_at
from source
  );
  
[0m07:03:00.119584 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.006 seconds
[0m07:03:00.136312 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:03:00.137305 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m07:03:00.138776 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:03:00.143027 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:03:00.143736 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m07:03:00.144899 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:03:00.177573 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:03:00.178233 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:03:00.178781 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:03:00.184324 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m07:03:00.195884 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m07:03:00.205288 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:03:00.205934 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m07:03:00.213422 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m07:03:00.217085 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m07:03:00.219787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83529b00-e76b-43cd-8d85-41c19cae3378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74112813e630>]}
[0m07:03:00.220818 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.staging .................................. [[32mSELECT 414[0m in 0.20s]
[0m07:03:00.221995 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m07:03:00.224133 [debug] [Thread-3 (]: Began running node model.my_project.beer_report
[0m07:03:00.224944 [info ] [Thread-3 (]: 2 of 2 START sql table model dev.beer_report ................................... [RUN]
[0m07:03:00.225894 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.beer_report'
[0m07:03:00.226557 [debug] [Thread-3 (]: Began compiling node model.my_project.beer_report
[0m07:03:00.232161 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.beer_report"
[0m07:03:00.233470 [debug] [Thread-3 (]: Began executing node model.my_project.beer_report
[0m07:03:00.241569 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.beer_report"
[0m07:03:00.242830 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:03:00.243542 [debug] [Thread-3 (]: On model.my_project.beer_report: BEGIN
[0m07:03:00.244058 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:03:00.259345 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m07:03:00.260755 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:03:00.261669 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */

  
    

  create  table "db"."dev"."beer_report__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    count(*) as total_beers,
    round(avg(abv)::numeric, 2) as avg_abv,
    round(min(abv)::numeric, 2) as min_abv,
    round(max(abv)::numeric, 2) as max_abv,
    round(avg(ibu)::numeric, 2) as avg_ibu,
    round(min(ibu)::numeric, 2) as min_ibu,
    round(max(ibu)::numeric, 2) as max_ibu,
    round(avg(ebc)::numeric, 2) as avg_ebc,
    round(min(ebc)::numeric, 2) as min_ebc,
    round(max(ebc)::numeric, 2) as max_ebc,
    round(avg(ph)::numeric, 2) as avg_ph,
    min(first_brewed) as oldest_brew,
    max(first_brewed) as newest_brew,
    count(distinct contributed_by) as unique_contributors
from beers
  );
  
[0m07:03:00.268025 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m07:03:00.272435 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:03:00.273041 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report" rename to "beer_report__dbt_backup"
[0m07:03:00.274243 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:03:00.278963 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:03:00.279882 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report__dbt_tmp" rename to "beer_report"
[0m07:03:00.281426 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:03:00.284014 [debug] [Thread-3 (]: On model.my_project.beer_report: COMMIT
[0m07:03:00.284676 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:03:00.285367 [debug] [Thread-3 (]: On model.my_project.beer_report: COMMIT
[0m07:03:00.290669 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m07:03:00.294265 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."beer_report__dbt_backup"
[0m07:03:00.296298 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:03:00.297106 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
drop table if exists "db"."dev"."beer_report__dbt_backup" cascade
[0m07:03:00.304126 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m07:03:00.306227 [debug] [Thread-3 (]: On model.my_project.beer_report: Close
[0m07:03:00.307182 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83529b00-e76b-43cd-8d85-41c19cae3378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741124c7f500>]}
[0m07:03:00.308201 [info ] [Thread-3 (]: 2 of 2 OK created sql table model dev.beer_report .............................. [[32mSELECT 1[0m in 0.08s]
[0m07:03:00.309449 [debug] [Thread-3 (]: Finished running node model.my_project.beer_report
[0m07:03:00.313398 [debug] [MainThread]: Using postgres connection "master"
[0m07:03:00.314006 [debug] [MainThread]: On master: BEGIN
[0m07:03:00.314517 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:03:00.328947 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m07:03:00.329716 [debug] [MainThread]: On master: COMMIT
[0m07:03:00.330674 [debug] [MainThread]: Using postgres connection "master"
[0m07:03:00.331812 [debug] [MainThread]: On master: COMMIT
[0m07:03:00.333243 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:03:00.334086 [debug] [MainThread]: On master: Close
[0m07:03:00.335196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:03:00.335801 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m07:03:00.336262 [debug] [MainThread]: Connection 'model.my_project.beer_report' was properly closed.
[0m07:03:00.336891 [info ] [MainThread]: 
[0m07:03:00.337770 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m07:03:00.340755 [debug] [MainThread]: Command end result
[0m07:03:00.382484 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:03:00.385364 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:03:00.395345 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:03:00.395989 [info ] [MainThread]: 
[0m07:03:00.396766 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:03:00.397555 [info ] [MainThread]: 
[0m07:03:00.398621 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:03:00.400879 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7987882, "process_in_blocks": "0", "process_kernel_time": 0.536542, "process_mem_max_rss": "108020", "process_out_blocks": "3384", "process_user_time": 3.16709}
[0m07:03:00.402569 [debug] [MainThread]: Command `dbt run` succeeded at 07:03:00.402143 after 1.80 seconds
[0m07:03:00.403490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74112828f320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7411275b63f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741127885fa0>]}
[0m07:03:00.404301 [debug] [MainThread]: Flushing usage events
[0m07:03:01.847036 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:07:48.530211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723cb553da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723cb564f560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723cb6f64380>]}


============================== 07:07:48.625020 | 7b541348-8cfe-49a1-99cf-cfc1c5edc563 ==============================
[0m07:07:48.625020 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:07:48.625992 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:07:49.394668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b541348-8cfe-49a1-99cf-cfc1c5edc563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723cb6edf530>]}
[0m07:07:49.498531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b541348-8cfe-49a1-99cf-cfc1c5edc563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723cb5981580>]}
[0m07:07:49.500081 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:07:49.633238 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:07:50.226109 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:07:50.226797 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:07:50.304203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b541348-8cfe-49a1-99cf-cfc1c5edc563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723cb373f620>]}
[0m07:07:50.603266 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:07:50.606602 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:07:51.060566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b541348-8cfe-49a1-99cf-cfc1c5edc563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723cb373f620>]}
[0m07:07:51.061198 [info ] [MainThread]: Found 2 data tests, 2 models, 1 source, 429 macros
[0m07:07:51.061727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b541348-8cfe-49a1-99cf-cfc1c5edc563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723cb4fd7aa0>]}
[0m07:07:51.064327 [info ] [MainThread]: 
[0m07:07:51.064875 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:07:51.065578 [info ] [MainThread]: 
[0m07:07:51.066424 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:07:51.072897 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m07:07:51.352492 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m07:07:51.353101 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:07:51.353656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:07:51.378582 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.025 seconds
[0m07:07:51.380535 [debug] [ThreadPool]: On list_db: Close
[0m07:07:51.383174 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m07:07:51.393126 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:07:51.394395 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m07:07:51.394997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:07:51.427566 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m07:07:51.428302 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:07:51.428983 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:07:51.434380 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m07:07:51.436985 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m07:07:51.438382 [debug] [ThreadPool]: On list_db_dev: Close
[0m07:07:51.447514 [debug] [MainThread]: Using postgres connection "master"
[0m07:07:51.448079 [debug] [MainThread]: On master: BEGIN
[0m07:07:51.448507 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:07:51.474357 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m07:07:51.474961 [debug] [MainThread]: Using postgres connection "master"
[0m07:07:51.475516 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:07:51.480773 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m07:07:51.484421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b541348-8cfe-49a1-99cf-cfc1c5edc563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723cb35847d0>]}
[0m07:07:51.486243 [debug] [MainThread]: On master: ROLLBACK
[0m07:07:51.487376 [debug] [MainThread]: Using postgres connection "master"
[0m07:07:51.487826 [debug] [MainThread]: On master: BEGIN
[0m07:07:51.488770 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:07:51.489424 [debug] [MainThread]: On master: COMMIT
[0m07:07:51.490149 [debug] [MainThread]: Using postgres connection "master"
[0m07:07:51.490671 [debug] [MainThread]: On master: COMMIT
[0m07:07:51.491456 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:07:51.491941 [debug] [MainThread]: On master: Close
[0m07:07:51.496534 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m07:07:51.497969 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.staging ....................................... [RUN]
[0m07:07:51.499860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m07:07:51.500822 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m07:07:51.510641 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m07:07:51.511419 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m07:07:51.633902 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m07:07:51.636373 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:07:51.638251 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m07:07:51.639298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:07:51.654637 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m07:07:51.655765 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:07:51.656598 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * 
    from "db"."dev"."raw_beer_data"
)

select 
    id,
    beer_id,
    name as beer_name,
    tagline,
    first_brewed,
    description,
    image,
    abv,
    ibu,
    ebc,
    ph,
    brewers_tips,
    contributed_by,
    inserted_at
from source
  );
  
[0m07:07:51.667643 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.010 seconds
[0m07:07:51.676439 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:07:51.676985 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m07:07:51.678042 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:07:51.683308 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:07:51.684548 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m07:07:51.685894 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:07:51.716991 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:07:51.717670 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:07:51.718156 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:07:51.767804 [debug] [Thread-1 (]: SQL status: COMMIT in 0.049 seconds
[0m07:07:51.778176 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m07:07:51.785931 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:07:51.786642 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m07:07:51.793022 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m07:07:51.796209 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m07:07:51.798431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b541348-8cfe-49a1-99cf-cfc1c5edc563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723cb2505610>]}
[0m07:07:51.799300 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.staging .................................. [[32mSELECT 414[0m in 0.30s]
[0m07:07:51.800618 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m07:07:51.802448 [debug] [Thread-3 (]: Began running node model.my_project.beer_report
[0m07:07:51.803884 [info ] [Thread-3 (]: 2 of 2 START sql table model dev.beer_report ................................... [RUN]
[0m07:07:51.805278 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.beer_report'
[0m07:07:51.805905 [debug] [Thread-3 (]: Began compiling node model.my_project.beer_report
[0m07:07:51.809782 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.beer_report"
[0m07:07:51.810569 [debug] [Thread-3 (]: Began executing node model.my_project.beer_report
[0m07:07:51.814539 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.beer_report"
[0m07:07:51.815441 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:07:51.815972 [debug] [Thread-3 (]: On model.my_project.beer_report: BEGIN
[0m07:07:51.816432 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:07:51.837819 [debug] [Thread-3 (]: SQL status: BEGIN in 0.021 seconds
[0m07:07:51.838983 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:07:51.839685 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */

  
    

  create  table "db"."dev"."beer_report__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    count(*) as total_beers,
    round(avg(abv)::numeric, 2) as avg_abv,
    round(min(abv)::numeric, 2) as min_abv,
    round(max(abv)::numeric, 2) as max_abv,
    round(avg(ibu)::numeric, 2) as avg_ibu,
    round(min(ibu)::numeric, 2) as min_ibu,
    round(max(ibu)::numeric, 2) as max_ibu,
    round(avg(ebc)::numeric, 2) as avg_ebc,
    round(min(ebc)::numeric, 2) as min_ebc,
    round(max(ebc)::numeric, 2) as max_ebc,
    round(avg(ph)::numeric, 2) as avg_ph,
    min(first_brewed) as oldest_brew,
    max(first_brewed) as newest_brew,
    count(distinct contributed_by) as unique_contributors
from beers
  );
  
[0m07:07:51.862157 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.022 seconds
[0m07:07:51.867200 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:07:51.867754 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report" rename to "beer_report__dbt_backup"
[0m07:07:51.868747 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:07:51.873232 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:07:51.873812 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report__dbt_tmp" rename to "beer_report"
[0m07:07:51.874710 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:07:51.876691 [debug] [Thread-3 (]: On model.my_project.beer_report: COMMIT
[0m07:07:51.877189 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:07:51.877833 [debug] [Thread-3 (]: On model.my_project.beer_report: COMMIT
[0m07:07:51.882410 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m07:07:51.885335 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."beer_report__dbt_backup"
[0m07:07:51.886356 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:07:51.886825 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
drop table if exists "db"."dev"."beer_report__dbt_backup" cascade
[0m07:07:51.892302 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.005 seconds
[0m07:07:51.894487 [debug] [Thread-3 (]: On model.my_project.beer_report: Close
[0m07:07:51.896667 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b541348-8cfe-49a1-99cf-cfc1c5edc563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723cb2634d10>]}
[0m07:07:51.898046 [info ] [Thread-3 (]: 2 of 2 OK created sql table model dev.beer_report .............................. [[32mSELECT 1[0m in 0.09s]
[0m07:07:51.899758 [debug] [Thread-3 (]: Finished running node model.my_project.beer_report
[0m07:07:51.902844 [debug] [MainThread]: Using postgres connection "master"
[0m07:07:51.903360 [debug] [MainThread]: On master: BEGIN
[0m07:07:51.903763 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:07:51.916621 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m07:07:51.917338 [debug] [MainThread]: On master: COMMIT
[0m07:07:51.918127 [debug] [MainThread]: Using postgres connection "master"
[0m07:07:51.918729 [debug] [MainThread]: On master: COMMIT
[0m07:07:51.919389 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:07:51.919906 [debug] [MainThread]: On master: Close
[0m07:07:51.920574 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:07:51.921015 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m07:07:51.921436 [debug] [MainThread]: Connection 'model.my_project.beer_report' was properly closed.
[0m07:07:51.922197 [info ] [MainThread]: 
[0m07:07:51.922752 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m07:07:51.924962 [debug] [MainThread]: Command end result
[0m07:07:51.965972 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:07:51.968272 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:07:51.979184 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:07:51.979739 [info ] [MainThread]: 
[0m07:07:51.980476 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:07:51.981216 [info ] [MainThread]: 
[0m07:07:51.982102 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:07:51.983790 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.5342705, "process_in_blocks": "904", "process_kernel_time": 1.549575, "process_mem_max_rss": "108140", "process_out_blocks": "3384", "process_user_time": 5.223765}
[0m07:07:51.984489 [debug] [MainThread]: Command `dbt run` succeeded at 07:07:51.984333 after 3.54 seconds
[0m07:07:51.985080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723cb6439280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723cb6ede600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723cb872e900>]}
[0m07:07:51.985615 [debug] [MainThread]: Flushing usage events
[0m07:07:53.239475 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:09:35.876299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aa098682c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aa0970bc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aa0986bbf0>]}


============================== 07:09:35.884844 | cce24388-056e-4c88-a4de-41e9ebfb00fa ==============================
[0m07:09:35.884844 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:09:35.885746 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m07:09:36.170940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cce24388-056e-4c88-a4de-41e9ebfb00fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aa0ad1f530>]}
[0m07:09:36.257178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cce24388-056e-4c88-a4de-41e9ebfb00fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aa08e6ca70>]}
[0m07:09:36.258288 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:09:36.389465 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:09:36.558789 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:09:36.559286 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:09:36.620470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cce24388-056e-4c88-a4de-41e9ebfb00fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aa075a4500>]}
[0m07:09:36.744789 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:09:36.747897 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:09:36.779528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cce24388-056e-4c88-a4de-41e9ebfb00fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aa075a6270>]}
[0m07:09:36.780169 [info ] [MainThread]: Found 2 data tests, 2 models, 1 source, 429 macros
[0m07:09:36.780708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cce24388-056e-4c88-a4de-41e9ebfb00fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aa0724a390>]}
[0m07:09:36.783112 [info ] [MainThread]: 
[0m07:09:36.783653 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:09:36.784293 [info ] [MainThread]: 
[0m07:09:36.785242 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:09:36.790918 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m07:09:36.864982 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m07:09:36.865461 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:09:36.865844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:09:36.879511 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m07:09:36.881282 [debug] [ThreadPool]: On list_db: Close
[0m07:09:36.883390 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m07:09:36.891293 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:09:36.892056 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m07:09:36.892570 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:09:36.909099 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m07:09:36.910204 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:09:36.911638 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:09:36.921856 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.009 seconds
[0m07:09:36.926725 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m07:09:36.929371 [debug] [ThreadPool]: On list_db_dev: Close
[0m07:09:36.946976 [debug] [MainThread]: Using postgres connection "master"
[0m07:09:36.948424 [debug] [MainThread]: On master: BEGIN
[0m07:09:36.949498 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:09:36.967920 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m07:09:36.968696 [debug] [MainThread]: Using postgres connection "master"
[0m07:09:36.969545 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:09:36.978017 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m07:09:36.980471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cce24388-056e-4c88-a4de-41e9ebfb00fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aa0abd4500>]}
[0m07:09:36.981144 [debug] [MainThread]: On master: ROLLBACK
[0m07:09:36.981942 [debug] [MainThread]: Using postgres connection "master"
[0m07:09:36.982421 [debug] [MainThread]: On master: BEGIN
[0m07:09:36.983516 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:09:36.984176 [debug] [MainThread]: On master: COMMIT
[0m07:09:36.984719 [debug] [MainThread]: Using postgres connection "master"
[0m07:09:36.985231 [debug] [MainThread]: On master: COMMIT
[0m07:09:36.985992 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:09:36.986473 [debug] [MainThread]: On master: Close
[0m07:09:36.991390 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m07:09:36.992558 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.staging ....................................... [RUN]
[0m07:09:36.993542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m07:09:36.994548 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m07:09:37.005144 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m07:09:37.006006 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m07:09:37.066121 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m07:09:37.067022 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:09:37.067584 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m07:09:37.068011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:09:37.082963 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m07:09:37.083649 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:09:37.084365 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * 
    from "db"."dev"."raw_beer_data"
)

select 
    id,
    beer_id,
    name as beer_name,
    tagline,
    first_brewed,
    description,
    image,
    abv,
    ibu,
    ebc,
    ph,
    brewers_tips,
    contributed_by,
    inserted_at
from source
  );
  
[0m07:09:37.100447 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.016 seconds
[0m07:09:37.108774 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:09:37.109777 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m07:09:37.111527 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:09:37.115520 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:09:37.116026 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m07:09:37.117203 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:09:37.145910 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:09:37.146499 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:09:37.146974 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:09:37.157820 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m07:09:37.167561 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m07:09:37.175654 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:09:37.176237 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m07:09:37.186488 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m07:09:37.190309 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m07:09:37.193560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce24388-056e-4c88-a4de-41e9ebfb00fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aa0ad1e690>]}
[0m07:09:37.194658 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.staging .................................. [[32mSELECT 414[0m in 0.20s]
[0m07:09:37.195906 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m07:09:37.197478 [debug] [Thread-3 (]: Began running node model.my_project.beer_report
[0m07:09:37.198874 [info ] [Thread-3 (]: 2 of 2 START sql table model dev.beer_report ................................... [RUN]
[0m07:09:37.199831 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.beer_report'
[0m07:09:37.201056 [debug] [Thread-3 (]: Began compiling node model.my_project.beer_report
[0m07:09:37.205677 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.beer_report"
[0m07:09:37.206564 [debug] [Thread-3 (]: Began executing node model.my_project.beer_report
[0m07:09:37.211465 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.beer_report"
[0m07:09:37.212524 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:09:37.213012 [debug] [Thread-3 (]: On model.my_project.beer_report: BEGIN
[0m07:09:37.213453 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:09:37.225639 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m07:09:37.226526 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:09:37.227239 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */

  
    

  create  table "db"."dev"."beer_report__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    count(*) as total_beers,
    round(avg(abv)::numeric, 2) as avg_abv,
    round(min(abv)::numeric, 2) as min_abv,
    round(max(abv)::numeric, 2) as max_abv,
    round(avg(ibu)::numeric, 2) as avg_ibu,
    round(min(ibu)::numeric, 2) as min_ibu,
    round(max(ibu)::numeric, 2) as max_ibu,
    round(avg(ebc)::numeric, 2) as avg_ebc,
    round(min(ebc)::numeric, 2) as min_ebc,
    round(max(ebc)::numeric, 2) as max_ebc,
    round(avg(ph)::numeric, 2) as avg_ph,
    min(first_brewed) as oldest_brew,
    max(first_brewed) as newest_brew,
    count(distinct contributed_by) as unique_contributors
from beers
  );
  
[0m07:09:37.238800 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m07:09:37.243743 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:09:37.244638 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report" rename to "beer_report__dbt_backup"
[0m07:09:37.246063 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:09:37.249883 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:09:37.250400 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report__dbt_tmp" rename to "beer_report"
[0m07:09:37.251361 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:09:37.253449 [debug] [Thread-3 (]: On model.my_project.beer_report: COMMIT
[0m07:09:37.253936 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:09:37.254546 [debug] [Thread-3 (]: On model.my_project.beer_report: COMMIT
[0m07:09:37.260314 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m07:09:37.263385 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."beer_report__dbt_backup"
[0m07:09:37.264394 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:09:37.264899 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
drop table if exists "db"."dev"."beer_report__dbt_backup" cascade
[0m07:09:37.272267 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.007 seconds
[0m07:09:37.274362 [debug] [Thread-3 (]: On model.my_project.beer_report: Close
[0m07:09:37.275413 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce24388-056e-4c88-a4de-41e9ebfb00fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aa06438c80>]}
[0m07:09:37.276956 [info ] [Thread-3 (]: 2 of 2 OK created sql table model dev.beer_report .............................. [[32mSELECT 1[0m in 0.08s]
[0m07:09:37.278161 [debug] [Thread-3 (]: Finished running node model.my_project.beer_report
[0m07:09:37.281304 [debug] [MainThread]: Using postgres connection "master"
[0m07:09:37.281933 [debug] [MainThread]: On master: BEGIN
[0m07:09:37.282420 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:09:37.296168 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m07:09:37.297208 [debug] [MainThread]: On master: COMMIT
[0m07:09:37.298011 [debug] [MainThread]: Using postgres connection "master"
[0m07:09:37.298593 [debug] [MainThread]: On master: COMMIT
[0m07:09:37.299393 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:09:37.299916 [debug] [MainThread]: On master: Close
[0m07:09:37.300910 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:09:37.301659 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m07:09:37.302449 [debug] [MainThread]: Connection 'model.my_project.beer_report' was properly closed.
[0m07:09:37.303587 [info ] [MainThread]: 
[0m07:09:37.305729 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m07:09:37.309713 [debug] [MainThread]: Command end result
[0m07:09:37.371967 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:09:37.374482 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:09:37.384022 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:09:37.384615 [info ] [MainThread]: 
[0m07:09:37.385306 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:09:37.385905 [info ] [MainThread]: 
[0m07:09:37.386997 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:09:37.388852 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5767698, "process_in_blocks": "8", "process_kernel_time": 0.514012, "process_mem_max_rss": "108144", "process_out_blocks": "3384", "process_user_time": 3.307213}
[0m07:09:37.389678 [debug] [MainThread]: Command `dbt run` succeeded at 07:09:37.389512 after 1.58 seconds
[0m07:09:37.390241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aa0956db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aa09914620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aa098f7a70>]}
[0m07:09:37.390841 [debug] [MainThread]: Flushing usage events
[0m07:09:38.730461 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:29:48.805796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f4acca4ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f4adcf13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f4ad6614f0>]}


============================== 07:29:48.820183 | aeed79f5-c911-491f-9279-c3e076747679 ==============================
[0m07:29:48.820183 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:29:48.821119 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:29:49.278205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aeed79f5-c911-491f-9279-c3e076747679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f4ad8f9fa0>]}
[0m07:29:49.391098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aeed79f5-c911-491f-9279-c3e076747679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f4ad598ef0>]}
[0m07:29:49.393263 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:29:49.628650 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:29:49.956885 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:29:49.957441 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:29:50.036803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aeed79f5-c911-491f-9279-c3e076747679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f4ab199c10>]}
[0m07:29:50.179708 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:29:50.183965 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:29:50.258374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aeed79f5-c911-491f-9279-c3e076747679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f4ab199220>]}
[0m07:29:50.259075 [info ] [MainThread]: Found 2 data tests, 2 models, 1 source, 429 macros
[0m07:29:50.259683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aeed79f5-c911-491f-9279-c3e076747679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f4add48c20>]}
[0m07:29:50.262283 [info ] [MainThread]: 
[0m07:29:50.263003 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:29:50.263580 [info ] [MainThread]: 
[0m07:29:50.264496 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:29:50.271699 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m07:29:50.385306 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m07:29:50.385901 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:29:50.386322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:50.442653 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.056 seconds
[0m07:29:50.444545 [debug] [ThreadPool]: On list_db: Close
[0m07:29:50.446220 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_dev)
[0m07:29:50.446988 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "dev"
"
[0m07:29:50.453910 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m07:29:50.454497 [debug] [ThreadPool]: On create_db_dev: BEGIN
[0m07:29:50.454962 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:29:50.468364 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m07:29:50.468918 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m07:29:50.469477 [debug] [ThreadPool]: On create_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "create_db_dev"} */
create schema if not exists "dev"
[0m07:29:50.470934 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m07:29:50.472395 [debug] [ThreadPool]: On create_db_dev: COMMIT
[0m07:29:50.472854 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m07:29:50.473280 [debug] [ThreadPool]: On create_db_dev: COMMIT
[0m07:29:50.479003 [debug] [ThreadPool]: SQL status: COMMIT in 0.005 seconds
[0m07:29:50.479636 [debug] [ThreadPool]: On create_db_dev: Close
[0m07:29:50.481992 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_dev, now list_db_dev)
[0m07:29:50.490245 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:29:50.490806 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m07:29:50.491239 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:29:50.504108 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m07:29:50.504698 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:29:50.505145 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:29:50.510346 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m07:29:50.512589 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m07:29:50.513526 [debug] [ThreadPool]: On list_db_dev: Close
[0m07:29:50.522147 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:50.523007 [debug] [MainThread]: On master: BEGIN
[0m07:29:50.523722 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:29:50.537606 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m07:29:50.538519 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:50.539575 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:29:50.546088 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m07:29:50.548400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aeed79f5-c911-491f-9279-c3e076747679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f4aaea1fd0>]}
[0m07:29:50.549171 [debug] [MainThread]: On master: ROLLBACK
[0m07:29:50.550028 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:50.550503 [debug] [MainThread]: On master: BEGIN
[0m07:29:50.551651 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:29:50.552233 [debug] [MainThread]: On master: COMMIT
[0m07:29:50.552702 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:50.553154 [debug] [MainThread]: On master: COMMIT
[0m07:29:50.553897 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:29:50.554395 [debug] [MainThread]: On master: Close
[0m07:29:50.559073 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m07:29:50.559907 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.staging ....................................... [RUN]
[0m07:29:50.560846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m07:29:50.561464 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m07:29:50.572101 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m07:29:50.572988 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m07:29:50.630162 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m07:29:50.631177 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:29:50.631712 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m07:29:50.632219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:29:50.645058 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m07:29:50.645898 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:29:50.646408 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * 
    from "db"."dev"."raw_beer_data"
)

select 
    id,
    beer_id,
    name as beer_name,
    tagline,
    first_brewed,
    description,
    image,
    abv,
    ibu,
    ebc,
    ph,
    brewers_tips,
    contributed_by,
    inserted_at
from source
  );
  
[0m07:29:50.649334 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dev.raw_beer_data" does not exist
LINE 16:     from "db"."dev"."raw_beer_data"
                  ^

[0m07:29:50.650000 [debug] [Thread-1 (]: On model.my_project.staging: ROLLBACK
[0m07:29:50.650948 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m07:29:50.668141 [debug] [Thread-1 (]: Database Error in model staging (models/staging/staging.sql)
  relation "dev.raw_beer_data" does not exist
  LINE 16:     from "db"."dev"."raw_beer_data"
                    ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m07:29:50.671366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aeed79f5-c911-491f-9279-c3e076747679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f4ab184ce0>]}
[0m07:29:50.672381 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model dev.staging .............................. [[31mERROR[0m in 0.11s]
[0m07:29:50.673403 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m07:29:50.674297 [debug] [Thread-7 (]: Marking all children of 'model.my_project.staging' to be skipped because of status 'error'.  Reason: Database Error in model staging (models/staging/staging.sql)
  relation "dev.raw_beer_data" does not exist
  LINE 16:     from "db"."dev"."raw_beer_data"
                    ^
  compiled code at target/run/my_project/models/staging/staging.sql.
[0m07:29:50.676805 [debug] [Thread-3 (]: Began running node model.my_project.beer_report
[0m07:29:50.677908 [info ] [Thread-3 (]: 2 of 2 SKIP relation dev.beer_report ........................................... [[33mSKIP[0m]
[0m07:29:50.679027 [debug] [Thread-3 (]: Finished running node model.my_project.beer_report
[0m07:29:50.681968 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:50.682532 [debug] [MainThread]: On master: BEGIN
[0m07:29:50.682990 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:29:50.696062 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m07:29:50.696701 [debug] [MainThread]: On master: COMMIT
[0m07:29:50.697174 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:50.697666 [debug] [MainThread]: On master: COMMIT
[0m07:29:50.698596 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:29:50.699298 [debug] [MainThread]: On master: Close
[0m07:29:50.700467 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:29:50.701392 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m07:29:50.702599 [info ] [MainThread]: 
[0m07:29:50.703352 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m07:29:50.704876 [debug] [MainThread]: Command end result
[0m07:29:50.743464 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:29:50.746448 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:29:50.756209 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:29:50.756829 [info ] [MainThread]: 
[0m07:29:50.757495 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m07:29:50.758073 [info ] [MainThread]: 
[0m07:29:50.758666 [error] [MainThread]:   Database Error in model staging (models/staging/staging.sql)
  relation "dev.raw_beer_data" does not exist
  LINE 16:     from "db"."dev"."raw_beer_data"
                    ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m07:29:50.759177 [info ] [MainThread]: 
[0m07:29:50.759697 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m07:29:50.763223 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.0715356, "process_in_blocks": "112968", "process_kernel_time": 0.789984, "process_mem_max_rss": "107092", "process_out_blocks": "3360", "process_user_time": 4.245661}
[0m07:29:50.764221 [debug] [MainThread]: Command `dbt run` failed at 07:29:50.764022 after 2.07 seconds
[0m07:29:50.764929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f4ad0251f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f4b016a8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f4b016a8a0>]}
[0m07:29:50.765534 [debug] [MainThread]: Flushing usage events
[0m07:29:52.057920 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:31:26.274809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c430e7ec500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c430ef73140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c430eec2cc0>]}


============================== 07:31:26.287231 | 787e72bf-e0d1-47a8-a1c7-16d9b3541f52 ==============================
[0m07:31:26.287231 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:31:26.289014 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m07:31:26.730354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '787e72bf-e0d1-47a8-a1c7-16d9b3541f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c430e969af0>]}
[0m07:31:26.883107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '787e72bf-e0d1-47a8-a1c7-16d9b3541f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c430cacea20>]}
[0m07:31:26.885679 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:31:27.128869 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:31:27.448617 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:31:27.449401 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:31:27.548983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '787e72bf-e0d1-47a8-a1c7-16d9b3541f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c430e5a1a30>]}
[0m07:31:27.740749 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:31:27.744758 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:31:27.791147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '787e72bf-e0d1-47a8-a1c7-16d9b3541f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c430c846d20>]}
[0m07:31:27.791853 [info ] [MainThread]: Found 2 data tests, 2 models, 1 source, 429 macros
[0m07:31:27.792475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '787e72bf-e0d1-47a8-a1c7-16d9b3541f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c430cacee10>]}
[0m07:31:27.796476 [info ] [MainThread]: 
[0m07:31:27.798036 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:31:27.798939 [info ] [MainThread]: 
[0m07:31:27.800529 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:31:27.812154 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m07:31:27.915334 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m07:31:27.916312 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:31:27.917469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:31:28.135457 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "db" (172.19.0.2), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m07:31:28.138591 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:31:28.139818 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:31:28.141030 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m07:31:28.141566 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:31:28.142071 [debug] [ThreadPool]: On list_db: No close available on handle
[0m07:31:28.143206 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:31:28.143749 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m07:31:28.144229 [info ] [MainThread]: 
[0m07:31:28.145875 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m07:31:28.147266 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "db" (172.19.0.2), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m07:31:28.149353 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.9945447, "process_in_blocks": "0", "process_kernel_time": 0.757508, "process_mem_max_rss": "103728", "process_out_blocks": "2480", "process_user_time": 4.424173}
[0m07:31:28.150541 [debug] [MainThread]: Command `dbt run` failed at 07:31:28.150269 after 2.00 seconds
[0m07:31:28.151339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c430e57a060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c430c85fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c430cb22ea0>]}
[0m07:31:28.152324 [debug] [MainThread]: Flushing usage events
[0m07:31:29.457930 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:34:42.104252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740dfeb66780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740dfe9fe330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740dfedf5a60>]}


============================== 07:34:42.115130 | 9c84cdc4-dee6-44f5-a3e0-8ecef1a5a0e6 ==============================
[0m07:34:42.115130 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:34:42.116586 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m07:34:42.576201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c84cdc4-dee6-44f5-a3e0-8ecef1a5a0e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740dfe51fe30>]}
[0m07:34:42.703074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c84cdc4-dee6-44f5-a3e0-8ecef1a5a0e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740dfe4fe8d0>]}
[0m07:34:42.704271 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:34:42.899069 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:34:43.162597 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:34:43.163140 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:34:43.256499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c84cdc4-dee6-44f5-a3e0-8ecef1a5a0e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740dfcd4b650>]}
[0m07:34:43.423164 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:34:43.554676 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:34:43.854670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c84cdc4-dee6-44f5-a3e0-8ecef1a5a0e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740dfcd6e960>]}
[0m07:34:43.855523 [info ] [MainThread]: Found 2 data tests, 2 models, 1 source, 429 macros
[0m07:34:43.856979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c84cdc4-dee6-44f5-a3e0-8ecef1a5a0e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740dfcc92960>]}
[0m07:34:43.861009 [info ] [MainThread]: 
[0m07:34:43.861779 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:34:43.862555 [info ] [MainThread]: 
[0m07:34:43.863930 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:34:43.876388 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m07:34:43.965546 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m07:34:43.966109 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:34:43.966548 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:34:44.032633 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.066 seconds
[0m07:34:44.034543 [debug] [ThreadPool]: On list_db: Close
[0m07:34:44.035876 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_dev)
[0m07:34:44.036557 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "dev"
"
[0m07:34:44.043493 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m07:34:44.044080 [debug] [ThreadPool]: On create_db_dev: BEGIN
[0m07:34:44.044484 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:34:44.059310 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m07:34:44.060047 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m07:34:44.060676 [debug] [ThreadPool]: On create_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "create_db_dev"} */
create schema if not exists "dev"
[0m07:34:44.065610 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.004 seconds
[0m07:34:44.067079 [debug] [ThreadPool]: On create_db_dev: COMMIT
[0m07:34:44.067744 [debug] [ThreadPool]: Using postgres connection "create_db_dev"
[0m07:34:44.068710 [debug] [ThreadPool]: On create_db_dev: COMMIT
[0m07:34:44.077480 [debug] [ThreadPool]: SQL status: COMMIT in 0.008 seconds
[0m07:34:44.078565 [debug] [ThreadPool]: On create_db_dev: Close
[0m07:34:44.082449 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_dev, now list_db_dev)
[0m07:34:44.095325 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:34:44.096284 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m07:34:44.096873 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:34:44.110830 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m07:34:44.111648 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:34:44.112500 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:34:44.244813 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.132 seconds
[0m07:34:44.248041 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m07:34:44.249237 [debug] [ThreadPool]: On list_db_dev: Close
[0m07:34:44.257211 [debug] [MainThread]: Using postgres connection "master"
[0m07:34:44.257896 [debug] [MainThread]: On master: BEGIN
[0m07:34:44.258337 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:34:44.275172 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m07:34:44.276202 [debug] [MainThread]: Using postgres connection "master"
[0m07:34:44.277216 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:34:44.286626 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m07:34:44.290087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c84cdc4-dee6-44f5-a3e0-8ecef1a5a0e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740dfca4bc50>]}
[0m07:34:44.290898 [debug] [MainThread]: On master: ROLLBACK
[0m07:34:44.291807 [debug] [MainThread]: Using postgres connection "master"
[0m07:34:44.292289 [debug] [MainThread]: On master: BEGIN
[0m07:34:44.293369 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:34:44.293931 [debug] [MainThread]: On master: COMMIT
[0m07:34:44.294552 [debug] [MainThread]: Using postgres connection "master"
[0m07:34:44.295194 [debug] [MainThread]: On master: COMMIT
[0m07:34:44.296195 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:34:44.296823 [debug] [MainThread]: On master: Close
[0m07:34:44.302806 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m07:34:44.304281 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.staging ....................................... [RUN]
[0m07:34:44.305725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m07:34:44.307114 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m07:34:44.318568 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m07:34:44.319787 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m07:34:44.398042 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m07:34:44.399494 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:34:44.400389 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m07:34:44.401192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:34:44.415727 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m07:34:44.416919 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:34:44.417882 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * 
    from "db"."dev"."raw_beer_data"
)

select 
    id,
    beer_id,
    name as beer_name,
    tagline,
    first_brewed,
    description,
    image,
    abv,
    ibu,
    ebc,
    ph,
    brewers_tips,
    contributed_by,
    inserted_at
from source
  );
  
[0m07:34:44.421065 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dev.raw_beer_data" does not exist
LINE 16:     from "db"."dev"."raw_beer_data"
                  ^

[0m07:34:44.422095 [debug] [Thread-1 (]: On model.my_project.staging: ROLLBACK
[0m07:34:44.423968 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m07:34:44.449068 [debug] [Thread-1 (]: Database Error in model staging (models/staging/staging.sql)
  relation "dev.raw_beer_data" does not exist
  LINE 16:     from "db"."dev"."raw_beer_data"
                    ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m07:34:44.457450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c84cdc4-dee6-44f5-a3e0-8ecef1a5a0e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740dfca4b1a0>]}
[0m07:34:44.460447 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model dev.staging .............................. [[31mERROR[0m in 0.14s]
[0m07:34:44.462853 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m07:34:44.465233 [debug] [Thread-7 (]: Marking all children of 'model.my_project.staging' to be skipped because of status 'error'.  Reason: Database Error in model staging (models/staging/staging.sql)
  relation "dev.raw_beer_data" does not exist
  LINE 16:     from "db"."dev"."raw_beer_data"
                    ^
  compiled code at target/run/my_project/models/staging/staging.sql.
[0m07:34:44.470075 [debug] [Thread-3 (]: Began running node model.my_project.beer_report
[0m07:34:44.472770 [info ] [Thread-3 (]: 2 of 2 SKIP relation dev.beer_report ........................................... [[33mSKIP[0m]
[0m07:34:44.473776 [debug] [Thread-3 (]: Finished running node model.my_project.beer_report
[0m07:34:44.478314 [debug] [MainThread]: Using postgres connection "master"
[0m07:34:44.479438 [debug] [MainThread]: On master: BEGIN
[0m07:34:44.480877 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:34:44.498582 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m07:34:44.499525 [debug] [MainThread]: On master: COMMIT
[0m07:34:44.500670 [debug] [MainThread]: Using postgres connection "master"
[0m07:34:44.501759 [debug] [MainThread]: On master: COMMIT
[0m07:34:44.503126 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:34:44.504157 [debug] [MainThread]: On master: Close
[0m07:34:44.505644 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:34:44.507157 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m07:34:44.508404 [info ] [MainThread]: 
[0m07:34:44.509826 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m07:34:44.512366 [debug] [MainThread]: Command end result
[0m07:34:44.556489 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:34:44.559478 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:34:44.576078 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:34:44.577144 [info ] [MainThread]: 
[0m07:34:44.580051 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m07:34:44.584020 [info ] [MainThread]: 
[0m07:34:44.586053 [error] [MainThread]:   Database Error in model staging (models/staging/staging.sql)
  relation "dev.raw_beer_data" does not exist
  LINE 16:     from "db"."dev"."raw_beer_data"
                    ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m07:34:44.587276 [info ] [MainThread]: 
[0m07:34:44.588717 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m07:34:44.695099 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.6891077, "process_in_blocks": "21736", "process_kernel_time": 0.646524, "process_mem_max_rss": "106792", "process_out_blocks": "3360", "process_user_time": 4.330119}
[0m07:34:44.696365 [debug] [MainThread]: Command `dbt run` failed at 07:34:44.696076 after 2.69 seconds
[0m07:34:44.697098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740dff041700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740e01d228a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740e01d22870>]}
[0m07:34:44.697882 [debug] [MainThread]: Flushing usage events
[0m07:34:46.042483 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:41:05.517411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d42fe984d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d42fddd3da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d42fe17cbf0>]}


============================== 07:41:05.528074 | 3c705bfd-c77e-41b2-bd0b-36e803091570 ==============================
[0m07:41:05.528074 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:41:05.529110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:41:05.843194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c705bfd-c77e-41b2-bd0b-36e803091570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d42fc4b4200>]}
[0m07:41:05.944842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c705bfd-c77e-41b2-bd0b-36e803091570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d42fe5c5640>]}
[0m07:41:05.946061 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:41:11.240069 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:41:11.685886 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:41:11.686451 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:41:11.775866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c705bfd-c77e-41b2-bd0b-36e803091570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d42fc5596d0>]}
[0m07:41:11.957007 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:41:11.960943 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:41:11.997859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c705bfd-c77e-41b2-bd0b-36e803091570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d42fc2820c0>]}
[0m07:41:11.998613 [info ] [MainThread]: Found 2 data tests, 2 models, 1 source, 429 macros
[0m07:41:11.999238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c705bfd-c77e-41b2-bd0b-36e803091570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d42fc558cb0>]}
[0m07:41:12.002492 [info ] [MainThread]: 
[0m07:41:12.003193 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:41:12.003903 [info ] [MainThread]: 
[0m07:41:12.005311 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:41:12.013908 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m07:41:12.098981 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m07:41:12.099537 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:41:12.099988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:41:12.125480 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.025 seconds
[0m07:41:12.128630 [debug] [ThreadPool]: On list_db: Close
[0m07:41:12.131064 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m07:41:12.141368 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:41:12.141949 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m07:41:12.142448 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:41:12.157361 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m07:41:12.158137 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:41:12.158855 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:41:12.165031 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m07:41:12.168648 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m07:41:12.170456 [debug] [ThreadPool]: On list_db_dev: Close
[0m07:41:12.179686 [debug] [MainThread]: Using postgres connection "master"
[0m07:41:12.180329 [debug] [MainThread]: On master: BEGIN
[0m07:41:12.180838 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:41:12.196219 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m07:41:12.196951 [debug] [MainThread]: Using postgres connection "master"
[0m07:41:12.197801 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:41:12.205440 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m07:41:12.207630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c705bfd-c77e-41b2-bd0b-36e803091570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d42feab61e0>]}
[0m07:41:12.209032 [debug] [MainThread]: On master: ROLLBACK
[0m07:41:12.209968 [debug] [MainThread]: Using postgres connection "master"
[0m07:41:12.210458 [debug] [MainThread]: On master: BEGIN
[0m07:41:12.211470 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:41:12.212322 [debug] [MainThread]: On master: COMMIT
[0m07:41:12.213340 [debug] [MainThread]: Using postgres connection "master"
[0m07:41:12.213810 [debug] [MainThread]: On master: COMMIT
[0m07:41:12.214581 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:41:12.215078 [debug] [MainThread]: On master: Close
[0m07:41:12.221094 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m07:41:12.222970 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.staging ....................................... [RUN]
[0m07:41:12.224308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m07:41:12.225560 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m07:41:12.243648 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m07:41:12.244616 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m07:41:12.310546 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m07:41:12.311596 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:41:12.312139 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m07:41:12.312696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:41:12.326993 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m07:41:12.327891 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:41:12.328801 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * 
    from "db"."dev"."raw_beer_data"
)

select 
    id,
    beer_id,
    name as beer_name,
    tagline,
    first_brewed,
    description,
    image,
    abv,
    ibu,
    ebc,
    ph,
    brewers_tips,
    contributed_by,
    inserted_at
from source
  );
  
[0m07:41:12.330344 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dev.raw_beer_data" does not exist
LINE 16:     from "db"."dev"."raw_beer_data"
                  ^

[0m07:41:12.331170 [debug] [Thread-1 (]: On model.my_project.staging: ROLLBACK
[0m07:41:12.332502 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m07:41:12.349320 [debug] [Thread-1 (]: Database Error in model staging (models/staging/staging.sql)
  relation "dev.raw_beer_data" does not exist
  LINE 16:     from "db"."dev"."raw_beer_data"
                    ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m07:41:12.356553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c705bfd-c77e-41b2-bd0b-36e803091570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d42fde8aae0>]}
[0m07:41:12.358152 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model dev.staging .............................. [[31mERROR[0m in 0.13s]
[0m07:41:12.362500 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m07:41:12.364026 [debug] [Thread-7 (]: Marking all children of 'model.my_project.staging' to be skipped because of status 'error'.  Reason: Database Error in model staging (models/staging/staging.sql)
  relation "dev.raw_beer_data" does not exist
  LINE 16:     from "db"."dev"."raw_beer_data"
                    ^
  compiled code at target/run/my_project/models/staging/staging.sql.
[0m07:41:12.369575 [debug] [Thread-3 (]: Began running node model.my_project.beer_report
[0m07:41:12.371083 [info ] [Thread-3 (]: 2 of 2 SKIP relation dev.beer_report ........................................... [[33mSKIP[0m]
[0m07:41:12.372358 [debug] [Thread-3 (]: Finished running node model.my_project.beer_report
[0m07:41:12.378151 [debug] [MainThread]: Using postgres connection "master"
[0m07:41:12.379576 [debug] [MainThread]: On master: BEGIN
[0m07:41:12.380686 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:41:12.400781 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m07:41:12.402125 [debug] [MainThread]: On master: COMMIT
[0m07:41:12.403168 [debug] [MainThread]: Using postgres connection "master"
[0m07:41:12.404008 [debug] [MainThread]: On master: COMMIT
[0m07:41:12.405219 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:41:12.406131 [debug] [MainThread]: On master: Close
[0m07:41:12.407878 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:41:12.409099 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m07:41:12.410554 [info ] [MainThread]: 
[0m07:41:12.411543 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m07:41:12.413854 [debug] [MainThread]: Command end result
[0m07:41:12.470528 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:41:12.473182 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:41:12.483833 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:41:12.484572 [info ] [MainThread]: 
[0m07:41:12.485885 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m07:41:12.487220 [info ] [MainThread]: 
[0m07:41:12.488649 [error] [MainThread]:   Database Error in model staging (models/staging/staging.sql)
  relation "dev.raw_beer_data" does not exist
  LINE 16:     from "db"."dev"."raw_beer_data"
                    ^
  compiled code at target/run/my_project/models/staging/staging.sql
[0m07:41:12.489723 [info ] [MainThread]: 
[0m07:41:12.490831 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m07:41:12.493856 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.0646105, "process_in_blocks": "504", "process_kernel_time": 0.766787, "process_mem_max_rss": "107096", "process_out_blocks": "3360", "process_user_time": 4.391963}
[0m07:41:12.497063 [debug] [MainThread]: Command `dbt run` failed at 07:41:12.496557 after 7.07 seconds
[0m07:41:12.498418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d42fe9ee9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d42fc56c440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d42fc56f080>]}
[0m07:41:12.499722 [debug] [MainThread]: Flushing usage events
[0m07:41:13.871933 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:44:19.974956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70202302b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7020224775c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70202302a150>]}


============================== 07:44:19.984487 | 72ecfedb-a87e-4f04-9e41-c9f98ed412c7 ==============================
[0m07:44:19.984487 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:44:19.985296 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:44:20.332060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72ecfedb-a87e-4f04-9e41-c9f98ed412c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702023f43680>]}
[0m07:44:20.425571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72ecfedb-a87e-4f04-9e41-c9f98ed412c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702021f74350>]}
[0m07:44:20.426624 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:44:20.566098 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:44:20.763495 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:44:20.764050 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:44:20.829578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72ecfedb-a87e-4f04-9e41-c9f98ed412c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702022051790>]}
[0m07:44:20.957406 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:44:20.961107 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:44:20.997573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72ecfedb-a87e-4f04-9e41-c9f98ed412c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7020204d6390>]}
[0m07:44:20.998269 [info ] [MainThread]: Found 2 data tests, 2 models, 1 source, 429 macros
[0m07:44:20.998799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72ecfedb-a87e-4f04-9e41-c9f98ed412c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70202049e810>]}
[0m07:44:21.001672 [info ] [MainThread]: 
[0m07:44:21.002251 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:44:21.002883 [info ] [MainThread]: 
[0m07:44:21.003968 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:44:21.009954 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m07:44:21.077078 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m07:44:21.078534 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:44:21.078973 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:44:21.154222 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.075 seconds
[0m07:44:21.156128 [debug] [ThreadPool]: On list_db: Close
[0m07:44:21.158223 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m07:44:21.166610 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:44:21.167173 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m07:44:21.167624 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:44:21.181447 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m07:44:21.182146 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:44:21.182873 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:44:21.187232 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m07:44:21.189119 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m07:44:21.190021 [debug] [ThreadPool]: On list_db_dev: Close
[0m07:44:21.198913 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:21.199766 [debug] [MainThread]: On master: BEGIN
[0m07:44:21.200252 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:44:21.212843 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m07:44:21.214835 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:21.215720 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:44:21.220852 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m07:44:21.223280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72ecfedb-a87e-4f04-9e41-c9f98ed412c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7020225dc7d0>]}
[0m07:44:21.224034 [debug] [MainThread]: On master: ROLLBACK
[0m07:44:21.224893 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:21.225385 [debug] [MainThread]: On master: BEGIN
[0m07:44:21.226469 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:44:21.226946 [debug] [MainThread]: On master: COMMIT
[0m07:44:21.227704 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:21.228293 [debug] [MainThread]: On master: COMMIT
[0m07:44:21.229264 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:44:21.230267 [debug] [MainThread]: On master: Close
[0m07:44:21.235818 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m07:44:21.237139 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.staging ....................................... [RUN]
[0m07:44:21.237961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m07:44:21.238463 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m07:44:21.250301 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m07:44:21.251603 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m07:44:21.307774 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m07:44:21.308735 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:44:21.309217 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m07:44:21.309813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:44:21.322184 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m07:44:21.322876 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:44:21.323762 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * 
    from "db"."dev"."raw_beer_data"
)

select 
    id,
    beer_id,
    name as beer_name,
    tagline,
    first_brewed,
    description,
    image,
    abv,
    ibu,
    ebc,
    ph,
    brewers_tips,
    contributed_by,
    inserted_at
from source
  );
  
[0m07:44:21.332449 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.008 seconds
[0m07:44:21.342173 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:44:21.342914 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m07:44:21.344497 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:44:21.433892 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:44:21.435649 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:44:21.436901 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:44:21.467363 [debug] [Thread-1 (]: SQL status: COMMIT in 0.029 seconds
[0m07:44:21.492824 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m07:44:21.507728 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:44:21.508388 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m07:44:21.509455 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m07:44:21.521368 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m07:44:21.528611 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72ecfedb-a87e-4f04-9e41-c9f98ed412c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702023f42870>]}
[0m07:44:21.530614 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.staging .................................. [[32mSELECT 414[0m in 0.29s]
[0m07:44:21.533360 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m07:44:21.538781 [debug] [Thread-3 (]: Began running node model.my_project.beer_report
[0m07:44:21.541331 [info ] [Thread-3 (]: 2 of 2 START sql table model dev.beer_report ................................... [RUN]
[0m07:44:21.543190 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.beer_report'
[0m07:44:21.544014 [debug] [Thread-3 (]: Began compiling node model.my_project.beer_report
[0m07:44:21.555427 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.beer_report"
[0m07:44:21.556554 [debug] [Thread-3 (]: Began executing node model.my_project.beer_report
[0m07:44:21.564349 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.beer_report"
[0m07:44:21.565859 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:44:21.566841 [debug] [Thread-3 (]: On model.my_project.beer_report: BEGIN
[0m07:44:21.567987 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:44:21.584600 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m07:44:21.585503 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:44:21.586319 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */

  
    

  create  table "db"."dev"."beer_report__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    count(*) as total_beers,
    round(avg(abv)::numeric, 2) as avg_abv,
    round(min(abv)::numeric, 2) as min_abv,
    round(max(abv)::numeric, 2) as max_abv,
    round(avg(ibu)::numeric, 2) as avg_ibu,
    round(min(ibu)::numeric, 2) as min_ibu,
    round(max(ibu)::numeric, 2) as max_ibu,
    round(avg(ebc)::numeric, 2) as avg_ebc,
    round(min(ebc)::numeric, 2) as min_ebc,
    round(max(ebc)::numeric, 2) as max_ebc,
    round(avg(ph)::numeric, 2) as avg_ph,
    min(first_brewed) as oldest_brew,
    max(first_brewed) as newest_brew,
    count(distinct contributed_by) as unique_contributors
from beers
  );
  
[0m07:44:21.597041 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.008 seconds
[0m07:44:21.605529 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:44:21.606275 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report__dbt_tmp" rename to "beer_report"
[0m07:44:21.607912 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:44:21.611127 [debug] [Thread-3 (]: On model.my_project.beer_report: COMMIT
[0m07:44:21.612210 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:44:21.613454 [debug] [Thread-3 (]: On model.my_project.beer_report: COMMIT
[0m07:44:21.619044 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m07:44:21.623246 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."beer_report__dbt_backup"
[0m07:44:21.624692 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:44:21.625543 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
drop table if exists "db"."dev"."beer_report__dbt_backup" cascade
[0m07:44:21.626971 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m07:44:21.629892 [debug] [Thread-3 (]: On model.my_project.beer_report: Close
[0m07:44:21.630965 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72ecfedb-a87e-4f04-9e41-c9f98ed412c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70201f7152b0>]}
[0m07:44:21.632430 [info ] [Thread-3 (]: 2 of 2 OK created sql table model dev.beer_report .............................. [[32mSELECT 1[0m in 0.09s]
[0m07:44:21.633966 [debug] [Thread-3 (]: Finished running node model.my_project.beer_report
[0m07:44:21.641009 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:21.641990 [debug] [MainThread]: On master: BEGIN
[0m07:44:21.643030 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:44:21.694105 [debug] [MainThread]: SQL status: BEGIN in 0.051 seconds
[0m07:44:21.695303 [debug] [MainThread]: On master: COMMIT
[0m07:44:21.697674 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:21.699443 [debug] [MainThread]: On master: COMMIT
[0m07:44:21.700543 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:44:21.701216 [debug] [MainThread]: On master: Close
[0m07:44:21.702330 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:44:21.702904 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m07:44:21.703638 [debug] [MainThread]: Connection 'model.my_project.beer_report' was properly closed.
[0m07:44:21.704594 [info ] [MainThread]: 
[0m07:44:21.705816 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m07:44:21.710172 [debug] [MainThread]: Command end result
[0m07:44:21.751333 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:44:21.753867 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:44:21.764743 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:44:21.765299 [info ] [MainThread]: 
[0m07:44:21.765927 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:44:21.766475 [info ] [MainThread]: 
[0m07:44:21.767328 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:44:21.770497 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8707718, "process_in_blocks": "29288", "process_kernel_time": 0.559638, "process_mem_max_rss": "106504", "process_out_blocks": "3384", "process_user_time": 3.237908}
[0m07:44:21.771424 [debug] [MainThread]: Command `dbt run` succeeded at 07:44:21.771243 after 1.87 seconds
[0m07:44:21.772017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70202231ff20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70201f685df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70201f684aa0>]}
[0m07:44:21.772643 [debug] [MainThread]: Flushing usage events
[0m07:44:23.141896 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:44:28.073819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5ff5d3d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5ff5cc1ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5ff5c4c9b0>]}


============================== 07:44:28.082574 | 2c6d386d-42e6-4ef6-9dcb-5559542537bb ==============================
[0m07:44:28.082574 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:44:28.083703 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:44:28.395996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c6d386d-42e6-4ef6-9dcb-5559542537bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5ff62d7470>]}
[0m07:44:28.494180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c6d386d-42e6-4ef6-9dcb-5559542537bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5ff588af60>]}
[0m07:44:28.495326 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:44:28.636111 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:44:28.839587 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:44:28.840397 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:44:28.918519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c6d386d-42e6-4ef6-9dcb-5559542537bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5ff3f708f0>]}
[0m07:44:29.049736 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:44:29.054009 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:44:29.088489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c6d386d-42e6-4ef6-9dcb-5559542537bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5ff6b3cf20>]}
[0m07:44:29.089228 [info ] [MainThread]: Found 2 data tests, 2 models, 1 source, 429 macros
[0m07:44:29.089792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c6d386d-42e6-4ef6-9dcb-5559542537bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5ff3c5b260>]}
[0m07:44:29.092396 [info ] [MainThread]: 
[0m07:44:29.092969 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:44:29.093594 [info ] [MainThread]: 
[0m07:44:29.094748 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:44:29.100928 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m07:44:29.176600 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m07:44:29.177173 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m07:44:29.177612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:44:29.194981 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.017 seconds
[0m07:44:29.197082 [debug] [ThreadPool]: On list_db: Close
[0m07:44:29.199326 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m07:44:29.208066 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:44:29.208640 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m07:44:29.209035 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:44:29.222582 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m07:44:29.223377 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m07:44:29.224010 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:44:29.229278 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m07:44:29.231616 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m07:44:29.232567 [debug] [ThreadPool]: On list_db_dev: Close
[0m07:44:29.242358 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:29.243095 [debug] [MainThread]: On master: BEGIN
[0m07:44:29.243579 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:44:29.258025 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m07:44:29.260087 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:29.260992 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:44:29.266508 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m07:44:29.270295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c6d386d-42e6-4ef6-9dcb-5559542537bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5ff5adeae0>]}
[0m07:44:29.271143 [debug] [MainThread]: On master: ROLLBACK
[0m07:44:29.272077 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:29.272551 [debug] [MainThread]: On master: BEGIN
[0m07:44:29.273630 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:44:29.275018 [debug] [MainThread]: On master: COMMIT
[0m07:44:29.276495 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:29.277154 [debug] [MainThread]: On master: COMMIT
[0m07:44:29.278434 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m07:44:29.279168 [debug] [MainThread]: On master: Close
[0m07:44:29.284501 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m07:44:29.286284 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.staging ....................................... [RUN]
[0m07:44:29.287235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m07:44:29.288313 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m07:44:29.299431 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m07:44:29.300841 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m07:44:29.368782 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m07:44:29.369820 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:44:29.370398 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m07:44:29.370882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:44:29.383461 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m07:44:29.384544 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:44:29.385735 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * 
    from "db"."dev"."raw_beer_data"
)

select 
    id,
    beer_id,
    name as beer_name,
    tagline,
    first_brewed,
    description,
    image,
    abv,
    ibu,
    ebc,
    ph,
    brewers_tips,
    contributed_by,
    inserted_at
from source
  );
  
[0m07:44:29.392298 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.006 seconds
[0m07:44:29.400816 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:44:29.401690 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m07:44:29.403499 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:44:29.407900 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:44:29.408478 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m07:44:29.409553 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:44:29.440360 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:44:29.441038 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:44:29.441502 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m07:44:29.447990 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m07:44:29.458898 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m07:44:29.467252 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m07:44:29.468110 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m07:44:29.481263 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.012 seconds
[0m07:44:29.485629 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m07:44:29.488231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c6d386d-42e6-4ef6-9dcb-5559542537bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5ff0511190>]}
[0m07:44:29.489155 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.staging .................................. [[32mSELECT 414[0m in 0.20s]
[0m07:44:29.490416 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m07:44:29.492144 [debug] [Thread-3 (]: Began running node model.my_project.beer_report
[0m07:44:29.492939 [info ] [Thread-3 (]: 2 of 2 START sql table model dev.beer_report ................................... [RUN]
[0m07:44:29.493790 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.beer_report'
[0m07:44:29.494389 [debug] [Thread-3 (]: Began compiling node model.my_project.beer_report
[0m07:44:29.498344 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.beer_report"
[0m07:44:29.499329 [debug] [Thread-3 (]: Began executing node model.my_project.beer_report
[0m07:44:29.504000 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.beer_report"
[0m07:44:29.504908 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:44:29.505451 [debug] [Thread-3 (]: On model.my_project.beer_report: BEGIN
[0m07:44:29.505947 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:44:29.518622 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m07:44:29.519482 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:44:29.520133 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */

  
    

  create  table "db"."dev"."beer_report__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    count(*) as total_beers,
    round(avg(abv)::numeric, 2) as avg_abv,
    round(min(abv)::numeric, 2) as min_abv,
    round(max(abv)::numeric, 2) as max_abv,
    round(avg(ibu)::numeric, 2) as avg_ibu,
    round(min(ibu)::numeric, 2) as min_ibu,
    round(max(ibu)::numeric, 2) as max_ibu,
    round(avg(ebc)::numeric, 2) as avg_ebc,
    round(min(ebc)::numeric, 2) as min_ebc,
    round(max(ebc)::numeric, 2) as max_ebc,
    round(avg(ph)::numeric, 2) as avg_ph,
    min(first_brewed) as oldest_brew,
    max(first_brewed) as newest_brew,
    count(distinct contributed_by) as unique_contributors
from beers
  );
  
[0m07:44:29.525417 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m07:44:29.529413 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:44:29.529964 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report" rename to "beer_report__dbt_backup"
[0m07:44:29.531219 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:44:29.535611 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:44:29.536310 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report__dbt_tmp" rename to "beer_report"
[0m07:44:29.537535 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:44:29.540360 [debug] [Thread-3 (]: On model.my_project.beer_report: COMMIT
[0m07:44:29.540955 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:44:29.541618 [debug] [Thread-3 (]: On model.my_project.beer_report: COMMIT
[0m07:44:29.547242 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m07:44:29.550272 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."beer_report__dbt_backup"
[0m07:44:29.551964 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m07:44:29.552808 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
drop table if exists "db"."dev"."beer_report__dbt_backup" cascade
[0m07:44:29.559740 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m07:44:29.561817 [debug] [Thread-3 (]: On model.my_project.beer_report: Close
[0m07:44:29.562784 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c6d386d-42e6-4ef6-9dcb-5559542537bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5ff3c7f590>]}
[0m07:44:29.563709 [info ] [Thread-3 (]: 2 of 2 OK created sql table model dev.beer_report .............................. [[32mSELECT 1[0m in 0.07s]
[0m07:44:29.564811 [debug] [Thread-3 (]: Finished running node model.my_project.beer_report
[0m07:44:29.568673 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:29.569354 [debug] [MainThread]: On master: BEGIN
[0m07:44:29.570138 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:44:29.582911 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m07:44:29.583631 [debug] [MainThread]: On master: COMMIT
[0m07:44:29.584995 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:29.585761 [debug] [MainThread]: On master: COMMIT
[0m07:44:29.586791 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:44:29.587315 [debug] [MainThread]: On master: Close
[0m07:44:29.588027 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:44:29.588441 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m07:44:29.588841 [debug] [MainThread]: Connection 'model.my_project.beer_report' was properly closed.
[0m07:44:29.589421 [info ] [MainThread]: 
[0m07:44:29.590092 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m07:44:29.592187 [debug] [MainThread]: Command end result
[0m07:44:29.627415 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m07:44:29.629849 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m07:44:29.639988 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m07:44:29.640527 [info ] [MainThread]: 
[0m07:44:29.641378 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:44:29.642497 [info ] [MainThread]: 
[0m07:44:29.643402 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:44:29.645117 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6513906, "process_in_blocks": "2248", "process_kernel_time": 0.549415, "process_mem_max_rss": "107092", "process_out_blocks": "3376", "process_user_time": 3.482324}
[0m07:44:29.645860 [debug] [MainThread]: Command `dbt run` succeeded at 07:44:29.645698 after 1.65 seconds
[0m07:44:29.646472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5ff6d14bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5ff3f00ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5ff5a375c0>]}
[0m07:44:29.647008 [debug] [MainThread]: Flushing usage events
[0m07:44:30.958322 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:43:45.469292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705cbd0c4770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705cbb313260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705cbbabf8c0>]}


============================== 08:43:45.485214 | e45d2df6-ba3b-41f6-8b1c-ddd791f1cdbf ==============================
[0m08:43:45.485214 [info ] [MainThread]: Running with dbt=1.9.0
[0m08:43:45.486005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:43:46.050517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e45d2df6-ba3b-41f6-8b1c-ddd791f1cdbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705cb9808cb0>]}
[0m08:43:46.168553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e45d2df6-ba3b-41f6-8b1c-ddd791f1cdbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705cbb1c80b0>]}
[0m08:43:46.169739 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:43:46.328976 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m08:43:46.564415 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:43:46.565066 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:43:46.674672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e45d2df6-ba3b-41f6-8b1c-ddd791f1cdbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705cb98ece00>]}
[0m08:43:46.890993 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m08:43:46.896683 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m08:43:46.964381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e45d2df6-ba3b-41f6-8b1c-ddd791f1cdbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705cb9602a80>]}
[0m08:43:46.965316 [info ] [MainThread]: Found 2 data tests, 2 models, 1 source, 429 macros
[0m08:43:46.966441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e45d2df6-ba3b-41f6-8b1c-ddd791f1cdbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705cb98b31d0>]}
[0m08:43:46.970666 [info ] [MainThread]: 
[0m08:43:46.971372 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:43:46.972004 [info ] [MainThread]: 
[0m08:43:46.973070 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:43:46.980978 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m08:43:47.090844 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m08:43:47.091563 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m08:43:47.092040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:43:47.235148 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.143 seconds
[0m08:43:47.237519 [debug] [ThreadPool]: On list_db: Close
[0m08:43:47.239827 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m08:43:47.252419 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m08:43:47.252986 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m08:43:47.253494 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:43:47.267547 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m08:43:47.268632 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m08:43:47.269482 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:43:47.278913 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.008 seconds
[0m08:43:47.281015 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m08:43:47.282096 [debug] [ThreadPool]: On list_db_dev: Close
[0m08:43:47.289469 [debug] [MainThread]: Using postgres connection "master"
[0m08:43:47.290182 [debug] [MainThread]: On master: BEGIN
[0m08:43:47.290810 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:43:47.314296 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m08:43:47.315718 [debug] [MainThread]: Using postgres connection "master"
[0m08:43:47.317175 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:43:47.326389 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m08:43:47.331466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e45d2df6-ba3b-41f6-8b1c-ddd791f1cdbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705cb9646990>]}
[0m08:43:47.332570 [debug] [MainThread]: On master: ROLLBACK
[0m08:43:47.333546 [debug] [MainThread]: Using postgres connection "master"
[0m08:43:47.334145 [debug] [MainThread]: On master: BEGIN
[0m08:43:47.335841 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m08:43:47.336722 [debug] [MainThread]: On master: COMMIT
[0m08:43:47.337650 [debug] [MainThread]: Using postgres connection "master"
[0m08:43:47.338167 [debug] [MainThread]: On master: COMMIT
[0m08:43:47.338983 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:43:47.339546 [debug] [MainThread]: On master: Close
[0m08:43:47.348306 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m08:43:47.349559 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.staging ....................................... [RUN]
[0m08:43:47.350819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m08:43:47.351662 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m08:43:47.363782 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m08:43:47.365154 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m08:43:47.440247 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m08:43:47.441379 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m08:43:47.441900 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m08:43:47.442383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:43:47.456931 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m08:43:47.457643 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m08:43:47.458525 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * 
    from "db"."dev"."raw_beer_data"
)

select 
    id,
    beer_id,
    name as beer_name,
    tagline,
    first_brewed,
    description,
    image,
    abv,
    ibu,
    ebc,
    ph,
    brewers_tips,
    contributed_by,
    inserted_at
from source
  );
  
[0m08:43:47.471735 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.013 seconds
[0m08:43:47.483048 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m08:43:47.483688 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m08:43:47.484989 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:43:47.489320 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m08:43:47.489845 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m08:43:47.490855 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:43:47.536135 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m08:43:47.537027 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m08:43:47.537565 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m08:43:47.648701 [debug] [Thread-1 (]: SQL status: COMMIT in 0.110 seconds
[0m08:43:47.660871 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m08:43:47.688277 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m08:43:47.689622 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m08:43:47.698863 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m08:43:47.704275 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m08:43:47.707267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e45d2df6-ba3b-41f6-8b1c-ddd791f1cdbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705cb864eab0>]}
[0m08:43:47.708447 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.staging .................................. [[32mSELECT 414[0m in 0.35s]
[0m08:43:47.711070 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m08:43:47.714507 [debug] [Thread-3 (]: Began running node model.my_project.beer_report
[0m08:43:47.717166 [info ] [Thread-3 (]: 2 of 2 START sql table model dev.beer_report ................................... [RUN]
[0m08:43:47.718714 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.beer_report'
[0m08:43:47.719357 [debug] [Thread-3 (]: Began compiling node model.my_project.beer_report
[0m08:43:47.723482 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.beer_report"
[0m08:43:47.724271 [debug] [Thread-3 (]: Began executing node model.my_project.beer_report
[0m08:43:47.730731 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.beer_report"
[0m08:43:47.731668 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m08:43:47.732228 [debug] [Thread-3 (]: On model.my_project.beer_report: BEGIN
[0m08:43:47.732691 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:43:47.748491 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m08:43:47.749787 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m08:43:47.750457 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */

  
    

  create  table "db"."dev"."beer_report__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    count(*) as total_beers,
    round(avg(abv)::numeric, 2) as avg_abv,
    round(min(abv)::numeric, 2) as min_abv,
    round(max(abv)::numeric, 2) as max_abv,
    round(avg(ibu)::numeric, 2) as avg_ibu,
    round(min(ibu)::numeric, 2) as min_ibu,
    round(max(ibu)::numeric, 2) as max_ibu,
    round(avg(ebc)::numeric, 2) as avg_ebc,
    round(min(ebc)::numeric, 2) as min_ebc,
    round(max(ebc)::numeric, 2) as max_ebc,
    round(avg(ph)::numeric, 2) as avg_ph,
    min(first_brewed) as oldest_brew,
    max(first_brewed) as newest_brew,
    count(distinct contributed_by) as unique_contributors
from beers
  );
  
[0m08:43:47.767490 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.016 seconds
[0m08:43:47.773586 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m08:43:47.774205 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report" rename to "beer_report__dbt_backup"
[0m08:43:47.775278 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:43:47.782012 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m08:43:47.782831 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report__dbt_tmp" rename to "beer_report"
[0m08:43:47.784362 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:43:47.786810 [debug] [Thread-3 (]: On model.my_project.beer_report: COMMIT
[0m08:43:47.787337 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m08:43:47.787980 [debug] [Thread-3 (]: On model.my_project.beer_report: COMMIT
[0m08:43:47.794530 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m08:43:47.798845 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."beer_report__dbt_backup"
[0m08:43:47.800149 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m08:43:47.800685 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
drop table if exists "db"."dev"."beer_report__dbt_backup" cascade
[0m08:43:47.808766 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.007 seconds
[0m08:43:47.812399 [debug] [Thread-3 (]: On model.my_project.beer_report: Close
[0m08:43:47.813411 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e45d2df6-ba3b-41f6-8b1c-ddd791f1cdbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705cb98ef1a0>]}
[0m08:43:47.814325 [info ] [Thread-3 (]: 2 of 2 OK created sql table model dev.beer_report .............................. [[32mSELECT 1[0m in 0.10s]
[0m08:43:47.815626 [debug] [Thread-3 (]: Finished running node model.my_project.beer_report
[0m08:43:47.819121 [debug] [MainThread]: Using postgres connection "master"
[0m08:43:47.819797 [debug] [MainThread]: On master: BEGIN
[0m08:43:47.820348 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:43:47.834296 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m08:43:47.835201 [debug] [MainThread]: On master: COMMIT
[0m08:43:47.835954 [debug] [MainThread]: Using postgres connection "master"
[0m08:43:47.836661 [debug] [MainThread]: On master: COMMIT
[0m08:43:47.837551 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:43:47.838098 [debug] [MainThread]: On master: Close
[0m08:43:47.838956 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:43:47.839519 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m08:43:47.840019 [debug] [MainThread]: Connection 'model.my_project.beer_report' was properly closed.
[0m08:43:47.841245 [info ] [MainThread]: 
[0m08:43:47.843560 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m08:43:47.847105 [debug] [MainThread]: Command end result
[0m08:43:47.888875 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m08:43:47.891272 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m08:43:47.904153 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m08:43:47.904751 [info ] [MainThread]: 
[0m08:43:47.905432 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:43:47.906010 [info ] [MainThread]: 
[0m08:43:47.906669 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m08:43:47.908371 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5222967, "process_in_blocks": "7456", "process_kernel_time": 0.970808, "process_mem_max_rss": "107308", "process_out_blocks": "3392", "process_user_time": 4.14507}
[0m08:43:47.909248 [debug] [MainThread]: Command `dbt run` succeeded at 08:43:47.908995 after 2.52 seconds
[0m08:43:47.909982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705cbd0c4770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705cbbc6c290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705cbbe446e0>]}
[0m08:43:47.912435 [debug] [MainThread]: Flushing usage events
[0m08:43:49.253401 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:14:24.750850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee15d850620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee15b40bc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee15af81520>]}


============================== 09:14:24.760661 | 25f9c23e-762f-429b-abc9-c57a4660de1e ==============================
[0m09:14:24.760661 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:14:24.761775 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:14:25.165817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25f9c23e-762f-429b-abc9-c57a4660de1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee15acea540>]}
[0m09:14:25.302191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25f9c23e-762f-429b-abc9-c57a4660de1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee15ad14e00>]}
[0m09:14:25.303645 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:14:25.539233 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:14:25.871189 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:14:25.872114 [debug] [MainThread]: Partial parsing: added file: my_project://models/mart/master_beer_table.sql
[0m09:14:26.485010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25f9c23e-762f-429b-abc9-c57a4660de1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee158e084d0>]}
[0m09:14:26.663196 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:14:26.666896 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:14:26.705292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25f9c23e-762f-429b-abc9-c57a4660de1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee1580221b0>]}
[0m09:14:26.706068 [info ] [MainThread]: Found 2 data tests, 3 models, 1 source, 429 macros
[0m09:14:26.706751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25f9c23e-762f-429b-abc9-c57a4660de1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee158d206b0>]}
[0m09:14:26.711526 [info ] [MainThread]: 
[0m09:14:26.712374 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:14:26.713170 [info ] [MainThread]: 
[0m09:14:26.714511 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:14:26.725462 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:14:26.819286 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:14:26.819993 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:14:26.820519 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:14:26.839206 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.019 seconds
[0m09:14:26.841358 [debug] [ThreadPool]: On list_db: Close
[0m09:14:26.843965 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m09:14:26.851888 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:14:26.852555 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m09:14:26.852973 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:14:26.867899 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m09:14:26.868843 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:14:26.869919 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:14:26.878488 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.008 seconds
[0m09:14:26.881219 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m09:14:26.882261 [debug] [ThreadPool]: On list_db_dev: Close
[0m09:14:26.889885 [debug] [MainThread]: Using postgres connection "master"
[0m09:14:26.890471 [debug] [MainThread]: On master: BEGIN
[0m09:14:26.890908 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:14:26.906556 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m09:14:26.907696 [debug] [MainThread]: Using postgres connection "master"
[0m09:14:26.909028 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:14:26.917835 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m09:14:26.920861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25f9c23e-762f-429b-abc9-c57a4660de1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee158d22ea0>]}
[0m09:14:26.921684 [debug] [MainThread]: On master: ROLLBACK
[0m09:14:26.922559 [debug] [MainThread]: Using postgres connection "master"
[0m09:14:26.923108 [debug] [MainThread]: On master: BEGIN
[0m09:14:26.924237 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:14:26.925129 [debug] [MainThread]: On master: COMMIT
[0m09:14:26.926158 [debug] [MainThread]: Using postgres connection "master"
[0m09:14:26.926999 [debug] [MainThread]: On master: COMMIT
[0m09:14:26.928202 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:14:26.929031 [debug] [MainThread]: On master: Close
[0m09:14:26.935165 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m09:14:26.936574 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.staging ....................................... [RUN]
[0m09:14:26.937729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m09:14:26.938714 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m09:14:26.953370 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m09:14:26.954260 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m09:14:27.017880 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m09:14:27.018895 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:14:27.019449 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m09:14:27.019965 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:14:27.035213 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m09:14:27.036170 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:14:27.037168 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * 
    from "db"."dev"."raw_beer_data"
)

select 
    id,
    beer_id,
    name as beer_name,
    tagline,
    first_brewed,
    description,
    image,
    abv,
    ibu,
    ebc,
    ph,
    brewers_tips,
    contributed_by,
    inserted_at
from source
  );
  
[0m09:14:27.050965 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.013 seconds
[0m09:14:27.060700 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:14:27.061560 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m09:14:27.062790 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:14:27.066828 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:14:27.067399 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m09:14:27.068395 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:14:27.104858 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m09:14:27.105483 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:14:27.105972 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m09:14:27.111558 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m09:14:27.119910 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m09:14:27.128430 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:14:27.129020 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m09:14:27.137123 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m09:14:27.140615 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m09:14:27.143265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25f9c23e-762f-429b-abc9-c57a4660de1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee142e8f650>]}
[0m09:14:27.144425 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.staging .................................. [[32mSELECT 414[0m in 0.20s]
[0m09:14:27.145901 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m09:14:27.148065 [debug] [Thread-3 (]: Began running node model.my_project.beer_report
[0m09:14:27.148684 [debug] [Thread-4 (]: Began running node model.my_project.master_beer_table
[0m09:14:27.149637 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.beer_report ................................... [RUN]
[0m09:14:27.153014 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.beer_report'
[0m09:14:27.151248 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.master_beer_table ............................. [RUN]
[0m09:14:27.154526 [debug] [Thread-3 (]: Began compiling node model.my_project.beer_report
[0m09:14:27.155623 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.master_beer_table'
[0m09:14:27.164594 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.beer_report"
[0m09:14:27.165334 [debug] [Thread-4 (]: Began compiling node model.my_project.master_beer_table
[0m09:14:27.169473 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.master_beer_table"
[0m09:14:27.170496 [debug] [Thread-3 (]: Began executing node model.my_project.beer_report
[0m09:14:27.175104 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.beer_report"
[0m09:14:27.177167 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m09:14:27.177888 [debug] [Thread-3 (]: On model.my_project.beer_report: BEGIN
[0m09:14:27.178506 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:14:27.184009 [debug] [Thread-4 (]: Began executing node model.my_project.master_beer_table
[0m09:14:27.188879 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.master_beer_table"
[0m09:14:27.190472 [debug] [Thread-4 (]: Using postgres connection "model.my_project.master_beer_table"
[0m09:14:27.191000 [debug] [Thread-4 (]: On model.my_project.master_beer_table: BEGIN
[0m09:14:27.191767 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:14:27.199838 [debug] [Thread-3 (]: SQL status: BEGIN in 0.021 seconds
[0m09:14:27.201006 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m09:14:27.201760 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */

  
    

  create  table "db"."dev"."beer_report__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    count(*) as total_beers,
    round(avg(abv)::numeric, 2) as avg_abv,
    round(min(abv)::numeric, 2) as min_abv,
    round(max(abv)::numeric, 2) as max_abv,
    round(avg(ibu)::numeric, 2) as avg_ibu,
    round(min(ibu)::numeric, 2) as min_ibu,
    round(max(ibu)::numeric, 2) as max_ibu,
    round(avg(ebc)::numeric, 2) as avg_ebc,
    round(min(ebc)::numeric, 2) as min_ebc,
    round(max(ebc)::numeric, 2) as max_ebc,
    round(avg(ph)::numeric, 2) as avg_ph,
    min(first_brewed) as oldest_brew,
    max(first_brewed) as newest_brew,
    count(distinct contributed_by) as unique_contributors
from beers
  );
  
[0m09:14:27.211104 [debug] [Thread-4 (]: SQL status: BEGIN in 0.019 seconds
[0m09:14:27.212134 [debug] [Thread-4 (]: Using postgres connection "model.my_project.master_beer_table"
[0m09:14:27.213152 [debug] [Thread-4 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */

  
    

  create  table "db"."dev"."master_beer_table__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    beer_id,
    beer_name,
    tagline as category,         -- treated as category/style
    description,
    abv as alcohol_percent,
    first_brewed,
from beers
  );
  
[0m09:14:27.213989 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.012 seconds
[0m09:14:27.221045 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 25: from beers
         ^

[0m09:14:27.224252 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m09:14:27.226491 [debug] [Thread-4 (]: On model.my_project.master_beer_table: ROLLBACK
[0m09:14:27.228009 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report" rename to "beer_report__dbt_backup"
[0m09:14:27.230358 [debug] [Thread-4 (]: On model.my_project.master_beer_table: Close
[0m09:14:27.231432 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:14:27.250039 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m09:14:27.251052 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report__dbt_tmp" rename to "beer_report"
[0m09:14:27.253289 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:14:27.259148 [debug] [Thread-3 (]: On model.my_project.beer_report: COMMIT
[0m09:14:27.261200 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m09:14:27.262271 [debug] [Thread-3 (]: On model.my_project.beer_report: COMMIT
[0m09:14:27.280719 [debug] [Thread-3 (]: SQL status: COMMIT in 0.017 seconds
[0m09:14:27.286017 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."beer_report__dbt_backup"
[0m09:14:27.288258 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m09:14:27.289462 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
drop table if exists "db"."dev"."beer_report__dbt_backup" cascade
[0m09:14:27.302532 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.012 seconds
[0m09:14:27.304563 [debug] [Thread-4 (]: Database Error in model master_beer_table (models/mart/master_beer_table.sql)
  syntax error at or near "from"
  LINE 25: from beers
           ^
  compiled code at target/run/my_project/models/mart/master_beer_table.sql
[0m09:14:27.308117 [debug] [Thread-3 (]: On model.my_project.beer_report: Close
[0m09:14:27.310321 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25f9c23e-762f-429b-abc9-c57a4660de1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee1590dc770>]}
[0m09:14:27.314244 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25f9c23e-762f-429b-abc9-c57a4660de1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee142eb2630>]}
[0m09:14:27.312711 [error] [Thread-4 (]: 3 of 3 ERROR creating sql table model dev.master_beer_table .................... [[31mERROR[0m in 0.15s]
[0m09:14:27.319191 [debug] [Thread-4 (]: Finished running node model.my_project.master_beer_table
[0m09:14:27.316117 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.beer_report .............................. [[32mSELECT 1[0m in 0.16s]
[0m09:14:27.321253 [debug] [Thread-7 (]: Marking all children of 'model.my_project.master_beer_table' to be skipped because of status 'error'.  Reason: Database Error in model master_beer_table (models/mart/master_beer_table.sql)
  syntax error at or near "from"
  LINE 25: from beers
           ^
  compiled code at target/run/my_project/models/mart/master_beer_table.sql.
[0m09:14:27.322811 [debug] [Thread-3 (]: Finished running node model.my_project.beer_report
[0m09:14:27.329624 [debug] [MainThread]: Using postgres connection "master"
[0m09:14:27.330370 [debug] [MainThread]: On master: BEGIN
[0m09:14:27.330962 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:14:27.347704 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m09:14:27.348716 [debug] [MainThread]: On master: COMMIT
[0m09:14:27.349851 [debug] [MainThread]: Using postgres connection "master"
[0m09:14:27.350730 [debug] [MainThread]: On master: COMMIT
[0m09:14:27.352003 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:14:27.352646 [debug] [MainThread]: On master: Close
[0m09:14:27.353582 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:14:27.354186 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m09:14:27.354650 [debug] [MainThread]: Connection 'model.my_project.beer_report' was properly closed.
[0m09:14:27.355355 [debug] [MainThread]: Connection 'model.my_project.master_beer_table' was properly closed.
[0m09:14:27.356282 [info ] [MainThread]: 
[0m09:14:27.357375 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m09:14:27.363282 [debug] [MainThread]: Command end result
[0m09:14:27.412574 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:14:27.414938 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:14:27.430014 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:14:27.430760 [info ] [MainThread]: 
[0m09:14:27.432485 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:14:27.433313 [info ] [MainThread]: 
[0m09:14:27.437657 [error] [MainThread]:   Database Error in model master_beer_table (models/mart/master_beer_table.sql)
  syntax error at or near "from"
  LINE 25: from beers
           ^
  compiled code at target/run/my_project/models/mart/master_beer_table.sql
[0m09:14:27.438629 [info ] [MainThread]: 
[0m09:14:27.441071 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m09:14:27.443927 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.8597975, "process_in_blocks": "5128", "process_kernel_time": 1.17191, "process_mem_max_rss": "110372", "process_out_blocks": "2648", "process_user_time": 4.83563}
[0m09:14:27.445584 [debug] [MainThread]: Command `dbt run` failed at 09:14:27.445273 after 2.86 seconds
[0m09:14:27.446436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee15ad15430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee15b4e0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee15b4e0a10>]}
[0m09:14:27.447410 [debug] [MainThread]: Flushing usage events
[0m09:14:28.826393 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:21:42.501775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700c4a3ee4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700c489f8bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700c4938e300>]}


============================== 09:21:42.514572 | 501519da-7709-43a7-8f5d-4fbc166371a6 ==============================
[0m09:21:42.514572 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:21:42.517676 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select master_beer_info', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:21:42.826282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '501519da-7709-43a7-8f5d-4fbc166371a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700c4a5b3470>]}
[0m09:21:42.908386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '501519da-7709-43a7-8f5d-4fbc166371a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700c485b2390>]}
[0m09:21:42.909452 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:21:43.102216 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:21:43.280159 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:21:43.280641 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:21:43.339959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '501519da-7709-43a7-8f5d-4fbc166371a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700c46e2cad0>]}
[0m09:21:43.467419 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:21:43.470715 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:21:43.514129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '501519da-7709-43a7-8f5d-4fbc166371a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700c46b27590>]}
[0m09:21:43.514789 [info ] [MainThread]: Found 2 data tests, 3 models, 1 source, 429 macros
[0m09:21:43.515485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '501519da-7709-43a7-8f5d-4fbc166371a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700c46e2ec60>]}
[0m09:21:43.516777 [warn ] [MainThread]: The selection criterion 'master_beer_info' does not match any enabled nodes
[0m09:21:43.519774 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:21:43.523815 [debug] [MainThread]: Command end result
[0m09:21:43.899531 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:21:43.902760 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:21:43.912938 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:21:43.915774 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5308684, "process_in_blocks": "32", "process_kernel_time": 0.565246, "process_mem_max_rss": "99368", "process_out_blocks": "3320", "process_user_time": 2.774115}
[0m09:21:43.916902 [debug] [MainThread]: Command `dbt run` succeeded at 09:21:43.916672 after 1.53 seconds
[0m09:21:43.918057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700c48fda540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700c48663d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700c488796d0>]}
[0m09:21:43.919063 [debug] [MainThread]: Flushing usage events
[0m09:21:45.713941 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:22:18.246985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756d53ef5a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756d5596dfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756d5596dfd0>]}


============================== 09:22:18.255220 | 6172b1ea-e9d4-46e5-a7c5-bdebe321c209 ==============================
[0m09:22:18.255220 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:22:18.256095 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select master_beer_table', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:22:18.542376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6172b1ea-e9d4-46e5-a7c5-bdebe321c209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756d53a95af0>]}
[0m09:22:18.620884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6172b1ea-e9d4-46e5-a7c5-bdebe321c209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756d53cf7fe0>]}
[0m09:22:18.621903 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:22:18.763464 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:22:18.965425 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:22:18.965940 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:22:19.029212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6172b1ea-e9d4-46e5-a7c5-bdebe321c209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756d51f44860>]}
[0m09:22:19.153300 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:22:19.157320 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:22:19.420732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6172b1ea-e9d4-46e5-a7c5-bdebe321c209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756d51f8e330>]}
[0m09:22:19.422826 [info ] [MainThread]: Found 2 data tests, 3 models, 1 source, 429 macros
[0m09:22:19.424913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6172b1ea-e9d4-46e5-a7c5-bdebe321c209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756d51f73b90>]}
[0m09:22:19.432471 [info ] [MainThread]: 
[0m09:22:19.434484 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:22:19.437317 [info ] [MainThread]: 
[0m09:22:19.442256 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:22:19.448689 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:22:19.650359 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:22:19.651855 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:22:19.653289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:22:19.703720 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.050 seconds
[0m09:22:19.709471 [debug] [ThreadPool]: On list_db: Close
[0m09:22:19.730763 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m09:22:19.757474 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:22:19.758547 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m09:22:19.759379 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:22:19.785282 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m09:22:19.788028 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:22:19.789590 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:22:19.801725 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.011 seconds
[0m09:22:19.805400 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m09:22:19.806806 [debug] [ThreadPool]: On list_db_dev: Close
[0m09:22:19.822304 [debug] [MainThread]: Using postgres connection "master"
[0m09:22:19.824152 [debug] [MainThread]: On master: BEGIN
[0m09:22:19.825647 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:22:19.850390 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m09:22:19.851704 [debug] [MainThread]: Using postgres connection "master"
[0m09:22:19.853775 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:22:19.866165 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m09:22:19.870030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6172b1ea-e9d4-46e5-a7c5-bdebe321c209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756d51de6f90>]}
[0m09:22:19.871364 [debug] [MainThread]: On master: ROLLBACK
[0m09:22:19.872968 [debug] [MainThread]: Using postgres connection "master"
[0m09:22:19.873918 [debug] [MainThread]: On master: BEGIN
[0m09:22:19.876260 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:22:19.877513 [debug] [MainThread]: On master: COMMIT
[0m09:22:19.878434 [debug] [MainThread]: Using postgres connection "master"
[0m09:22:19.879306 [debug] [MainThread]: On master: COMMIT
[0m09:22:19.880303 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:22:19.881086 [debug] [MainThread]: On master: Close
[0m09:22:19.886947 [debug] [Thread-1 (]: Began running node model.my_project.master_beer_table
[0m09:22:19.888002 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.master_beer_table ............................. [RUN]
[0m09:22:19.889130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.master_beer_table)
[0m09:22:19.890202 [debug] [Thread-1 (]: Began compiling node model.my_project.master_beer_table
[0m09:22:19.906796 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.master_beer_table"
[0m09:22:19.908068 [debug] [Thread-1 (]: Began executing node model.my_project.master_beer_table
[0m09:22:19.969943 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.master_beer_table"
[0m09:22:19.970885 [debug] [Thread-1 (]: Using postgres connection "model.my_project.master_beer_table"
[0m09:22:19.971330 [debug] [Thread-1 (]: On model.my_project.master_beer_table: BEGIN
[0m09:22:19.971733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:19.983497 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m09:22:19.984085 [debug] [Thread-1 (]: Using postgres connection "model.my_project.master_beer_table"
[0m09:22:19.984934 [debug] [Thread-1 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */

  
    

  create  table "db"."dev"."master_beer_table__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    beer_id,
    beer_name,
    tagline as category,         -- treated as category/style
    description,
    abv as alcohol_percent,
    first_brewed,
from beers
  );
  
[0m09:22:19.985887 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 25: from beers
         ^

[0m09:22:19.986521 [debug] [Thread-1 (]: On model.my_project.master_beer_table: ROLLBACK
[0m09:22:19.987968 [debug] [Thread-1 (]: On model.my_project.master_beer_table: Close
[0m09:22:19.996997 [debug] [Thread-1 (]: Database Error in model master_beer_table (models/mart/master_beer_table.sql)
  syntax error at or near "from"
  LINE 25: from beers
           ^
  compiled code at target/run/my_project/models/mart/master_beer_table.sql
[0m09:22:20.001014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6172b1ea-e9d4-46e5-a7c5-bdebe321c209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756d5461e390>]}
[0m09:22:20.002624 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev.master_beer_table .................... [[31mERROR[0m in 0.11s]
[0m09:22:20.004211 [debug] [Thread-1 (]: Finished running node model.my_project.master_beer_table
[0m09:22:20.006059 [debug] [Thread-7 (]: Marking all children of 'model.my_project.master_beer_table' to be skipped because of status 'error'.  Reason: Database Error in model master_beer_table (models/mart/master_beer_table.sql)
  syntax error at or near "from"
  LINE 25: from beers
           ^
  compiled code at target/run/my_project/models/mart/master_beer_table.sql.
[0m09:22:20.014538 [debug] [MainThread]: Using postgres connection "master"
[0m09:22:20.015225 [debug] [MainThread]: On master: BEGIN
[0m09:22:20.016269 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:22:20.034754 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m09:22:20.037299 [debug] [MainThread]: On master: COMMIT
[0m09:22:20.038356 [debug] [MainThread]: Using postgres connection "master"
[0m09:22:20.039018 [debug] [MainThread]: On master: COMMIT
[0m09:22:20.040248 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:22:20.042447 [debug] [MainThread]: On master: Close
[0m09:22:20.043750 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:22:20.044910 [debug] [MainThread]: Connection 'model.my_project.master_beer_table' was properly closed.
[0m09:22:20.046064 [info ] [MainThread]: 
[0m09:22:20.047275 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m09:22:20.050780 [debug] [MainThread]: Command end result
[0m09:22:20.085038 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:22:20.088237 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:22:20.110423 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:22:20.111493 [info ] [MainThread]: 
[0m09:22:20.113219 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:22:20.115882 [info ] [MainThread]: 
[0m09:22:20.118102 [error] [MainThread]:   Database Error in model master_beer_table (models/mart/master_beer_table.sql)
  syntax error at or near "from"
  LINE 25: from beers
           ^
  compiled code at target/run/my_project/models/mart/master_beer_table.sql
[0m09:22:20.119443 [info ] [MainThread]: 
[0m09:22:20.121154 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:22:20.123961 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.9421266, "process_in_blocks": "0", "process_kernel_time": 0.620997, "process_mem_max_rss": "107128", "process_out_blocks": "3352", "process_user_time": 3.160719}
[0m09:22:20.125247 [debug] [MainThread]: Command `dbt run` failed at 09:22:20.125013 after 1.94 seconds
[0m09:22:20.126020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756d53d66ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756d53ae8a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756d54a361e0>]}
[0m09:22:20.126750 [debug] [MainThread]: Flushing usage events
[0m09:22:21.753307 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:23:09.288626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2a327bdb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2a32f68cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2a34356ab0>]}


============================== 09:23:09.300421 | 23442b33-179e-4915-93e5-ca6c37ce8d85 ==============================
[0m09:23:09.300421 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:23:09.301761 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select master_beer_table', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:23:09.663998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23442b33-179e-4915-93e5-ca6c37ce8d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2a325b2870>]}
[0m09:23:09.769144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23442b33-179e-4915-93e5-ca6c37ce8d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2a3283f0b0>]}
[0m09:23:09.770402 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:23:09.932452 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:23:10.165028 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:23:10.167113 [debug] [MainThread]: Partial parsing: updated file: my_project://models/mart/master_beer_table.sql
[0m09:23:10.667281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23442b33-179e-4915-93e5-ca6c37ce8d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2a30853dd0>]}
[0m09:23:10.788212 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:23:10.791521 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:23:10.825020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23442b33-179e-4915-93e5-ca6c37ce8d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2a308e0920>]}
[0m09:23:10.825656 [info ] [MainThread]: Found 2 data tests, 3 models, 1 source, 429 macros
[0m09:23:10.826226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23442b33-179e-4915-93e5-ca6c37ce8d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2a3079f200>]}
[0m09:23:10.828816 [info ] [MainThread]: 
[0m09:23:10.829479 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:23:10.830842 [info ] [MainThread]: 
[0m09:23:10.833154 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:23:10.837952 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:23:10.943843 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:23:10.944332 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:23:10.944778 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:23:10.959574 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m09:23:10.961531 [debug] [ThreadPool]: On list_db: Close
[0m09:23:10.968296 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m09:23:10.976616 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:23:10.977144 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m09:23:10.977563 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:23:11.007583 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m09:23:11.009832 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:23:11.012128 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:23:11.025312 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.011 seconds
[0m09:23:11.030722 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m09:23:11.032690 [debug] [ThreadPool]: On list_db_dev: Close
[0m09:23:11.056578 [debug] [MainThread]: Using postgres connection "master"
[0m09:23:11.058061 [debug] [MainThread]: On master: BEGIN
[0m09:23:11.059609 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:23:11.094282 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m09:23:11.096340 [debug] [MainThread]: Using postgres connection "master"
[0m09:23:11.099039 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:23:11.114827 [debug] [MainThread]: SQL status: SELECT 0 in 0.014 seconds
[0m09:23:11.121734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23442b33-179e-4915-93e5-ca6c37ce8d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2a3079f200>]}
[0m09:23:11.124067 [debug] [MainThread]: On master: ROLLBACK
[0m09:23:11.126593 [debug] [MainThread]: Using postgres connection "master"
[0m09:23:11.128239 [debug] [MainThread]: On master: BEGIN
[0m09:23:11.131727 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m09:23:11.134092 [debug] [MainThread]: On master: COMMIT
[0m09:23:11.136004 [debug] [MainThread]: Using postgres connection "master"
[0m09:23:11.137762 [debug] [MainThread]: On master: COMMIT
[0m09:23:11.140972 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:23:11.143011 [debug] [MainThread]: On master: Close
[0m09:23:11.157395 [debug] [Thread-1 (]: Began running node model.my_project.master_beer_table
[0m09:23:11.160414 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.master_beer_table ............................. [RUN]
[0m09:23:11.162729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.master_beer_table)
[0m09:23:11.165371 [debug] [Thread-1 (]: Began compiling node model.my_project.master_beer_table
[0m09:23:11.198954 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.master_beer_table"
[0m09:23:11.201559 [debug] [Thread-1 (]: Began executing node model.my_project.master_beer_table
[0m09:23:11.300409 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.master_beer_table"
[0m09:23:11.301451 [debug] [Thread-1 (]: Using postgres connection "model.my_project.master_beer_table"
[0m09:23:11.301969 [debug] [Thread-1 (]: On model.my_project.master_beer_table: BEGIN
[0m09:23:11.302489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:23:11.315849 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m09:23:11.316763 [debug] [Thread-1 (]: Using postgres connection "model.my_project.master_beer_table"
[0m09:23:11.317337 [debug] [Thread-1 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */

  
    

  create  table "db"."dev"."master_beer_table__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    beer_id,
    beer_name,
    tagline as category,         -- category/style approximation
    description,
    abv as alcohol_percent,
    ibu as bitterness,
    ebc as color_scale,
    first_brewed,
    contributed_by,
    inserted_at
from beers
  );
  
[0m09:23:11.325134 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.007 seconds
[0m09:23:11.333711 [debug] [Thread-1 (]: Using postgres connection "model.my_project.master_beer_table"
[0m09:23:11.334251 [debug] [Thread-1 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */
alter table "db"."dev"."master_beer_table__dbt_tmp" rename to "master_beer_table"
[0m09:23:11.335317 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:23:11.359918 [debug] [Thread-1 (]: On model.my_project.master_beer_table: COMMIT
[0m09:23:11.360546 [debug] [Thread-1 (]: Using postgres connection "model.my_project.master_beer_table"
[0m09:23:11.361047 [debug] [Thread-1 (]: On model.my_project.master_beer_table: COMMIT
[0m09:23:11.399112 [debug] [Thread-1 (]: SQL status: COMMIT in 0.037 seconds
[0m09:23:11.417480 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."master_beer_table__dbt_backup"
[0m09:23:11.433776 [debug] [Thread-1 (]: Using postgres connection "model.my_project.master_beer_table"
[0m09:23:11.434519 [debug] [Thread-1 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */
drop table if exists "db"."dev"."master_beer_table__dbt_backup" cascade
[0m09:23:11.436036 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m09:23:11.440187 [debug] [Thread-1 (]: On model.my_project.master_beer_table: Close
[0m09:23:11.443313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23442b33-179e-4915-93e5-ca6c37ce8d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2a343063c0>]}
[0m09:23:11.444595 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.master_beer_table ........................ [[32mSELECT 414[0m in 0.28s]
[0m09:23:11.446348 [debug] [Thread-1 (]: Finished running node model.my_project.master_beer_table
[0m09:23:11.450226 [debug] [MainThread]: Using postgres connection "master"
[0m09:23:11.450929 [debug] [MainThread]: On master: BEGIN
[0m09:23:11.451609 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:23:11.469718 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m09:23:11.470628 [debug] [MainThread]: On master: COMMIT
[0m09:23:11.471789 [debug] [MainThread]: Using postgres connection "master"
[0m09:23:11.472908 [debug] [MainThread]: On master: COMMIT
[0m09:23:11.474683 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:23:11.476153 [debug] [MainThread]: On master: Close
[0m09:23:11.477501 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:23:11.478751 [debug] [MainThread]: Connection 'model.my_project.master_beer_table' was properly closed.
[0m09:23:11.479849 [info ] [MainThread]: 
[0m09:23:11.480803 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m09:23:11.483437 [debug] [MainThread]: Command end result
[0m09:23:11.534286 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:23:11.537475 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:23:11.551040 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:23:11.551651 [info ] [MainThread]: 
[0m09:23:11.552416 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:23:11.553184 [info ] [MainThread]: 
[0m09:23:11.554182 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:23:11.556400 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3668242, "process_in_blocks": "0", "process_kernel_time": 0.571168, "process_mem_max_rss": "110532", "process_out_blocks": "4200", "process_user_time": 3.768906}
[0m09:23:11.557204 [debug] [MainThread]: Command `dbt run` succeeded at 09:23:11.557014 after 2.37 seconds
[0m09:23:11.557726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2a327bdb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2a3292ab10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2a2a7aef90>]}
[0m09:23:11.558287 [debug] [MainThread]: Flushing usage events
[0m09:23:13.140497 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:24:37.327713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4bfb647140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4bfd303800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4bfd0940b0>]}


============================== 09:24:37.337685 | a7abb17f-9908-4807-a6da-88c60b3e24b6 ==============================
[0m09:24:37.337685 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:24:37.338525 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select master_beer_table', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:24:37.858390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7abb17f-9908-4807-a6da-88c60b3e24b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4bf97d6d20>]}
[0m09:24:37.965662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7abb17f-9908-4807-a6da-88c60b3e24b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4bfd303800>]}
[0m09:24:37.968872 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:24:38.174387 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:24:38.371622 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:24:38.372546 [debug] [MainThread]: Partial parsing: updated file: my_project://models/mart/master_beer_table.sql
[0m09:24:39.086692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7abb17f-9908-4807-a6da-88c60b3e24b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4bf94b5520>]}
[0m09:24:39.311244 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:24:39.315619 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:24:39.364934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7abb17f-9908-4807-a6da-88c60b3e24b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4bf97bbd70>]}
[0m09:24:39.365788 [info ] [MainThread]: Found 2 data tests, 3 models, 1 source, 429 macros
[0m09:24:39.366471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7abb17f-9908-4807-a6da-88c60b3e24b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4bf94a2990>]}
[0m09:24:39.369292 [info ] [MainThread]: 
[0m09:24:39.369976 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:24:39.370905 [info ] [MainThread]: 
[0m09:24:39.372377 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:24:39.374499 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:24:39.584115 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:24:39.584759 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:24:39.585303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:24:39.602899 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.017 seconds
[0m09:24:39.605522 [debug] [ThreadPool]: On list_db: Close
[0m09:24:39.613936 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m09:24:39.622541 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:24:39.623100 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m09:24:39.623616 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:24:39.638210 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m09:24:39.639112 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:24:39.639985 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:24:39.646160 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m09:24:39.648429 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m09:24:39.649393 [debug] [ThreadPool]: On list_db_dev: Close
[0m09:24:39.659417 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:39.659998 [debug] [MainThread]: On master: BEGIN
[0m09:24:39.660428 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:24:39.674151 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m09:24:39.675578 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:39.676380 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:24:39.684084 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m09:24:39.688053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7abb17f-9908-4807-a6da-88c60b3e24b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4bfb05b590>]}
[0m09:24:39.689128 [debug] [MainThread]: On master: ROLLBACK
[0m09:24:39.690767 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:39.691914 [debug] [MainThread]: On master: BEGIN
[0m09:24:39.693534 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:24:39.695095 [debug] [MainThread]: On master: COMMIT
[0m09:24:39.696405 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:39.697320 [debug] [MainThread]: On master: COMMIT
[0m09:24:39.698424 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:24:39.699065 [debug] [MainThread]: On master: Close
[0m09:24:39.704328 [debug] [Thread-1 (]: Began running node model.my_project.master_beer_table
[0m09:24:39.705282 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.master_beer_table ............................. [RUN]
[0m09:24:39.706232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.master_beer_table)
[0m09:24:39.706972 [debug] [Thread-1 (]: Began compiling node model.my_project.master_beer_table
[0m09:24:39.719066 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.master_beer_table"
[0m09:24:39.719976 [debug] [Thread-1 (]: Began executing node model.my_project.master_beer_table
[0m09:24:39.784752 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.master_beer_table"
[0m09:24:39.785785 [debug] [Thread-1 (]: Using postgres connection "model.my_project.master_beer_table"
[0m09:24:39.786300 [debug] [Thread-1 (]: On model.my_project.master_beer_table: BEGIN
[0m09:24:39.786786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:24:39.799247 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m09:24:39.800077 [debug] [Thread-1 (]: Using postgres connection "model.my_project.master_beer_table"
[0m09:24:39.800775 [debug] [Thread-1 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */

  
    

  create  table "db"."dev"."master_beer_table__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    beer_id,
    beer_name,
    tagline as category,         -- category/style approximation
    description,
    abv as alcohol_percent,
    first_brewed
from beers
  );
  
[0m09:24:39.808636 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.007 seconds
[0m09:24:39.820232 [debug] [Thread-1 (]: Using postgres connection "model.my_project.master_beer_table"
[0m09:24:39.821256 [debug] [Thread-1 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */
alter table "db"."dev"."master_beer_table" rename to "master_beer_table__dbt_backup"
[0m09:24:39.822951 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:24:39.835349 [debug] [Thread-1 (]: Using postgres connection "model.my_project.master_beer_table"
[0m09:24:39.836259 [debug] [Thread-1 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */
alter table "db"."dev"."master_beer_table__dbt_tmp" rename to "master_beer_table"
[0m09:24:39.837803 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:24:39.898808 [debug] [Thread-1 (]: On model.my_project.master_beer_table: COMMIT
[0m09:24:39.899834 [debug] [Thread-1 (]: Using postgres connection "model.my_project.master_beer_table"
[0m09:24:39.900416 [debug] [Thread-1 (]: On model.my_project.master_beer_table: COMMIT
[0m09:24:39.998536 [debug] [Thread-1 (]: SQL status: COMMIT in 0.097 seconds
[0m09:24:40.029641 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."master_beer_table__dbt_backup"
[0m09:24:40.083544 [debug] [Thread-1 (]: Using postgres connection "model.my_project.master_beer_table"
[0m09:24:40.085163 [debug] [Thread-1 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */
drop table if exists "db"."dev"."master_beer_table__dbt_backup" cascade
[0m09:24:40.096608 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m09:24:40.106529 [debug] [Thread-1 (]: On model.my_project.master_beer_table: Close
[0m09:24:40.117573 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7abb17f-9908-4807-a6da-88c60b3e24b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4bfd0022d0>]}
[0m09:24:40.121878 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.master_beer_table ........................ [[32mSELECT 414[0m in 0.40s]
[0m09:24:40.125488 [debug] [Thread-1 (]: Finished running node model.my_project.master_beer_table
[0m09:24:40.135705 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:40.138149 [debug] [MainThread]: On master: BEGIN
[0m09:24:40.139942 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:24:40.182943 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m09:24:40.185080 [debug] [MainThread]: On master: COMMIT
[0m09:24:40.187692 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:40.189530 [debug] [MainThread]: On master: COMMIT
[0m09:24:40.191914 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:24:40.197421 [debug] [MainThread]: On master: Close
[0m09:24:40.201598 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:24:40.203746 [debug] [MainThread]: Connection 'model.my_project.master_beer_table' was properly closed.
[0m09:24:40.205700 [info ] [MainThread]: 
[0m09:24:40.207897 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m09:24:40.216310 [debug] [MainThread]: Command end result
[0m09:24:40.297721 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:24:40.300009 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:24:40.308696 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:24:40.309177 [info ] [MainThread]: 
[0m09:24:40.309891 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:24:40.311099 [info ] [MainThread]: 
[0m09:24:40.312087 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:24:40.314245 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.0471656, "process_in_blocks": "0", "process_kernel_time": 0.669842, "process_mem_max_rss": "109124", "process_out_blocks": "4192", "process_user_time": 4.61493}
[0m09:24:40.315003 [debug] [MainThread]: Command `dbt run` succeeded at 09:24:40.314823 after 3.05 seconds
[0m09:24:40.315507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4bfb397ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4bfb646a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4bf988bfb0>]}
[0m09:24:40.316034 [debug] [MainThread]: Flushing usage events
[0m09:24:41.946145 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:37:38.690898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ceee235b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ceedd37e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ceec719700>]}


============================== 09:37:38.699474 | 09709f21-1c5c-4ba9-ba4a-059f81784779 ==============================
[0m09:37:38.699474 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:37:38.700383 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select malt_per_beer', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:37:39.041762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09709f21-1c5c-4ba9-ba4a-059f81784779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ceec719d00>]}
[0m09:37:39.133977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09709f21-1c5c-4ba9-ba4a-059f81784779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ceec361eb0>]}
[0m09:37:39.135025 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:37:39.282664 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:37:39.514153 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:37:39.514951 [debug] [MainThread]: Partial parsing: added file: my_project://models/mart/malt_per_beer.sql
[0m09:37:40.032864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09709f21-1c5c-4ba9-ba4a-059f81784779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ceea799b80>]}
[0m09:37:40.184413 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:37:40.333993 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:37:40.411155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09709f21-1c5c-4ba9-ba4a-059f81784779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ceea851cd0>]}
[0m09:37:40.411905 [info ] [MainThread]: Found 2 data tests, 4 models, 1 source, 429 macros
[0m09:37:40.412562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09709f21-1c5c-4ba9-ba4a-059f81784779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ceec980590>]}
[0m09:37:40.415690 [info ] [MainThread]: 
[0m09:37:40.417036 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:37:40.418309 [info ] [MainThread]: 
[0m09:37:40.419746 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:37:40.423813 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:37:40.507723 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:37:40.508283 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:37:40.508741 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:37:40.525337 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m09:37:40.527269 [debug] [ThreadPool]: On list_db: Close
[0m09:37:40.528387 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now create_db_dev_dev)
[0m09:37:40.529286 [debug] [ThreadPool]: Creating schema "database: "db"
schema: "dev_dev"
"
[0m09:37:40.536914 [debug] [ThreadPool]: Using postgres connection "create_db_dev_dev"
[0m09:37:40.537512 [debug] [ThreadPool]: On create_db_dev_dev: BEGIN
[0m09:37:40.537969 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:37:40.550237 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m09:37:40.551395 [debug] [ThreadPool]: Using postgres connection "create_db_dev_dev"
[0m09:37:40.551980 [debug] [ThreadPool]: On create_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "create_db_dev_dev"} */
create schema if not exists "dev_dev"
[0m09:37:40.554362 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m09:37:40.556436 [debug] [ThreadPool]: On create_db_dev_dev: COMMIT
[0m09:37:40.557295 [debug] [ThreadPool]: Using postgres connection "create_db_dev_dev"
[0m09:37:40.558745 [debug] [ThreadPool]: On create_db_dev_dev: COMMIT
[0m09:37:40.565328 [debug] [ThreadPool]: SQL status: COMMIT in 0.005 seconds
[0m09:37:40.566034 [debug] [ThreadPool]: On create_db_dev_dev: Close
[0m09:37:40.572909 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_db_dev_dev, now list_db_dev)
[0m09:37:40.579246 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_dev_dev'
[0m09:37:40.583459 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:37:40.586212 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m09:37:40.586938 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m09:37:40.587509 [debug] [ThreadPool]: On list_db_dev_dev: BEGIN
[0m09:37:40.588121 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:37:40.588717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:37:40.601317 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m09:37:40.601996 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m09:37:40.602982 [debug] [ThreadPool]: On list_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_dev'
  
[0m09:37:40.603648 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m09:37:40.604562 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:37:40.605462 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:37:40.609212 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m09:37:40.611978 [debug] [ThreadPool]: On list_db_dev_dev: ROLLBACK
[0m09:37:40.612619 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m09:37:40.615561 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m09:37:40.616329 [debug] [ThreadPool]: On list_db_dev_dev: Close
[0m09:37:40.616761 [debug] [ThreadPool]: On list_db_dev: Close
[0m09:37:40.626566 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:40.627205 [debug] [MainThread]: On master: BEGIN
[0m09:37:40.627635 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:37:40.641852 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m09:37:40.642741 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:40.643528 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:37:40.649174 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m09:37:40.651855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09709f21-1c5c-4ba9-ba4a-059f81784779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ceea75cef0>]}
[0m09:37:40.652757 [debug] [MainThread]: On master: ROLLBACK
[0m09:37:40.654169 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:40.654792 [debug] [MainThread]: On master: BEGIN
[0m09:37:40.656169 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:37:40.656938 [debug] [MainThread]: On master: COMMIT
[0m09:37:40.657662 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:40.658292 [debug] [MainThread]: On master: COMMIT
[0m09:37:40.659103 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:37:40.659557 [debug] [MainThread]: On master: Close
[0m09:37:40.664293 [debug] [Thread-1 (]: Began running node model.my_project.malt_per_beer
[0m09:37:40.665432 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_dev.malt_per_beer ............................. [RUN]
[0m09:37:40.666366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.malt_per_beer)
[0m09:37:40.667354 [debug] [Thread-1 (]: Began compiling node model.my_project.malt_per_beer
[0m09:37:40.681121 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.malt_per_beer"
[0m09:37:40.682120 [debug] [Thread-1 (]: Began executing node model.my_project.malt_per_beer
[0m09:37:40.749182 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.malt_per_beer"
[0m09:37:40.750897 [debug] [Thread-1 (]: Using postgres connection "model.my_project.malt_per_beer"
[0m09:37:40.751859 [debug] [Thread-1 (]: On model.my_project.malt_per_beer: BEGIN
[0m09:37:40.752495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:37:40.764491 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m09:37:40.765551 [debug] [Thread-1 (]: Using postgres connection "model.my_project.malt_per_beer"
[0m09:37:40.766518 [debug] [Thread-1 (]: On model.my_project.malt_per_beer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.malt_per_beer"} */

  
    

  create  table "db"."dev_dev"."malt_per_beer__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select
        beer_id,
        ingredients
    from "db"."dev"."staging"
),

malts as (
    select
        beer_id,
        malt ->> 'name' as malt_type,
        (malt -> 'amount' ->> 'value')::numeric as amount,
        malt -> 'amount' ->> 'unit' as unit
    from source,
    jsonb_array_elements(ingredients -> 'malt') as malt
)

select * from malts
  );
  
[0m09:37:40.769358 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "ingredients" does not exist
LINE 17:         ingredients
                 ^

[0m09:37:40.770707 [debug] [Thread-1 (]: On model.my_project.malt_per_beer: ROLLBACK
[0m09:37:40.772889 [debug] [Thread-1 (]: On model.my_project.malt_per_beer: Close
[0m09:37:40.782807 [debug] [Thread-1 (]: Database Error in model malt_per_beer (models/mart/malt_per_beer.sql)
  column "ingredients" does not exist
  LINE 17:         ingredients
                   ^
  compiled code at target/run/my_project/models/mart/malt_per_beer.sql
[0m09:37:40.787933 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09709f21-1c5c-4ba9-ba4a-059f81784779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cee882eed0>]}
[0m09:37:40.790931 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_dev.malt_per_beer .................... [[31mERROR[0m in 0.12s]
[0m09:37:40.793390 [debug] [Thread-1 (]: Finished running node model.my_project.malt_per_beer
[0m09:37:40.795283 [debug] [Thread-7 (]: Marking all children of 'model.my_project.malt_per_beer' to be skipped because of status 'error'.  Reason: Database Error in model malt_per_beer (models/mart/malt_per_beer.sql)
  column "ingredients" does not exist
  LINE 17:         ingredients
                   ^
  compiled code at target/run/my_project/models/mart/malt_per_beer.sql.
[0m09:37:40.802684 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:40.804073 [debug] [MainThread]: On master: BEGIN
[0m09:37:40.804989 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:37:40.828937 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m09:37:40.830002 [debug] [MainThread]: On master: COMMIT
[0m09:37:40.831054 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:40.832460 [debug] [MainThread]: On master: COMMIT
[0m09:37:40.834312 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:37:40.835284 [debug] [MainThread]: On master: Close
[0m09:37:40.836084 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:37:40.837023 [debug] [MainThread]: Connection 'model.my_project.malt_per_beer' was properly closed.
[0m09:37:40.839208 [debug] [MainThread]: Connection 'list_db_dev_dev' was properly closed.
[0m09:37:40.840168 [info ] [MainThread]: 
[0m09:37:40.840873 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m09:37:40.842622 [debug] [MainThread]: Command end result
[0m09:37:40.879946 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:37:40.882380 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:37:40.892558 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:37:40.893296 [info ] [MainThread]: 
[0m09:37:40.894102 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:37:40.894986 [info ] [MainThread]: 
[0m09:37:40.895949 [error] [MainThread]:   Database Error in model malt_per_beer (models/mart/malt_per_beer.sql)
  column "ingredients" does not exist
  LINE 17:         ingredients
                   ^
  compiled code at target/run/my_project/models/mart/malt_per_beer.sql
[0m09:37:40.896720 [info ] [MainThread]: 
[0m09:37:40.897533 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:37:40.899617 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.2844074, "process_in_blocks": "0", "process_kernel_time": 0.614292, "process_mem_max_rss": "110556", "process_out_blocks": "4232", "process_user_time": 4.199674}
[0m09:37:40.900615 [debug] [MainThread]: Command `dbt run` failed at 09:37:40.900292 after 2.29 seconds
[0m09:37:40.902071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ceed550a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ceec317410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ceecf64fe0>]}
[0m09:37:40.903260 [debug] [MainThread]: Flushing usage events
[0m09:37:42.368179 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:43:55.575575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d169d8e6210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d169d68c590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d169bee8bf0>]}


============================== 09:43:55.584771 | f88a4c46-6914-44c4-989a-8652ad449187 ==============================
[0m09:43:55.584771 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:43:55.585642 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:43:55.910745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f88a4c46-6914-44c4-989a-8652ad449187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d169b6f5fd0>]}
[0m09:43:55.995042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f88a4c46-6914-44c4-989a-8652ad449187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d169c2b5970>]}
[0m09:43:55.996154 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:43:56.163683 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:43:56.379142 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:43:56.379701 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:43:56.442120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f88a4c46-6914-44c4-989a-8652ad449187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1699ddeff0>]}
[0m09:43:56.648893 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:43:56.654121 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:43:56.700551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f88a4c46-6914-44c4-989a-8652ad449187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1699b612e0>]}
[0m09:43:56.701297 [info ] [MainThread]: Found 2 data tests, 4 models, 1 source, 429 macros
[0m09:43:56.701860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f88a4c46-6914-44c4-989a-8652ad449187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d169b8b72c0>]}
[0m09:43:56.704900 [info ] [MainThread]: 
[0m09:43:56.705530 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:43:56.706178 [info ] [MainThread]: 
[0m09:43:56.707138 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:43:57.029424 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:43:57.030892 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:43:57.166247 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:43:57.166894 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:43:57.167586 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:43:57.168404 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:43:57.169132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:43:57.169908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:43:57.193931 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.025 seconds
[0m09:43:57.196749 [debug] [ThreadPool]: On list_db: Close
[0m09:43:57.197361 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.027 seconds
[0m09:43:57.199684 [debug] [ThreadPool]: On list_db: Close
[0m09:43:57.207294 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev_dev)
[0m09:43:57.208975 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m09:43:57.217796 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m09:43:57.220146 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:43:57.220697 [debug] [ThreadPool]: On list_db_dev_dev: BEGIN
[0m09:43:57.221325 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m09:43:57.221818 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:43:57.222315 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:43:57.235525 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m09:43:57.236717 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m09:43:57.237452 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m09:43:57.237955 [debug] [ThreadPool]: On list_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_dev'
  
[0m09:43:57.238661 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:43:57.239520 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:43:57.243322 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m09:43:57.244124 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m09:43:57.246288 [debug] [ThreadPool]: On list_db_dev_dev: ROLLBACK
[0m09:43:57.248314 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m09:43:57.249270 [debug] [ThreadPool]: On list_db_dev_dev: Close
[0m09:43:57.249708 [debug] [ThreadPool]: On list_db_dev: Close
[0m09:43:57.259534 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:57.260203 [debug] [MainThread]: On master: BEGIN
[0m09:43:57.260654 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:43:57.275075 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m09:43:57.275723 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:57.276764 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:43:57.290702 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m09:43:57.292896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f88a4c46-6914-44c4-989a-8652ad449187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1699b78b90>]}
[0m09:43:57.293576 [debug] [MainThread]: On master: ROLLBACK
[0m09:43:57.294420 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:57.294903 [debug] [MainThread]: On master: BEGIN
[0m09:43:57.296123 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:43:57.296614 [debug] [MainThread]: On master: COMMIT
[0m09:43:57.297200 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:57.297780 [debug] [MainThread]: On master: COMMIT
[0m09:43:57.298537 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:43:57.299012 [debug] [MainThread]: On master: Close
[0m09:43:57.304466 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m09:43:57.305530 [info ] [Thread-1 (]: 1 of 4 START sql table model dev.staging ....................................... [RUN]
[0m09:43:57.306390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m09:43:57.306956 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m09:43:57.317260 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m09:43:57.318091 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m09:43:57.369983 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m09:43:57.371097 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:43:57.371569 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m09:43:57.372092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:43:57.384573 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m09:43:57.385452 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:43:57.386036 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * 
    from "db"."dev"."raw_beer_data"
)

select 
    id,
    beer_id,
    name as beer_name,
    tagline,
    first_brewed,
    description,
    image,
    abv,
    ibu,
    ebc,
    ph,
    brewers_tips,
    contributed_by,
    inserted_at
from source
  );
  
[0m09:43:57.795189 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.408 seconds
[0m09:43:57.828196 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:43:57.829709 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m09:43:57.832117 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:43:57.839264 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:43:57.840521 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m09:43:57.842361 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:43:57.890878 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m09:43:57.891561 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:43:57.892129 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m09:43:58.998692 [debug] [Thread-1 (]: SQL status: COMMIT in 1.106 seconds
[0m09:43:59.014359 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m09:43:59.024027 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:43:59.024680 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m09:43:59.032104 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m09:43:59.042441 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m09:43:59.045069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f88a4c46-6914-44c4-989a-8652ad449187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d169c1e6810>]}
[0m09:43:59.046032 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dev.staging .................................. [[32mSELECT 414[0m in 1.74s]
[0m09:43:59.047254 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m09:43:59.048985 [debug] [Thread-3 (]: Began running node model.my_project.beer_report
[0m09:43:59.049609 [debug] [Thread-4 (]: Began running node model.my_project.malt_per_beer
[0m09:43:59.050448 [info ] [Thread-3 (]: 2 of 4 START sql table model dev.beer_report ................................... [RUN]
[0m09:43:59.051550 [debug] [Thread-2 (]: Began running node model.my_project.master_beer_table
[0m09:43:59.053014 [info ] [Thread-4 (]: 3 of 4 START sql table model dev_dev.malt_per_beer ............................. [RUN]
[0m09:43:59.054383 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.beer_report'
[0m09:43:59.055345 [info ] [Thread-2 (]: 4 of 4 START sql table model dev.master_beer_table ............................. [RUN]
[0m09:43:59.056738 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.malt_per_beer'
[0m09:43:59.057582 [debug] [Thread-3 (]: Began compiling node model.my_project.beer_report
[0m09:43:59.058280 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_dev_dev, now model.my_project.master_beer_table)
[0m09:43:59.058991 [debug] [Thread-4 (]: Began compiling node model.my_project.malt_per_beer
[0m09:43:59.063295 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.beer_report"
[0m09:43:59.064030 [debug] [Thread-2 (]: Began compiling node model.my_project.master_beer_table
[0m09:43:59.069483 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.malt_per_beer"
[0m09:43:59.074437 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_project.master_beer_table"
[0m09:43:59.075703 [debug] [Thread-3 (]: Began executing node model.my_project.beer_report
[0m09:43:59.077000 [debug] [Thread-4 (]: Began executing node model.my_project.malt_per_beer
[0m09:43:59.082031 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.beer_report"
[0m09:43:59.083209 [debug] [Thread-2 (]: Began executing node model.my_project.master_beer_table
[0m09:43:59.087813 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.malt_per_beer"
[0m09:43:59.093272 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_project.master_beer_table"
[0m09:43:59.094456 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m09:43:59.095212 [debug] [Thread-4 (]: Using postgres connection "model.my_project.malt_per_beer"
[0m09:43:59.096110 [debug] [Thread-3 (]: On model.my_project.beer_report: BEGIN
[0m09:43:59.096980 [debug] [Thread-4 (]: On model.my_project.malt_per_beer: BEGIN
[0m09:43:59.097471 [debug] [Thread-2 (]: Using postgres connection "model.my_project.master_beer_table"
[0m09:43:59.098195 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:43:59.098973 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:43:59.099645 [debug] [Thread-2 (]: On model.my_project.master_beer_table: BEGIN
[0m09:43:59.102114 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:43:59.115008 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m09:43:59.116517 [debug] [Thread-4 (]: Using postgres connection "model.my_project.malt_per_beer"
[0m09:43:59.117539 [debug] [Thread-4 (]: On model.my_project.malt_per_beer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.malt_per_beer"} */

  
    

  create  table "db"."dev_dev"."malt_per_beer__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select
        beer_id,
        ingredients
    from "db"."dev"."staging"
),

malts as (
    select
        beer_id,
        malt ->> 'name' as malt_type,
        (malt -> 'amount' ->> 'value')::numeric as amount,
        malt -> 'amount' ->> 'unit' as unit
    from source,
    jsonb_array_elements(ingredients -> 'malt') as malt
)

select * from malts
  );
  
[0m09:43:59.119194 [debug] [Thread-3 (]: SQL status: BEGIN in 0.021 seconds
[0m09:43:59.120157 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m09:43:59.120889 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column "ingredients" does not exist
LINE 17:         ingredients
                 ^

[0m09:43:59.122007 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */

  
    

  create  table "db"."dev"."beer_report__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    count(*) as total_beers,
    round(avg(abv)::numeric, 2) as avg_abv,
    round(min(abv)::numeric, 2) as min_abv,
    round(max(abv)::numeric, 2) as max_abv,
    round(avg(ibu)::numeric, 2) as avg_ibu,
    round(min(ibu)::numeric, 2) as min_ibu,
    round(max(ibu)::numeric, 2) as max_ibu,
    round(avg(ebc)::numeric, 2) as avg_ebc,
    round(min(ebc)::numeric, 2) as min_ebc,
    round(max(ebc)::numeric, 2) as max_ebc,
    round(avg(ph)::numeric, 2) as avg_ph,
    min(first_brewed) as oldest_brew,
    max(first_brewed) as newest_brew,
    count(distinct contributed_by) as unique_contributors
from beers
  );
  
[0m09:43:59.123442 [debug] [Thread-2 (]: SQL status: BEGIN in 0.022 seconds
[0m09:43:59.125949 [debug] [Thread-2 (]: Using postgres connection "model.my_project.master_beer_table"
[0m09:43:59.124487 [debug] [Thread-4 (]: On model.my_project.malt_per_beer: ROLLBACK
[0m09:43:59.127134 [debug] [Thread-2 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */

  
    

  create  table "db"."dev"."master_beer_table__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    beer_id,
    beer_name,
    tagline as category,         -- category/style approximation
    description,
    abv as alcohol_percent,
    first_brewed
from beers
  );
  
[0m09:43:59.129882 [debug] [Thread-4 (]: On model.my_project.malt_per_beer: Close
[0m09:43:59.152108 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.026 seconds
[0m09:43:59.155036 [debug] [Thread-4 (]: Database Error in model malt_per_beer (models/mart/malt_per_beer.sql)
  column "ingredients" does not exist
  LINE 17:         ingredients
                   ^
  compiled code at target/run/my_project/models/mart/malt_per_beer.sql
[0m09:43:59.171773 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f88a4c46-6914-44c4-989a-8652ad449187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d169d0ef770>]}
[0m09:43:59.169221 [debug] [Thread-2 (]: SQL status: SELECT 414 in 0.039 seconds
[0m09:43:59.176008 [error] [Thread-4 (]: 3 of 4 ERROR creating sql table model dev_dev.malt_per_beer .................... [[31mERROR[0m in 0.12s]
[0m09:43:59.181171 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m09:43:59.195018 [debug] [Thread-2 (]: Using postgres connection "model.my_project.master_beer_table"
[0m09:43:59.196575 [debug] [Thread-4 (]: Finished running node model.my_project.malt_per_beer
[0m09:43:59.197934 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report" rename to "beer_report__dbt_backup"
[0m09:43:59.198852 [debug] [Thread-2 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */
alter table "db"."dev"."master_beer_table" rename to "master_beer_table__dbt_backup"
[0m09:43:59.201336 [debug] [Thread-7 (]: Marking all children of 'model.my_project.malt_per_beer' to be skipped because of status 'error'.  Reason: Database Error in model malt_per_beer (models/mart/malt_per_beer.sql)
  column "ingredients" does not exist
  LINE 17:         ingredients
                   ^
  compiled code at target/run/my_project/models/mart/malt_per_beer.sql.
[0m09:43:59.204912 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:43:59.205695 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:43:59.209891 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m09:43:59.213892 [debug] [Thread-2 (]: Using postgres connection "model.my_project.master_beer_table"
[0m09:43:59.214537 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report__dbt_tmp" rename to "beer_report"
[0m09:43:59.215168 [debug] [Thread-2 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */
alter table "db"."dev"."master_beer_table__dbt_tmp" rename to "master_beer_table"
[0m09:43:59.216683 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:43:59.217440 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:43:59.220126 [debug] [Thread-2 (]: On model.my_project.master_beer_table: COMMIT
[0m09:43:59.222528 [debug] [Thread-3 (]: On model.my_project.beer_report: COMMIT
[0m09:43:59.223168 [debug] [Thread-2 (]: Using postgres connection "model.my_project.master_beer_table"
[0m09:43:59.223771 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m09:43:59.224478 [debug] [Thread-2 (]: On model.my_project.master_beer_table: COMMIT
[0m09:43:59.225047 [debug] [Thread-3 (]: On model.my_project.beer_report: COMMIT
[0m09:43:59.239647 [debug] [Thread-2 (]: SQL status: COMMIT in 0.014 seconds
[0m09:43:59.240305 [debug] [Thread-3 (]: SQL status: COMMIT in 0.014 seconds
[0m09:43:59.243432 [debug] [Thread-2 (]: Applying DROP to: "db"."dev"."master_beer_table__dbt_backup"
[0m09:43:59.248154 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."beer_report__dbt_backup"
[0m09:43:59.249290 [debug] [Thread-2 (]: Using postgres connection "model.my_project.master_beer_table"
[0m09:43:59.250484 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m09:43:59.251254 [debug] [Thread-2 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */
drop table if exists "db"."dev"."master_beer_table__dbt_backup" cascade
[0m09:43:59.251866 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
drop table if exists "db"."dev"."beer_report__dbt_backup" cascade
[0m09:43:59.447037 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.194 seconds
[0m09:43:59.449214 [debug] [Thread-3 (]: On model.my_project.beer_report: Close
[0m09:43:59.450093 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f88a4c46-6914-44c4-989a-8652ad449187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1698437f20>]}
[0m09:43:59.450922 [info ] [Thread-3 (]: 2 of 4 OK created sql table model dev.beer_report .............................. [[32mSELECT 1[0m in 0.40s]
[0m09:43:59.452246 [debug] [Thread-3 (]: Finished running node model.my_project.beer_report
[0m09:43:59.456240 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.204 seconds
[0m09:43:59.458294 [debug] [Thread-2 (]: On model.my_project.master_beer_table: Close
[0m09:43:59.459147 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f88a4c46-6914-44c4-989a-8652ad449187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d169846a270>]}
[0m09:43:59.460269 [info ] [Thread-2 (]: 4 of 4 OK created sql table model dev.master_beer_table ........................ [[32mSELECT 414[0m in 0.40s]
[0m09:43:59.461439 [debug] [Thread-2 (]: Finished running node model.my_project.master_beer_table
[0m09:43:59.464846 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:59.465490 [debug] [MainThread]: On master: BEGIN
[0m09:43:59.466116 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:43:59.485606 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m09:43:59.486483 [debug] [MainThread]: On master: COMMIT
[0m09:43:59.487357 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:59.487924 [debug] [MainThread]: On master: COMMIT
[0m09:43:59.488827 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:43:59.489311 [debug] [MainThread]: On master: Close
[0m09:43:59.490055 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:43:59.490493 [debug] [MainThread]: Connection 'model.my_project.master_beer_table' was properly closed.
[0m09:43:59.491068 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m09:43:59.491751 [debug] [MainThread]: Connection 'model.my_project.beer_report' was properly closed.
[0m09:43:59.492679 [debug] [MainThread]: Connection 'model.my_project.malt_per_beer' was properly closed.
[0m09:43:59.493561 [info ] [MainThread]: 
[0m09:43:59.494593 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 2.79 seconds (2.79s).
[0m09:43:59.498410 [debug] [MainThread]: Command end result
[0m09:43:59.542994 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:43:59.545506 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:43:59.555167 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:43:59.555700 [info ] [MainThread]: 
[0m09:43:59.556413 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:43:59.557206 [info ] [MainThread]: 
[0m09:43:59.558020 [error] [MainThread]:   Database Error in model malt_per_beer (models/mart/malt_per_beer.sql)
  column "ingredients" does not exist
  LINE 17:         ingredients
                   ^
  compiled code at target/run/my_project/models/mart/malt_per_beer.sql
[0m09:43:59.558669 [info ] [MainThread]: 
[0m09:43:59.560586 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m09:43:59.562514 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.078872, "process_in_blocks": "88", "process_kernel_time": 0.901705, "process_mem_max_rss": "108524", "process_out_blocks": "3480", "process_user_time": 4.416604}
[0m09:43:59.563442 [debug] [MainThread]: Command `dbt run` failed at 09:43:59.563278 after 4.08 seconds
[0m09:43:59.564023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d169d68c590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d169b9cc5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d169c205130>]}
[0m09:43:59.564611 [debug] [MainThread]: Flushing usage events
[0m09:44:01.141058 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:52:47.465949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780bb2e0dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780bb480c410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780bb2e0c860>]}


============================== 09:52:47.483962 | a9726e83-476e-4af2-a662-367307f1bf2a ==============================
[0m09:52:47.483962 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:52:47.485185 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:52:47.903595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9726e83-476e-4af2-a662-367307f1bf2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780bb27d5700>]}
[0m09:52:48.028275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9726e83-476e-4af2-a662-367307f1bf2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780bb2827b30>]}
[0m09:52:48.030133 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:52:48.224897 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:52:48.468372 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:52:48.468964 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:52:48.563360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9726e83-476e-4af2-a662-367307f1bf2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780bb2f64980>]}
[0m09:52:48.754086 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:52:48.758207 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:52:48.819419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9726e83-476e-4af2-a662-367307f1bf2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780bb0d57560>]}
[0m09:52:48.820637 [info ] [MainThread]: Found 2 data tests, 4 models, 1 source, 429 macros
[0m09:52:48.821388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9726e83-476e-4af2-a662-367307f1bf2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780bb0c92120>]}
[0m09:52:48.824821 [info ] [MainThread]: 
[0m09:52:48.825577 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:52:48.826374 [info ] [MainThread]: 
[0m09:52:48.827590 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:52:48.840143 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:52:48.852451 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:52:48.987316 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:52:48.988208 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:52:48.988867 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:52:48.989503 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:52:48.990047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:48.990646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:49.040071 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.049 seconds
[0m09:52:49.040721 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.051 seconds
[0m09:52:49.042584 [debug] [ThreadPool]: On list_db: Close
[0m09:52:49.044613 [debug] [ThreadPool]: On list_db: Close
[0m09:52:49.048558 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m09:52:49.050012 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev_dev)
[0m09:52:49.062678 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:52:49.066187 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m09:52:49.067119 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m09:52:49.067948 [debug] [ThreadPool]: On list_db_dev_dev: BEGIN
[0m09:52:49.068531 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:52:49.069125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:52:49.088458 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m09:52:49.089572 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m09:52:49.090321 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m09:52:49.091418 [debug] [ThreadPool]: On list_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_dev'
  
[0m09:52:49.092302 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:52:49.093208 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:52:49.104971 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.012 seconds
[0m09:52:49.108130 [debug] [ThreadPool]: On list_db_dev_dev: ROLLBACK
[0m09:52:49.108952 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.015 seconds
[0m09:52:49.111151 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m09:52:49.111744 [debug] [ThreadPool]: On list_db_dev_dev: Close
[0m09:52:49.112960 [debug] [ThreadPool]: On list_db_dev: Close
[0m09:52:49.125330 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:49.125969 [debug] [MainThread]: On master: BEGIN
[0m09:52:49.126508 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:52:49.141673 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m09:52:49.142756 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:49.143609 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:52:49.158920 [debug] [MainThread]: SQL status: SELECT 0 in 0.014 seconds
[0m09:52:49.161587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9726e83-476e-4af2-a662-367307f1bf2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780bb10019a0>]}
[0m09:52:49.162494 [debug] [MainThread]: On master: ROLLBACK
[0m09:52:49.163285 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:49.163844 [debug] [MainThread]: On master: BEGIN
[0m09:52:49.165112 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:52:49.166594 [debug] [MainThread]: On master: COMMIT
[0m09:52:49.167976 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:49.168973 [debug] [MainThread]: On master: COMMIT
[0m09:52:49.170347 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:52:49.171437 [debug] [MainThread]: On master: Close
[0m09:52:49.178634 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m09:52:49.179694 [info ] [Thread-1 (]: 1 of 4 START sql table model dev.staging ....................................... [RUN]
[0m09:52:49.180651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m09:52:49.181635 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m09:52:49.196393 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m09:52:49.197529 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m09:52:49.266135 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m09:52:49.267205 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:52:49.267707 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m09:52:49.268227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:49.280620 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m09:52:49.281926 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:52:49.282525 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * 
    from "db"."dev"."raw_beer_data"
)

select 
    id,
    beer_id,
    name as beer_name,
    tagline,
    first_brewed,
    description,
    image,
    abv,
    ibu,
    ebc,
    ph,
    brewers_tips,
    contributed_by,
    inserted_at
from source
  );
  
[0m09:52:49.423511 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.140 seconds
[0m09:52:49.441365 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:52:49.442111 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m09:52:49.443633 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:52:49.448183 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:52:49.448880 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m09:52:49.449953 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:52:49.478666 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m09:52:49.479304 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:52:49.479833 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m09:52:50.092692 [debug] [Thread-1 (]: SQL status: COMMIT in 0.612 seconds
[0m09:52:50.103046 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m09:52:50.115575 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:52:50.116568 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m09:52:50.248066 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.131 seconds
[0m09:52:50.252214 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m09:52:50.254701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9726e83-476e-4af2-a662-367307f1bf2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780bb335e6f0>]}
[0m09:52:50.255647 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dev.staging .................................. [[32mSELECT 414[0m in 1.07s]
[0m09:52:50.256975 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m09:52:50.259296 [debug] [Thread-3 (]: Began running node model.my_project.beer_report
[0m09:52:50.260193 [debug] [Thread-4 (]: Began running node model.my_project.malt_per_beer
[0m09:52:50.261350 [debug] [Thread-2 (]: Began running node model.my_project.master_beer_table
[0m09:52:50.262319 [info ] [Thread-3 (]: 2 of 4 START sql table model dev.beer_report ................................... [RUN]
[0m09:52:50.263691 [info ] [Thread-4 (]: 3 of 4 START sql table model dev_dev.malt_per_beer ............................. [RUN]
[0m09:52:50.268573 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.malt_per_beer'
[0m09:52:50.267143 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.beer_report'
[0m09:52:50.269220 [debug] [Thread-4 (]: Began compiling node model.my_project.malt_per_beer
[0m09:52:50.265552 [info ] [Thread-2 (]: 4 of 4 START sql table model dev.master_beer_table ............................. [RUN]
[0m09:52:50.270314 [debug] [Thread-3 (]: Began compiling node model.my_project.beer_report
[0m09:52:50.276128 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.malt_per_beer"
[0m09:52:50.277274 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_dev_dev, now model.my_project.master_beer_table)
[0m09:52:50.284689 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.beer_report"
[0m09:52:50.286576 [debug] [Thread-2 (]: Began compiling node model.my_project.master_beer_table
[0m09:52:50.288136 [debug] [Thread-4 (]: Began executing node model.my_project.malt_per_beer
[0m09:52:50.292854 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_project.master_beer_table"
[0m09:52:50.293496 [debug] [Thread-3 (]: Began executing node model.my_project.beer_report
[0m09:52:50.298016 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.malt_per_beer"
[0m09:52:50.306553 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.beer_report"
[0m09:52:50.307977 [debug] [Thread-2 (]: Began executing node model.my_project.master_beer_table
[0m09:52:50.309156 [debug] [Thread-4 (]: Using postgres connection "model.my_project.malt_per_beer"
[0m09:52:50.309903 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m09:52:50.317416 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_project.master_beer_table"
[0m09:52:50.318378 [debug] [Thread-4 (]: On model.my_project.malt_per_beer: BEGIN
[0m09:52:50.319127 [debug] [Thread-3 (]: On model.my_project.beer_report: BEGIN
[0m09:52:50.320226 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:52:50.321170 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:52:50.321950 [debug] [Thread-2 (]: Using postgres connection "model.my_project.master_beer_table"
[0m09:52:50.323631 [debug] [Thread-2 (]: On model.my_project.master_beer_table: BEGIN
[0m09:52:50.324393 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:52:50.342086 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m09:52:50.344258 [debug] [Thread-3 (]: SQL status: BEGIN in 0.022 seconds
[0m09:52:50.345493 [debug] [Thread-4 (]: SQL status: BEGIN in 0.025 seconds
[0m09:52:50.346444 [debug] [Thread-2 (]: Using postgres connection "model.my_project.master_beer_table"
[0m09:52:50.347915 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m09:52:50.349289 [debug] [Thread-4 (]: Using postgres connection "model.my_project.malt_per_beer"
[0m09:52:50.350918 [debug] [Thread-2 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */

  
    

  create  table "db"."dev"."master_beer_table__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    beer_id,
    beer_name,
    tagline as category,         -- category/style approximation
    description,
    abv as alcohol_percent,
    first_brewed
from beers
  );
  
[0m09:52:50.353041 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */

  
    

  create  table "db"."dev"."beer_report__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    count(*) as total_beers,
    round(avg(abv)::numeric, 2) as avg_abv,
    round(min(abv)::numeric, 2) as min_abv,
    round(max(abv)::numeric, 2) as max_abv,
    round(avg(ibu)::numeric, 2) as avg_ibu,
    round(min(ibu)::numeric, 2) as min_ibu,
    round(max(ibu)::numeric, 2) as max_ibu,
    round(avg(ebc)::numeric, 2) as avg_ebc,
    round(min(ebc)::numeric, 2) as min_ebc,
    round(max(ebc)::numeric, 2) as max_ebc,
    round(avg(ph)::numeric, 2) as avg_ph,
    min(first_brewed) as oldest_brew,
    max(first_brewed) as newest_brew,
    count(distinct contributed_by) as unique_contributors
from beers
  );
  
[0m09:52:50.354650 [debug] [Thread-4 (]: On model.my_project.malt_per_beer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.malt_per_beer"} */

  
    

  create  table "db"."dev_dev"."malt_per_beer__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select
        beer_id,
        ingredients
    from "db"."dev"."staging"
),

malts as (
    select
        beer_id,
        malt ->> 'name' as malt_type,
        (malt -> 'amount' ->> 'value')::numeric as amount,
        malt -> 'amount' ->> 'unit' as unit
    from source,
    jsonb_array_elements(ingredients -> 'malt') as malt
)

select * from malts
  );
  
[0m09:52:50.357535 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column "ingredients" does not exist
LINE 17:         ingredients
                 ^

[0m09:52:50.358736 [debug] [Thread-4 (]: On model.my_project.malt_per_beer: ROLLBACK
[0m09:52:50.360364 [debug] [Thread-4 (]: On model.my_project.malt_per_beer: Close
[0m09:52:50.366033 [debug] [Thread-2 (]: SQL status: SELECT 414 in 0.010 seconds
[0m09:52:50.376602 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.020 seconds
[0m09:52:50.381507 [debug] [Thread-2 (]: Using postgres connection "model.my_project.master_beer_table"
[0m09:52:50.392439 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m09:52:50.394372 [debug] [Thread-2 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */
alter table "db"."dev"."master_beer_table" rename to "master_beer_table__dbt_backup"
[0m09:52:50.396565 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report" rename to "beer_report__dbt_backup"
[0m09:52:50.399960 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:52:50.401568 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:52:50.406941 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m09:52:50.411618 [debug] [Thread-2 (]: Using postgres connection "model.my_project.master_beer_table"
[0m09:52:50.413953 [debug] [Thread-4 (]: Database Error in model malt_per_beer (models/mart/malt_per_beer.sql)
  column "ingredients" does not exist
  LINE 17:         ingredients
                   ^
  compiled code at target/run/my_project/models/mart/malt_per_beer.sql
[0m09:52:50.414681 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report__dbt_tmp" rename to "beer_report"
[0m09:52:50.415336 [debug] [Thread-2 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */
alter table "db"."dev"."master_beer_table__dbt_tmp" rename to "master_beer_table"
[0m09:52:50.416144 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9726e83-476e-4af2-a662-367307f1bf2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780bab660aa0>]}
[0m09:52:50.420076 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:52:50.418870 [error] [Thread-4 (]: 3 of 4 ERROR creating sql table model dev_dev.malt_per_beer .................... [[31mERROR[0m in 0.15s]
[0m09:52:50.428273 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m09:52:50.431072 [debug] [Thread-4 (]: Finished running node model.my_project.malt_per_beer
[0m09:52:50.425851 [debug] [Thread-2 (]: On model.my_project.master_beer_table: COMMIT
[0m09:52:50.438547 [debug] [Thread-3 (]: On model.my_project.beer_report: COMMIT
[0m09:52:50.440742 [debug] [Thread-7 (]: Marking all children of 'model.my_project.malt_per_beer' to be skipped because of status 'error'.  Reason: Database Error in model malt_per_beer (models/mart/malt_per_beer.sql)
  column "ingredients" does not exist
  LINE 17:         ingredients
                   ^
  compiled code at target/run/my_project/models/mart/malt_per_beer.sql.
[0m09:52:50.442043 [debug] [Thread-2 (]: Using postgres connection "model.my_project.master_beer_table"
[0m09:52:50.442881 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m09:52:50.445388 [debug] [Thread-2 (]: On model.my_project.master_beer_table: COMMIT
[0m09:52:50.446211 [debug] [Thread-3 (]: On model.my_project.beer_report: COMMIT
[0m09:52:50.595810 [debug] [Thread-2 (]: SQL status: COMMIT in 0.149 seconds
[0m09:52:50.598969 [debug] [Thread-2 (]: Applying DROP to: "db"."dev"."master_beer_table__dbt_backup"
[0m09:52:50.600250 [debug] [Thread-2 (]: Using postgres connection "model.my_project.master_beer_table"
[0m09:52:50.600992 [debug] [Thread-3 (]: SQL status: COMMIT in 0.154 seconds
[0m09:52:50.601575 [debug] [Thread-2 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */
drop table if exists "db"."dev"."master_beer_table__dbt_backup" cascade
[0m09:52:50.605368 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."beer_report__dbt_backup"
[0m09:52:50.606770 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m09:52:50.607391 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
drop table if exists "db"."dev"."beer_report__dbt_backup" cascade
[0m09:52:50.615081 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.009 seconds
[0m09:52:50.617313 [debug] [Thread-2 (]: On model.my_project.master_beer_table: Close
[0m09:52:50.618477 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9726e83-476e-4af2-a662-367307f1bf2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780bab663590>]}
[0m09:52:50.619201 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.011 seconds
[0m09:52:50.620117 [info ] [Thread-2 (]: 4 of 4 OK created sql table model dev.master_beer_table ........................ [[32mSELECT 414[0m in 0.34s]
[0m09:52:50.624096 [debug] [Thread-3 (]: On model.my_project.beer_report: Close
[0m09:52:50.625753 [debug] [Thread-2 (]: Finished running node model.my_project.master_beer_table
[0m09:52:50.627281 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9726e83-476e-4af2-a662-367307f1bf2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780ba8d69370>]}
[0m09:52:50.628828 [info ] [Thread-3 (]: 2 of 4 OK created sql table model dev.beer_report .............................. [[32mSELECT 1[0m in 0.36s]
[0m09:52:50.630659 [debug] [Thread-3 (]: Finished running node model.my_project.beer_report
[0m09:52:50.635369 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:50.636297 [debug] [MainThread]: On master: BEGIN
[0m09:52:50.636780 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:52:50.654300 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m09:52:50.655348 [debug] [MainThread]: On master: COMMIT
[0m09:52:50.656308 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:50.657144 [debug] [MainThread]: On master: COMMIT
[0m09:52:50.658262 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:52:50.658815 [debug] [MainThread]: On master: Close
[0m09:52:50.659548 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:52:50.660078 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m09:52:50.660521 [debug] [MainThread]: Connection 'model.my_project.master_beer_table' was properly closed.
[0m09:52:50.661142 [debug] [MainThread]: Connection 'model.my_project.beer_report' was properly closed.
[0m09:52:50.662030 [debug] [MainThread]: Connection 'model.my_project.malt_per_beer' was properly closed.
[0m09:52:50.663230 [info ] [MainThread]: 
[0m09:52:50.664714 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.84 seconds (1.84s).
[0m09:52:50.669820 [debug] [MainThread]: Command end result
[0m09:52:50.710029 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:52:50.712898 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:52:50.725015 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:52:50.725633 [info ] [MainThread]: 
[0m09:52:50.726356 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:52:50.727122 [info ] [MainThread]: 
[0m09:52:50.728335 [error] [MainThread]:   Database Error in model malt_per_beer (models/mart/malt_per_beer.sql)
  column "ingredients" does not exist
  LINE 17:         ingredients
                   ^
  compiled code at target/run/my_project/models/mart/malt_per_beer.sql
[0m09:52:50.729302 [info ] [MainThread]: 
[0m09:52:50.730272 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m09:52:50.733198 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.3703542, "process_in_blocks": "2800", "process_kernel_time": 1.099519, "process_mem_max_rss": "108792", "process_out_blocks": "3480", "process_user_time": 4.286533}
[0m09:52:50.735281 [debug] [MainThread]: Command `dbt run` failed at 09:52:50.734808 after 3.37 seconds
[0m09:52:50.736621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780bb2e0c2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780bb2db70b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780bb337c1d0>]}
[0m09:52:50.738015 [debug] [MainThread]: Flushing usage events
[0m09:52:52.458590 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:55:29.410151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78eca0895d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78eca07badb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78eca0f92210>]}


============================== 09:55:29.419404 | 343b4a9b-5560-4ad6-8fcd-2ac5649ffe61 ==============================
[0m09:55:29.419404 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:55:29.420175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:55:29.838144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '343b4a9b-5560-4ad6-8fcd-2ac5649ffe61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78eca02c7b30>]}
[0m09:55:30.004871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '343b4a9b-5560-4ad6-8fcd-2ac5649ffe61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78eca022f0b0>]}
[0m09:55:30.006245 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:55:30.249197 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:55:30.441190 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:55:30.441685 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:55:30.516262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '343b4a9b-5560-4ad6-8fcd-2ac5649ffe61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78eca04c8a40>]}
[0m09:55:30.672271 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:55:30.676472 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:55:30.717507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '343b4a9b-5560-4ad6-8fcd-2ac5649ffe61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ec9e759220>]}
[0m09:55:30.718234 [info ] [MainThread]: Found 2 data tests, 4 models, 1 source, 429 macros
[0m09:55:30.718812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '343b4a9b-5560-4ad6-8fcd-2ac5649ffe61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ec9e728980>]}
[0m09:55:30.721557 [info ] [MainThread]: 
[0m09:55:30.722280 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:55:30.723107 [info ] [MainThread]: 
[0m09:55:30.724173 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:55:30.732441 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:55:30.733993 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m09:55:30.843062 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:55:30.843664 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m09:55:30.844217 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:55:30.844874 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m09:55:30.845457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:55:30.846023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:55:30.864950 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.019 seconds
[0m09:55:30.865548 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.020 seconds
[0m09:55:30.867439 [debug] [ThreadPool]: On list_db: Close
[0m09:55:30.869242 [debug] [ThreadPool]: On list_db: Close
[0m09:55:30.872196 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m09:55:30.878628 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev_dev)
[0m09:55:30.883536 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:55:30.890171 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m09:55:30.891882 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m09:55:30.893862 [debug] [ThreadPool]: On list_db_dev_dev: BEGIN
[0m09:55:30.895362 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:55:30.896082 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:55:30.916714 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m09:55:30.917827 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m09:55:30.918788 [debug] [ThreadPool]: On list_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_dev'
  
[0m09:55:30.919592 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m09:55:30.920166 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m09:55:30.920682 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:55:30.923235 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m09:55:30.925188 [debug] [ThreadPool]: On list_db_dev_dev: ROLLBACK
[0m09:55:30.925843 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.005 seconds
[0m09:55:30.928555 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m09:55:30.929101 [debug] [ThreadPool]: On list_db_dev_dev: Close
[0m09:55:30.930290 [debug] [ThreadPool]: On list_db_dev: Close
[0m09:55:30.938866 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:30.939397 [debug] [MainThread]: On master: BEGIN
[0m09:55:30.939818 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:55:30.956331 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m09:55:30.957914 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:30.960225 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:55:30.972525 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m09:55:30.977649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '343b4a9b-5560-4ad6-8fcd-2ac5649ffe61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ec9e79cec0>]}
[0m09:55:30.979194 [debug] [MainThread]: On master: ROLLBACK
[0m09:55:30.981066 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:30.982229 [debug] [MainThread]: On master: BEGIN
[0m09:55:30.984801 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:55:30.986581 [debug] [MainThread]: On master: COMMIT
[0m09:55:30.988836 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:30.989885 [debug] [MainThread]: On master: COMMIT
[0m09:55:30.991659 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:55:30.993015 [debug] [MainThread]: On master: Close
[0m09:55:31.004625 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m09:55:31.006486 [info ] [Thread-1 (]: 1 of 4 START sql table model dev.staging ....................................... [RUN]
[0m09:55:31.008191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m09:55:31.010138 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m09:55:31.034234 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m09:55:31.035923 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m09:55:31.096329 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m09:55:31.097293 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:55:31.097720 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m09:55:31.098097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:55:31.109973 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m09:55:31.111116 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:55:31.111724 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * 
    from "db"."dev"."raw_beer_data"
)

select 
    id,
    beer_id,
    name as beer_name,
    tagline,
    first_brewed,
    description,
    image,
    abv,
    ibu,
    ebc,
    ph,
    brewers_tips,
    contributed_by,
    inserted_at
from source
  );
  
[0m09:55:31.117332 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.005 seconds
[0m09:55:31.127694 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:55:31.128300 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m09:55:31.129468 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:55:31.133134 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:55:31.133647 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m09:55:31.134622 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:55:31.169597 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m09:55:31.171993 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:55:31.173774 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m09:55:31.200021 [debug] [Thread-1 (]: SQL status: COMMIT in 0.025 seconds
[0m09:55:31.222350 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m09:55:31.244551 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m09:55:31.246154 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m09:55:31.259990 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.012 seconds
[0m09:55:31.265748 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m09:55:31.269190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '343b4a9b-5560-4ad6-8fcd-2ac5649ffe61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78eca0dce210>]}
[0m09:55:31.270465 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dev.staging .................................. [[32mSELECT 414[0m in 0.26s]
[0m09:55:31.271930 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m09:55:31.274580 [debug] [Thread-3 (]: Began running node model.my_project.beer_report
[0m09:55:31.275636 [debug] [Thread-4 (]: Began running node model.my_project.malt_per_beer
[0m09:55:31.276947 [debug] [Thread-2 (]: Began running node model.my_project.master_beer_table
[0m09:55:31.278402 [info ] [Thread-3 (]: 2 of 4 START sql table model dev.beer_report ................................... [RUN]
[0m09:55:31.282291 [info ] [Thread-4 (]: 3 of 4 START sql table model dev_dev.malt_per_beer ............................. [RUN]
[0m09:55:31.286261 [info ] [Thread-2 (]: 4 of 4 START sql table model dev.master_beer_table ............................. [RUN]
[0m09:55:31.290736 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.beer_report'
[0m09:55:31.294041 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.malt_per_beer'
[0m09:55:31.296578 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_dev_dev, now model.my_project.master_beer_table)
[0m09:55:31.298738 [debug] [Thread-3 (]: Began compiling node model.my_project.beer_report
[0m09:55:31.300948 [debug] [Thread-4 (]: Began compiling node model.my_project.malt_per_beer
[0m09:55:31.302941 [debug] [Thread-2 (]: Began compiling node model.my_project.master_beer_table
[0m09:55:31.322245 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.beer_report"
[0m09:55:31.329740 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.malt_per_beer"
[0m09:55:31.340592 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_project.master_beer_table"
[0m09:55:31.346685 [debug] [Thread-4 (]: Began executing node model.my_project.malt_per_beer
[0m09:55:31.349048 [debug] [Thread-3 (]: Began executing node model.my_project.beer_report
[0m09:55:31.365135 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.malt_per_beer"
[0m09:55:31.375920 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.beer_report"
[0m09:55:31.378579 [debug] [Thread-2 (]: Began executing node model.my_project.master_beer_table
[0m09:55:31.386021 [debug] [Thread-4 (]: Using postgres connection "model.my_project.malt_per_beer"
[0m09:55:31.389917 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_project.master_beer_table"
[0m09:55:31.391838 [debug] [Thread-4 (]: On model.my_project.malt_per_beer: BEGIN
[0m09:55:31.393128 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m09:55:31.394838 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:55:31.396272 [debug] [Thread-3 (]: On model.my_project.beer_report: BEGIN
[0m09:55:31.397578 [debug] [Thread-2 (]: Using postgres connection "model.my_project.master_beer_table"
[0m09:55:31.399513 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:55:31.401627 [debug] [Thread-2 (]: On model.my_project.master_beer_table: BEGIN
[0m09:55:31.404016 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:55:31.438115 [debug] [Thread-3 (]: SQL status: BEGIN in 0.039 seconds
[0m09:55:31.439452 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m09:55:31.440960 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */

  
    

  create  table "db"."dev"."beer_report__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    count(*) as total_beers,
    round(avg(abv)::numeric, 2) as avg_abv,
    round(min(abv)::numeric, 2) as min_abv,
    round(max(abv)::numeric, 2) as max_abv,
    round(avg(ibu)::numeric, 2) as avg_ibu,
    round(min(ibu)::numeric, 2) as min_ibu,
    round(max(ibu)::numeric, 2) as max_ibu,
    round(avg(ebc)::numeric, 2) as avg_ebc,
    round(min(ebc)::numeric, 2) as min_ebc,
    round(max(ebc)::numeric, 2) as max_ebc,
    round(avg(ph)::numeric, 2) as avg_ph,
    min(first_brewed) as oldest_brew,
    max(first_brewed) as newest_brew,
    count(distinct contributed_by) as unique_contributors
from beers
  );
  
[0m09:55:31.446339 [debug] [Thread-4 (]: SQL status: BEGIN in 0.051 seconds
[0m09:55:31.447616 [debug] [Thread-4 (]: Using postgres connection "model.my_project.malt_per_beer"
[0m09:55:31.449104 [debug] [Thread-4 (]: On model.my_project.malt_per_beer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.malt_per_beer"} */

  
    

  create  table "db"."dev_dev"."malt_per_beer__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select
        beer_id,
        ingredients
    from "db"."dev"."staging"
),

malts as (
    select
        beer_id,
        malt ->> 'name' as malt_type,
        (malt -> 'amount' ->> 'value')::numeric as amount,
        malt -> 'amount' ->> 'unit' as unit
    from source,
    jsonb_array_elements(ingredients -> 'malt') as malt
)

select * from malts
  );
  
[0m09:55:31.451606 [debug] [Thread-2 (]: SQL status: BEGIN in 0.047 seconds
[0m09:55:31.452917 [debug] [Thread-2 (]: Using postgres connection "model.my_project.master_beer_table"
[0m09:55:31.454146 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.010 seconds
[0m09:55:31.455548 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column "ingredients" does not exist
LINE 17:         ingredients
                 ^

[0m09:55:31.470068 [debug] [Thread-4 (]: On model.my_project.malt_per_beer: ROLLBACK
[0m09:55:31.457023 [debug] [Thread-2 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */

  
    

  create  table "db"."dev"."master_beer_table__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    beer_id,
    beer_name,
    tagline as category,         -- category/style approximation
    description,
    abv as alcohol_percent,
    first_brewed
from beers
  );
  
[0m09:55:31.471433 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m09:55:31.472659 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report" rename to "beer_report__dbt_backup"
[0m09:55:31.474586 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:55:31.487331 [debug] [Thread-4 (]: On model.my_project.malt_per_beer: Close
[0m09:55:31.490325 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m09:55:31.491312 [debug] [Thread-2 (]: SQL status: SELECT 414 in 0.020 seconds
[0m09:55:31.495260 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report__dbt_tmp" rename to "beer_report"
[0m09:55:31.502496 [debug] [Thread-2 (]: Using postgres connection "model.my_project.master_beer_table"
[0m09:55:31.504640 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:55:31.505352 [debug] [Thread-2 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */
alter table "db"."dev"."master_beer_table" rename to "master_beer_table__dbt_backup"
[0m09:55:31.509763 [debug] [Thread-3 (]: On model.my_project.beer_report: COMMIT
[0m09:55:31.513752 [debug] [Thread-4 (]: Database Error in model malt_per_beer (models/mart/malt_per_beer.sql)
  column "ingredients" does not exist
  LINE 17:         ingredients
                   ^
  compiled code at target/run/my_project/models/mart/malt_per_beer.sql
[0m09:55:31.514420 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m09:55:31.515135 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:55:31.516084 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '343b4a9b-5560-4ad6-8fcd-2ac5649ffe61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ec9d07a3f0>]}
[0m09:55:31.517339 [debug] [Thread-3 (]: On model.my_project.beer_report: COMMIT
[0m09:55:31.522943 [debug] [Thread-2 (]: Using postgres connection "model.my_project.master_beer_table"
[0m09:55:31.524487 [error] [Thread-4 (]: 3 of 4 ERROR creating sql table model dev_dev.malt_per_beer .................... [[31mERROR[0m in 0.22s]
[0m09:55:31.525934 [debug] [Thread-2 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */
alter table "db"."dev"."master_beer_table__dbt_tmp" rename to "master_beer_table"
[0m09:55:31.527213 [debug] [Thread-4 (]: Finished running node model.my_project.malt_per_beer
[0m09:55:31.528733 [debug] [Thread-7 (]: Marking all children of 'model.my_project.malt_per_beer' to be skipped because of status 'error'.  Reason: Database Error in model malt_per_beer (models/mart/malt_per_beer.sql)
  column "ingredients" does not exist
  LINE 17:         ingredients
                   ^
  compiled code at target/run/my_project/models/mart/malt_per_beer.sql.
[0m09:55:31.529444 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:55:31.533194 [debug] [Thread-2 (]: On model.my_project.master_beer_table: COMMIT
[0m09:55:31.533845 [debug] [Thread-2 (]: Using postgres connection "model.my_project.master_beer_table"
[0m09:55:31.534371 [debug] [Thread-2 (]: On model.my_project.master_beer_table: COMMIT
[0m09:55:31.587607 [debug] [Thread-3 (]: SQL status: COMMIT in 0.062 seconds
[0m09:55:31.588265 [debug] [Thread-2 (]: SQL status: COMMIT in 0.053 seconds
[0m09:55:31.591770 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."beer_report__dbt_backup"
[0m09:55:31.595763 [debug] [Thread-2 (]: Applying DROP to: "db"."dev"."master_beer_table__dbt_backup"
[0m09:55:31.597015 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m09:55:31.598236 [debug] [Thread-2 (]: Using postgres connection "model.my_project.master_beer_table"
[0m09:55:31.599317 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
drop table if exists "db"."dev"."beer_report__dbt_backup" cascade
[0m09:55:31.600290 [debug] [Thread-2 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */
drop table if exists "db"."dev"."master_beer_table__dbt_backup" cascade
[0m09:55:31.610077 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.009 seconds
[0m09:55:31.610820 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.010 seconds
[0m09:55:31.613008 [debug] [Thread-2 (]: On model.my_project.master_beer_table: Close
[0m09:55:31.615034 [debug] [Thread-3 (]: On model.my_project.beer_report: Close
[0m09:55:31.616510 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '343b4a9b-5560-4ad6-8fcd-2ac5649ffe61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ec9d138c20>]}
[0m09:55:31.617761 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '343b4a9b-5560-4ad6-8fcd-2ac5649ffe61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ec9d05c3e0>]}
[0m09:55:31.618762 [info ] [Thread-2 (]: 4 of 4 OK created sql table model dev.master_beer_table ........................ [[32mSELECT 414[0m in 0.32s]
[0m09:55:31.620284 [info ] [Thread-3 (]: 2 of 4 OK created sql table model dev.beer_report .............................. [[32mSELECT 1[0m in 0.33s]
[0m09:55:31.621925 [debug] [Thread-2 (]: Finished running node model.my_project.master_beer_table
[0m09:55:31.622978 [debug] [Thread-3 (]: Finished running node model.my_project.beer_report
[0m09:55:31.626740 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:31.627340 [debug] [MainThread]: On master: BEGIN
[0m09:55:31.627881 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:55:31.640787 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m09:55:31.641685 [debug] [MainThread]: On master: COMMIT
[0m09:55:31.642480 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:31.643011 [debug] [MainThread]: On master: COMMIT
[0m09:55:31.643804 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:55:31.644322 [debug] [MainThread]: On master: Close
[0m09:55:31.645223 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:55:31.645740 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m09:55:31.646333 [debug] [MainThread]: Connection 'model.my_project.master_beer_table' was properly closed.
[0m09:55:31.646880 [debug] [MainThread]: Connection 'model.my_project.beer_report' was properly closed.
[0m09:55:31.647731 [debug] [MainThread]: Connection 'model.my_project.malt_per_beer' was properly closed.
[0m09:55:31.648868 [info ] [MainThread]: 
[0m09:55:31.649723 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m09:55:31.652114 [debug] [MainThread]: Command end result
[0m09:55:31.706033 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m09:55:31.708555 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m09:55:31.733636 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m09:55:31.734588 [info ] [MainThread]: 
[0m09:55:31.735704 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:55:31.736858 [info ] [MainThread]: 
[0m09:55:31.739324 [error] [MainThread]:   Database Error in model malt_per_beer (models/mart/malt_per_beer.sql)
  column "ingredients" does not exist
  LINE 17:         ingredients
                   ^
  compiled code at target/run/my_project/models/mart/malt_per_beer.sql
[0m09:55:31.740873 [info ] [MainThread]: 
[0m09:55:31.742056 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m09:55:31.744648 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.4164503, "process_in_blocks": "0", "process_kernel_time": 0.840515, "process_mem_max_rss": "108652", "process_out_blocks": "3480", "process_user_time": 4.251069}
[0m09:55:31.745566 [debug] [MainThread]: Command `dbt run` failed at 09:55:31.745372 after 2.42 seconds
[0m09:55:31.746211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78eca2254320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78eca0ded100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ec9d086ea0>]}
[0m09:55:31.746773 [debug] [MainThread]: Flushing usage events
[0m09:55:33.325786 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:58:09.794737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e798ece5bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e798e3b8fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e798d1fb500>]}


============================== 09:58:09.802706 | eb3d9656-ab83-4a7c-8800-dab119cce395 ==============================
[0m09:58:09.802706 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:58:09.803606 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select malt_per_beer', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:58:10.100889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb3d9656-ab83-4a7c-8800-dab119cce395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e798b571130>]}
[0m09:58:10.185977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb3d9656-ab83-4a7c-8800-dab119cce395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e798cf2fbf0>]}
[0m09:58:10.187074 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:58:10.319861 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:58:10.484839 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:58:10.485567 [debug] [MainThread]: Partial parsing: updated file: my_project://models/mart/malt_per_beer.sql
[0m09:58:10.745804 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_project.malt_per_beer' (models/mart/malt_per_beer.sql) depends on a node named 'malt_ingredients' which was not found
[0m09:58:10.747593 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.019552, "process_in_blocks": "0", "process_kernel_time": 0.496191, "process_mem_max_rss": "98656", "process_out_blocks": "1504", "process_user_time": 3.03317}
[0m09:58:10.748351 [debug] [MainThread]: Command `dbt run` failed at 09:58:10.748175 after 1.02 seconds
[0m09:58:10.749120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e798ece5bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e798b2ddb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e798ce42ae0>]}
[0m09:58:10.749630 [debug] [MainThread]: Flushing usage events
[0m09:58:12.259132 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:59:38.435357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f4a8575490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f4a88773b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f4a8576cf0>]}


============================== 09:59:38.442852 | d8caebb4-35e9-46f7-ae65-ab5ceb7c11ec ==============================
[0m09:59:38.442852 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:59:38.443875 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select malt_per_beer', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:59:38.777756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8caebb4-35e9-46f7-ae65-ab5ceb7c11ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f4a66bf7a0>]}
[0m09:59:39.075412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8caebb4-35e9-46f7-ae65-ab5ceb7c11ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f4a8696cc0>]}
[0m09:59:39.078021 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:59:39.427485 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:59:39.669847 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m09:59:39.671576 [debug] [MainThread]: Partial parsing: updated file: my_project://models/sources/sources.yml
[0m09:59:39.672219 [debug] [MainThread]: Partial parsing: updated file: my_project://models/mart/malt_per_beer.sql
[0m09:59:40.632847 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_project.malt_per_beer' (models/mart/malt_per_beer.sql) depends on a node named 'malt_ingredients' which was not found
[0m09:59:40.635762 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.2616532, "process_in_blocks": "0", "process_kernel_time": 0.587255, "process_mem_max_rss": "101056", "process_out_blocks": "1504", "process_user_time": 4.021688}
[0m09:59:40.636879 [debug] [MainThread]: Command `dbt run` failed at 09:59:40.636647 after 2.26 seconds
[0m09:59:40.637607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f4a8697b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f4a636d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f4a7f57e30>]}
[0m09:59:40.638388 [debug] [MainThread]: Flushing usage events
[0m09:59:42.158914 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:00:52.036897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9d4610c500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9d462b70e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9d46448500>]}


============================== 10:00:52.047907 | 24ffd3fd-e7e9-4db1-b94b-4a49896567d1 ==============================
[0m10:00:52.047907 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:00:52.049533 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select malt_per_beer', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:00:52.384346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24ffd3fd-e7e9-4db1-b94b-4a49896567d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9d45e01160>]}
[0m10:00:52.471413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24ffd3fd-e7e9-4db1-b94b-4a49896567d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9d461bdac0>]}
[0m10:00:52.472646 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:00:52.611925 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:00:52.792169 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m10:00:52.793378 [debug] [MainThread]: Partial parsing: updated file: my_project://models/sources/sources.yml
[0m10:00:52.793866 [debug] [MainThread]: Partial parsing: updated file: my_project://models/mart/malt_per_beer.sql
[0m10:00:53.646654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24ffd3fd-e7e9-4db1-b94b-4a49896567d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9d4303b320>]}
[0m10:00:53.781841 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:00:53.785703 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:00:53.822672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24ffd3fd-e7e9-4db1-b94b-4a49896567d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9d42e34380>]}
[0m10:00:53.823405 [info ] [MainThread]: Found 4 models, 6 data tests, 5 sources, 429 macros
[0m10:00:53.823959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24ffd3fd-e7e9-4db1-b94b-4a49896567d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9d4304ad20>]}
[0m10:00:53.826528 [info ] [MainThread]: 
[0m10:00:53.827139 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:00:53.827822 [info ] [MainThread]: 
[0m10:00:53.829109 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:00:53.831117 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m10:00:53.929235 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m10:00:53.930041 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m10:00:53.930751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:00:53.947233 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.016 seconds
[0m10:00:53.949431 [debug] [ThreadPool]: On list_db: Close
[0m10:00:53.956762 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev_dev)
[0m10:00:53.957906 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_dev'
[0m10:00:53.975457 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m10:00:53.974343 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m10:00:53.977449 [debug] [ThreadPool]: On list_db_dev_dev: BEGIN
[0m10:00:53.978833 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m10:00:53.980338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:00:53.981809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:00:54.012548 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m10:00:54.014898 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m10:00:54.017262 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m10:00:54.019613 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m10:00:54.021163 [debug] [ThreadPool]: On list_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_dev'
  
[0m10:00:54.023115 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:00:54.035676 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m10:00:54.037244 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.012 seconds
[0m10:00:54.041939 [debug] [ThreadPool]: On list_db_dev_dev: ROLLBACK
[0m10:00:54.047970 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m10:00:54.306398 [debug] [ThreadPool]: On list_db_dev_dev: Close
[0m10:00:54.308160 [debug] [ThreadPool]: On list_db_dev: Close
[0m10:00:54.343164 [debug] [MainThread]: Using postgres connection "master"
[0m10:00:54.345054 [debug] [MainThread]: On master: BEGIN
[0m10:00:54.346553 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:00:54.373610 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m10:00:54.375635 [debug] [MainThread]: Using postgres connection "master"
[0m10:00:54.377213 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:00:54.387552 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m10:00:54.391507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24ffd3fd-e7e9-4db1-b94b-4a49896567d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9d4416fe00>]}
[0m10:00:54.392821 [debug] [MainThread]: On master: ROLLBACK
[0m10:00:54.394248 [debug] [MainThread]: Using postgres connection "master"
[0m10:00:54.395137 [debug] [MainThread]: On master: BEGIN
[0m10:00:54.397151 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:00:54.399016 [debug] [MainThread]: On master: COMMIT
[0m10:00:54.400929 [debug] [MainThread]: Using postgres connection "master"
[0m10:00:54.401860 [debug] [MainThread]: On master: COMMIT
[0m10:00:54.403280 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:00:54.404290 [debug] [MainThread]: On master: Close
[0m10:00:54.412825 [debug] [Thread-1 (]: Began running node model.my_project.malt_per_beer
[0m10:00:54.414304 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_dev.malt_per_beer ............................. [RUN]
[0m10:00:54.416131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.malt_per_beer)
[0m10:00:54.417928 [debug] [Thread-1 (]: Began compiling node model.my_project.malt_per_beer
[0m10:00:54.437985 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.malt_per_beer"
[0m10:00:54.439720 [debug] [Thread-1 (]: Began executing node model.my_project.malt_per_beer
[0m10:00:54.497973 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.malt_per_beer"
[0m10:00:54.498952 [debug] [Thread-1 (]: Using postgres connection "model.my_project.malt_per_beer"
[0m10:00:54.499432 [debug] [Thread-1 (]: On model.my_project.malt_per_beer: BEGIN
[0m10:00:54.499908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:00:54.512155 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m10:00:54.512976 [debug] [Thread-1 (]: Using postgres connection "model.my_project.malt_per_beer"
[0m10:00:54.513627 [debug] [Thread-1 (]: On model.my_project.malt_per_beer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.malt_per_beer"} */

  
    

  create  table "db"."dev_dev"."malt_per_beer__dbt_tmp"
  
  
    as
  
  (
    

select
    beer_id,
    malt_name as malt_type,
    amount_value as amount,
    amount_unit as unit
from "db"."dev"."malt_ingredients"
  );
  
[0m10:00:54.519671 [debug] [Thread-1 (]: SQL status: SELECT 1627 in 0.005 seconds
[0m10:00:54.529009 [debug] [Thread-1 (]: Using postgres connection "model.my_project.malt_per_beer"
[0m10:00:54.529632 [debug] [Thread-1 (]: On model.my_project.malt_per_beer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.malt_per_beer"} */
alter table "db"."dev_dev"."malt_per_beer__dbt_tmp" rename to "malt_per_beer"
[0m10:00:54.530724 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:00:54.555628 [debug] [Thread-1 (]: On model.my_project.malt_per_beer: COMMIT
[0m10:00:54.556212 [debug] [Thread-1 (]: Using postgres connection "model.my_project.malt_per_beer"
[0m10:00:54.556723 [debug] [Thread-1 (]: On model.my_project.malt_per_beer: COMMIT
[0m10:00:54.743072 [debug] [Thread-1 (]: SQL status: COMMIT in 0.185 seconds
[0m10:00:54.779268 [debug] [Thread-1 (]: Applying DROP to: "db"."dev_dev"."malt_per_beer__dbt_backup"
[0m10:00:54.806824 [debug] [Thread-1 (]: Using postgres connection "model.my_project.malt_per_beer"
[0m10:00:54.807950 [debug] [Thread-1 (]: On model.my_project.malt_per_beer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.malt_per_beer"} */
drop table if exists "db"."dev_dev"."malt_per_beer__dbt_backup" cascade
[0m10:00:54.809874 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m10:00:54.815673 [debug] [Thread-1 (]: On model.my_project.malt_per_beer: Close
[0m10:00:54.819555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24ffd3fd-e7e9-4db1-b94b-4a49896567d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9d4695a810>]}
[0m10:00:54.821292 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_dev.malt_per_beer ........................ [[32mSELECT 1627[0m in 0.40s]
[0m10:00:54.824267 [debug] [Thread-1 (]: Finished running node model.my_project.malt_per_beer
[0m10:00:54.829724 [debug] [MainThread]: Using postgres connection "master"
[0m10:00:54.830676 [debug] [MainThread]: On master: BEGIN
[0m10:00:54.831892 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:00:54.856597 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m10:00:54.858066 [debug] [MainThread]: On master: COMMIT
[0m10:00:54.859398 [debug] [MainThread]: Using postgres connection "master"
[0m10:00:54.860302 [debug] [MainThread]: On master: COMMIT
[0m10:00:54.861800 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:00:54.862719 [debug] [MainThread]: On master: Close
[0m10:00:54.864020 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:00:54.865460 [debug] [MainThread]: Connection 'list_db_dev_dev' was properly closed.
[0m10:00:54.866925 [debug] [MainThread]: Connection 'model.my_project.malt_per_beer' was properly closed.
[0m10:00:54.868416 [info ] [MainThread]: 
[0m10:00:54.870136 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.04 seconds (1.04s).
[0m10:00:54.873237 [debug] [MainThread]: Command end result
[0m10:00:54.945456 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:00:54.950864 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:00:54.962236 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m10:00:54.962738 [info ] [MainThread]: 
[0m10:00:54.963468 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:00:54.964107 [info ] [MainThread]: 
[0m10:00:54.965033 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:00:54.967000 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.042563, "process_in_blocks": "0", "process_kernel_time": 0.770912, "process_mem_max_rss": "113492", "process_out_blocks": "4320", "process_user_time": 5.171539}
[0m10:00:54.967810 [debug] [MainThread]: Command `dbt run` succeeded at 10:00:54.967653 after 3.04 seconds
[0m10:00:54.968354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9d46526600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9d47e046e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9d45e53d40>]}
[0m10:00:54.968980 [debug] [MainThread]: Flushing usage events
[0m10:00:56.534180 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:12:42.012900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0584a9f200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0584555460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d05860f8380>]}


============================== 10:12:42.022006 | 6aa95c8a-f81e-4275-bf82-8c4bad819854 ==============================
[0m10:12:42.022006 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:12:42.023008 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select beer_with_type', 'send_anonymous_usage_stats': 'True'}
[0m10:12:42.306613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6aa95c8a-f81e-4275-bf82-8c4bad819854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d05840de480>]}
[0m10:12:42.388612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6aa95c8a-f81e-4275-bf82-8c4bad819854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d05841eb260>]}
[0m10:12:42.389630 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:12:42.576024 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:12:42.800674 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m10:12:42.801560 [debug] [MainThread]: Partial parsing: added file: my_project://models/mart/beer_with_type.sql
[0m10:12:43.238641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6aa95c8a-f81e-4275-bf82-8c4bad819854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0582616480>]}
[0m10:12:43.366591 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:12:43.372000 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:12:43.409962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6aa95c8a-f81e-4275-bf82-8c4bad819854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d058263e3f0>]}
[0m10:12:43.410800 [info ] [MainThread]: Found 5 models, 6 data tests, 5 sources, 429 macros
[0m10:12:43.411648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6aa95c8a-f81e-4275-bf82-8c4bad819854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0582614b30>]}
[0m10:12:43.414730 [info ] [MainThread]: 
[0m10:12:43.415591 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:12:43.416391 [info ] [MainThread]: 
[0m10:12:43.417759 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:12:43.419769 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m10:12:43.525286 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m10:12:43.525842 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m10:12:43.526263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:12:43.542412 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.016 seconds
[0m10:12:43.547387 [debug] [ThreadPool]: On list_db: Close
[0m10:12:43.572079 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev_dev)
[0m10:12:43.575362 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_dev'
[0m10:12:43.592063 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m10:12:43.596718 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m10:12:43.597932 [debug] [ThreadPool]: On list_db_dev_dev: BEGIN
[0m10:12:43.599144 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m10:12:43.600247 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:12:43.601331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:12:43.640414 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m10:12:43.643251 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m10:12:43.646172 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m10:12:43.649385 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m10:12:43.652243 [debug] [ThreadPool]: On list_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_dev'
  
[0m10:12:43.655094 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:12:43.674928 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.016 seconds
[0m10:12:43.677059 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.018 seconds
[0m10:12:43.684484 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m10:12:43.690661 [debug] [ThreadPool]: On list_db_dev_dev: ROLLBACK
[0m10:12:43.695092 [debug] [ThreadPool]: On list_db_dev: Close
[0m10:12:43.696874 [debug] [ThreadPool]: On list_db_dev_dev: Close
[0m10:12:43.739137 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:43.740965 [debug] [MainThread]: On master: BEGIN
[0m10:12:43.742464 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:12:43.780861 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m10:12:43.784405 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:43.787330 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:12:43.803340 [debug] [MainThread]: SQL status: SELECT 0 in 0.014 seconds
[0m10:12:43.809704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6aa95c8a-f81e-4275-bf82-8c4bad819854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d05825fdd60>]}
[0m10:12:43.812083 [debug] [MainThread]: On master: ROLLBACK
[0m10:12:43.814253 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:43.815931 [debug] [MainThread]: On master: BEGIN
[0m10:12:43.819191 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m10:12:43.823404 [debug] [MainThread]: On master: COMMIT
[0m10:12:43.828000 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:43.830606 [debug] [MainThread]: On master: COMMIT
[0m10:12:43.836914 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:12:43.839051 [debug] [MainThread]: On master: Close
[0m10:12:43.856308 [debug] [Thread-1 (]: Began running node model.my_project.beer_with_type
[0m10:12:43.860174 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_dev.beer_with_type ............................ [RUN]
[0m10:12:43.864183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev_dev, now model.my_project.beer_with_type)
[0m10:12:43.867411 [debug] [Thread-1 (]: Began compiling node model.my_project.beer_with_type
[0m10:12:43.894026 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.beer_with_type"
[0m10:12:43.896692 [debug] [Thread-1 (]: Began executing node model.my_project.beer_with_type
[0m10:12:44.024440 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.beer_with_type"
[0m10:12:44.026190 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_with_type"
[0m10:12:44.026814 [debug] [Thread-1 (]: On model.my_project.beer_with_type: BEGIN
[0m10:12:44.027624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:12:44.040669 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m10:12:44.041487 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_with_type"
[0m10:12:44.042160 [debug] [Thread-1 (]: On model.my_project.beer_with_type: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_with_type"} */

  
    

  create  table "db"."dev_dev"."beer_with_type__dbt_tmp"
  
  
    as
  
  (
    

select
    beer_id,
    name,
    tagline,
    -- Add a "type" column, mapped from tagline patterns
    case
        when lower(tagline) like '%lager%' then 'Lager'
        when lower(tagline) like '%pilsner%' then 'Lager'
        when lower(tagline) like '%ipa%' then 'Ale'
        when lower(tagline) like '%stout%' then 'Ale'
        when lower(tagline) like '%porter%' then 'Ale'
        when lower(tagline) like '%ale%' then 'Ale'
        when lower(tagline) like '%wheat%' then 'Ale'
        -- Expand with more mappings as needed
        else 'Other'
    end as type,
    first_brewed,
    abv,
    ibu,
    ebc,
    ph,
    brewers_tips,
    contributed_by,
    inserted_at
from "db"."dev"."raw_beer_data"
  );
  
[0m10:12:44.051484 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.009 seconds
[0m10:12:44.065488 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_with_type"
[0m10:12:44.067037 [debug] [Thread-1 (]: On model.my_project.beer_with_type: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_with_type"} */
alter table "db"."dev_dev"."beer_with_type__dbt_tmp" rename to "beer_with_type"
[0m10:12:44.069425 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:12:44.130065 [debug] [Thread-1 (]: On model.my_project.beer_with_type: COMMIT
[0m10:12:44.131143 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_with_type"
[0m10:12:44.131901 [debug] [Thread-1 (]: On model.my_project.beer_with_type: COMMIT
[0m10:12:44.137508 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m10:12:44.149677 [debug] [Thread-1 (]: Applying DROP to: "db"."dev_dev"."beer_with_type__dbt_backup"
[0m10:12:44.162179 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_with_type"
[0m10:12:44.163127 [debug] [Thread-1 (]: On model.my_project.beer_with_type: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_with_type"} */
drop table if exists "db"."dev_dev"."beer_with_type__dbt_backup" cascade
[0m10:12:44.164472 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m10:12:44.169315 [debug] [Thread-1 (]: On model.my_project.beer_with_type: Close
[0m10:12:44.172726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6aa95c8a-f81e-4275-bf82-8c4bad819854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d05860726f0>]}
[0m10:12:44.174027 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_dev.beer_with_type ....................... [[32mSELECT 414[0m in 0.31s]
[0m10:12:44.175384 [debug] [Thread-1 (]: Finished running node model.my_project.beer_with_type
[0m10:12:44.179148 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:44.179685 [debug] [MainThread]: On master: BEGIN
[0m10:12:44.180175 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:12:44.195199 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m10:12:44.196362 [debug] [MainThread]: On master: COMMIT
[0m10:12:44.197338 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:44.197888 [debug] [MainThread]: On master: COMMIT
[0m10:12:44.198800 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:12:44.199514 [debug] [MainThread]: On master: Close
[0m10:12:44.200537 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:12:44.201099 [debug] [MainThread]: Connection 'model.my_project.beer_with_type' was properly closed.
[0m10:12:44.201566 [debug] [MainThread]: Connection 'list_db_dev' was properly closed.
[0m10:12:44.202094 [info ] [MainThread]: 
[0m10:12:44.202794 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m10:12:44.205370 [debug] [MainThread]: Command end result
[0m10:12:44.241978 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:12:44.245089 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:12:44.254853 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m10:12:44.255458 [info ] [MainThread]: 
[0m10:12:44.256465 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:12:44.257427 [info ] [MainThread]: 
[0m10:12:44.258489 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:12:44.260493 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.335704, "process_in_blocks": "1904", "process_kernel_time": 0.680627, "process_mem_max_rss": "110716", "process_out_blocks": "4352", "process_user_time": 4.124039}
[0m10:12:44.261492 [debug] [MainThread]: Command `dbt run` succeeded at 10:12:44.261322 after 2.34 seconds
[0m10:12:44.262068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0585672600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d05840fdd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d05850eb800>]}
[0m10:12:44.262730 [debug] [MainThread]: Flushing usage events
[0m10:12:45.737736 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:13:48.935651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fdb52283b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fdb5229160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fdb5228650>]}


============================== 10:13:48.944413 | 6634f519-31ae-4a2a-b0a6-a76e3ff15d7a ==============================
[0m10:13:48.944413 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:13:48.945160 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select beer_with_type', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:13:49.221417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6634f519-31ae-4a2a-b0a6-a76e3ff15d7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fdb7107350>]}
[0m10:13:49.314091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6634f519-31ae-4a2a-b0a6-a76e3ff15d7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fdb54a78c0>]}
[0m10:13:49.315234 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:13:49.458049 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:13:49.637184 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:13:49.638207 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:13:49.825668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6634f519-31ae-4a2a-b0a6-a76e3ff15d7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fdb3980200>]}
[0m10:13:50.140533 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:13:50.144166 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:13:50.181562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6634f519-31ae-4a2a-b0a6-a76e3ff15d7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fdb367dfa0>]}
[0m10:13:50.182384 [info ] [MainThread]: Found 5 models, 6 data tests, 5 sources, 429 macros
[0m10:13:50.184297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6634f519-31ae-4a2a-b0a6-a76e3ff15d7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fdb38ff170>]}
[0m10:13:50.186799 [info ] [MainThread]: 
[0m10:13:50.187412 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:13:50.188059 [info ] [MainThread]: 
[0m10:13:50.189406 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:13:50.191128 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m10:13:50.267606 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m10:13:50.268194 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m10:13:50.268696 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:13:50.283783 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.015 seconds
[0m10:13:50.285676 [debug] [ThreadPool]: On list_db: Close
[0m10:13:50.292572 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m10:13:50.301648 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m10:13:50.302532 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_dev_dev'
[0m10:13:50.303364 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m10:13:50.305712 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m10:13:50.306333 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:13:50.306930 [debug] [ThreadPool]: On list_db_dev_dev: BEGIN
[0m10:13:50.307773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:13:50.320075 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m10:13:50.321312 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m10:13:50.322552 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:13:50.323838 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m10:13:50.324700 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m10:13:50.325175 [debug] [ThreadPool]: On list_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_dev'
  
[0m10:13:50.329285 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.005 seconds
[0m10:13:50.331391 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m10:13:50.331899 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m10:13:50.334165 [debug] [ThreadPool]: On list_db_dev_dev: ROLLBACK
[0m10:13:50.334649 [debug] [ThreadPool]: On list_db_dev: Close
[0m10:13:50.335645 [debug] [ThreadPool]: On list_db_dev_dev: Close
[0m10:13:50.345266 [debug] [MainThread]: Using postgres connection "master"
[0m10:13:50.345802 [debug] [MainThread]: On master: BEGIN
[0m10:13:50.346323 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:13:50.358552 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m10:13:50.359357 [debug] [MainThread]: Using postgres connection "master"
[0m10:13:50.360085 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:13:50.364883 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m10:13:50.367766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6634f519-31ae-4a2a-b0a6-a76e3ff15d7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fdb54206e0>]}
[0m10:13:50.368536 [debug] [MainThread]: On master: ROLLBACK
[0m10:13:50.369637 [debug] [MainThread]: Using postgres connection "master"
[0m10:13:50.370236 [debug] [MainThread]: On master: BEGIN
[0m10:13:50.371438 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:13:50.372268 [debug] [MainThread]: On master: COMMIT
[0m10:13:50.372980 [debug] [MainThread]: Using postgres connection "master"
[0m10:13:50.373501 [debug] [MainThread]: On master: COMMIT
[0m10:13:50.374279 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:13:50.374829 [debug] [MainThread]: On master: Close
[0m10:13:50.379140 [debug] [Thread-1 (]: Began running node model.my_project.beer_with_type
[0m10:13:50.380291 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_dev.beer_with_type ............................ [RUN]
[0m10:13:50.381410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev_dev, now model.my_project.beer_with_type)
[0m10:13:50.382326 [debug] [Thread-1 (]: Began compiling node model.my_project.beer_with_type
[0m10:13:50.393254 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.beer_with_type"
[0m10:13:50.394226 [debug] [Thread-1 (]: Began executing node model.my_project.beer_with_type
[0m10:13:50.449062 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.beer_with_type"
[0m10:13:50.450475 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_with_type"
[0m10:13:50.450983 [debug] [Thread-1 (]: On model.my_project.beer_with_type: BEGIN
[0m10:13:50.451444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:13:50.463351 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m10:13:50.464635 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_with_type"
[0m10:13:50.465336 [debug] [Thread-1 (]: On model.my_project.beer_with_type: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_with_type"} */

  
    

  create  table "db"."dev_dev"."beer_with_type__dbt_tmp"
  
  
    as
  
  (
    

select
    beer_id,
    name,
    tagline,
    -- Add a "type" column, mapped from tagline patterns
    case
        when lower(tagline) like '%lager%' then 'Lager'
        when lower(tagline) like '%pilsner%' then 'Lager'
        when lower(tagline) like '%ipa%' then 'Ale'
        when lower(tagline) like '%stout%' then 'Ale'
        when lower(tagline) like '%porter%' then 'Ale'
        when lower(tagline) like '%ale%' then 'Ale'
        when lower(tagline) like '%wheat%' then 'Ale'
        -- Expand with more mappings as needed
        else 'Other'
    end as type,
    first_brewed,
    abv,
    ibu,
    ebc,
    ph,
    brewers_tips,
    contributed_by,
    inserted_at
from "db"."dev"."raw_beer_data"
  );
  
[0m10:13:50.472114 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.006 seconds
[0m10:13:50.480585 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_with_type"
[0m10:13:50.481135 [debug] [Thread-1 (]: On model.my_project.beer_with_type: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_with_type"} */
alter table "db"."dev_dev"."beer_with_type" rename to "beer_with_type__dbt_backup"
[0m10:13:50.482358 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:13:50.486159 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_with_type"
[0m10:13:50.486681 [debug] [Thread-1 (]: On model.my_project.beer_with_type: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_with_type"} */
alter table "db"."dev_dev"."beer_with_type__dbt_tmp" rename to "beer_with_type"
[0m10:13:50.487694 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:13:50.513614 [debug] [Thread-1 (]: On model.my_project.beer_with_type: COMMIT
[0m10:13:50.514404 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_with_type"
[0m10:13:50.514868 [debug] [Thread-1 (]: On model.my_project.beer_with_type: COMMIT
[0m10:13:50.529644 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m10:13:50.537834 [debug] [Thread-1 (]: Applying DROP to: "db"."dev_dev"."beer_with_type__dbt_backup"
[0m10:13:50.545946 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_with_type"
[0m10:13:50.546543 [debug] [Thread-1 (]: On model.my_project.beer_with_type: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_with_type"} */
drop table if exists "db"."dev_dev"."beer_with_type__dbt_backup" cascade
[0m10:13:50.553375 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m10:13:50.556701 [debug] [Thread-1 (]: On model.my_project.beer_with_type: Close
[0m10:13:50.558912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6634f519-31ae-4a2a-b0a6-a76e3ff15d7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fdb3982f60>]}
[0m10:13:50.559908 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_dev.beer_with_type ....................... [[32mSELECT 414[0m in 0.18s]
[0m10:13:50.561161 [debug] [Thread-1 (]: Finished running node model.my_project.beer_with_type
[0m10:13:50.564060 [debug] [MainThread]: Using postgres connection "master"
[0m10:13:50.564574 [debug] [MainThread]: On master: BEGIN
[0m10:13:50.565019 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:13:50.577579 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m10:13:50.578271 [debug] [MainThread]: On master: COMMIT
[0m10:13:50.578881 [debug] [MainThread]: Using postgres connection "master"
[0m10:13:50.579319 [debug] [MainThread]: On master: COMMIT
[0m10:13:50.580069 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:13:50.580605 [debug] [MainThread]: On master: Close
[0m10:13:50.581384 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:13:50.581838 [debug] [MainThread]: Connection 'list_db_dev' was properly closed.
[0m10:13:50.582463 [debug] [MainThread]: Connection 'model.my_project.beer_with_type' was properly closed.
[0m10:13:50.583170 [info ] [MainThread]: 
[0m10:13:50.583987 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m10:13:50.586373 [debug] [MainThread]: Command end result
[0m10:13:50.625539 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:13:50.627898 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:13:50.637537 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m10:13:50.638086 [info ] [MainThread]: 
[0m10:13:50.638816 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:13:50.639516 [info ] [MainThread]: 
[0m10:13:50.640523 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:13:50.642361 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7819381, "process_in_blocks": "0", "process_kernel_time": 0.436233, "process_mem_max_rss": "107376", "process_out_blocks": "3480", "process_user_time": 3.388884}
[0m10:13:50.643135 [debug] [MainThread]: Command `dbt run` succeeded at 10:13:50.642959 after 1.78 seconds
[0m10:13:50.643658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fdb554e4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fdb51e7fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fdb7e98b30>]}
[0m10:13:50.644212 [debug] [MainThread]: Flushing usage events
[0m10:13:52.109812 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:16:09.455145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbf4dda60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc02a8530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbf4de2d0>]}


============================== 10:16:09.463454 | 3c715d36-2e2f-44f0-b729-5bf30b182845 ==============================
[0m10:16:09.463454 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:16:09.464404 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select beer_with_type', 'send_anonymous_usage_stats': 'True'}
[0m10:16:09.742789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c715d36-2e2f-44f0-b729-5bf30b182845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbd68d100>]}
[0m10:16:09.946887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c715d36-2e2f-44f0-b729-5bf30b182845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbf229430>]}
[0m10:16:09.949147 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:16:10.179784 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:16:10.347076 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:16:10.347969 [debug] [MainThread]: Partial parsing: updated file: my_project://models/mart/beer_with_type.sql
[0m10:16:10.752378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c715d36-2e2f-44f0-b729-5bf30b182845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbd35c3b0>]}
[0m10:16:10.886014 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:16:10.889665 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:16:10.928319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c715d36-2e2f-44f0-b729-5bf30b182845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbd4fa570>]}
[0m10:16:10.929079 [info ] [MainThread]: Found 5 models, 6 data tests, 5 sources, 429 macros
[0m10:16:10.929743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c715d36-2e2f-44f0-b729-5bf30b182845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbd6fcb60>]}
[0m10:16:10.932839 [info ] [MainThread]: 
[0m10:16:10.933622 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:16:10.934443 [info ] [MainThread]: 
[0m10:16:10.935811 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:16:10.937607 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m10:16:11.007153 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m10:16:11.008024 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m10:16:11.008580 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:11.028369 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.020 seconds
[0m10:16:11.030304 [debug] [ThreadPool]: On list_db: Close
[0m10:16:11.037156 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m10:16:11.038226 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_dev_dev'
[0m10:16:11.046085 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m10:16:11.048616 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m10:16:11.049268 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m10:16:11.049848 [debug] [ThreadPool]: On list_db_dev_dev: BEGIN
[0m10:16:11.050409 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:16:11.050963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:11.063187 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m10:16:11.064234 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m10:16:11.065174 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m10:16:11.066216 [debug] [ThreadPool]: On list_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_dev'
  
[0m10:16:11.067164 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m10:16:11.068383 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:16:11.074434 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m10:16:11.077057 [debug] [ThreadPool]: On list_db_dev_dev: ROLLBACK
[0m10:16:11.077642 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.009 seconds
[0m10:16:11.079811 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m10:16:11.080334 [debug] [ThreadPool]: On list_db_dev_dev: Close
[0m10:16:11.082719 [debug] [ThreadPool]: On list_db_dev: Close
[0m10:16:11.092701 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:11.093300 [debug] [MainThread]: On master: BEGIN
[0m10:16:11.093731 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:16:11.106015 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m10:16:11.106752 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:11.107900 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:16:11.112815 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m10:16:11.115217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c715d36-2e2f-44f0-b729-5bf30b182845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbd70f7d0>]}
[0m10:16:11.116190 [debug] [MainThread]: On master: ROLLBACK
[0m10:16:11.117108 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:11.117624 [debug] [MainThread]: On master: BEGIN
[0m10:16:11.118803 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:16:11.119375 [debug] [MainThread]: On master: COMMIT
[0m10:16:11.120068 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:11.120557 [debug] [MainThread]: On master: COMMIT
[0m10:16:11.121348 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:16:11.121844 [debug] [MainThread]: On master: Close
[0m10:16:11.126481 [debug] [Thread-1 (]: Began running node model.my_project.beer_with_type
[0m10:16:11.127564 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_dev.beer_with_type ............................ [RUN]
[0m10:16:11.128508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.beer_with_type)
[0m10:16:11.129405 [debug] [Thread-1 (]: Began compiling node model.my_project.beer_with_type
[0m10:16:11.140202 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.beer_with_type"
[0m10:16:11.141126 [debug] [Thread-1 (]: Began executing node model.my_project.beer_with_type
[0m10:16:11.193512 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.beer_with_type"
[0m10:16:11.194463 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_with_type"
[0m10:16:11.195092 [debug] [Thread-1 (]: On model.my_project.beer_with_type: BEGIN
[0m10:16:11.195565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:11.207500 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m10:16:11.208482 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_with_type"
[0m10:16:11.209097 [debug] [Thread-1 (]: On model.my_project.beer_with_type: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_with_type"} */

  
    

  create  table "db"."dev_dev"."beer_with_type__dbt_tmp"
  
  
    as
  
  (
    

select
    beer_id,
    name,
    tagline,
    case
        when lower(tagline) like '%lager%' then 'Lager'
        when lower(tagline) like '%pilsner%' then 'Lager'
        when lower(tagline) like '%ipa%' then 'Ale'
        when lower(tagline) like '%stout%' then 'Ale'
        when lower(tagline) like '%porter%' then 'Ale'
        when lower(tagline) like '%ale%' then 'Ale'
        when lower(tagline) like '%wheat%' then 'Ale'
        -- add more mappings as needed
        else 'Other'
    end as type
from "db"."dev"."raw_beer_data"
  );
  
[0m10:16:11.215007 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.005 seconds
[0m10:16:11.223560 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_with_type"
[0m10:16:11.224272 [debug] [Thread-1 (]: On model.my_project.beer_with_type: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_with_type"} */
alter table "db"."dev_dev"."beer_with_type" rename to "beer_with_type__dbt_backup"
[0m10:16:11.225570 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:16:11.229389 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_with_type"
[0m10:16:11.229957 [debug] [Thread-1 (]: On model.my_project.beer_with_type: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_with_type"} */
alter table "db"."dev_dev"."beer_with_type__dbt_tmp" rename to "beer_with_type"
[0m10:16:11.230936 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:16:11.255538 [debug] [Thread-1 (]: On model.my_project.beer_with_type: COMMIT
[0m10:16:11.256054 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_with_type"
[0m10:16:11.256451 [debug] [Thread-1 (]: On model.my_project.beer_with_type: COMMIT
[0m10:16:11.320952 [debug] [Thread-1 (]: SQL status: COMMIT in 0.064 seconds
[0m10:16:11.337010 [debug] [Thread-1 (]: Applying DROP to: "db"."dev_dev"."beer_with_type__dbt_backup"
[0m10:16:11.356305 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_with_type"
[0m10:16:11.357801 [debug] [Thread-1 (]: On model.my_project.beer_with_type: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_with_type"} */
drop table if exists "db"."dev_dev"."beer_with_type__dbt_backup" cascade
[0m10:16:11.365218 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m10:16:11.368598 [debug] [Thread-1 (]: On model.my_project.beer_with_type: Close
[0m10:16:11.370712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c715d36-2e2f-44f0-b729-5bf30b182845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbfa96900>]}
[0m10:16:11.371556 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_dev.beer_with_type ....................... [[32mSELECT 414[0m in 0.24s]
[0m10:16:11.372763 [debug] [Thread-1 (]: Finished running node model.my_project.beer_with_type
[0m10:16:11.375712 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:11.376274 [debug] [MainThread]: On master: BEGIN
[0m10:16:11.376731 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:16:11.390385 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m10:16:11.391244 [debug] [MainThread]: On master: COMMIT
[0m10:16:11.392144 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:11.392963 [debug] [MainThread]: On master: COMMIT
[0m10:16:11.394041 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:16:11.394650 [debug] [MainThread]: On master: Close
[0m10:16:11.395421 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:16:11.395962 [debug] [MainThread]: Connection 'model.my_project.beer_with_type' was properly closed.
[0m10:16:11.396415 [debug] [MainThread]: Connection 'list_db_dev_dev' was properly closed.
[0m10:16:11.396936 [info ] [MainThread]: 
[0m10:16:11.397524 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m10:16:11.399510 [debug] [MainThread]: Command end result
[0m10:16:11.434986 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:16:11.437408 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:16:11.446341 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m10:16:11.446847 [info ] [MainThread]: 
[0m10:16:11.447630 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:16:11.448489 [info ] [MainThread]: 
[0m10:16:11.449387 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:16:11.451111 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0587864, "process_in_blocks": "0", "process_kernel_time": 0.539574, "process_mem_max_rss": "110536", "process_out_blocks": "4352", "process_user_time": 3.745046}
[0m10:16:11.451945 [debug] [MainThread]: Command `dbt run` succeeded at 10:16:11.451763 after 2.06 seconds
[0m10:16:11.452493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbf1d3530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbd26eb70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbfc0b890>]}
[0m10:16:11.453013 [debug] [MainThread]: Flushing usage events
[0m10:16:12.794853 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:19:07.008091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723c4fc7c500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723c500deff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723c504f3c20>]}


============================== 10:19:07.017003 | a4234aa7-72db-485d-bb61-3aab8cbabec0 ==============================
[0m10:19:07.017003 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:19:07.017888 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select beer_with_type', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:19:07.312698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4234aa7-72db-485d-bb61-3aab8cbabec0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723c4df5e150>]}
[0m10:19:07.401784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4234aa7-72db-485d-bb61-3aab8cbabec0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723c504d3f50>]}
[0m10:19:07.403003 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:19:07.554846 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:19:07.726392 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:19:07.726852 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:19:07.791606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4234aa7-72db-485d-bb61-3aab8cbabec0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723c4f7db530>]}
[0m10:19:07.921599 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:19:07.926081 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:19:07.965820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4234aa7-72db-485d-bb61-3aab8cbabec0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723c4dcbb170>]}
[0m10:19:07.967478 [info ] [MainThread]: Found 5 models, 6 data tests, 5 sources, 429 macros
[0m10:19:07.968212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4234aa7-72db-485d-bb61-3aab8cbabec0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723c4dfadfa0>]}
[0m10:19:07.970951 [info ] [MainThread]: 
[0m10:19:07.971543 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:19:07.972310 [info ] [MainThread]: 
[0m10:19:07.973493 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:19:07.975138 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m10:19:08.051575 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m10:19:08.052108 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m10:19:08.052541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:08.067766 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.015 seconds
[0m10:19:08.069623 [debug] [ThreadPool]: On list_db: Close
[0m10:19:08.076205 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev_dev)
[0m10:19:08.082498 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_dev'
[0m10:19:08.085100 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m10:19:08.087430 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m10:19:08.088163 [debug] [ThreadPool]: On list_db_dev_dev: BEGIN
[0m10:19:08.088733 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m10:19:08.089349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:19:08.089908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:08.102765 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m10:19:08.103862 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m10:19:08.104735 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m10:19:08.105724 [debug] [ThreadPool]: On list_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_dev'
  
[0m10:19:08.106792 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m10:19:08.107542 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:19:08.112874 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m10:19:08.113611 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.006 seconds
[0m10:19:08.115637 [debug] [ThreadPool]: On list_db_dev_dev: ROLLBACK
[0m10:19:08.117593 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m10:19:08.118562 [debug] [ThreadPool]: On list_db_dev_dev: Close
[0m10:19:08.119005 [debug] [ThreadPool]: On list_db_dev: Close
[0m10:19:08.128815 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:08.129443 [debug] [MainThread]: On master: BEGIN
[0m10:19:08.129907 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:19:08.141668 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m10:19:08.142376 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:08.143267 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:19:08.147926 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m10:19:08.149873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4234aa7-72db-485d-bb61-3aab8cbabec0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723c4dcde570>]}
[0m10:19:08.150509 [debug] [MainThread]: On master: ROLLBACK
[0m10:19:08.151430 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:08.152030 [debug] [MainThread]: On master: BEGIN
[0m10:19:08.153378 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:19:08.154040 [debug] [MainThread]: On master: COMMIT
[0m10:19:08.154753 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:08.155224 [debug] [MainThread]: On master: COMMIT
[0m10:19:08.155987 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:19:08.156461 [debug] [MainThread]: On master: Close
[0m10:19:08.160812 [debug] [Thread-1 (]: Began running node model.my_project.beer_with_type
[0m10:19:08.161813 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_dev.beer_with_type ............................ [RUN]
[0m10:19:08.162817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.beer_with_type)
[0m10:19:08.163828 [debug] [Thread-1 (]: Began compiling node model.my_project.beer_with_type
[0m10:19:08.175288 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.beer_with_type"
[0m10:19:08.176211 [debug] [Thread-1 (]: Began executing node model.my_project.beer_with_type
[0m10:19:08.232560 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.beer_with_type"
[0m10:19:08.233599 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_with_type"
[0m10:19:08.234204 [debug] [Thread-1 (]: On model.my_project.beer_with_type: BEGIN
[0m10:19:08.234831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:08.247171 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m10:19:08.248093 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_with_type"
[0m10:19:08.248959 [debug] [Thread-1 (]: On model.my_project.beer_with_type: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_with_type"} */

  
    

  create  table "db"."dev_dev"."beer_with_type__dbt_tmp"
  
  
    as
  
  (
    

select
    beer_id,
    name,
    tagline,
    case
        when lower(tagline) like '%lager%' then 'Lager'
        when lower(tagline) like '%pilsner%' then 'Lager'
        when lower(tagline) like '%ipa%' then 'Ale'
        when lower(tagline) like '%stout%' then 'Ale'
        when lower(tagline) like '%porter%' then 'Ale'
        when lower(tagline) like '%ale%' then 'Ale'
        when lower(tagline) like '%wheat%' then 'Ale'
        -- add more mappings as needed
        else 'Other'
    end as type
from "db"."dev"."raw_beer_data"
  );
  
[0m10:19:08.256304 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.007 seconds
[0m10:19:08.264630 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_with_type"
[0m10:19:08.265371 [debug] [Thread-1 (]: On model.my_project.beer_with_type: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_with_type"} */
alter table "db"."dev_dev"."beer_with_type" rename to "beer_with_type__dbt_backup"
[0m10:19:08.266829 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:19:08.270554 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_with_type"
[0m10:19:08.271090 [debug] [Thread-1 (]: On model.my_project.beer_with_type: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_with_type"} */
alter table "db"."dev_dev"."beer_with_type__dbt_tmp" rename to "beer_with_type"
[0m10:19:08.272068 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:19:08.298350 [debug] [Thread-1 (]: On model.my_project.beer_with_type: COMMIT
[0m10:19:08.299015 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_with_type"
[0m10:19:08.299464 [debug] [Thread-1 (]: On model.my_project.beer_with_type: COMMIT
[0m10:19:08.308385 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m10:19:08.316938 [debug] [Thread-1 (]: Applying DROP to: "db"."dev_dev"."beer_with_type__dbt_backup"
[0m10:19:08.325162 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_with_type"
[0m10:19:08.325769 [debug] [Thread-1 (]: On model.my_project.beer_with_type: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_with_type"} */
drop table if exists "db"."dev_dev"."beer_with_type__dbt_backup" cascade
[0m10:19:08.332329 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m10:19:08.335641 [debug] [Thread-1 (]: On model.my_project.beer_with_type: Close
[0m10:19:08.337814 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4234aa7-72db-485d-bb61-3aab8cbabec0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723c50332840>]}
[0m10:19:08.338657 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_dev.beer_with_type ....................... [[32mSELECT 414[0m in 0.17s]
[0m10:19:08.340091 [debug] [Thread-1 (]: Finished running node model.my_project.beer_with_type
[0m10:19:08.343045 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:08.343509 [debug] [MainThread]: On master: BEGIN
[0m10:19:08.343934 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:19:08.356639 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m10:19:08.357610 [debug] [MainThread]: On master: COMMIT
[0m10:19:08.358142 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:08.358605 [debug] [MainThread]: On master: COMMIT
[0m10:19:08.359431 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:19:08.359901 [debug] [MainThread]: On master: Close
[0m10:19:08.360634 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:19:08.361044 [debug] [MainThread]: Connection 'list_db_dev_dev' was properly closed.
[0m10:19:08.361553 [debug] [MainThread]: Connection 'model.my_project.beer_with_type' was properly closed.
[0m10:19:08.362008 [info ] [MainThread]: 
[0m10:19:08.362557 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m10:19:08.364216 [debug] [MainThread]: Command end result
[0m10:19:08.401739 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:19:08.404046 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:19:08.412418 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m10:19:08.412885 [info ] [MainThread]: 
[0m10:19:08.413546 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:19:08.414100 [info ] [MainThread]: 
[0m10:19:08.415010 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:19:08.417892 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4823455, "process_in_blocks": "0", "process_kernel_time": 0.56256, "process_mem_max_rss": "107372", "process_out_blocks": "3480", "process_user_time": 3.135978}
[0m10:19:08.418812 [debug] [MainThread]: Command `dbt run` succeeded at 10:19:08.418609 after 1.48 seconds
[0m10:19:08.419416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723c4f86c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723c4faecc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723c4e0095b0>]}
[0m10:19:08.419971 [debug] [MainThread]: Flushing usage events
[0m10:19:09.832022 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:21:55.081940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c85b0e4e6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c85b1493a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c85b0c52780>]}


============================== 10:21:55.091093 | a383a77a-3d8a-4f8c-9bef-8477dbdf0837 ==============================
[0m10:21:55.091093 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:21:55.092789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select beer_with_type', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:21:55.426182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a383a77a-3d8a-4f8c-9bef-8477dbdf0837', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c85aef765d0>]}
[0m10:21:55.519694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a383a77a-3d8a-4f8c-9bef-8477dbdf0837', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c85b1455a60>]}
[0m10:21:55.520734 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:21:55.673635 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:21:55.864342 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m10:21:55.865031 [debug] [MainThread]: Partial parsing: added file: my_project://models/mart/beer_types.sql
[0m10:21:55.865470 [debug] [MainThread]: Partial parsing: deleted file: my_project://models/mart/beer_with_type.sql
[0m10:21:56.290487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a383a77a-3d8a-4f8c-9bef-8477dbdf0837', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c85adacbd70>]}
[0m10:21:56.441966 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:21:56.446177 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:21:56.488519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a383a77a-3d8a-4f8c-9bef-8477dbdf0837', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c85aeddc230>]}
[0m10:21:56.489214 [info ] [MainThread]: Found 5 models, 6 data tests, 5 sources, 429 macros
[0m10:21:56.489820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a383a77a-3d8a-4f8c-9bef-8477dbdf0837', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c85aefa70b0>]}
[0m10:21:56.491592 [warn ] [MainThread]: The selection criterion 'beer_with_type' does not match any enabled nodes
[0m10:21:56.494494 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:21:56.495483 [debug] [MainThread]: Command end result
[0m10:21:56.584100 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:21:56.586425 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:21:56.592001 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m10:21:56.593507 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.589866, "process_in_blocks": "0", "process_kernel_time": 0.488033, "process_mem_max_rss": "102756", "process_out_blocks": "4312", "process_user_time": 3.188215}
[0m10:21:56.594292 [debug] [MainThread]: Command `dbt run` succeeded at 10:21:56.594132 after 1.59 seconds
[0m10:21:56.594816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c85b27b2180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c85b27b23c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c85aed68a40>]}
[0m10:21:56.595342 [debug] [MainThread]: Flushing usage events
[0m10:21:57.999644 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:22:23.055674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7119318594c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711931f99400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7119332a44d0>]}


============================== 10:22:23.064536 | d8e20a21-79db-470b-9800-23fbef9bea93 ==============================
[0m10:22:23.064536 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:22:23.065431 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select beer_types', 'send_anonymous_usage_stats': 'True'}
[0m10:22:23.370491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8e20a21-79db-470b-9800-23fbef9bea93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71193125af00>]}
[0m10:22:23.447197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8e20a21-79db-470b-9800-23fbef9bea93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7119313af260>]}
[0m10:22:23.448425 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:22:23.578276 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:22:23.765634 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:22:23.766137 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:22:23.827644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8e20a21-79db-470b-9800-23fbef9bea93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71192faabad0>]}
[0m10:22:23.945922 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:22:23.949891 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:22:23.984327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8e20a21-79db-470b-9800-23fbef9bea93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71192f7a79b0>]}
[0m10:22:23.985037 [info ] [MainThread]: Found 5 models, 6 data tests, 5 sources, 429 macros
[0m10:22:23.985669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8e20a21-79db-470b-9800-23fbef9bea93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71192faab8c0>]}
[0m10:22:23.988459 [info ] [MainThread]: 
[0m10:22:23.989169 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:22:23.989931 [info ] [MainThread]: 
[0m10:22:23.991232 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:22:23.993219 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m10:22:24.064312 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m10:22:24.064882 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m10:22:24.065283 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:22:24.079361 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.014 seconds
[0m10:22:24.081160 [debug] [ThreadPool]: On list_db: Close
[0m10:22:24.088382 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m10:22:24.089375 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_dev_dev'
[0m10:22:24.097168 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m10:22:24.099693 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m10:22:24.100314 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m10:22:24.100844 [debug] [ThreadPool]: On list_db_dev_dev: BEGIN
[0m10:22:24.101407 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:22:24.101936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:22:24.114501 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m10:22:24.115638 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m10:22:24.116555 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m10:22:24.117131 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:22:24.117689 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m10:22:24.118493 [debug] [ThreadPool]: On list_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_dev'
  
[0m10:22:24.122737 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m10:22:24.123523 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m10:22:24.125746 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m10:22:24.128139 [debug] [ThreadPool]: On list_db_dev_dev: ROLLBACK
[0m10:22:24.129088 [debug] [ThreadPool]: On list_db_dev: Close
[0m10:22:24.129493 [debug] [ThreadPool]: On list_db_dev_dev: Close
[0m10:22:24.139040 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:24.139579 [debug] [MainThread]: On master: BEGIN
[0m10:22:24.139984 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:22:24.151459 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m10:22:24.151989 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:24.152789 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:22:24.157117 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m10:22:24.159097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8e20a21-79db-470b-9800-23fbef9bea93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7119330cc6e0>]}
[0m10:22:24.159820 [debug] [MainThread]: On master: ROLLBACK
[0m10:22:24.160814 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:24.161383 [debug] [MainThread]: On master: BEGIN
[0m10:22:24.162448 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:22:24.163037 [debug] [MainThread]: On master: COMMIT
[0m10:22:24.163630 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:24.164037 [debug] [MainThread]: On master: COMMIT
[0m10:22:24.164733 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:22:24.165146 [debug] [MainThread]: On master: Close
[0m10:22:24.169303 [debug] [Thread-1 (]: Began running node model.my_project.beer_types
[0m10:22:24.170195 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_dev.beer_types ................................ [RUN]
[0m10:22:24.171354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev_dev, now model.my_project.beer_types)
[0m10:22:24.172318 [debug] [Thread-1 (]: Began compiling node model.my_project.beer_types
[0m10:22:24.183230 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.beer_types"
[0m10:22:24.183993 [debug] [Thread-1 (]: Began executing node model.my_project.beer_types
[0m10:22:24.236783 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.beer_types"
[0m10:22:24.237609 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m10:22:24.238077 [debug] [Thread-1 (]: On model.my_project.beer_types: BEGIN
[0m10:22:24.238548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:22:24.250640 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m10:22:24.251349 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m10:22:24.251938 [debug] [Thread-1 (]: On model.my_project.beer_types: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_types"} */

  
    

  create  table "db"."dev_dev"."beer_types__dbt_tmp"
  
  
    as
  
  (
    

select
    beer_id,
    name,
    tagline,
    case
        when lower(tagline) like '%lager%' then 'Lager'
        when lower(tagline) like '%pilsner%' then 'Lager'
        when lower(tagline) like '%ipa%' then 'Ale'
        when lower(tagline) like '%stout%' then 'Ale'
        when lower(tagline) like '%porter%' then 'Ale'
        when lower(tagline) like '%ale%' then 'Ale'
        when lower(tagline) like '%wheat%' then 'Ale'
        -- add more mappings as needed
        else 'Other'
    end as type
from "db"."dev"."raw_beer_data"
  );
  
[0m10:22:24.257288 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.005 seconds
[0m10:22:24.265618 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m10:22:24.266216 [debug] [Thread-1 (]: On model.my_project.beer_types: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_types"} */
alter table "db"."dev_dev"."beer_types__dbt_tmp" rename to "beer_types"
[0m10:22:24.267279 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:22:24.289927 [debug] [Thread-1 (]: On model.my_project.beer_types: COMMIT
[0m10:22:24.290477 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m10:22:24.290932 [debug] [Thread-1 (]: On model.my_project.beer_types: COMMIT
[0m10:22:24.297713 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m10:22:24.305744 [debug] [Thread-1 (]: Applying DROP to: "db"."dev_dev"."beer_types__dbt_backup"
[0m10:22:24.313085 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m10:22:24.313599 [debug] [Thread-1 (]: On model.my_project.beer_types: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_types"} */
drop table if exists "db"."dev_dev"."beer_types__dbt_backup" cascade
[0m10:22:24.314565 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:22:24.317837 [debug] [Thread-1 (]: On model.my_project.beer_types: Close
[0m10:22:24.320431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8e20a21-79db-470b-9800-23fbef9bea93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71192f629100>]}
[0m10:22:24.321363 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_dev.beer_types ........................... [[32mSELECT 414[0m in 0.15s]
[0m10:22:24.322392 [debug] [Thread-1 (]: Finished running node model.my_project.beer_types
[0m10:22:24.325054 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:24.325585 [debug] [MainThread]: On master: BEGIN
[0m10:22:24.326001 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:22:24.339606 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m10:22:24.340441 [debug] [MainThread]: On master: COMMIT
[0m10:22:24.341078 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:24.341612 [debug] [MainThread]: On master: COMMIT
[0m10:22:24.342544 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:22:24.343036 [debug] [MainThread]: On master: Close
[0m10:22:24.343767 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:22:24.344345 [debug] [MainThread]: Connection 'list_db_dev' was properly closed.
[0m10:22:24.345010 [debug] [MainThread]: Connection 'model.my_project.beer_types' was properly closed.
[0m10:22:24.345921 [info ] [MainThread]: 
[0m10:22:24.347132 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m10:22:24.349327 [debug] [MainThread]: Command end result
[0m10:22:24.386713 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:22:24.388899 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:22:24.397435 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m10:22:24.397973 [info ] [MainThread]: 
[0m10:22:24.398723 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:22:24.399369 [info ] [MainThread]: 
[0m10:22:24.400385 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:22:24.402097 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4273596, "process_in_blocks": "0", "process_kernel_time": 0.484846, "process_mem_max_rss": "107420", "process_out_blocks": "3480", "process_user_time": 2.897158}
[0m10:22:24.402899 [debug] [MainThread]: Command `dbt run` succeeded at 10:22:24.402735 after 1.43 seconds
[0m10:22:24.403427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711931915ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71192f7cf560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71192f5e90d0>]}
[0m10:22:24.403946 [debug] [MainThread]: Flushing usage events
[0m10:22:25.765574 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:32:55.528411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fca17ff140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fca17ff110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fca31fbfb0>]}


============================== 10:32:55.536999 | 85f47d75-fd61-42d7-b0c4-24a992117d0f ==============================
[0m10:32:55.536999 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:32:55.537904 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select type_by_year', 'send_anonymous_usage_stats': 'True'}
[0m10:32:55.861838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85f47d75-fd61-42d7-b0c4-24a992117d0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fca1de6000>]}
[0m10:32:55.954055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85f47d75-fd61-42d7-b0c4-24a992117d0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fca1477f50>]}
[0m10:32:55.955187 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:32:56.108618 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:32:56.303491 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m10:32:56.304370 [debug] [MainThread]: Partial parsing: added file: my_project://models/mart/type_by_year.sql
[0m10:32:56.768488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85f47d75-fd61-42d7-b0c4-24a992117d0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fca15c9730>]}
[0m10:32:56.914887 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:32:56.918624 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:32:56.959543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85f47d75-fd61-42d7-b0c4-24a992117d0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fc9e4d85f0>]}
[0m10:32:56.960302 [info ] [MainThread]: Found 6 models, 6 data tests, 5 sources, 429 macros
[0m10:32:56.960880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85f47d75-fd61-42d7-b0c4-24a992117d0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fc9f7aacf0>]}
[0m10:32:56.963576 [info ] [MainThread]: 
[0m10:32:56.964457 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:32:56.965278 [info ] [MainThread]: 
[0m10:32:56.967052 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:32:56.969054 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m10:32:57.047987 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m10:32:57.048569 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m10:32:57.049009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:32:57.064761 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.016 seconds
[0m10:32:57.066658 [debug] [ThreadPool]: On list_db: Close
[0m10:32:57.074167 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m10:32:57.075282 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_dev_dev'
[0m10:32:57.083110 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m10:32:57.085509 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m10:32:57.086110 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m10:32:57.086676 [debug] [ThreadPool]: On list_db_dev_dev: BEGIN
[0m10:32:57.087237 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:32:57.087789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:32:57.101296 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m10:32:57.101986 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m10:32:57.103018 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m10:32:57.103869 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m10:32:57.104662 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:32:57.105300 [debug] [ThreadPool]: On list_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_dev'
  
[0m10:32:57.110726 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.005 seconds
[0m10:32:57.111456 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m10:32:57.113575 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m10:32:57.115689 [debug] [ThreadPool]: On list_db_dev_dev: ROLLBACK
[0m10:32:57.116721 [debug] [ThreadPool]: On list_db_dev: Close
[0m10:32:57.117172 [debug] [ThreadPool]: On list_db_dev_dev: Close
[0m10:32:57.126915 [debug] [MainThread]: Using postgres connection "master"
[0m10:32:57.127449 [debug] [MainThread]: On master: BEGIN
[0m10:32:57.127877 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:32:57.140202 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m10:32:57.140936 [debug] [MainThread]: Using postgres connection "master"
[0m10:32:57.141710 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:32:57.146457 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m10:32:57.148613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85f47d75-fd61-42d7-b0c4-24a992117d0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fc9e48e930>]}
[0m10:32:57.149470 [debug] [MainThread]: On master: ROLLBACK
[0m10:32:57.150710 [debug] [MainThread]: Using postgres connection "master"
[0m10:32:57.151239 [debug] [MainThread]: On master: BEGIN
[0m10:32:57.152455 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:32:57.152975 [debug] [MainThread]: On master: COMMIT
[0m10:32:57.153586 [debug] [MainThread]: Using postgres connection "master"
[0m10:32:57.154114 [debug] [MainThread]: On master: COMMIT
[0m10:32:57.154818 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:32:57.155294 [debug] [MainThread]: On master: Close
[0m10:32:57.160423 [debug] [Thread-1 (]: Began running node model.my_project.type_by_year
[0m10:32:57.161470 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_dev.type_by_year .............................. [RUN]
[0m10:32:57.162488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev_dev, now model.my_project.type_by_year)
[0m10:32:57.163323 [debug] [Thread-1 (]: Began compiling node model.my_project.type_by_year
[0m10:32:57.175601 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.type_by_year"
[0m10:32:57.176536 [debug] [Thread-1 (]: Began executing node model.my_project.type_by_year
[0m10:32:57.233216 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.type_by_year"
[0m10:32:57.234127 [debug] [Thread-1 (]: Using postgres connection "model.my_project.type_by_year"
[0m10:32:57.234639 [debug] [Thread-1 (]: On model.my_project.type_by_year: BEGIN
[0m10:32:57.235081 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:32:57.247555 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m10:32:57.248203 [debug] [Thread-1 (]: Using postgres connection "model.my_project.type_by_year"
[0m10:32:57.248939 [debug] [Thread-1 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */

  
    

  create  table "db"."dev_dev"."type_by_year__dbt_tmp"
  
  
    as
  
  (
    

select
    type,
    left(first_brewed, 4) as year,
    count(*) as beer_count
from "db"."dev_dev"."beer_types"
group by type, left(first_brewed, 4)
order by year, type
  );
  
[0m10:32:57.250431 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "first_brewed" does not exist
LINE 16:     left(first_brewed, 4) as year,
                  ^

[0m10:32:57.251030 [debug] [Thread-1 (]: On model.my_project.type_by_year: ROLLBACK
[0m10:32:57.252003 [debug] [Thread-1 (]: On model.my_project.type_by_year: Close
[0m10:32:57.267137 [debug] [Thread-1 (]: Database Error in model type_by_year (models/mart/type_by_year.sql)
  column "first_brewed" does not exist
  LINE 16:     left(first_brewed, 4) as year,
                    ^
  compiled code at target/run/my_project/models/mart/type_by_year.sql
[0m10:32:57.271274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85f47d75-fd61-42d7-b0c4-24a992117d0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fc9d69a1e0>]}
[0m10:32:57.273462 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_dev.type_by_year ..................... [[31mERROR[0m in 0.11s]
[0m10:32:57.276961 [debug] [Thread-1 (]: Finished running node model.my_project.type_by_year
[0m10:32:57.278898 [debug] [Thread-7 (]: Marking all children of 'model.my_project.type_by_year' to be skipped because of status 'error'.  Reason: Database Error in model type_by_year (models/mart/type_by_year.sql)
  column "first_brewed" does not exist
  LINE 16:     left(first_brewed, 4) as year,
                    ^
  compiled code at target/run/my_project/models/mart/type_by_year.sql.
[0m10:32:57.283883 [debug] [MainThread]: Using postgres connection "master"
[0m10:32:57.284666 [debug] [MainThread]: On master: BEGIN
[0m10:32:57.285413 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:32:57.300553 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m10:32:57.301427 [debug] [MainThread]: On master: COMMIT
[0m10:32:57.302181 [debug] [MainThread]: Using postgres connection "master"
[0m10:32:57.302667 [debug] [MainThread]: On master: COMMIT
[0m10:32:57.303440 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:32:57.303951 [debug] [MainThread]: On master: Close
[0m10:32:57.304835 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:32:57.305577 [debug] [MainThread]: Connection 'list_db_dev' was properly closed.
[0m10:32:57.306296 [debug] [MainThread]: Connection 'model.my_project.type_by_year' was properly closed.
[0m10:32:57.307286 [info ] [MainThread]: 
[0m10:32:57.308539 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m10:32:57.313443 [debug] [MainThread]: Command end result
[0m10:32:57.351647 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:32:57.354015 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:32:57.363219 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m10:32:57.363730 [info ] [MainThread]: 
[0m10:32:57.364383 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:32:57.365225 [info ] [MainThread]: 
[0m10:32:57.366333 [error] [MainThread]:   Database Error in model type_by_year (models/mart/type_by_year.sql)
  column "first_brewed" does not exist
  LINE 16:     left(first_brewed, 4) as year,
                    ^
  compiled code at target/run/my_project/models/mart/type_by_year.sql
[0m10:32:57.367076 [info ] [MainThread]: 
[0m10:32:57.367872 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:32:57.369700 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.9102436, "process_in_blocks": "0", "process_kernel_time": 0.698075, "process_mem_max_rss": "111232", "process_out_blocks": "4352", "process_user_time": 4.168276}
[0m10:32:57.370462 [debug] [MainThread]: Command `dbt run` failed at 10:32:57.370303 after 1.91 seconds
[0m10:32:57.371028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fca17ff140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fc9f72eff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fca1aecc80>]}
[0m10:32:57.371556 [debug] [MainThread]: Flushing usage events
[0m10:32:58.725235 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:33:47.827159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c7729bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c77f06270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c7740e330>]}


============================== 10:33:47.835111 | cfb18406-0b49-4652-8585-4edc50e0d085 ==============================
[0m10:33:47.835111 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:33:47.836361 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select type_by_year', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:33:48.103251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cfb18406-0b49-4652-8585-4edc50e0d085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c773342f0>]}
[0m10:33:48.187355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cfb18406-0b49-4652-8585-4edc50e0d085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c779c3830>]}
[0m10:33:48.188500 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:33:48.312274 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:33:48.478487 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:33:48.479273 [debug] [MainThread]: Partial parsing: updated file: my_project://models/mart/type_by_year.sql
[0m10:33:48.903133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cfb18406-0b49-4652-8585-4edc50e0d085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c753f0bf0>]}
[0m10:33:49.028609 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:33:49.032551 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:33:49.068814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cfb18406-0b49-4652-8585-4edc50e0d085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c75323b30>]}
[0m10:33:49.069462 [info ] [MainThread]: Found 6 models, 6 data tests, 5 sources, 429 macros
[0m10:33:49.070037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfb18406-0b49-4652-8585-4edc50e0d085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c754f77d0>]}
[0m10:33:49.072349 [info ] [MainThread]: 
[0m10:33:49.072904 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:33:49.073636 [info ] [MainThread]: 
[0m10:33:49.074568 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:33:49.076054 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m10:33:49.149231 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m10:33:49.149765 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m10:33:49.150167 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:33:49.164946 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.015 seconds
[0m10:33:49.166704 [debug] [ThreadPool]: On list_db: Close
[0m10:33:49.174308 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m10:33:49.175557 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_dev_dev'
[0m10:33:49.183669 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m10:33:49.186239 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m10:33:49.186905 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m10:33:49.187481 [debug] [ThreadPool]: On list_db_dev_dev: BEGIN
[0m10:33:49.188030 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:33:49.188578 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:33:49.200693 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m10:33:49.201633 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m10:33:49.202486 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m10:33:49.203129 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m10:33:49.203698 [debug] [ThreadPool]: On list_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_dev'
  
[0m10:33:49.204370 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:33:49.210191 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m10:33:49.211109 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.006 seconds
[0m10:33:49.213175 [debug] [ThreadPool]: On list_db_dev_dev: ROLLBACK
[0m10:33:49.215126 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m10:33:49.216075 [debug] [ThreadPool]: On list_db_dev_dev: Close
[0m10:33:49.216555 [debug] [ThreadPool]: On list_db_dev: Close
[0m10:33:49.226182 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:49.226687 [debug] [MainThread]: On master: BEGIN
[0m10:33:49.227163 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:33:49.239782 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m10:33:49.240583 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:49.241473 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:33:49.246854 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m10:33:49.249511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfb18406-0b49-4652-8585-4edc50e0d085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c76f735c0>]}
[0m10:33:49.250281 [debug] [MainThread]: On master: ROLLBACK
[0m10:33:49.251148 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:49.251622 [debug] [MainThread]: On master: BEGIN
[0m10:33:49.252871 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:33:49.253801 [debug] [MainThread]: On master: COMMIT
[0m10:33:49.254406 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:49.254835 [debug] [MainThread]: On master: COMMIT
[0m10:33:49.255633 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:33:49.256119 [debug] [MainThread]: On master: Close
[0m10:33:49.260618 [debug] [Thread-1 (]: Began running node model.my_project.type_by_year
[0m10:33:49.261733 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_dev.type_by_year .............................. [RUN]
[0m10:33:49.262516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.type_by_year)
[0m10:33:49.263354 [debug] [Thread-1 (]: Began compiling node model.my_project.type_by_year
[0m10:33:49.274333 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.type_by_year"
[0m10:33:49.275195 [debug] [Thread-1 (]: Began executing node model.my_project.type_by_year
[0m10:33:49.329527 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.type_by_year"
[0m10:33:49.330683 [debug] [Thread-1 (]: Using postgres connection "model.my_project.type_by_year"
[0m10:33:49.331262 [debug] [Thread-1 (]: On model.my_project.type_by_year: BEGIN
[0m10:33:49.331754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:33:49.344505 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m10:33:49.345419 [debug] [Thread-1 (]: Using postgres connection "model.my_project.type_by_year"
[0m10:33:49.346158 [debug] [Thread-1 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */

  
    

  create  table "db"."dev_dev"."type_by_year__dbt_tmp"
  
  
    as
  
  (
    

with beer_years as (
    select
        beer_id,
        type,
        -- Safely extract the year as a 4-digit string (null if not present)
        regexp_extract(first_brewed, '(\\d{4})') as year
    from "db"."dev_dev"."beer_types"
    where first_brewed ~ '\\d{4}'
)

select
    year,
    type,
    count(*) as beer_count
from beer_years
where year is not null
group by year, type
order by year, type
  );
  
[0m10:33:49.347614 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "first_brewed" does not exist
LINE 19:         regexp_extract(first_brewed, '(\\d{4})') as year
                                ^

[0m10:33:49.348693 [debug] [Thread-1 (]: On model.my_project.type_by_year: ROLLBACK
[0m10:33:49.350317 [debug] [Thread-1 (]: On model.my_project.type_by_year: Close
[0m10:33:49.359949 [debug] [Thread-1 (]: Database Error in model type_by_year (models/mart/type_by_year.sql)
  column "first_brewed" does not exist
  LINE 19:         regexp_extract(first_brewed, '(\\d{4})') as year
                                  ^
  compiled code at target/run/my_project/models/mart/type_by_year.sql
[0m10:33:49.364955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfb18406-0b49-4652-8585-4edc50e0d085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c7421af60>]}
[0m10:33:49.366986 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_dev.type_by_year ..................... [[31mERROR[0m in 0.10s]
[0m10:33:49.368891 [debug] [Thread-1 (]: Finished running node model.my_project.type_by_year
[0m10:33:49.370543 [debug] [Thread-7 (]: Marking all children of 'model.my_project.type_by_year' to be skipped because of status 'error'.  Reason: Database Error in model type_by_year (models/mart/type_by_year.sql)
  column "first_brewed" does not exist
  LINE 19:         regexp_extract(first_brewed, '(\\d{4})') as year
                                  ^
  compiled code at target/run/my_project/models/mart/type_by_year.sql.
[0m10:33:49.375354 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:49.376450 [debug] [MainThread]: On master: BEGIN
[0m10:33:49.377723 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:33:49.391229 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m10:33:49.392072 [debug] [MainThread]: On master: COMMIT
[0m10:33:49.392561 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:49.393048 [debug] [MainThread]: On master: COMMIT
[0m10:33:49.393814 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:33:49.394347 [debug] [MainThread]: On master: Close
[0m10:33:49.395029 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:33:49.395444 [debug] [MainThread]: Connection 'model.my_project.type_by_year' was properly closed.
[0m10:33:49.395834 [debug] [MainThread]: Connection 'list_db_dev_dev' was properly closed.
[0m10:33:49.396288 [info ] [MainThread]: 
[0m10:33:49.396943 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m10:33:49.398604 [debug] [MainThread]: Command end result
[0m10:33:49.437186 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:33:49.439395 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:33:49.447864 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m10:33:49.448338 [info ] [MainThread]: 
[0m10:33:49.449470 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:33:49.450495 [info ] [MainThread]: 
[0m10:33:49.451600 [error] [MainThread]:   Database Error in model type_by_year (models/mart/type_by_year.sql)
  column "first_brewed" does not exist
  LINE 19:         regexp_extract(first_brewed, '(\\d{4})') as year
                                  ^
  compiled code at target/run/my_project/models/mart/type_by_year.sql
[0m10:33:49.452496 [info ] [MainThread]: 
[0m10:33:49.453534 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:33:49.455548 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6900257, "process_in_blocks": "0", "process_kernel_time": 0.468622, "process_mem_max_rss": "110852", "process_out_blocks": "4352", "process_user_time": 3.192239}
[0m10:33:49.456294 [debug] [MainThread]: Command `dbt run` failed at 10:33:49.456135 after 1.69 seconds
[0m10:33:49.456898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c77b457f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c774e1520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c7747cc80>]}
[0m10:33:49.457561 [debug] [MainThread]: Flushing usage events
[0m10:33:50.896460 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:35:29.855081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793dd6d4cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793dd6e43ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793dd6d4d070>]}


============================== 10:35:29.862943 | ea07c477-1e50-42a5-9c93-bb080e2501ee ==============================
[0m10:35:29.862943 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:35:29.863763 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select type_by_year', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:35:30.153984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea07c477-1e50-42a5-9c93-bb080e2501ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793dd61233e0>]}
[0m10:35:30.234362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea07c477-1e50-42a5-9c93-bb080e2501ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793dd6357470>]}
[0m10:35:30.235355 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:35:30.358694 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:35:30.538144 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:35:30.539068 [debug] [MainThread]: Partial parsing: updated file: my_project://models/mart/type_by_year.sql
[0m10:35:30.929515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea07c477-1e50-42a5-9c93-bb080e2501ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793dd4495070>]}
[0m10:35:31.051487 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:35:31.054647 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:35:31.089444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea07c477-1e50-42a5-9c93-bb080e2501ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793dcf394920>]}
[0m10:35:31.090090 [info ] [MainThread]: Found 6 models, 6 data tests, 5 sources, 429 macros
[0m10:35:31.090651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea07c477-1e50-42a5-9c93-bb080e2501ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793dcf3634a0>]}
[0m10:35:31.093126 [info ] [MainThread]: 
[0m10:35:31.093700 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:35:31.094266 [info ] [MainThread]: 
[0m10:35:31.095268 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:35:31.096913 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m10:35:31.171601 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m10:35:31.172190 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m10:35:31.172591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:31.187278 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.015 seconds
[0m10:35:31.189168 [debug] [ThreadPool]: On list_db: Close
[0m10:35:31.196329 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m10:35:31.202637 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_dev_dev'
[0m10:35:31.204990 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m10:35:31.207305 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m10:35:31.207873 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m10:35:31.208419 [debug] [ThreadPool]: On list_db_dev_dev: BEGIN
[0m10:35:31.209019 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:35:31.209554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:31.221778 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m10:35:31.222754 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m10:35:31.223322 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m10:35:31.223899 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m10:35:31.224456 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:35:31.225125 [debug] [ThreadPool]: On list_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_dev'
  
[0m10:35:31.231731 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.006 seconds
[0m10:35:31.234335 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m10:35:31.235120 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m10:35:31.237630 [debug] [ThreadPool]: On list_db_dev_dev: ROLLBACK
[0m10:35:31.238164 [debug] [ThreadPool]: On list_db_dev: Close
[0m10:35:31.241670 [debug] [ThreadPool]: On list_db_dev_dev: Close
[0m10:35:31.249077 [debug] [MainThread]: Using postgres connection "master"
[0m10:35:31.249626 [debug] [MainThread]: On master: BEGIN
[0m10:35:31.250081 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:35:31.262133 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m10:35:31.262789 [debug] [MainThread]: Using postgres connection "master"
[0m10:35:31.263440 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:35:31.268782 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m10:35:31.270895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea07c477-1e50-42a5-9c93-bb080e2501ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793dcf395850>]}
[0m10:35:31.271595 [debug] [MainThread]: On master: ROLLBACK
[0m10:35:31.272490 [debug] [MainThread]: Using postgres connection "master"
[0m10:35:31.273206 [debug] [MainThread]: On master: BEGIN
[0m10:35:31.274394 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:35:31.274973 [debug] [MainThread]: On master: COMMIT
[0m10:35:31.275668 [debug] [MainThread]: Using postgres connection "master"
[0m10:35:31.276160 [debug] [MainThread]: On master: COMMIT
[0m10:35:31.277044 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:35:31.277553 [debug] [MainThread]: On master: Close
[0m10:35:31.281853 [debug] [Thread-1 (]: Began running node model.my_project.type_by_year
[0m10:35:31.282708 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_dev.type_by_year .............................. [RUN]
[0m10:35:31.283596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev_dev, now model.my_project.type_by_year)
[0m10:35:31.284563 [debug] [Thread-1 (]: Began compiling node model.my_project.type_by_year
[0m10:35:31.296305 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.type_by_year"
[0m10:35:31.297277 [debug] [Thread-1 (]: Began executing node model.my_project.type_by_year
[0m10:35:31.352041 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.type_by_year"
[0m10:35:31.353194 [debug] [Thread-1 (]: Using postgres connection "model.my_project.type_by_year"
[0m10:35:31.354011 [debug] [Thread-1 (]: On model.my_project.type_by_year: BEGIN
[0m10:35:31.354505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:35:31.366047 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m10:35:31.366963 [debug] [Thread-1 (]: Using postgres connection "model.my_project.type_by_year"
[0m10:35:31.367508 [debug] [Thread-1 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */

  
    

  create  table "db"."dev_dev"."type_by_year__dbt_tmp"
  
  
    as
  
  (
    

select
    beer_id,
    name,
    tagline,
    first_brewed,   -- <--- add this column!
    case
        when lower(tagline) like '%lager%' then 'Lager'
        when lower(tagline) like '%pilsner%' then 'Lager'
        when lower(tagline) like '%ipa%' then 'Ale'
        when lower(tagline) like '%stout%' then 'Ale'
        when lower(tagline) like '%porter%' then 'Ale'
        when lower(tagline) like '%ale%' then 'Ale'
        when lower(tagline) like '%wheat%' then 'Ale'
        else 'Other'
    end as type
from "db"."dev"."raw_beer_data"
  );
  
[0m10:35:31.375288 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.007 seconds
[0m10:35:31.383414 [debug] [Thread-1 (]: Using postgres connection "model.my_project.type_by_year"
[0m10:35:31.383970 [debug] [Thread-1 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */
alter table "db"."dev_dev"."type_by_year__dbt_tmp" rename to "type_by_year"
[0m10:35:31.385022 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:35:31.407975 [debug] [Thread-1 (]: On model.my_project.type_by_year: COMMIT
[0m10:35:31.408500 [debug] [Thread-1 (]: Using postgres connection "model.my_project.type_by_year"
[0m10:35:31.408979 [debug] [Thread-1 (]: On model.my_project.type_by_year: COMMIT
[0m10:35:31.557711 [debug] [Thread-1 (]: SQL status: COMMIT in 0.148 seconds
[0m10:35:31.576013 [debug] [Thread-1 (]: Applying DROP to: "db"."dev_dev"."type_by_year__dbt_backup"
[0m10:35:31.586930 [debug] [Thread-1 (]: Using postgres connection "model.my_project.type_by_year"
[0m10:35:31.587443 [debug] [Thread-1 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */
drop table if exists "db"."dev_dev"."type_by_year__dbt_backup" cascade
[0m10:35:31.588470 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:35:31.591582 [debug] [Thread-1 (]: On model.my_project.type_by_year: Close
[0m10:35:31.594022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea07c477-1e50-42a5-9c93-bb080e2501ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793dd80a2510>]}
[0m10:35:31.594902 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_dev.type_by_year ......................... [[32mSELECT 414[0m in 0.31s]
[0m10:35:31.596127 [debug] [Thread-1 (]: Finished running node model.my_project.type_by_year
[0m10:35:31.599077 [debug] [MainThread]: Using postgres connection "master"
[0m10:35:31.599574 [debug] [MainThread]: On master: BEGIN
[0m10:35:31.600003 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:35:31.612635 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m10:35:31.613458 [debug] [MainThread]: On master: COMMIT
[0m10:35:31.613962 [debug] [MainThread]: Using postgres connection "master"
[0m10:35:31.614409 [debug] [MainThread]: On master: COMMIT
[0m10:35:31.615174 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:35:31.615648 [debug] [MainThread]: On master: Close
[0m10:35:31.616325 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:35:31.616802 [debug] [MainThread]: Connection 'list_db_dev' was properly closed.
[0m10:35:31.617205 [debug] [MainThread]: Connection 'model.my_project.type_by_year' was properly closed.
[0m10:35:31.617664 [info ] [MainThread]: 
[0m10:35:31.618255 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m10:35:31.620016 [debug] [MainThread]: Command end result
[0m10:35:31.657667 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:35:31.659955 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:35:31.668590 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m10:35:31.669132 [info ] [MainThread]: 
[0m10:35:31.669810 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:35:31.670481 [info ] [MainThread]: 
[0m10:35:31.671594 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:35:31.673591 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8823838, "process_in_blocks": "0", "process_kernel_time": 0.524907, "process_mem_max_rss": "109852", "process_out_blocks": "4352", "process_user_time": 3.097357}
[0m10:35:31.674362 [debug] [MainThread]: Command `dbt run` succeeded at 10:35:31.674202 after 1.88 seconds
[0m10:35:31.674877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793dd7fe5d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793dd6cc10a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793dcf357ef0>]}
[0m10:35:31.675410 [debug] [MainThread]: Flushing usage events
[0m10:35:33.017432 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:40:22.763333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7975b8a22e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7975ba3fc6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7975b863fd40>]}


============================== 10:40:22.775283 | 84675e09-3e1a-40b4-acda-c5a0b0f65be6 ==============================
[0m10:40:22.775283 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:40:22.776546 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select abv_histogram', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:40:23.208284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84675e09-3e1a-40b4-acda-c5a0b0f65be6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7975b6b482c0>]}
[0m10:40:23.296402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84675e09-3e1a-40b4-acda-c5a0b0f65be6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7975b9847770>]}
[0m10:40:23.297506 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:40:23.432657 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:40:23.599272 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m10:40:23.599975 [debug] [MainThread]: Partial parsing: added file: my_project://models/mart/abv_histogram.sql
[0m10:40:24.006565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84675e09-3e1a-40b4-acda-c5a0b0f65be6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7975b6bbd100>]}
[0m10:40:24.131548 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:40:24.136474 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:40:24.172485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84675e09-3e1a-40b4-acda-c5a0b0f65be6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7975b5638d40>]}
[0m10:40:24.173131 [info ] [MainThread]: Found 7 models, 6 data tests, 5 sources, 429 macros
[0m10:40:24.173654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84675e09-3e1a-40b4-acda-c5a0b0f65be6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7975b565c350>]}
[0m10:40:24.176173 [info ] [MainThread]: 
[0m10:40:24.176774 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:40:24.177486 [info ] [MainThread]: 
[0m10:40:24.178507 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:40:24.180202 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m10:40:24.248801 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m10:40:24.249375 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m10:40:24.249807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:40:24.264174 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.014 seconds
[0m10:40:24.266054 [debug] [ThreadPool]: On list_db: Close
[0m10:40:24.273346 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev_dev)
[0m10:40:24.274590 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_dev'
[0m10:40:24.282924 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m10:40:24.285245 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m10:40:24.285851 [debug] [ThreadPool]: On list_db_dev_dev: BEGIN
[0m10:40:24.286410 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m10:40:24.286968 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:40:24.287512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:40:24.300582 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m10:40:24.301466 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m10:40:24.301982 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m10:40:24.302514 [debug] [ThreadPool]: On list_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_dev'
  
[0m10:40:24.303199 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m10:40:24.303953 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:40:24.308492 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m10:40:24.309428 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.005 seconds
[0m10:40:24.312147 [debug] [ThreadPool]: On list_db_dev_dev: ROLLBACK
[0m10:40:24.314960 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m10:40:24.316230 [debug] [ThreadPool]: On list_db_dev_dev: Close
[0m10:40:24.316779 [debug] [ThreadPool]: On list_db_dev: Close
[0m10:40:24.326779 [debug] [MainThread]: Using postgres connection "master"
[0m10:40:24.327325 [debug] [MainThread]: On master: BEGIN
[0m10:40:24.327791 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:40:24.339867 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m10:40:24.340673 [debug] [MainThread]: Using postgres connection "master"
[0m10:40:24.341434 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:40:24.346781 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m10:40:24.348995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84675e09-3e1a-40b4-acda-c5a0b0f65be6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7975ba2245c0>]}
[0m10:40:24.349877 [debug] [MainThread]: On master: ROLLBACK
[0m10:40:24.350796 [debug] [MainThread]: Using postgres connection "master"
[0m10:40:24.351268 [debug] [MainThread]: On master: BEGIN
[0m10:40:24.352452 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:40:24.352991 [debug] [MainThread]: On master: COMMIT
[0m10:40:24.353609 [debug] [MainThread]: Using postgres connection "master"
[0m10:40:24.354099 [debug] [MainThread]: On master: COMMIT
[0m10:40:24.354871 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:40:24.355344 [debug] [MainThread]: On master: Close
[0m10:40:24.359694 [debug] [Thread-1 (]: Began running node model.my_project.abv_histogram
[0m10:40:24.360634 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_dev.abv_histogram ............................. [RUN]
[0m10:40:24.361545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.abv_histogram)
[0m10:40:24.362408 [debug] [Thread-1 (]: Began compiling node model.my_project.abv_histogram
[0m10:40:24.373409 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.abv_histogram"
[0m10:40:24.374247 [debug] [Thread-1 (]: Began executing node model.my_project.abv_histogram
[0m10:40:24.426054 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.abv_histogram"
[0m10:40:24.426987 [debug] [Thread-1 (]: Using postgres connection "model.my_project.abv_histogram"
[0m10:40:24.427438 [debug] [Thread-1 (]: On model.my_project.abv_histogram: BEGIN
[0m10:40:24.427857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:24.439444 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m10:40:24.440244 [debug] [Thread-1 (]: Using postgres connection "model.my_project.abv_histogram"
[0m10:40:24.441028 [debug] [Thread-1 (]: On model.my_project.abv_histogram: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.abv_histogram"} */

  
    

  create  table "db"."dev_dev"."abv_histogram__dbt_tmp"
  
  
    as
  
  (
    

select
    abv
from "db"."dev_dev"."beer_types"
where abv is not null
  );
  
[0m10:40:24.442473 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "abv" does not exist
LINE 15:     abv
             ^

[0m10:40:24.443742 [debug] [Thread-1 (]: On model.my_project.abv_histogram: ROLLBACK
[0m10:40:24.445500 [debug] [Thread-1 (]: On model.my_project.abv_histogram: Close
[0m10:40:24.457393 [debug] [Thread-1 (]: Database Error in model abv_histogram (models/mart/abv_histogram.sql)
  column "abv" does not exist
  LINE 15:     abv
               ^
  compiled code at target/run/my_project/models/mart/abv_histogram.sql
[0m10:40:24.461026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84675e09-3e1a-40b4-acda-c5a0b0f65be6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7975b48b6f60>]}
[0m10:40:24.462251 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_dev.abv_histogram .................... [[31mERROR[0m in 0.10s]
[0m10:40:24.463694 [debug] [Thread-1 (]: Finished running node model.my_project.abv_histogram
[0m10:40:24.464969 [debug] [Thread-7 (]: Marking all children of 'model.my_project.abv_histogram' to be skipped because of status 'error'.  Reason: Database Error in model abv_histogram (models/mart/abv_histogram.sql)
  column "abv" does not exist
  LINE 15:     abv
               ^
  compiled code at target/run/my_project/models/mart/abv_histogram.sql.
[0m10:40:24.469769 [debug] [MainThread]: Using postgres connection "master"
[0m10:40:24.470334 [debug] [MainThread]: On master: BEGIN
[0m10:40:24.470944 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:40:24.483482 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m10:40:24.485009 [debug] [MainThread]: On master: COMMIT
[0m10:40:24.485873 [debug] [MainThread]: Using postgres connection "master"
[0m10:40:24.486391 [debug] [MainThread]: On master: COMMIT
[0m10:40:24.487408 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:40:24.487909 [debug] [MainThread]: On master: Close
[0m10:40:24.488736 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:40:24.489212 [debug] [MainThread]: Connection 'list_db_dev_dev' was properly closed.
[0m10:40:24.489749 [debug] [MainThread]: Connection 'model.my_project.abv_histogram' was properly closed.
[0m10:40:24.490253 [info ] [MainThread]: 
[0m10:40:24.490781 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m10:40:24.492680 [debug] [MainThread]: Command end result
[0m10:40:24.530652 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:40:24.534002 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:40:24.542827 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m10:40:24.543302 [info ] [MainThread]: 
[0m10:40:24.543892 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:40:24.544553 [info ] [MainThread]: 
[0m10:40:24.545673 [error] [MainThread]:   Database Error in model abv_histogram (models/mart/abv_histogram.sql)
  column "abv" does not exist
  LINE 15:     abv
               ^
  compiled code at target/run/my_project/models/mart/abv_histogram.sql
[0m10:40:24.546270 [info ] [MainThread]: 
[0m10:40:24.547035 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:40:24.549563 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.8910365, "process_in_blocks": "0", "process_kernel_time": 0.541312, "process_mem_max_rss": "111184", "process_out_blocks": "4376", "process_user_time": 3.391162}
[0m10:40:24.550382 [debug] [MainThread]: Command `dbt run` failed at 10:40:24.550212 after 1.89 seconds
[0m10:40:24.550922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7975b93f7c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7975b6a07560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7975b8f902f0>]}
[0m10:40:24.551490 [debug] [MainThread]: Flushing usage events
[0m10:40:25.858048 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:43:54.500044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed0fd685f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed0fc7be2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed0fbf2e450>]}


============================== 10:43:54.509773 | 44052dd1-9d92-45a2-b853-75807f0f0150 ==============================
[0m10:43:54.509773 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:43:54.510633 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:43:54.817473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44052dd1-9d92-45a2-b853-75807f0f0150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed0fbcff260>]}
[0m10:43:54.909189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44052dd1-9d92-45a2-b853-75807f0f0150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed0fc315c10>]}
[0m10:43:54.910371 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:43:55.080101 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:43:55.335949 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:43:55.336529 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:43:55.411623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44052dd1-9d92-45a2-b853-75807f0f0150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed0fbdabad0>]}
[0m10:43:55.559502 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:43:55.563969 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:43:55.613694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44052dd1-9d92-45a2-b853-75807f0f0150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed0f9fc1730>]}
[0m10:43:55.614689 [info ] [MainThread]: Found 7 models, 6 data tests, 5 sources, 429 macros
[0m10:43:55.615550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44052dd1-9d92-45a2-b853-75807f0f0150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed0f9fad7f0>]}
[0m10:43:55.622444 [info ] [MainThread]: 
[0m10:43:55.623863 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:43:55.624958 [info ] [MainThread]: 
[0m10:43:55.626423 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:43:55.638879 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m10:43:55.640052 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m10:43:55.804398 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m10:43:55.804963 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m10:43:55.805569 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m10:43:55.806172 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m10:43:55.806857 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:43:55.807411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:43:55.832974 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.025 seconds
[0m10:43:55.835045 [debug] [ThreadPool]: On list_db: Close
[0m10:43:55.846108 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.039 seconds
[0m10:43:55.848695 [debug] [ThreadPool]: On list_db: Close
[0m10:43:55.852524 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev_dev)
[0m10:43:55.853550 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m10:43:55.863422 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m10:43:55.866388 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m10:43:55.867034 [debug] [ThreadPool]: On list_db_dev_dev: BEGIN
[0m10:43:55.867705 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m10:43:55.868238 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:55.868920 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:55.883503 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m10:43:55.884652 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m10:43:55.885435 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m10:43:55.886555 [debug] [ThreadPool]: On list_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_dev'
  
[0m10:43:55.887482 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m10:43:55.888592 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:43:55.894932 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m10:43:55.898724 [debug] [ThreadPool]: On list_db_dev_dev: ROLLBACK
[0m10:43:55.899723 [debug] [ThreadPool]: On list_db_dev_dev: Close
[0m10:43:55.903378 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.014 seconds
[0m10:43:55.906632 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m10:43:55.907753 [debug] [ThreadPool]: On list_db_dev: Close
[0m10:43:55.919585 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:55.920574 [debug] [MainThread]: On master: BEGIN
[0m10:43:55.921231 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:43:55.934778 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m10:43:55.935471 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:55.936138 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:43:55.952424 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m10:43:55.954604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44052dd1-9d92-45a2-b853-75807f0f0150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed0f9f8ed80>]}
[0m10:43:55.955312 [debug] [MainThread]: On master: ROLLBACK
[0m10:43:55.956117 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:55.956709 [debug] [MainThread]: On master: BEGIN
[0m10:43:55.957818 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:43:55.958485 [debug] [MainThread]: On master: COMMIT
[0m10:43:55.959065 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:55.959563 [debug] [MainThread]: On master: COMMIT
[0m10:43:55.960667 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:43:55.962177 [debug] [MainThread]: On master: Close
[0m10:43:55.968522 [debug] [Thread-1 (]: Began running node model.my_project.beer_types
[0m10:43:55.969454 [debug] [Thread-2 (]: Began running node model.my_project.malt_per_beer
[0m10:43:55.970287 [debug] [Thread-3 (]: Began running node model.my_project.staging
[0m10:43:55.970962 [debug] [Thread-4 (]: Began running node model.my_project.type_by_year
[0m10:43:55.971679 [info ] [Thread-1 (]: 1 of 7 START sql table model dev_dev.beer_types ................................ [RUN]
[0m10:43:55.972677 [info ] [Thread-2 (]: 2 of 7 START sql table model dev_dev.malt_per_beer ............................. [RUN]
[0m10:43:55.974137 [info ] [Thread-3 (]: 3 of 7 START sql table model dev.staging ....................................... [RUN]
[0m10:43:55.975421 [info ] [Thread-4 (]: 4 of 7 START sql table model dev_dev.type_by_year .............................. [RUN]
[0m10:43:55.976497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.beer_types)
[0m10:43:55.977708 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_dev_dev, now model.my_project.malt_per_beer)
[0m10:43:55.979054 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.staging'
[0m10:43:55.979978 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.type_by_year'
[0m10:43:55.980811 [debug] [Thread-1 (]: Began compiling node model.my_project.beer_types
[0m10:43:55.981481 [debug] [Thread-2 (]: Began compiling node model.my_project.malt_per_beer
[0m10:43:55.982200 [debug] [Thread-3 (]: Began compiling node model.my_project.staging
[0m10:43:55.982802 [debug] [Thread-4 (]: Began compiling node model.my_project.type_by_year
[0m10:43:55.996154 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.beer_types"
[0m10:43:56.002461 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_project.malt_per_beer"
[0m10:43:56.008511 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.staging"
[0m10:43:56.017316 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.type_by_year"
[0m10:43:56.019451 [debug] [Thread-1 (]: Began executing node model.my_project.beer_types
[0m10:43:56.020228 [debug] [Thread-2 (]: Began executing node model.my_project.malt_per_beer
[0m10:43:56.022487 [debug] [Thread-4 (]: Began executing node model.my_project.type_by_year
[0m10:43:56.028738 [debug] [Thread-3 (]: Began executing node model.my_project.staging
[0m10:43:56.168502 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.type_by_year"
[0m10:43:56.173348 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_project.malt_per_beer"
[0m10:43:56.173937 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.beer_types"
[0m10:43:56.174696 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.staging"
[0m10:43:56.176527 [debug] [Thread-4 (]: Using postgres connection "model.my_project.type_by_year"
[0m10:43:56.177989 [debug] [Thread-2 (]: Using postgres connection "model.my_project.malt_per_beer"
[0m10:43:56.178997 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m10:43:56.179846 [debug] [Thread-4 (]: On model.my_project.type_by_year: BEGIN
[0m10:43:56.180497 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m10:43:56.181227 [debug] [Thread-2 (]: On model.my_project.malt_per_beer: BEGIN
[0m10:43:56.181886 [debug] [Thread-1 (]: On model.my_project.beer_types: BEGIN
[0m10:43:56.182587 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:43:56.183208 [debug] [Thread-3 (]: On model.my_project.staging: BEGIN
[0m10:43:56.183815 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:43:56.184494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:56.185392 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:43:56.203958 [debug] [Thread-2 (]: SQL status: BEGIN in 0.020 seconds
[0m10:43:56.205312 [debug] [Thread-2 (]: Using postgres connection "model.my_project.malt_per_beer"
[0m10:43:56.205970 [debug] [Thread-4 (]: SQL status: BEGIN in 0.023 seconds
[0m10:43:56.206815 [debug] [Thread-2 (]: On model.my_project.malt_per_beer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.malt_per_beer"} */

  
    

  create  table "db"."dev_dev"."malt_per_beer__dbt_tmp"
  
  
    as
  
  (
    

select
    beer_id,
    malt_name as malt_type,
    amount_value as amount,
    amount_unit as unit
from "db"."dev"."malt_ingredients"
  );
  
[0m10:43:56.207464 [debug] [Thread-4 (]: Using postgres connection "model.my_project.type_by_year"
[0m10:43:56.208772 [debug] [Thread-4 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */

  
    

  create  table "db"."dev_dev"."type_by_year__dbt_tmp"
  
  
    as
  
  (
    

select
    beer_id,
    name,
    tagline,
    first_brewed,   -- <--- add this column!
    case
        when lower(tagline) like '%lager%' then 'Lager'
        when lower(tagline) like '%pilsner%' then 'Lager'
        when lower(tagline) like '%ipa%' then 'Ale'
        when lower(tagline) like '%stout%' then 'Ale'
        when lower(tagline) like '%porter%' then 'Ale'
        when lower(tagline) like '%ale%' then 'Ale'
        when lower(tagline) like '%wheat%' then 'Ale'
        else 'Other'
    end as type
from "db"."dev"."raw_beer_data"
  );
  
[0m10:43:56.211593 [debug] [Thread-3 (]: SQL status: BEGIN in 0.025 seconds
[0m10:43:56.212797 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m10:43:56.215000 [debug] [Thread-3 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * 
    from "db"."dev"."raw_beer_data"
)

select 
    id,
    beer_id,
    name as beer_name,
    tagline,
    first_brewed,
    description,
    image,
    abv,
    ibu,
    ebc,
    ph,
    brewers_tips,
    contributed_by,
    inserted_at
from source
  );
  
[0m10:43:56.217807 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m10:43:56.218865 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m10:43:56.219652 [debug] [Thread-1 (]: On model.my_project.beer_types: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_types"} */

  
    

  create  table "db"."dev_dev"."beer_types__dbt_tmp"
  
  
    as
  
  (
    

select
    beer_id,
    name,
    tagline,
    case
        when lower(tagline) like '%lager%' then 'Lager'
        when lower(tagline) like '%pilsner%' then 'Lager'
        when lower(tagline) like '%ipa%' then 'Ale'
        when lower(tagline) like '%stout%' then 'Ale'
        when lower(tagline) like '%porter%' then 'Ale'
        when lower(tagline) like '%ale%' then 'Ale'
        when lower(tagline) like '%wheat%' then 'Ale'
        -- add more mappings as needed
        else 'Other'
    end as type
from "db"."dev"."raw_beer_data"
  );
  
[0m10:43:56.226257 [debug] [Thread-2 (]: SQL status: SELECT 3254 in 0.018 seconds
[0m10:43:56.234312 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.014 seconds
[0m10:43:56.238498 [debug] [Thread-2 (]: Using postgres connection "model.my_project.malt_per_beer"
[0m10:43:56.247318 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m10:43:56.248492 [debug] [Thread-2 (]: On model.my_project.malt_per_beer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.malt_per_beer"} */
alter table "db"."dev_dev"."malt_per_beer__dbt_tmp" rename to "malt_per_beer"
[0m10:43:56.249081 [debug] [Thread-4 (]: SQL status: SELECT 414 in 0.039 seconds
[0m10:43:56.249753 [debug] [Thread-1 (]: On model.my_project.beer_types: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_types"} */
alter table "db"."dev_dev"."beer_types" rename to "beer_types__dbt_backup"
[0m10:43:56.254064 [debug] [Thread-4 (]: Using postgres connection "model.my_project.type_by_year"
[0m10:43:56.254821 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:43:56.255403 [debug] [Thread-3 (]: SQL status: SELECT 414 in 0.038 seconds
[0m10:43:56.256170 [debug] [Thread-4 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */
alter table "db"."dev_dev"."type_by_year" rename to "type_by_year__dbt_backup"
[0m10:43:56.256874 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:43:56.282265 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m10:43:56.289148 [debug] [Thread-2 (]: On model.my_project.malt_per_beer: COMMIT
[0m10:43:56.293684 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m10:43:56.294644 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m10:43:56.295344 [debug] [Thread-3 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m10:43:56.296057 [debug] [Thread-2 (]: Using postgres connection "model.my_project.malt_per_beer"
[0m10:43:56.296772 [debug] [Thread-1 (]: On model.my_project.beer_types: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_types"} */
alter table "db"."dev_dev"."beer_types__dbt_tmp" rename to "beer_types"
[0m10:43:56.301020 [debug] [Thread-4 (]: Using postgres connection "model.my_project.type_by_year"
[0m10:43:56.301822 [debug] [Thread-2 (]: On model.my_project.malt_per_beer: COMMIT
[0m10:43:56.302312 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:43:56.303029 [debug] [Thread-4 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */
alter table "db"."dev_dev"."type_by_year__dbt_tmp" rename to "type_by_year"
[0m10:43:56.303602 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:43:56.308205 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m10:43:56.313896 [debug] [Thread-1 (]: On model.my_project.beer_types: COMMIT
[0m10:43:56.314902 [debug] [Thread-3 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m10:43:56.315505 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m10:43:56.316101 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m10:43:56.316959 [debug] [Thread-2 (]: SQL status: COMMIT in 0.013 seconds
[0m10:43:56.317584 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:43:56.320032 [debug] [Thread-4 (]: On model.my_project.type_by_year: COMMIT
[0m10:43:56.320745 [debug] [Thread-1 (]: On model.my_project.beer_types: COMMIT
[0m10:43:56.329860 [debug] [Thread-2 (]: Applying DROP to: "db"."dev_dev"."malt_per_beer__dbt_backup"
[0m10:43:56.332510 [debug] [Thread-3 (]: On model.my_project.staging: COMMIT
[0m10:43:56.333209 [debug] [Thread-4 (]: Using postgres connection "model.my_project.type_by_year"
[0m10:43:56.342554 [debug] [Thread-2 (]: Using postgres connection "model.my_project.malt_per_beer"
[0m10:43:56.343260 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m10:43:56.344155 [debug] [Thread-4 (]: On model.my_project.type_by_year: COMMIT
[0m10:43:56.344961 [debug] [Thread-2 (]: On model.my_project.malt_per_beer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.malt_per_beer"} */
drop table if exists "db"."dev_dev"."malt_per_beer__dbt_backup" cascade
[0m10:43:56.345744 [debug] [Thread-3 (]: On model.my_project.staging: COMMIT
[0m10:43:56.347278 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:43:56.350998 [debug] [Thread-2 (]: On model.my_project.malt_per_beer: Close
[0m10:43:56.353592 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44052dd1-9d92-45a2-b853-75807f0f0150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed0f8553260>]}
[0m10:43:56.354631 [info ] [Thread-2 (]: 2 of 7 OK created sql table model dev_dev.malt_per_beer ........................ [[32mSELECT 3254[0m in 0.37s]
[0m10:43:56.355850 [debug] [Thread-2 (]: Finished running node model.my_project.malt_per_beer
[0m10:43:56.473101 [debug] [Thread-1 (]: SQL status: COMMIT in 0.139 seconds
[0m10:43:56.476560 [debug] [Thread-1 (]: Applying DROP to: "db"."dev_dev"."beer_types__dbt_backup"
[0m10:43:56.477418 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m10:43:56.478068 [debug] [Thread-1 (]: On model.my_project.beer_types: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_types"} */
drop table if exists "db"."dev_dev"."beer_types__dbt_backup" cascade
[0m10:43:56.478851 [debug] [Thread-4 (]: SQL status: COMMIT in 0.132 seconds
[0m10:43:56.479500 [debug] [Thread-3 (]: SQL status: COMMIT in 0.132 seconds
[0m10:43:56.483091 [debug] [Thread-4 (]: Applying DROP to: "db"."dev_dev"."type_by_year__dbt_backup"
[0m10:43:56.487015 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m10:43:56.488261 [debug] [Thread-4 (]: Using postgres connection "model.my_project.type_by_year"
[0m10:43:56.489965 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m10:43:56.490662 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.012 seconds
[0m10:43:56.491307 [debug] [Thread-4 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */
drop table if exists "db"."dev_dev"."type_by_year__dbt_backup" cascade
[0m10:43:56.491985 [debug] [Thread-3 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m10:43:56.494141 [debug] [Thread-1 (]: On model.my_project.beer_types: Close
[0m10:43:56.495828 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44052dd1-9d92-45a2-b853-75807f0f0150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed0f86bb110>]}
[0m10:43:56.496907 [info ] [Thread-1 (]: 1 of 7 OK created sql table model dev_dev.beer_types ........................... [[32mSELECT 414[0m in 0.52s]
[0m10:43:56.497942 [debug] [Thread-1 (]: Finished running node model.my_project.beer_types
[0m10:43:56.499183 [debug] [Thread-2 (]: Began running node model.my_project.abv_histogram
[0m10:43:56.499882 [info ] [Thread-2 (]: 5 of 7 START sql table model dev_dev.abv_histogram ............................. [RUN]
[0m10:43:56.500727 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_project.malt_per_beer, now model.my_project.abv_histogram)
[0m10:43:56.501229 [debug] [Thread-2 (]: Began compiling node model.my_project.abv_histogram
[0m10:43:56.505227 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_project.abv_histogram"
[0m10:43:56.506056 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.011 seconds
[0m10:43:56.509341 [debug] [Thread-4 (]: On model.my_project.type_by_year: Close
[0m10:43:56.510257 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.015 seconds
[0m10:43:56.511442 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44052dd1-9d92-45a2-b853-75807f0f0150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed0f854ef90>]}
[0m10:43:56.515159 [debug] [Thread-3 (]: On model.my_project.staging: Close
[0m10:43:56.516506 [debug] [Thread-2 (]: Began executing node model.my_project.abv_histogram
[0m10:43:56.517464 [info ] [Thread-4 (]: 4 of 7 OK created sql table model dev_dev.type_by_year ......................... [[32mSELECT 414[0m in 0.53s]
[0m10:43:56.524065 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44052dd1-9d92-45a2-b853-75807f0f0150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed0f86a3a10>]}
[0m10:43:56.529128 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_project.abv_histogram"
[0m10:43:56.530097 [debug] [Thread-4 (]: Finished running node model.my_project.type_by_year
[0m10:43:56.531036 [info ] [Thread-3 (]: 3 of 7 OK created sql table model dev.staging .................................. [[32mSELECT 414[0m in 0.55s]
[0m10:43:56.533224 [debug] [Thread-3 (]: Finished running node model.my_project.staging
[0m10:43:56.533848 [debug] [Thread-2 (]: Using postgres connection "model.my_project.abv_histogram"
[0m10:43:56.535071 [debug] [Thread-1 (]: Began running node model.my_project.beer_report
[0m10:43:56.535789 [debug] [Thread-4 (]: Began running node model.my_project.master_beer_table
[0m10:43:56.536420 [debug] [Thread-2 (]: On model.my_project.abv_histogram: BEGIN
[0m10:43:56.537246 [info ] [Thread-1 (]: 6 of 7 START sql table model dev.beer_report ................................... [RUN]
[0m10:43:56.538227 [info ] [Thread-4 (]: 7 of 7 START sql table model dev.master_beer_table ............................. [RUN]
[0m10:43:56.538978 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:43:56.539631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.beer_types, now model.my_project.beer_report)
[0m10:43:56.540400 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_project.type_by_year, now model.my_project.master_beer_table)
[0m10:43:56.541349 [debug] [Thread-1 (]: Began compiling node model.my_project.beer_report
[0m10:43:56.542043 [debug] [Thread-4 (]: Began compiling node model.my_project.master_beer_table
[0m10:43:56.546481 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.beer_report"
[0m10:43:56.550621 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.master_beer_table"
[0m10:43:56.552037 [debug] [Thread-4 (]: Began executing node model.my_project.master_beer_table
[0m10:43:56.552883 [debug] [Thread-1 (]: Began executing node model.my_project.beer_report
[0m10:43:56.557566 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.master_beer_table"
[0m10:43:56.558357 [debug] [Thread-2 (]: SQL status: BEGIN in 0.019 seconds
[0m10:43:56.562249 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.beer_report"
[0m10:43:56.563413 [debug] [Thread-2 (]: Using postgres connection "model.my_project.abv_histogram"
[0m10:43:56.564980 [debug] [Thread-2 (]: On model.my_project.abv_histogram: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.abv_histogram"} */

  
    

  create  table "db"."dev_dev"."abv_histogram__dbt_tmp"
  
  
    as
  
  (
    

select
    abv
from "db"."dev_dev"."beer_types"
where abv is not null
  );
  
[0m10:43:56.565923 [debug] [Thread-4 (]: Using postgres connection "model.my_project.master_beer_table"
[0m10:43:56.566937 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_report"
[0m10:43:56.567677 [debug] [Thread-4 (]: On model.my_project.master_beer_table: BEGIN
[0m10:43:56.568428 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "abv" does not exist
LINE 15:     abv
             ^

[0m10:43:56.569241 [debug] [Thread-1 (]: On model.my_project.beer_report: BEGIN
[0m10:43:56.570169 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:43:56.570835 [debug] [Thread-2 (]: On model.my_project.abv_histogram: ROLLBACK
[0m10:43:56.571528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:56.573429 [debug] [Thread-2 (]: On model.my_project.abv_histogram: Close
[0m10:43:56.590329 [debug] [Thread-4 (]: SQL status: BEGIN in 0.020 seconds
[0m10:43:56.591732 [debug] [Thread-4 (]: Using postgres connection "model.my_project.master_beer_table"
[0m10:43:56.593242 [debug] [Thread-4 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */

  
    

  create  table "db"."dev"."master_beer_table__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    beer_id,
    beer_name,
    tagline as category,         -- category/style approximation
    description,
    abv as alcohol_percent,
    first_brewed
from beers
  );
  
[0m10:43:56.597224 [debug] [Thread-1 (]: SQL status: BEGIN in 0.025 seconds
[0m10:43:56.599257 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_report"
[0m10:43:56.601352 [debug] [Thread-1 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */

  
    

  create  table "db"."dev"."beer_report__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    count(*) as total_beers,
    round(avg(abv)::numeric, 2) as avg_abv,
    round(min(abv)::numeric, 2) as min_abv,
    round(max(abv)::numeric, 2) as max_abv,
    round(avg(ibu)::numeric, 2) as avg_ibu,
    round(min(ibu)::numeric, 2) as min_ibu,
    round(max(ibu)::numeric, 2) as max_ibu,
    round(avg(ebc)::numeric, 2) as avg_ebc,
    round(min(ebc)::numeric, 2) as min_ebc,
    round(max(ebc)::numeric, 2) as max_ebc,
    round(avg(ph)::numeric, 2) as avg_ph,
    min(first_brewed) as oldest_brew,
    max(first_brewed) as newest_brew,
    count(distinct contributed_by) as unique_contributors
from beers
  );
  
[0m10:43:56.611335 [debug] [Thread-2 (]: Database Error in model abv_histogram (models/mart/abv_histogram.sql)
  column "abv" does not exist
  LINE 15:     abv
               ^
  compiled code at target/run/my_project/models/mart/abv_histogram.sql
[0m10:43:56.613128 [debug] [Thread-4 (]: SQL status: SELECT 414 in 0.018 seconds
[0m10:43:56.614976 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44052dd1-9d92-45a2-b853-75807f0f0150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed0fb8be7b0>]}
[0m10:43:56.622339 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.019 seconds
[0m10:43:56.621141 [debug] [Thread-4 (]: Using postgres connection "model.my_project.master_beer_table"
[0m10:43:56.624949 [error] [Thread-2 (]: 5 of 7 ERROR creating sql table model dev_dev.abv_histogram .................... [[31mERROR[0m in 0.11s]
[0m10:43:56.632519 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_report"
[0m10:43:56.633292 [debug] [Thread-4 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */
alter table "db"."dev"."master_beer_table" rename to "master_beer_table__dbt_backup"
[0m10:43:56.634451 [debug] [Thread-2 (]: Finished running node model.my_project.abv_histogram
[0m10:43:56.635119 [debug] [Thread-1 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report" rename to "beer_report__dbt_backup"
[0m10:43:56.636631 [debug] [Thread-7 (]: Marking all children of 'model.my_project.abv_histogram' to be skipped because of status 'error'.  Reason: Database Error in model abv_histogram (models/mart/abv_histogram.sql)
  column "abv" does not exist
  LINE 15:     abv
               ^
  compiled code at target/run/my_project/models/mart/abv_histogram.sql.
[0m10:43:56.637531 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:43:56.639591 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:43:56.644839 [debug] [Thread-4 (]: Using postgres connection "model.my_project.master_beer_table"
[0m10:43:56.649863 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_report"
[0m10:43:56.650639 [debug] [Thread-4 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */
alter table "db"."dev"."master_beer_table__dbt_tmp" rename to "master_beer_table"
[0m10:43:56.651339 [debug] [Thread-1 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report__dbt_tmp" rename to "beer_report"
[0m10:43:56.652635 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:43:56.653178 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:43:56.655880 [debug] [Thread-4 (]: On model.my_project.master_beer_table: COMMIT
[0m10:43:56.658233 [debug] [Thread-1 (]: On model.my_project.beer_report: COMMIT
[0m10:43:56.658901 [debug] [Thread-4 (]: Using postgres connection "model.my_project.master_beer_table"
[0m10:43:56.659805 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_report"
[0m10:43:56.661851 [debug] [Thread-4 (]: On model.my_project.master_beer_table: COMMIT
[0m10:43:56.662719 [debug] [Thread-1 (]: On model.my_project.beer_report: COMMIT
[0m10:43:56.793740 [debug] [Thread-4 (]: SQL status: COMMIT in 0.130 seconds
[0m10:43:56.800464 [debug] [Thread-1 (]: SQL status: COMMIT in 0.136 seconds
[0m10:43:56.802653 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."master_beer_table__dbt_backup"
[0m10:43:56.809606 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."beer_report__dbt_backup"
[0m10:43:56.811557 [debug] [Thread-4 (]: Using postgres connection "model.my_project.master_beer_table"
[0m10:43:56.812912 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_report"
[0m10:43:56.813796 [debug] [Thread-4 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */
drop table if exists "db"."dev"."master_beer_table__dbt_backup" cascade
[0m10:43:56.814744 [debug] [Thread-1 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
drop table if exists "db"."dev"."beer_report__dbt_backup" cascade
[0m10:43:56.823254 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m10:43:56.827530 [debug] [Thread-1 (]: On model.my_project.beer_report: Close
[0m10:43:56.829516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44052dd1-9d92-45a2-b853-75807f0f0150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed0f86a2db0>]}
[0m10:43:56.841402 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.026 seconds
[0m10:43:56.840764 [info ] [Thread-1 (]: 6 of 7 OK created sql table model dev.beer_report .............................. [[32mSELECT 1[0m in 0.29s]
[0m10:43:56.848039 [debug] [Thread-4 (]: On model.my_project.master_beer_table: Close
[0m10:43:56.849785 [debug] [Thread-1 (]: Finished running node model.my_project.beer_report
[0m10:43:56.851413 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44052dd1-9d92-45a2-b853-75807f0f0150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed0f85e7bf0>]}
[0m10:43:56.862536 [info ] [Thread-4 (]: 7 of 7 OK created sql table model dev.master_beer_table ........................ [[32mSELECT 414[0m in 0.31s]
[0m10:43:56.864342 [debug] [Thread-4 (]: Finished running node model.my_project.master_beer_table
[0m10:43:56.868789 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:56.869708 [debug] [MainThread]: On master: BEGIN
[0m10:43:56.870461 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:43:56.904473 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m10:43:56.905451 [debug] [MainThread]: On master: COMMIT
[0m10:43:56.906357 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:56.907133 [debug] [MainThread]: On master: COMMIT
[0m10:43:56.908433 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:43:56.909411 [debug] [MainThread]: On master: Close
[0m10:43:56.910761 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:43:56.911627 [debug] [MainThread]: Connection 'model.my_project.beer_report' was properly closed.
[0m10:43:56.915278 [debug] [MainThread]: Connection 'model.my_project.abv_histogram' was properly closed.
[0m10:43:56.915907 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m10:43:56.916527 [debug] [MainThread]: Connection 'model.my_project.master_beer_table' was properly closed.
[0m10:43:56.917181 [info ] [MainThread]: 
[0m10:43:56.917872 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 1.29 seconds (1.29s).
[0m10:43:56.920969 [debug] [MainThread]: Command end result
[0m10:43:56.965825 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:43:56.968229 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:43:56.977835 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m10:43:56.978361 [info ] [MainThread]: 
[0m10:43:56.978923 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:43:56.979727 [info ] [MainThread]: 
[0m10:43:56.980799 [error] [MainThread]:   Database Error in model abv_histogram (models/mart/abv_histogram.sql)
  column "abv" does not exist
  LINE 15:     abv
               ^
  compiled code at target/run/my_project/models/mart/abv_histogram.sql
[0m10:43:56.981576 [info ] [MainThread]: 
[0m10:43:56.982209 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m10:43:56.983742 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.5715344, "process_in_blocks": "1600", "process_kernel_time": 0.700401, "process_mem_max_rss": "109552", "process_out_blocks": "3664", "process_user_time": 4.266814}
[0m10:43:56.984521 [debug] [MainThread]: Command `dbt run` failed at 10:43:56.984361 after 2.57 seconds
[0m10:43:56.985089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed0fbc776e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed0fcbeb0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed0fb851670>]}
[0m10:43:56.985616 [debug] [MainThread]: Flushing usage events
[0m10:43:58.683742 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:50:57.301665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1b88491d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1b89ea87d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1b8833e6c0>]}


============================== 10:50:57.313729 | a0175553-09df-4c7c-90f6-15e0a5b80b2a ==============================
[0m10:50:57.313729 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:50:57.315160 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select type_by_year', 'send_anonymous_usage_stats': 'True'}
[0m10:50:57.700297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0175553-09df-4c7c-90f6-15e0a5b80b2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1b89e2b4d0>]}
[0m10:50:57.793409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0175553-09df-4c7c-90f6-15e0a5b80b2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1b87ef7b60>]}
[0m10:50:57.794508 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:50:57.951274 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:50:58.151507 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:50:58.152458 [debug] [MainThread]: Partial parsing: updated file: my_project://models/mart/type_by_year.sql
[0m10:50:58.604125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0175553-09df-4c7c-90f6-15e0a5b80b2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1b8622b740>]}
[0m10:50:58.731000 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:50:58.735969 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:50:58.772983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0175553-09df-4c7c-90f6-15e0a5b80b2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1b8511fd70>]}
[0m10:50:58.773665 [info ] [MainThread]: Found 7 models, 6 data tests, 5 sources, 429 macros
[0m10:50:58.774234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0175553-09df-4c7c-90f6-15e0a5b80b2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1b866d12b0>]}
[0m10:50:58.776862 [info ] [MainThread]: 
[0m10:50:58.777483 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:50:58.778278 [info ] [MainThread]: 
[0m10:50:58.779462 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:50:58.781228 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m10:50:58.854481 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m10:50:58.855077 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m10:50:58.855558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:50:58.871326 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.016 seconds
[0m10:50:58.873256 [debug] [ThreadPool]: On list_db: Close
[0m10:50:58.880787 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m10:50:58.887411 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_dev_dev'
[0m10:50:58.891656 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m10:50:58.894411 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m10:50:58.895113 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m10:50:58.895703 [debug] [ThreadPool]: On list_db_dev_dev: BEGIN
[0m10:50:58.896293 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:50:58.896859 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:50:58.909442 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m10:50:58.910409 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m10:50:58.911206 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m10:50:58.912096 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m10:50:58.912884 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:50:58.913527 [debug] [ThreadPool]: On list_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_dev'
  
[0m10:50:58.918332 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m10:50:58.919440 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.005 seconds
[0m10:50:58.921410 [debug] [ThreadPool]: On list_db_dev_dev: ROLLBACK
[0m10:50:58.923391 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m10:50:58.924369 [debug] [ThreadPool]: On list_db_dev_dev: Close
[0m10:50:58.924843 [debug] [ThreadPool]: On list_db_dev: Close
[0m10:50:58.935578 [debug] [MainThread]: Using postgres connection "master"
[0m10:50:58.936202 [debug] [MainThread]: On master: BEGIN
[0m10:50:58.936643 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:50:58.949361 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m10:50:58.950185 [debug] [MainThread]: Using postgres connection "master"
[0m10:50:58.951094 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:50:58.956398 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m10:50:58.958875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0175553-09df-4c7c-90f6-15e0a5b80b2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1b861e6cf0>]}
[0m10:50:58.959582 [debug] [MainThread]: On master: ROLLBACK
[0m10:50:58.960424 [debug] [MainThread]: Using postgres connection "master"
[0m10:50:58.960891 [debug] [MainThread]: On master: BEGIN
[0m10:50:58.962022 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:50:58.962588 [debug] [MainThread]: On master: COMMIT
[0m10:50:58.963265 [debug] [MainThread]: Using postgres connection "master"
[0m10:50:58.963932 [debug] [MainThread]: On master: COMMIT
[0m10:50:58.964686 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:50:58.965169 [debug] [MainThread]: On master: Close
[0m10:50:58.969813 [debug] [Thread-1 (]: Began running node model.my_project.type_by_year
[0m10:50:58.971067 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_dev.type_by_year .............................. [RUN]
[0m10:50:58.972021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.type_by_year)
[0m10:50:58.972736 [debug] [Thread-1 (]: Began compiling node model.my_project.type_by_year
[0m10:50:58.983791 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.type_by_year"
[0m10:50:58.984998 [debug] [Thread-1 (]: Began executing node model.my_project.type_by_year
[0m10:50:59.038893 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.type_by_year"
[0m10:50:59.039876 [debug] [Thread-1 (]: Using postgres connection "model.my_project.type_by_year"
[0m10:50:59.040377 [debug] [Thread-1 (]: On model.my_project.type_by_year: BEGIN
[0m10:50:59.040820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:50:59.053127 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m10:50:59.053881 [debug] [Thread-1 (]: Using postgres connection "model.my_project.type_by_year"
[0m10:50:59.054464 [debug] [Thread-1 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */

  
    

  create  table "db"."dev_dev"."type_by_year__dbt_tmp"
  
  
    as
  
  (
    

select
    beer_id,
    name,
    tagline,
    -- Standardize first_brewed to yyyy
    case
        when length(first_brewed) = 7 and substr(first_brewed, 3, 1) = '-' then right(first_brewed, 4)
        when length(first_brewed) = 4 then first_brewed
        else null
    end as first_brewed,
    case
        when lower(tagline) like '%lager%' then 'Lager'
        when lower(tagline) like '%pilsner%' then 'Lager'
        when lower(tagline) like '%ipa%' then 'Ale'
        when lower(tagline) like '%stout%' then 'Ale'
        when lower(tagline) like '%porter%' then 'Ale'
        when lower(tagline) like '%ale%' then 'Ale'
        when lower(tagline) like '%wheat%' then 'Ale'
        else 'Other'
    end as type
from "db"."dev"."raw_beer_data"
  );
  
[0m10:50:59.061363 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.006 seconds
[0m10:50:59.070051 [debug] [Thread-1 (]: Using postgres connection "model.my_project.type_by_year"
[0m10:50:59.070722 [debug] [Thread-1 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */
alter table "db"."dev_dev"."type_by_year" rename to "type_by_year__dbt_backup"
[0m10:50:59.071834 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:50:59.075598 [debug] [Thread-1 (]: Using postgres connection "model.my_project.type_by_year"
[0m10:50:59.076104 [debug] [Thread-1 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */
alter table "db"."dev_dev"."type_by_year__dbt_tmp" rename to "type_by_year"
[0m10:50:59.077040 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:50:59.104192 [debug] [Thread-1 (]: On model.my_project.type_by_year: COMMIT
[0m10:50:59.104737 [debug] [Thread-1 (]: Using postgres connection "model.my_project.type_by_year"
[0m10:50:59.105215 [debug] [Thread-1 (]: On model.my_project.type_by_year: COMMIT
[0m10:50:59.110810 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m10:50:59.121032 [debug] [Thread-1 (]: Applying DROP to: "db"."dev_dev"."type_by_year__dbt_backup"
[0m10:50:59.129059 [debug] [Thread-1 (]: Using postgres connection "model.my_project.type_by_year"
[0m10:50:59.129589 [debug] [Thread-1 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */
drop table if exists "db"."dev_dev"."type_by_year__dbt_backup" cascade
[0m10:50:59.137891 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m10:50:59.141240 [debug] [Thread-1 (]: On model.my_project.type_by_year: Close
[0m10:50:59.143651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0175553-09df-4c7c-90f6-15e0a5b80b2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1b85106f30>]}
[0m10:50:59.144525 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_dev.type_by_year ......................... [[32mSELECT 414[0m in 0.17s]
[0m10:50:59.145738 [debug] [Thread-1 (]: Finished running node model.my_project.type_by_year
[0m10:50:59.148798 [debug] [MainThread]: Using postgres connection "master"
[0m10:50:59.149298 [debug] [MainThread]: On master: BEGIN
[0m10:50:59.149725 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:50:59.162466 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m10:50:59.163130 [debug] [MainThread]: On master: COMMIT
[0m10:50:59.164000 [debug] [MainThread]: Using postgres connection "master"
[0m10:50:59.164554 [debug] [MainThread]: On master: COMMIT
[0m10:50:59.165345 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:50:59.165853 [debug] [MainThread]: On master: Close
[0m10:50:59.166721 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:50:59.167300 [debug] [MainThread]: Connection 'model.my_project.type_by_year' was properly closed.
[0m10:50:59.168038 [debug] [MainThread]: Connection 'list_db_dev_dev' was properly closed.
[0m10:50:59.168750 [info ] [MainThread]: 
[0m10:50:59.169460 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m10:50:59.171982 [debug] [MainThread]: Command end result
[0m10:50:59.207558 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:50:59.209901 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:50:59.218957 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m10:50:59.219513 [info ] [MainThread]: 
[0m10:50:59.220268 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:50:59.221216 [info ] [MainThread]: 
[0m10:50:59.222014 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:50:59.223962 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.026877, "process_in_blocks": "6736", "process_kernel_time": 0.619272, "process_mem_max_rss": "110760", "process_out_blocks": "4376", "process_user_time": 4.037335}
[0m10:50:59.224751 [debug] [MainThread]: Command `dbt run` succeeded at 10:50:59.224590 after 2.03 seconds
[0m10:50:59.225285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1b88b3f8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1b881b7b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1b88f34470>]}
[0m10:50:59.225803 [debug] [MainThread]: Flushing usage events
[0m10:51:00.626442 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:55:23.225362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721590d53a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721590427b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72159049a1b0>]}


============================== 10:55:23.234179 | 12024002-d553-4c1a-abb2-7e6025b16f16 ==============================
[0m10:55:23.234179 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:55:23.235114 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select abv_histogram', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:55:23.570812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12024002-d553-4c1a-abb2-7e6025b16f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7215903cf620>]}
[0m10:55:23.756785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12024002-d553-4c1a-abb2-7e6025b16f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721590967ef0>]}
[0m10:55:23.758578 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:55:23.934282 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m10:55:24.106063 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:55:24.106629 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:55:24.165728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12024002-d553-4c1a-abb2-7e6025b16f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72158e9a43b0>]}
[0m10:55:24.292951 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:55:24.296231 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:55:24.328632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12024002-d553-4c1a-abb2-7e6025b16f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72158e515a30>]}
[0m10:55:24.329258 [info ] [MainThread]: Found 7 models, 6 data tests, 5 sources, 429 macros
[0m10:55:24.329773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12024002-d553-4c1a-abb2-7e6025b16f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72158ea019d0>]}
[0m10:55:24.332250 [info ] [MainThread]: 
[0m10:55:24.332798 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:55:24.333548 [info ] [MainThread]: 
[0m10:55:24.334682 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:55:24.336165 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m10:55:24.409534 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m10:55:24.410047 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m10:55:24.410471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:55:24.424430 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.014 seconds
[0m10:55:24.426216 [debug] [ThreadPool]: On list_db: Close
[0m10:55:24.433050 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m10:55:24.434069 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_dev_dev'
[0m10:55:24.441501 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m10:55:24.443786 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m10:55:24.444353 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m10:55:24.444900 [debug] [ThreadPool]: On list_db_dev_dev: BEGIN
[0m10:55:24.445421 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:55:24.446028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:55:24.457571 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m10:55:24.458353 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m10:55:24.458998 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m10:55:24.459620 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m10:55:24.460226 [debug] [ThreadPool]: On list_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_dev'
  
[0m10:55:24.460825 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:55:24.465190 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m10:55:24.467556 [debug] [ThreadPool]: On list_db_dev_dev: ROLLBACK
[0m10:55:24.468629 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.007 seconds
[0m10:55:24.469406 [debug] [ThreadPool]: On list_db_dev_dev: Close
[0m10:55:24.471630 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m10:55:24.473865 [debug] [ThreadPool]: On list_db_dev: Close
[0m10:55:24.482935 [debug] [MainThread]: Using postgres connection "master"
[0m10:55:24.483478 [debug] [MainThread]: On master: BEGIN
[0m10:55:24.484012 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:55:24.495886 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m10:55:24.496599 [debug] [MainThread]: Using postgres connection "master"
[0m10:55:24.497438 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:55:24.502046 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m10:55:24.504309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12024002-d553-4c1a-abb2-7e6025b16f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72158e9dbf80>]}
[0m10:55:24.505102 [debug] [MainThread]: On master: ROLLBACK
[0m10:55:24.505947 [debug] [MainThread]: Using postgres connection "master"
[0m10:55:24.506516 [debug] [MainThread]: On master: BEGIN
[0m10:55:24.507593 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:55:24.508281 [debug] [MainThread]: On master: COMMIT
[0m10:55:24.508864 [debug] [MainThread]: Using postgres connection "master"
[0m10:55:24.509312 [debug] [MainThread]: On master: COMMIT
[0m10:55:24.510026 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:55:24.510567 [debug] [MainThread]: On master: Close
[0m10:55:24.514826 [debug] [Thread-1 (]: Began running node model.my_project.abv_histogram
[0m10:55:24.515644 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_dev.abv_histogram ............................. [RUN]
[0m10:55:24.517007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.abv_histogram)
[0m10:55:24.518026 [debug] [Thread-1 (]: Began compiling node model.my_project.abv_histogram
[0m10:55:24.528585 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.abv_histogram"
[0m10:55:24.529469 [debug] [Thread-1 (]: Began executing node model.my_project.abv_histogram
[0m10:55:24.583519 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.abv_histogram"
[0m10:55:24.584460 [debug] [Thread-1 (]: Using postgres connection "model.my_project.abv_histogram"
[0m10:55:24.584901 [debug] [Thread-1 (]: On model.my_project.abv_histogram: BEGIN
[0m10:55:24.585326 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:55:24.596708 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m10:55:24.597404 [debug] [Thread-1 (]: Using postgres connection "model.my_project.abv_histogram"
[0m10:55:24.598034 [debug] [Thread-1 (]: On model.my_project.abv_histogram: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.abv_histogram"} */

  
    

  create  table "db"."dev_dev"."abv_histogram__dbt_tmp"
  
  
    as
  
  (
    

select
    abv
from "db"."dev_dev"."beer_types"
where abv is not null
  );
  
[0m10:55:24.599443 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "abv" does not exist
LINE 15:     abv
             ^

[0m10:55:24.600275 [debug] [Thread-1 (]: On model.my_project.abv_histogram: ROLLBACK
[0m10:55:24.601319 [debug] [Thread-1 (]: On model.my_project.abv_histogram: Close
[0m10:55:24.610217 [debug] [Thread-1 (]: Database Error in model abv_histogram (models/mart/abv_histogram.sql)
  column "abv" does not exist
  LINE 15:     abv
               ^
  compiled code at target/run/my_project/models/mart/abv_histogram.sql
[0m10:55:24.615269 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12024002-d553-4c1a-abb2-7e6025b16f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72158d744e90>]}
[0m10:55:24.617601 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_dev.abv_histogram .................... [[31mERROR[0m in 0.10s]
[0m10:55:24.619246 [debug] [Thread-1 (]: Finished running node model.my_project.abv_histogram
[0m10:55:24.620915 [debug] [Thread-7 (]: Marking all children of 'model.my_project.abv_histogram' to be skipped because of status 'error'.  Reason: Database Error in model abv_histogram (models/mart/abv_histogram.sql)
  column "abv" does not exist
  LINE 15:     abv
               ^
  compiled code at target/run/my_project/models/mart/abv_histogram.sql.
[0m10:55:24.626568 [debug] [MainThread]: Using postgres connection "master"
[0m10:55:24.628084 [debug] [MainThread]: On master: BEGIN
[0m10:55:24.629260 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:55:24.643656 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m10:55:24.644382 [debug] [MainThread]: On master: COMMIT
[0m10:55:24.644940 [debug] [MainThread]: Using postgres connection "master"
[0m10:55:24.645421 [debug] [MainThread]: On master: COMMIT
[0m10:55:24.646159 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:55:24.646726 [debug] [MainThread]: On master: Close
[0m10:55:24.647418 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:55:24.647835 [debug] [MainThread]: Connection 'model.my_project.abv_histogram' was properly closed.
[0m10:55:24.648225 [debug] [MainThread]: Connection 'list_db_dev_dev' was properly closed.
[0m10:55:24.648673 [info ] [MainThread]: 
[0m10:55:24.649183 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m10:55:24.652105 [debug] [MainThread]: Command end result
[0m10:55:24.688648 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m10:55:24.690939 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m10:55:24.699196 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m10:55:24.699985 [info ] [MainThread]: 
[0m10:55:24.700768 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:55:24.701545 [info ] [MainThread]: 
[0m10:55:24.702574 [error] [MainThread]:   Database Error in model abv_histogram (models/mart/abv_histogram.sql)
  column "abv" does not exist
  LINE 15:     abv
               ^
  compiled code at target/run/my_project/models/mart/abv_histogram.sql
[0m10:55:24.703301 [info ] [MainThread]: 
[0m10:55:24.704046 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:55:24.705878 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5574986, "process_in_blocks": "0", "process_kernel_time": 0.455874, "process_mem_max_rss": "107324", "process_out_blocks": "3496", "process_user_time": 3.166912}
[0m10:55:24.706685 [debug] [MainThread]: Command `dbt run` failed at 10:55:24.706520 after 1.56 seconds
[0m10:55:24.707234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72159066f770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72159079ee40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72158e9a5be0>]}
[0m10:55:24.707745 [debug] [MainThread]: Flushing usage events
[0m10:55:26.087575 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:00:40.154626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c032e1d38c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c032f7cc290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c032e4d3890>]}


============================== 11:00:40.163083 | 10809e23-89a0-49ee-bcf4-d8c531e9ca5c ==============================
[0m11:00:40.163083 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:00:40.163887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select style_distribution', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:00:40.431191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10809e23-89a0-49ee-bcf4-d8c531e9ca5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c032dc738f0>]}
[0m11:00:40.508268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '10809e23-89a0-49ee-bcf4-d8c531e9ca5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c032d8e0a40>]}
[0m11:00:40.509284 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:00:40.633441 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:00:40.824459 [debug] [MainThread]: Partial parsing enabled: 4 files deleted, 1 files added, 0 files changed.
[0m11:00:40.825175 [debug] [MainThread]: Partial parsing: added file: my_project://models/mart/style_distribution.sql
[0m11:00:40.825536 [debug] [MainThread]: Partial parsing: deleted file: my_project://models/mart/abv_histogram.sql
[0m11:00:40.825940 [debug] [MainThread]: Partial parsing: deleted file: my_project://models/mart/beer_types.sql
[0m11:00:40.826325 [debug] [MainThread]: Partial parsing: deleted file: my_project://models/mart/type_by_year.sql
[0m11:00:40.826713 [debug] [MainThread]: Partial parsing: deleted file: my_project://models/mart/malt_per_beer.sql
[0m11:00:41.202074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10809e23-89a0-49ee-bcf4-d8c531e9ca5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c032bbef800>]}
[0m11:00:41.321982 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:00:41.325273 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:00:41.360998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '10809e23-89a0-49ee-bcf4-d8c531e9ca5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c032bdade50>]}
[0m11:00:41.361780 [info ] [MainThread]: Found 4 models, 6 data tests, 5 sources, 429 macros
[0m11:00:41.362509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10809e23-89a0-49ee-bcf4-d8c531e9ca5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c032bcca6f0>]}
[0m11:00:41.365428 [info ] [MainThread]: 
[0m11:00:41.366129 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:00:41.366979 [info ] [MainThread]: 
[0m11:00:41.368593 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:00:41.370606 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:00:41.445822 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:00:41.446385 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:00:41.446794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:00:41.460684 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.014 seconds
[0m11:00:41.462537 [debug] [ThreadPool]: On list_db: Close
[0m11:00:41.469039 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev_dev)
[0m11:00:41.470090 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_dev'
[0m11:00:41.477302 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m11:00:41.479666 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:00:41.480314 [debug] [ThreadPool]: On list_db_dev_dev: BEGIN
[0m11:00:41.480866 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:00:41.481397 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:00:41.481935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:00:41.493687 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m11:00:41.494487 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m11:00:41.495040 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m11:00:41.495737 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:00:41.496359 [debug] [ThreadPool]: On list_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_dev'
  
[0m11:00:41.496967 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:00:41.502175 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m11:00:41.503118 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.005 seconds
[0m11:00:41.505488 [debug] [ThreadPool]: On list_db_dev_dev: ROLLBACK
[0m11:00:41.507615 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:00:41.508584 [debug] [ThreadPool]: On list_db_dev_dev: Close
[0m11:00:41.509027 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:00:41.519612 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:41.520205 [debug] [MainThread]: On master: BEGIN
[0m11:00:41.520619 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:00:41.532950 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m11:00:41.533581 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:41.534291 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:00:41.539060 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m11:00:41.541141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10809e23-89a0-49ee-bcf4-d8c531e9ca5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c032eb905f0>]}
[0m11:00:41.541904 [debug] [MainThread]: On master: ROLLBACK
[0m11:00:41.542829 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:41.543443 [debug] [MainThread]: On master: BEGIN
[0m11:00:41.544531 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:00:41.545098 [debug] [MainThread]: On master: COMMIT
[0m11:00:41.546065 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:41.546669 [debug] [MainThread]: On master: COMMIT
[0m11:00:41.547472 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:00:41.547934 [debug] [MainThread]: On master: Close
[0m11:00:41.552215 [debug] [Thread-1 (]: Began running node model.my_project.style_distribution
[0m11:00:41.553268 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_dev.style_distribution ........................ [RUN]
[0m11:00:41.554381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.style_distribution)
[0m11:00:41.555442 [debug] [Thread-1 (]: Began compiling node model.my_project.style_distribution
[0m11:00:41.567033 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.style_distribution"
[0m11:00:41.568907 [debug] [Thread-1 (]: Began executing node model.my_project.style_distribution
[0m11:00:41.623182 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.style_distribution"
[0m11:00:41.624974 [debug] [Thread-1 (]: Using postgres connection "model.my_project.style_distribution"
[0m11:00:41.625539 [debug] [Thread-1 (]: On model.my_project.style_distribution: BEGIN
[0m11:00:41.625979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:41.637568 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m11:00:41.638408 [debug] [Thread-1 (]: Using postgres connection "model.my_project.style_distribution"
[0m11:00:41.639129 [debug] [Thread-1 (]: On model.my_project.style_distribution: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.style_distribution"} */

  
    

  create  table "db"."dev_dev"."style_distribution__dbt_tmp"
  
  
    as
  
  (
    

select
    type,
    count(beer_id) as count_beers
from (
    select
        beer_id,
        case
            when lower(tagline) like '%lager%' then 'Lager'
            when lower(tagline) like '%pilsner%' then 'Lager'
            when lower(tagline) like '%ipa%' then 'Ale'
            when lower(tagline) like '%stout%' then 'Ale'
            when lower(tagline) like '%porter%' then 'Ale'
            when lower(tagline) like '%ale%' then 'Ale'
            when lower(tagline) like '%wheat%' then 'Ale'
            else 'Other'
        end as type
    from "db"."dev"."raw_beer_data"
) as styles
group by type
order by count_beers desc
  );
  
[0m11:00:41.644821 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m11:00:41.653425 [debug] [Thread-1 (]: Using postgres connection "model.my_project.style_distribution"
[0m11:00:41.654036 [debug] [Thread-1 (]: On model.my_project.style_distribution: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.style_distribution"} */
alter table "db"."dev_dev"."style_distribution__dbt_tmp" rename to "style_distribution"
[0m11:00:41.655198 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:00:41.684116 [debug] [Thread-1 (]: On model.my_project.style_distribution: COMMIT
[0m11:00:41.684766 [debug] [Thread-1 (]: Using postgres connection "model.my_project.style_distribution"
[0m11:00:41.685224 [debug] [Thread-1 (]: On model.my_project.style_distribution: COMMIT
[0m11:00:41.691554 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m11:00:41.700432 [debug] [Thread-1 (]: Applying DROP to: "db"."dev_dev"."style_distribution__dbt_backup"
[0m11:00:41.709232 [debug] [Thread-1 (]: Using postgres connection "model.my_project.style_distribution"
[0m11:00:41.709975 [debug] [Thread-1 (]: On model.my_project.style_distribution: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.style_distribution"} */
drop table if exists "db"."dev_dev"."style_distribution__dbt_backup" cascade
[0m11:00:41.711201 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m11:00:41.714736 [debug] [Thread-1 (]: On model.my_project.style_distribution: Close
[0m11:00:41.717206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10809e23-89a0-49ee-bcf4-d8c531e9ca5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c032f746420>]}
[0m11:00:41.718167 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_dev.style_distribution ................... [[32mSELECT 3[0m in 0.16s]
[0m11:00:41.719680 [debug] [Thread-1 (]: Finished running node model.my_project.style_distribution
[0m11:00:41.723352 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:41.724279 [debug] [MainThread]: On master: BEGIN
[0m11:00:41.725069 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:00:41.755541 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m11:00:41.756878 [debug] [MainThread]: On master: COMMIT
[0m11:00:41.758118 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:41.759279 [debug] [MainThread]: On master: COMMIT
[0m11:00:41.760807 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:00:41.761886 [debug] [MainThread]: On master: Close
[0m11:00:41.763396 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:00:41.764345 [debug] [MainThread]: Connection 'list_db_dev_dev' was properly closed.
[0m11:00:41.765260 [debug] [MainThread]: Connection 'model.my_project.style_distribution' was properly closed.
[0m11:00:41.766390 [info ] [MainThread]: 
[0m11:00:41.767721 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m11:00:41.770273 [debug] [MainThread]: Command end result
[0m11:00:41.839626 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:00:41.844221 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:00:41.863116 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:00:41.864046 [info ] [MainThread]: 
[0m11:00:41.866029 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:00:41.867833 [info ] [MainThread]: 
[0m11:00:41.869589 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:00:41.872630 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7868997, "process_in_blocks": "16", "process_kernel_time": 0.535997, "process_mem_max_rss": "110860", "process_out_blocks": "4328", "process_user_time": 3.259986}
[0m11:00:41.874202 [debug] [MainThread]: Command `dbt run` succeeded at 11:00:41.873888 after 1.79 seconds
[0m11:00:41.875350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c032db64bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0329edd100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c032df875f0>]}
[0m11:00:41.876501 [debug] [MainThread]: Flushing usage events
[0m11:00:43.192999 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:11:09.240756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d846961d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d8466533b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d8483d1460>]}


============================== 11:11:09.248024 | 346047c8-a0b5-440e-838e-0ee7005f165b ==============================
[0m11:11:09.248024 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:11:09.248949 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select beer_styles', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:11:09.516055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '346047c8-a0b5-440e-838e-0ee7005f165b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d846c90bf0>]}
[0m11:11:09.596704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '346047c8-a0b5-440e-838e-0ee7005f165b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d846af1400>]}
[0m11:11:09.597671 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:11:09.733877 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:11:09.908424 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m11:11:09.909354 [debug] [MainThread]: Partial parsing: added file: my_project://models/mart/beer_types.sql
[0m11:11:09.909868 [debug] [MainThread]: Partial parsing: deleted file: my_project://models/mart/style_distribution.sql
[0m11:11:10.324884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '346047c8-a0b5-440e-838e-0ee7005f165b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d844777e60>]}
[0m11:11:10.452769 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:11:10.457746 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:11:10.491324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '346047c8-a0b5-440e-838e-0ee7005f165b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d84492cda0>]}
[0m11:11:10.491970 [info ] [MainThread]: Found 4 models, 6 data tests, 5 sources, 429 macros
[0m11:11:10.492542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '346047c8-a0b5-440e-838e-0ee7005f165b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d83f52d8b0>]}
[0m11:11:10.493770 [warn ] [MainThread]: The selection criterion 'beer_styles' does not match any enabled nodes
[0m11:11:10.495686 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:11:10.496685 [debug] [MainThread]: Command end result
[0m11:11:10.605571 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:11:10.607745 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:11:10.612166 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:11:10.613458 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4348314, "process_in_blocks": "0", "process_kernel_time": 0.520907, "process_mem_max_rss": "102844", "process_out_blocks": "4288", "process_user_time": 2.864993}
[0m11:11:10.614181 [debug] [MainThread]: Command `dbt run` succeeded at 11:11:10.614026 after 1.44 seconds
[0m11:11:10.614757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d8463d4260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d84483edb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d848354320>]}
[0m11:11:10.615287 [debug] [MainThread]: Flushing usage events
[0m11:11:12.033489 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:11:24.954265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7918d946c290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7918d8443b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7918d83f2b40>]}


============================== 11:11:24.962805 | bd29a1c8-a7f2-44c2-95fc-15dd0932b350 ==============================
[0m11:11:24.962805 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:11:24.963852 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select beer_types', 'send_anonymous_usage_stats': 'True'}
[0m11:11:25.252369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd29a1c8-a7f2-44c2-95fc-15dd0932b350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7918d5bb52b0>]}
[0m11:11:25.348141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd29a1c8-a7f2-44c2-95fc-15dd0932b350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7918d743ad20>]}
[0m11:11:25.349221 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:11:25.497131 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:11:25.856640 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:11:25.857156 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:11:25.919616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd29a1c8-a7f2-44c2-95fc-15dd0932b350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7918d5c61790>]}
[0m11:11:26.047220 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:11:26.050288 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:11:26.090492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd29a1c8-a7f2-44c2-95fc-15dd0932b350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7918d5c2da60>]}
[0m11:11:26.091329 [info ] [MainThread]: Found 4 models, 6 data tests, 5 sources, 429 macros
[0m11:11:26.091932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd29a1c8-a7f2-44c2-95fc-15dd0932b350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7918d5bb76b0>]}
[0m11:11:26.094538 [info ] [MainThread]: 
[0m11:11:26.095168 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:11:26.095946 [info ] [MainThread]: 
[0m11:11:26.097162 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:11:26.098741 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:11:26.176330 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:11:26.176895 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:11:26.177365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:26.240235 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.063 seconds
[0m11:11:26.246102 [debug] [ThreadPool]: On list_db: Close
[0m11:11:26.261563 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m11:11:26.263220 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_dev_dev'
[0m11:11:26.275832 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:11:26.279280 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m11:11:26.280187 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:11:26.281087 [debug] [ThreadPool]: On list_db_dev_dev: BEGIN
[0m11:11:26.282103 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:11:26.283087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:26.302001 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m11:11:26.303237 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:11:26.304351 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:11:26.314894 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m11:11:26.315586 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.010 seconds
[0m11:11:26.316640 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m11:11:26.318850 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:11:26.319507 [debug] [ThreadPool]: On list_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_dev'
  
[0m11:11:26.320464 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:11:26.325739 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m11:11:26.328664 [debug] [ThreadPool]: On list_db_dev_dev: ROLLBACK
[0m11:11:26.329686 [debug] [ThreadPool]: On list_db_dev_dev: Close
[0m11:11:26.338401 [debug] [MainThread]: Using postgres connection "master"
[0m11:11:26.339051 [debug] [MainThread]: On master: BEGIN
[0m11:11:26.339520 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:11:26.351560 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m11:11:26.352395 [debug] [MainThread]: Using postgres connection "master"
[0m11:11:26.353256 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:11:26.357995 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m11:11:26.360128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd29a1c8-a7f2-44c2-95fc-15dd0932b350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7918d74388c0>]}
[0m11:11:26.360861 [debug] [MainThread]: On master: ROLLBACK
[0m11:11:26.361749 [debug] [MainThread]: Using postgres connection "master"
[0m11:11:26.362225 [debug] [MainThread]: On master: BEGIN
[0m11:11:26.363347 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:11:26.363933 [debug] [MainThread]: On master: COMMIT
[0m11:11:26.364698 [debug] [MainThread]: Using postgres connection "master"
[0m11:11:26.365200 [debug] [MainThread]: On master: COMMIT
[0m11:11:26.365961 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:11:26.366531 [debug] [MainThread]: On master: Close
[0m11:11:26.371260 [debug] [Thread-1 (]: Began running node model.my_project.beer_types
[0m11:11:26.372234 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_dev.beer_types ................................ [RUN]
[0m11:11:26.373111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev_dev, now model.my_project.beer_types)
[0m11:11:26.373898 [debug] [Thread-1 (]: Began compiling node model.my_project.beer_types
[0m11:11:26.384929 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.beer_types"
[0m11:11:26.385853 [debug] [Thread-1 (]: Began executing node model.my_project.beer_types
[0m11:11:26.543137 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.beer_types"
[0m11:11:26.544079 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m11:11:26.544648 [debug] [Thread-1 (]: On model.my_project.beer_types: BEGIN
[0m11:11:26.545098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:11:26.558368 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m11:11:26.559278 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m11:11:26.560006 [debug] [Thread-1 (]: On model.my_project.beer_types: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_types"} */

  
    

  create  table "db"."dev_dev"."beer_types__dbt_tmp"
  
  
    as
  
  (
    

select
    beer_id,
    name,
    tagline,
    first_brewed,
    abv,
    ibu,
    ebc,
    ph,
    case
        when lower(tagline) like '%lager%' then 'Lager'
        when lower(tagline) like '%pilsner%' then 'Lager'
        when lower(tagline) like '%ipa%' then 'Ale'
        when lower(tagline) like '%stout%' then 'Ale'
        when lower(tagline) like '%porter%' then 'Ale'
        when lower(tagline) like '%ale%' then 'Ale'
        when lower(tagline) like '%wheat%' then 'Ale'
        else 'Other'
    end as type
from "db"."dev"."raw_beer_data"
  );
  
[0m11:11:26.569921 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.009 seconds
[0m11:11:26.578010 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m11:11:26.578527 [debug] [Thread-1 (]: On model.my_project.beer_types: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_types"} */
alter table "db"."dev_dev"."beer_types__dbt_tmp" rename to "beer_types"
[0m11:11:26.579548 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:11:26.603780 [debug] [Thread-1 (]: On model.my_project.beer_types: COMMIT
[0m11:11:26.604391 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m11:11:26.604856 [debug] [Thread-1 (]: On model.my_project.beer_types: COMMIT
[0m11:11:26.611466 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m11:11:26.619880 [debug] [Thread-1 (]: Applying DROP to: "db"."dev_dev"."beer_types__dbt_backup"
[0m11:11:26.627687 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m11:11:26.628236 [debug] [Thread-1 (]: On model.my_project.beer_types: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_types"} */
drop table if exists "db"."dev_dev"."beer_types__dbt_backup" cascade
[0m11:11:26.629197 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m11:11:26.632279 [debug] [Thread-1 (]: On model.my_project.beer_types: Close
[0m11:11:26.634869 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd29a1c8-a7f2-44c2-95fc-15dd0932b350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7918d7fba2d0>]}
[0m11:11:26.635849 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_dev.beer_types ........................... [[32mSELECT 414[0m in 0.26s]
[0m11:11:26.637323 [debug] [Thread-1 (]: Finished running node model.my_project.beer_types
[0m11:11:26.640253 [debug] [MainThread]: Using postgres connection "master"
[0m11:11:26.640781 [debug] [MainThread]: On master: BEGIN
[0m11:11:26.641226 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:11:26.654433 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m11:11:26.655706 [debug] [MainThread]: On master: COMMIT
[0m11:11:26.656548 [debug] [MainThread]: Using postgres connection "master"
[0m11:11:26.656991 [debug] [MainThread]: On master: COMMIT
[0m11:11:26.657797 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:11:26.658282 [debug] [MainThread]: On master: Close
[0m11:11:26.659050 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:11:26.659466 [debug] [MainThread]: Connection 'list_db_dev' was properly closed.
[0m11:11:26.659903 [debug] [MainThread]: Connection 'model.my_project.beer_types' was properly closed.
[0m11:11:26.660417 [info ] [MainThread]: 
[0m11:11:26.660952 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m11:11:26.662848 [debug] [MainThread]: Command end result
[0m11:11:26.704491 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:11:26.706885 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:11:26.715814 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:11:26.716652 [info ] [MainThread]: 
[0m11:11:26.717541 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:11:26.718396 [info ] [MainThread]: 
[0m11:11:26.719769 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:11:26.727674 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8379692, "process_in_blocks": "440", "process_kernel_time": 0.484818, "process_mem_max_rss": "107580", "process_out_blocks": "3464", "process_user_time": 3.369489}
[0m11:11:26.728753 [debug] [MainThread]: Command `dbt run` succeeded at 11:11:26.728569 after 1.84 seconds
[0m11:11:26.729460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7918d768f2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7918d590ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7918d83f3bf0>]}
[0m11:11:26.730066 [debug] [MainThread]: Flushing usage events
[0m11:11:28.083528 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:15:45.041430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70559dd7e030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70559bf49460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70559bf49070>]}


============================== 11:15:45.048864 | 09916df9-2eeb-4525-aef5-b1fb931f6670 ==============================
[0m11:15:45.048864 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:15:45.049701 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select type_by_year', 'send_anonymous_usage_stats': 'True'}
[0m11:15:45.330081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09916df9-2eeb-4525-aef5-b1fb931f6670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70559cab93a0>]}
[0m11:15:45.417598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09916df9-2eeb-4525-aef5-b1fb931f6670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70559c0e6c60>]}
[0m11:15:45.418904 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:15:45.591330 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:15:45.855495 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:15:45.857019 [debug] [MainThread]: Partial parsing: added file: my_project://models/mart/type_by_year.sql
[0m11:15:46.413787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09916df9-2eeb-4525-aef5-b1fb931f6670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70559a23e480>]}
[0m11:15:46.562230 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:15:46.566124 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:15:46.605974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09916df9-2eeb-4525-aef5-b1fb931f6670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70559a46ad80>]}
[0m11:15:46.606864 [info ] [MainThread]: Found 5 models, 6 data tests, 5 sources, 429 macros
[0m11:15:46.607484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09916df9-2eeb-4525-aef5-b1fb931f6670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70559a215e80>]}
[0m11:15:46.610312 [info ] [MainThread]: 
[0m11:15:46.610899 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:15:46.611707 [info ] [MainThread]: 
[0m11:15:46.612909 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:15:46.614915 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:15:46.723020 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:15:46.723859 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:15:46.724548 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:46.741131 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.016 seconds
[0m11:15:46.743494 [debug] [ThreadPool]: On list_db: Close
[0m11:15:46.752791 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev_dev)
[0m11:15:46.759460 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_dev'
[0m11:15:46.762378 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m11:15:46.765136 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:15:46.765866 [debug] [ThreadPool]: On list_db_dev_dev: BEGIN
[0m11:15:46.766406 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:15:46.766976 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:15:46.767473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:46.781440 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m11:15:46.782375 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m11:15:46.783249 [debug] [ThreadPool]: On list_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_dev'
  
[0m11:15:46.785181 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m11:15:46.786300 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:15:46.787204 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:15:46.790935 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m11:15:46.793175 [debug] [ThreadPool]: On list_db_dev_dev: ROLLBACK
[0m11:15:46.794436 [debug] [ThreadPool]: On list_db_dev_dev: Close
[0m11:15:46.796472 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.008 seconds
[0m11:15:46.800006 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:15:46.801027 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:15:46.815264 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:46.816169 [debug] [MainThread]: On master: BEGIN
[0m11:15:46.816839 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:15:46.832415 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m11:15:46.833250 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:46.834319 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:15:46.841905 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m11:15:46.844197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09916df9-2eeb-4525-aef5-b1fb931f6670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70559a6364e0>]}
[0m11:15:46.844904 [debug] [MainThread]: On master: ROLLBACK
[0m11:15:46.845751 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:46.846260 [debug] [MainThread]: On master: BEGIN
[0m11:15:46.847368 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:15:46.847955 [debug] [MainThread]: On master: COMMIT
[0m11:15:46.848840 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:46.849669 [debug] [MainThread]: On master: COMMIT
[0m11:15:46.850555 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:15:46.851165 [debug] [MainThread]: On master: Close
[0m11:15:46.856493 [debug] [Thread-1 (]: Began running node model.my_project.type_by_year
[0m11:15:46.858030 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_dev.type_by_year .............................. [RUN]
[0m11:15:46.859423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.type_by_year)
[0m11:15:46.860410 [debug] [Thread-1 (]: Began compiling node model.my_project.type_by_year
[0m11:15:46.872547 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.type_by_year"
[0m11:15:46.873522 [debug] [Thread-1 (]: Began executing node model.my_project.type_by_year
[0m11:15:46.951444 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.type_by_year"
[0m11:15:46.952458 [debug] [Thread-1 (]: Using postgres connection "model.my_project.type_by_year"
[0m11:15:46.953064 [debug] [Thread-1 (]: On model.my_project.type_by_year: BEGIN
[0m11:15:46.953615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:15:46.966321 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m11:15:46.967620 [debug] [Thread-1 (]: Using postgres connection "model.my_project.type_by_year"
[0m11:15:46.968873 [debug] [Thread-1 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */

  
    

  create  table "db"."dev_dev"."type_by_year__dbt_tmp"
  
  
    as
  
  (
    

select
    left(first_brewed, 4) as year,
    type,
    count(*) as beer_count
from "db"."dev_dev"."beer_types"
where first_brewed ~ '\\d{4}'
group by left(first_brewed, 4), type
order by year, type
  );
  
[0m11:15:46.979171 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.010 seconds
[0m11:15:46.988728 [debug] [Thread-1 (]: Using postgres connection "model.my_project.type_by_year"
[0m11:15:46.989503 [debug] [Thread-1 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */
alter table "db"."dev_dev"."type_by_year__dbt_tmp" rename to "type_by_year"
[0m11:15:46.990914 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:15:47.019947 [debug] [Thread-1 (]: On model.my_project.type_by_year: COMMIT
[0m11:15:47.020611 [debug] [Thread-1 (]: Using postgres connection "model.my_project.type_by_year"
[0m11:15:47.021193 [debug] [Thread-1 (]: On model.my_project.type_by_year: COMMIT
[0m11:15:47.027316 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m11:15:47.036882 [debug] [Thread-1 (]: Applying DROP to: "db"."dev_dev"."type_by_year__dbt_backup"
[0m11:15:47.051287 [debug] [Thread-1 (]: Using postgres connection "model.my_project.type_by_year"
[0m11:15:47.052006 [debug] [Thread-1 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */
drop table if exists "db"."dev_dev"."type_by_year__dbt_backup" cascade
[0m11:15:47.053240 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m11:15:47.057120 [debug] [Thread-1 (]: On model.my_project.type_by_year: Close
[0m11:15:47.059787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09916df9-2eeb-4525-aef5-b1fb931f6670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70559de3a720>]}
[0m11:15:47.060834 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_dev.type_by_year ......................... [[32mSELECT 0[0m in 0.20s]
[0m11:15:47.062496 [debug] [Thread-1 (]: Finished running node model.my_project.type_by_year
[0m11:15:47.066402 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:47.066999 [debug] [MainThread]: On master: BEGIN
[0m11:15:47.067459 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:15:47.081396 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m11:15:47.082913 [debug] [MainThread]: On master: COMMIT
[0m11:15:47.084402 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:47.085103 [debug] [MainThread]: On master: COMMIT
[0m11:15:47.086084 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:15:47.086678 [debug] [MainThread]: On master: Close
[0m11:15:47.087721 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:15:47.088519 [debug] [MainThread]: Connection 'list_db_dev_dev' was properly closed.
[0m11:15:47.089376 [debug] [MainThread]: Connection 'model.my_project.type_by_year' was properly closed.
[0m11:15:47.241952 [info ] [MainThread]: 
[0m11:15:47.243481 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m11:15:47.246300 [debug] [MainThread]: Command end result
[0m11:15:47.299944 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:15:47.302904 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:15:47.315096 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:15:47.315723 [info ] [MainThread]: 
[0m11:15:47.316701 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:15:47.318084 [info ] [MainThread]: 
[0m11:15:47.319423 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:15:47.322178 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.340336, "process_in_blocks": "4320", "process_kernel_time": 0.669949, "process_mem_max_rss": "110764", "process_out_blocks": "4352", "process_user_time": 3.676744}
[0m11:15:47.323545 [debug] [MainThread]: Command `dbt run` succeeded at 11:15:47.323183 after 2.34 seconds
[0m11:15:47.324770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70559bf48140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70559a217530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70559c806ff0>]}
[0m11:15:47.325747 [debug] [MainThread]: Flushing usage events
[0m11:15:48.689000 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:18:52.826760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792827a65b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7928279c4980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792827ba42c0>]}


============================== 11:18:52.837468 | e449dec2-14b5-4018-a141-2f9edc420b0f ==============================
[0m11:18:52.837468 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:18:52.838842 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select type_by_year', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:18:53.216187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e449dec2-14b5-4018-a141-2f9edc420b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792825eb3bc0>]}
[0m11:18:53.327110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e449dec2-14b5-4018-a141-2f9edc420b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792825efcb60>]}
[0m11:18:53.328528 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:18:53.503286 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:18:53.713255 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:18:53.714319 [debug] [MainThread]: Partial parsing: updated file: my_project://models/mart/type_by_year.sql
[0m11:18:54.217192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e449dec2-14b5-4018-a141-2f9edc420b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792822e2c1d0>]}
[0m11:18:54.368091 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:18:54.372673 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:18:54.413513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e449dec2-14b5-4018-a141-2f9edc420b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7928242cc830>]}
[0m11:18:54.414263 [info ] [MainThread]: Found 5 models, 6 data tests, 5 sources, 429 macros
[0m11:18:54.415024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e449dec2-14b5-4018-a141-2f9edc420b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79282438d280>]}
[0m11:18:54.419089 [info ] [MainThread]: 
[0m11:18:54.419836 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:18:54.421398 [info ] [MainThread]: 
[0m11:18:54.422811 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:18:54.425393 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:18:54.514340 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:18:54.514955 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:18:54.515450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:54.529690 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.014 seconds
[0m11:18:54.531541 [debug] [ThreadPool]: On list_db: Close
[0m11:18:54.538332 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev_dev)
[0m11:18:54.544645 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_dev'
[0m11:18:54.546898 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m11:18:54.549340 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:18:54.549938 [debug] [ThreadPool]: On list_db_dev_dev: BEGIN
[0m11:18:54.550517 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:18:54.551022 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:18:54.551569 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:54.569027 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m11:18:54.569873 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m11:18:54.570941 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:18:54.571799 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m11:18:54.572995 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:18:54.574144 [debug] [ThreadPool]: On list_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_dev'
  
[0m11:18:54.580549 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m11:18:54.581389 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.006 seconds
[0m11:18:54.583601 [debug] [ThreadPool]: On list_db_dev_dev: ROLLBACK
[0m11:18:54.585802 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:18:54.587146 [debug] [ThreadPool]: On list_db_dev_dev: Close
[0m11:18:54.587757 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:18:54.598386 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:54.598986 [debug] [MainThread]: On master: BEGIN
[0m11:18:54.599470 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:18:54.612996 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m11:18:54.613735 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:54.614573 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:18:54.619678 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m11:18:54.622158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e449dec2-14b5-4018-a141-2f9edc420b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79282431aff0>]}
[0m11:18:54.623181 [debug] [MainThread]: On master: ROLLBACK
[0m11:18:54.624061 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:54.624536 [debug] [MainThread]: On master: BEGIN
[0m11:18:54.625839 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:18:54.626703 [debug] [MainThread]: On master: COMMIT
[0m11:18:54.627790 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:54.628262 [debug] [MainThread]: On master: COMMIT
[0m11:18:54.629274 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:18:54.629807 [debug] [MainThread]: On master: Close
[0m11:18:54.635252 [debug] [Thread-1 (]: Began running node model.my_project.type_by_year
[0m11:18:54.636317 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_dev.type_by_year .............................. [RUN]
[0m11:18:54.637391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.type_by_year)
[0m11:18:54.638486 [debug] [Thread-1 (]: Began compiling node model.my_project.type_by_year
[0m11:18:54.665282 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.type_by_year"
[0m11:18:54.667315 [debug] [Thread-1 (]: Began executing node model.my_project.type_by_year
[0m11:18:54.830497 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.type_by_year"
[0m11:18:54.833765 [debug] [Thread-1 (]: Using postgres connection "model.my_project.type_by_year"
[0m11:18:54.834916 [debug] [Thread-1 (]: On model.my_project.type_by_year: BEGIN
[0m11:18:54.835926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:18:54.859915 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m11:18:54.861514 [debug] [Thread-1 (]: Using postgres connection "model.my_project.type_by_year"
[0m11:18:54.862761 [debug] [Thread-1 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */

  
    

  create  table "db"."dev_dev"."type_by_year__dbt_tmp"
  
  
    as
  
  (
    

select
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4) as year,
    type,
    count(*) as beer_count
from "db"."dev_dev"."beer_types"
where
    -- Only keep non-null, non-empty years and ensure first 4 chars are digits
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4) ~ '^\d{4}$'
group by
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4),
    type
order by
    year,
    type
  );
  
[0m11:18:54.873322 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.009 seconds
[0m11:18:54.888547 [debug] [Thread-1 (]: Using postgres connection "model.my_project.type_by_year"
[0m11:18:54.889493 [debug] [Thread-1 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */
alter table "db"."dev_dev"."type_by_year" rename to "type_by_year__dbt_backup"
[0m11:18:54.891206 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:18:54.897562 [debug] [Thread-1 (]: Using postgres connection "model.my_project.type_by_year"
[0m11:18:54.898500 [debug] [Thread-1 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */
alter table "db"."dev_dev"."type_by_year__dbt_tmp" rename to "type_by_year"
[0m11:18:54.900200 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:18:54.956329 [debug] [Thread-1 (]: On model.my_project.type_by_year: COMMIT
[0m11:18:54.957344 [debug] [Thread-1 (]: Using postgres connection "model.my_project.type_by_year"
[0m11:18:54.957972 [debug] [Thread-1 (]: On model.my_project.type_by_year: COMMIT
[0m11:18:54.963667 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m11:18:54.977198 [debug] [Thread-1 (]: Applying DROP to: "db"."dev_dev"."type_by_year__dbt_backup"
[0m11:18:54.985797 [debug] [Thread-1 (]: Using postgres connection "model.my_project.type_by_year"
[0m11:18:54.986359 [debug] [Thread-1 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */
drop table if exists "db"."dev_dev"."type_by_year__dbt_backup" cascade
[0m11:18:54.992603 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m11:18:54.996171 [debug] [Thread-1 (]: On model.my_project.type_by_year: Close
[0m11:18:55.000282 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e449dec2-14b5-4018-a141-2f9edc420b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7928266f2870>]}
[0m11:18:55.001983 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_dev.type_by_year ......................... [[32mSELECT 12[0m in 0.36s]
[0m11:18:55.003520 [debug] [Thread-1 (]: Finished running node model.my_project.type_by_year
[0m11:18:55.006713 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:55.007247 [debug] [MainThread]: On master: BEGIN
[0m11:18:55.007757 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:18:55.021849 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m11:18:55.022591 [debug] [MainThread]: On master: COMMIT
[0m11:18:55.023166 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:55.023629 [debug] [MainThread]: On master: COMMIT
[0m11:18:55.024310 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:18:55.024793 [debug] [MainThread]: On master: Close
[0m11:18:55.025479 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:18:55.025903 [debug] [MainThread]: Connection 'list_db_dev_dev' was properly closed.
[0m11:18:55.026294 [debug] [MainThread]: Connection 'model.my_project.type_by_year' was properly closed.
[0m11:18:55.026754 [info ] [MainThread]: 
[0m11:18:55.027288 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m11:18:55.029118 [debug] [MainThread]: Command end result
[0m11:18:55.065027 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:18:55.067939 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:18:55.078663 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:18:55.079229 [info ] [MainThread]: 
[0m11:18:55.079973 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:18:55.080937 [info ] [MainThread]: 
[0m11:18:55.081743 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:18:55.083899 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.340461, "process_in_blocks": "632", "process_kernel_time": 0.551384, "process_mem_max_rss": "110952", "process_out_blocks": "4360", "process_user_time": 3.827729}
[0m11:18:55.084817 [debug] [MainThread]: Command `dbt run` succeeded at 11:18:55.084530 after 2.34 seconds
[0m11:18:55.085377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792825c2c650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7928267101a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792826711130>]}
[0m11:18:55.086075 [debug] [MainThread]: Flushing usage events
[0m11:18:56.406278 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:39:43.713055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e849f188320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e849f4aec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e849f188530>]}


============================== 11:39:43.729057 | 3483f509-646a-42eb-a40d-41d6e0b4b40f ==============================
[0m11:39:43.729057 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:39:43.730234 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select beer_released', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:39:44.047457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3483f509-646a-42eb-a40d-41d6e0b4b40f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e849f40bbc0>]}
[0m11:39:44.134824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3483f509-646a-42eb-a40d-41d6e0b4b40f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e849f9a73e0>]}
[0m11:39:44.135833 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:39:44.279488 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:39:44.503985 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:39:44.504797 [debug] [MainThread]: Partial parsing: added file: my_project://models/mart/beer_released.sql
[0m11:39:44.924392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3483f509-646a-42eb-a40d-41d6e0b4b40f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e849c390b30>]}
[0m11:39:45.049894 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:39:45.054159 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:39:45.312316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3483f509-646a-42eb-a40d-41d6e0b4b40f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e849c36bc80>]}
[0m11:39:45.314788 [info ] [MainThread]: Found 6 models, 6 data tests, 5 sources, 429 macros
[0m11:39:45.316763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3483f509-646a-42eb-a40d-41d6e0b4b40f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e849d9207d0>]}
[0m11:39:45.322425 [info ] [MainThread]: 
[0m11:39:45.323243 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:39:45.324225 [info ] [MainThread]: 
[0m11:39:45.326090 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:39:45.329712 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:39:45.436653 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:39:45.437162 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:39:45.437536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:45.459293 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.022 seconds
[0m11:39:45.461704 [debug] [ThreadPool]: On list_db: Close
[0m11:39:45.469168 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev_dev)
[0m11:39:45.470314 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_dev'
[0m11:39:45.478343 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m11:39:45.480994 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:39:45.481615 [debug] [ThreadPool]: On list_db_dev_dev: BEGIN
[0m11:39:45.482175 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:39:45.482768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:39:45.483428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:45.499708 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m11:39:45.500427 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m11:39:45.501185 [debug] [ThreadPool]: On list_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_dev'
  
[0m11:39:45.504708 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m11:39:45.505531 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:39:45.506275 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:39:45.511723 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.005 seconds
[0m11:39:45.512480 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.011 seconds
[0m11:39:45.515328 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:39:45.517585 [debug] [ThreadPool]: On list_db_dev_dev: ROLLBACK
[0m11:39:45.518555 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:39:45.518989 [debug] [ThreadPool]: On list_db_dev_dev: Close
[0m11:39:45.530949 [debug] [MainThread]: Using postgres connection "master"
[0m11:39:45.531662 [debug] [MainThread]: On master: BEGIN
[0m11:39:45.532114 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:39:45.891115 [debug] [MainThread]: SQL status: BEGIN in 0.359 seconds
[0m11:39:45.892175 [debug] [MainThread]: Using postgres connection "master"
[0m11:39:45.892914 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:39:45.909163 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m11:39:45.912989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3483f509-646a-42eb-a40d-41d6e0b4b40f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e849d6357c0>]}
[0m11:39:45.914001 [debug] [MainThread]: On master: ROLLBACK
[0m11:39:45.915455 [debug] [MainThread]: Using postgres connection "master"
[0m11:39:45.916302 [debug] [MainThread]: On master: BEGIN
[0m11:39:45.917587 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:39:45.920194 [debug] [MainThread]: On master: COMMIT
[0m11:39:45.921082 [debug] [MainThread]: Using postgres connection "master"
[0m11:39:45.922072 [debug] [MainThread]: On master: COMMIT
[0m11:39:45.927919 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:39:45.929177 [debug] [MainThread]: On master: Close
[0m11:39:45.941264 [debug] [Thread-1 (]: Began running node model.my_project.beer_released
[0m11:39:45.942976 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_dev.beer_released ............................. [RUN]
[0m11:39:45.944394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev_dev, now model.my_project.beer_released)
[0m11:39:45.945864 [debug] [Thread-1 (]: Began compiling node model.my_project.beer_released
[0m11:39:45.987723 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.beer_released"
[0m11:39:45.991793 [debug] [Thread-1 (]: Began executing node model.my_project.beer_released
[0m11:39:46.066974 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.beer_released"
[0m11:39:46.328027 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_released"
[0m11:39:46.329871 [debug] [Thread-1 (]: On model.my_project.beer_released: BEGIN
[0m11:39:46.331523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:46.383572 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m11:39:46.385108 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_released"
[0m11:39:46.385955 [debug] [Thread-1 (]: On model.my_project.beer_released: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_released"} */

  
    

  create  table "db"."dev_dev"."beer_released__dbt_tmp"
  
  
    as
  
  (
    

select
    left(first_brewed,4) as year,
    count(*) as beer_count
from "db"."dev_dev"."beer_types"
where first_brewed ~ '\\d{4}'
group by left(first_brewed,4)
order by year
  );
  
[0m11:39:46.401867 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.015 seconds
[0m11:39:46.410504 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_released"
[0m11:39:46.411175 [debug] [Thread-1 (]: On model.my_project.beer_released: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_released"} */
alter table "db"."dev_dev"."beer_released__dbt_tmp" rename to "beer_released"
[0m11:39:46.412350 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:39:46.437906 [debug] [Thread-1 (]: On model.my_project.beer_released: COMMIT
[0m11:39:46.438499 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_released"
[0m11:39:46.438971 [debug] [Thread-1 (]: On model.my_project.beer_released: COMMIT
[0m11:39:46.444631 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m11:39:46.453048 [debug] [Thread-1 (]: Applying DROP to: "db"."dev_dev"."beer_released__dbt_backup"
[0m11:39:46.461797 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_released"
[0m11:39:46.462539 [debug] [Thread-1 (]: On model.my_project.beer_released: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_released"} */
drop table if exists "db"."dev_dev"."beer_released__dbt_backup" cascade
[0m11:39:46.463555 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m11:39:46.467102 [debug] [Thread-1 (]: On model.my_project.beer_released: Close
[0m11:39:46.469367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3483f509-646a-42eb-a40d-41d6e0b4b40f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e84a107a6c0>]}
[0m11:39:46.470251 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_dev.beer_released ........................ [[32mSELECT 0[0m in 0.52s]
[0m11:39:46.471466 [debug] [Thread-1 (]: Finished running node model.my_project.beer_released
[0m11:39:46.475067 [debug] [MainThread]: Using postgres connection "master"
[0m11:39:46.475687 [debug] [MainThread]: On master: BEGIN
[0m11:39:46.476170 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:39:46.489994 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m11:39:46.490794 [debug] [MainThread]: On master: COMMIT
[0m11:39:46.491377 [debug] [MainThread]: Using postgres connection "master"
[0m11:39:46.491825 [debug] [MainThread]: On master: COMMIT
[0m11:39:46.492565 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:39:46.493091 [debug] [MainThread]: On master: Close
[0m11:39:46.493804 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:39:46.494229 [debug] [MainThread]: Connection 'model.my_project.beer_released' was properly closed.
[0m11:39:46.494665 [debug] [MainThread]: Connection 'list_db_dev' was properly closed.
[0m11:39:46.496565 [info ] [MainThread]: 
[0m11:39:46.497679 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.17 seconds (1.17s).
[0m11:39:46.500580 [debug] [MainThread]: Command end result
[0m11:39:46.540727 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:39:46.543064 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:39:46.552380 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:39:46.552905 [info ] [MainThread]: 
[0m11:39:46.553636 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:39:46.554230 [info ] [MainThread]: 
[0m11:39:46.555272 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:39:46.557198 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.9233315, "process_in_blocks": "1720", "process_kernel_time": 0.759728, "process_mem_max_rss": "109940", "process_out_blocks": "4352", "process_user_time": 3.298821}
[0m11:39:46.557931 [debug] [MainThread]: Command `dbt run` succeeded at 11:39:46.557780 after 2.92 seconds
[0m11:39:46.558443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e84a28ca930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e849f1880e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e849f83e720>]}
[0m11:39:46.558942 [debug] [MainThread]: Flushing usage events
[0m11:39:47.957313 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:41:45.003294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2f4d12f320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2f4cdfd1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2f4eb70590>]}


============================== 11:41:45.013428 | 8fa21dd4-1ccf-43d8-9675-f7278c80327e ==============================
[0m11:41:45.013428 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:41:45.015099 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select beer_released', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:41:45.370076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fa21dd4-1ccf-43d8-9675-f7278c80327e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2f4b2f03e0>]}
[0m11:41:45.501801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8fa21dd4-1ccf-43d8-9675-f7278c80327e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2f4d834d70>]}
[0m11:41:45.504226 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:41:45.660989 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:41:45.972973 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:41:45.975338 [debug] [MainThread]: Partial parsing: updated file: my_project://models/mart/beer_released.sql
[0m11:41:46.510240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fa21dd4-1ccf-43d8-9675-f7278c80327e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2f49e0c920>]}
[0m11:41:46.637209 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:41:46.641991 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:41:46.989618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8fa21dd4-1ccf-43d8-9675-f7278c80327e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2f49dac800>]}
[0m11:41:46.990349 [info ] [MainThread]: Found 6 models, 6 data tests, 5 sources, 429 macros
[0m11:41:46.991178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fa21dd4-1ccf-43d8-9675-f7278c80327e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2f4b2bddf0>]}
[0m11:41:46.993936 [info ] [MainThread]: 
[0m11:41:46.994747 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:41:46.995522 [info ] [MainThread]: 
[0m11:41:46.996775 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:41:47.270893 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:41:47.382546 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:41:47.383078 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:41:47.383464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:47.408264 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.025 seconds
[0m11:41:47.410282 [debug] [ThreadPool]: On list_db: Close
[0m11:41:47.417288 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev_dev)
[0m11:41:47.423734 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_dev'
[0m11:41:47.426109 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m11:41:47.429151 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:41:47.429932 [debug] [ThreadPool]: On list_db_dev_dev: BEGIN
[0m11:41:47.430541 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:41:47.431150 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:47.431705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:47.446833 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m11:41:47.447507 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m11:41:47.448110 [debug] [ThreadPool]: On list_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_dev'
  
[0m11:41:47.449738 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m11:41:47.450510 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:41:47.451365 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:41:47.456272 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.008 seconds
[0m11:41:47.458687 [debug] [ThreadPool]: On list_db_dev_dev: ROLLBACK
[0m11:41:47.459272 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.007 seconds
[0m11:41:47.461957 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:41:47.462438 [debug] [ThreadPool]: On list_db_dev_dev: Close
[0m11:41:47.463548 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:41:47.473657 [debug] [MainThread]: Using postgres connection "master"
[0m11:41:47.474195 [debug] [MainThread]: On master: BEGIN
[0m11:41:47.474635 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:41:47.488025 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m11:41:47.488685 [debug] [MainThread]: Using postgres connection "master"
[0m11:41:47.489285 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:41:47.506631 [debug] [MainThread]: SQL status: SELECT 0 in 0.017 seconds
[0m11:41:47.508812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fa21dd4-1ccf-43d8-9675-f7278c80327e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2f4929e7e0>]}
[0m11:41:47.509548 [debug] [MainThread]: On master: ROLLBACK
[0m11:41:47.510392 [debug] [MainThread]: Using postgres connection "master"
[0m11:41:47.511023 [debug] [MainThread]: On master: BEGIN
[0m11:41:47.512656 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:41:47.513839 [debug] [MainThread]: On master: COMMIT
[0m11:41:47.514432 [debug] [MainThread]: Using postgres connection "master"
[0m11:41:47.514873 [debug] [MainThread]: On master: COMMIT
[0m11:41:47.515700 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:41:47.516195 [debug] [MainThread]: On master: Close
[0m11:41:47.521439 [debug] [Thread-1 (]: Began running node model.my_project.beer_released
[0m11:41:47.522882 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_dev.beer_released ............................. [RUN]
[0m11:41:47.524244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.beer_released)
[0m11:41:47.525559 [debug] [Thread-1 (]: Began compiling node model.my_project.beer_released
[0m11:41:47.541684 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.beer_released"
[0m11:41:47.542605 [debug] [Thread-1 (]: Began executing node model.my_project.beer_released
[0m11:41:47.601011 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.beer_released"
[0m11:41:47.602000 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_released"
[0m11:41:47.602544 [debug] [Thread-1 (]: On model.my_project.beer_released: BEGIN
[0m11:41:47.602998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:47.615158 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m11:41:47.616388 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_released"
[0m11:41:47.617031 [debug] [Thread-1 (]: On model.my_project.beer_released: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_released"} */

  
    

  create  table "db"."dev_dev"."beer_released__dbt_tmp"
  
  
    as
  
  (
    

select
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4) as year,
    count(*) as beer_count
from "db"."dev_dev"."beer_types"
where
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4) ~ '^\d{4}$'
group by year
order by year
  );
  
[0m11:41:47.621797 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.004 seconds
[0m11:41:47.631468 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_released"
[0m11:41:47.632141 [debug] [Thread-1 (]: On model.my_project.beer_released: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_released"} */
alter table "db"."dev_dev"."beer_released" rename to "beer_released__dbt_backup"
[0m11:41:47.633341 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:41:47.637593 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_released"
[0m11:41:47.638132 [debug] [Thread-1 (]: On model.my_project.beer_released: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_released"} */
alter table "db"."dev_dev"."beer_released__dbt_tmp" rename to "beer_released"
[0m11:41:47.639084 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:41:47.666587 [debug] [Thread-1 (]: On model.my_project.beer_released: COMMIT
[0m11:41:47.667122 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_released"
[0m11:41:47.667557 [debug] [Thread-1 (]: On model.my_project.beer_released: COMMIT
[0m11:41:47.673656 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m11:41:47.684125 [debug] [Thread-1 (]: Applying DROP to: "db"."dev_dev"."beer_released__dbt_backup"
[0m11:41:47.692158 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_released"
[0m11:41:47.692751 [debug] [Thread-1 (]: On model.my_project.beer_released: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_released"} */
drop table if exists "db"."dev_dev"."beer_released__dbt_backup" cascade
[0m11:41:47.699214 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m11:41:47.704495 [debug] [Thread-1 (]: On model.my_project.beer_released: Close
[0m11:41:47.706863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fa21dd4-1ccf-43d8-9675-f7278c80327e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2f4d6c6720>]}
[0m11:41:47.707717 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_dev.beer_released ........................ [[32mSELECT 5[0m in 0.18s]
[0m11:41:47.708902 [debug] [Thread-1 (]: Finished running node model.my_project.beer_released
[0m11:41:47.711999 [debug] [MainThread]: Using postgres connection "master"
[0m11:41:47.712545 [debug] [MainThread]: On master: BEGIN
[0m11:41:47.712974 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:41:47.725556 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m11:41:47.726229 [debug] [MainThread]: On master: COMMIT
[0m11:41:47.726756 [debug] [MainThread]: Using postgres connection "master"
[0m11:41:47.727238 [debug] [MainThread]: On master: COMMIT
[0m11:41:47.728023 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:41:47.728851 [debug] [MainThread]: On master: Close
[0m11:41:47.730281 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:41:47.731753 [debug] [MainThread]: Connection 'list_db_dev_dev' was properly closed.
[0m11:41:47.732491 [debug] [MainThread]: Connection 'model.my_project.beer_released' was properly closed.
[0m11:41:47.734462 [info ] [MainThread]: 
[0m11:41:47.735746 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m11:41:47.738130 [debug] [MainThread]: Command end result
[0m11:41:47.775896 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:41:47.778541 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:41:47.787850 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:41:47.788380 [info ] [MainThread]: 
[0m11:41:47.789013 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:41:47.789677 [info ] [MainThread]: 
[0m11:41:47.790570 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:41:47.792451 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.8816316, "process_in_blocks": "9400", "process_kernel_time": 0.660533, "process_mem_max_rss": "110464", "process_out_blocks": "4352", "process_user_time": 3.991222}
[0m11:41:47.793187 [debug] [MainThread]: Command `dbt run` succeeded at 11:41:47.793029 after 2.88 seconds
[0m11:41:47.793734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2f4d09e870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2f4d18de20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2f4ce7e480>]}
[0m11:41:47.794475 [debug] [MainThread]: Flushing usage events
[0m11:41:49.123955 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:43:49.899290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d066fa0faa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d066fa0f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d066f194bf0>]}


============================== 11:43:49.918628 | bf80701d-9dca-4b02-9a30-ed72f688f99e ==============================
[0m11:43:49.918628 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:43:49.920409 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:43:50.377819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf80701d-9dca-4b02-9a30-ed72f688f99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d066f006f60>]}
[0m11:43:50.481831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf80701d-9dca-4b02-9a30-ed72f688f99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d066ec2ce60>]}
[0m11:43:50.483049 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:43:50.658398 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:43:50.921414 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:43:50.922032 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:43:50.988549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf80701d-9dca-4b02-9a30-ed72f688f99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d066d4df980>]}
[0m11:43:51.145654 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:43:51.149457 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:43:51.205338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf80701d-9dca-4b02-9a30-ed72f688f99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d066d1c7e00>]}
[0m11:43:51.206068 [info ] [MainThread]: Found 6 models, 6 data tests, 5 sources, 429 macros
[0m11:43:51.206640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf80701d-9dca-4b02-9a30-ed72f688f99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d066ed13a70>]}
[0m11:43:51.209855 [info ] [MainThread]: 
[0m11:43:51.210494 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:43:51.211205 [info ] [MainThread]: 
[0m11:43:51.212226 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:43:51.220258 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:43:51.221514 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:43:51.312611 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:43:51.313117 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:43:51.313570 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:43:51.314382 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:43:51.315029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:43:51.315718 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:43:51.334812 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.020 seconds
[0m11:43:51.336607 [debug] [ThreadPool]: On list_db: Close
[0m11:43:51.337214 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.021 seconds
[0m11:43:51.339269 [debug] [ThreadPool]: On list_db: Close
[0m11:43:51.342054 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev_dev)
[0m11:43:51.348954 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m11:43:51.353813 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m11:43:51.356477 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:43:51.357336 [debug] [ThreadPool]: On list_db_dev_dev: BEGIN
[0m11:43:51.358338 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:43:51.359228 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:43:51.360113 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:43:51.392046 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m11:43:51.394281 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m11:43:51.395682 [debug] [ThreadPool]: On list_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_dev'
  
[0m11:43:51.404368 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m11:43:51.406544 [debug] [ThreadPool]: On list_db_dev_dev: ROLLBACK
[0m11:43:51.407450 [debug] [ThreadPool]: On list_db_dev_dev: Close
[0m11:43:51.413597 [debug] [ThreadPool]: SQL status: BEGIN in 0.053 seconds
[0m11:43:51.414700 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:43:51.415919 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:43:51.431188 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.014 seconds
[0m11:43:51.433419 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:43:51.434347 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:43:51.449795 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:51.450537 [debug] [MainThread]: On master: BEGIN
[0m11:43:51.451541 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:43:51.470114 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m11:43:51.471014 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:51.471729 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:43:51.485776 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m11:43:51.488030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf80701d-9dca-4b02-9a30-ed72f688f99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d066ed43e60>]}
[0m11:43:51.488773 [debug] [MainThread]: On master: ROLLBACK
[0m11:43:51.489521 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:51.490238 [debug] [MainThread]: On master: BEGIN
[0m11:43:51.491511 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:43:51.493107 [debug] [MainThread]: On master: COMMIT
[0m11:43:51.497298 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:51.501363 [debug] [MainThread]: On master: COMMIT
[0m11:43:51.503130 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:43:51.503836 [debug] [MainThread]: On master: Close
[0m11:43:51.510885 [debug] [Thread-1 (]: Began running node model.my_project.beer_types
[0m11:43:51.512495 [debug] [Thread-2 (]: Began running node model.my_project.staging
[0m11:43:51.513741 [info ] [Thread-1 (]: 1 of 6 START sql table model dev_dev.beer_types ................................ [RUN]
[0m11:43:51.515025 [info ] [Thread-2 (]: 2 of 6 START sql table model dev.staging ....................................... [RUN]
[0m11:43:51.516495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.beer_types)
[0m11:43:51.517428 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_dev_dev, now model.my_project.staging)
[0m11:43:51.518135 [debug] [Thread-1 (]: Began compiling node model.my_project.beer_types
[0m11:43:51.518748 [debug] [Thread-2 (]: Began compiling node model.my_project.staging
[0m11:43:51.532914 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.beer_types"
[0m11:43:51.538811 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_project.staging"
[0m11:43:51.540133 [debug] [Thread-1 (]: Began executing node model.my_project.beer_types
[0m11:43:51.551354 [debug] [Thread-2 (]: Began executing node model.my_project.staging
[0m11:43:51.639963 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.beer_types"
[0m11:43:51.640887 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_project.staging"
[0m11:43:51.642630 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m11:43:51.643572 [debug] [Thread-1 (]: On model.my_project.beer_types: BEGIN
[0m11:43:51.644376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:51.644952 [debug] [Thread-2 (]: Using postgres connection "model.my_project.staging"
[0m11:43:51.645832 [debug] [Thread-2 (]: On model.my_project.staging: BEGIN
[0m11:43:51.646521 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:43:51.666258 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m11:43:51.667063 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m11:43:51.667832 [debug] [Thread-1 (]: On model.my_project.beer_types: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_types"} */

  
    

  create  table "db"."dev_dev"."beer_types__dbt_tmp"
  
  
    as
  
  (
    

select
    beer_id,
    name,
    tagline,
    first_brewed,
    abv,
    ibu,
    ebc,
    ph,
    case
        when lower(tagline) like '%lager%' then 'Lager'
        when lower(tagline) like '%pilsner%' then 'Lager'
        when lower(tagline) like '%ipa%' then 'Ale'
        when lower(tagline) like '%stout%' then 'Ale'
        when lower(tagline) like '%porter%' then 'Ale'
        when lower(tagline) like '%ale%' then 'Ale'
        when lower(tagline) like '%wheat%' then 'Ale'
        else 'Other'
    end as type
from "db"."dev"."raw_beer_data"
  );
  
[0m11:43:51.669686 [debug] [Thread-2 (]: SQL status: BEGIN in 0.023 seconds
[0m11:43:51.670327 [debug] [Thread-2 (]: Using postgres connection "model.my_project.staging"
[0m11:43:51.671465 [debug] [Thread-2 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * 
    from "db"."dev"."raw_beer_data"
)

select 
    id,
    beer_id,
    name as beer_name,
    tagline,
    first_brewed,
    description,
    image,
    abv,
    ibu,
    ebc,
    ph,
    brewers_tips,
    contributed_by,
    inserted_at
from source
  );
  
[0m11:43:51.691418 [debug] [Thread-2 (]: SQL status: SELECT 414 in 0.019 seconds
[0m11:43:51.702838 [debug] [Thread-2 (]: Using postgres connection "model.my_project.staging"
[0m11:43:51.703507 [debug] [Thread-2 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m11:43:51.754838 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.051 seconds
[0m11:43:51.764175 [debug] [Thread-2 (]: Using postgres connection "model.my_project.staging"
[0m11:43:51.765731 [debug] [Thread-2 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m11:43:51.767565 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:43:51.776489 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.108 seconds
[0m11:43:51.800544 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m11:43:51.807673 [debug] [Thread-2 (]: On model.my_project.staging: COMMIT
[0m11:43:51.808544 [debug] [Thread-1 (]: On model.my_project.beer_types: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_types"} */
alter table "db"."dev_dev"."beer_types" rename to "beer_types__dbt_backup"
[0m11:43:51.809281 [debug] [Thread-2 (]: Using postgres connection "model.my_project.staging"
[0m11:43:51.810171 [debug] [Thread-2 (]: On model.my_project.staging: COMMIT
[0m11:43:51.810715 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:43:51.815766 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m11:43:51.816368 [debug] [Thread-1 (]: On model.my_project.beer_types: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_types"} */
alter table "db"."dev_dev"."beer_types__dbt_tmp" rename to "beer_types"
[0m11:43:51.817461 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:43:51.819805 [debug] [Thread-1 (]: On model.my_project.beer_types: COMMIT
[0m11:43:51.820440 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m11:43:51.821003 [debug] [Thread-1 (]: On model.my_project.beer_types: COMMIT
[0m11:43:52.934090 [debug] [Thread-2 (]: SQL status: COMMIT in 1.122 seconds
[0m11:43:52.938158 [debug] [Thread-1 (]: SQL status: COMMIT in 1.115 seconds
[0m11:43:52.969385 [debug] [Thread-2 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m11:43:52.970461 [debug] [Thread-1 (]: Applying DROP to: "db"."dev_dev"."beer_types__dbt_backup"
[0m11:43:52.980540 [debug] [Thread-2 (]: Using postgres connection "model.my_project.staging"
[0m11:43:52.981517 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m11:43:52.982208 [debug] [Thread-2 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m11:43:52.982927 [debug] [Thread-1 (]: On model.my_project.beer_types: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_types"} */
drop table if exists "db"."dev_dev"."beer_types__dbt_backup" cascade
[0m11:43:53.092814 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.109 seconds
[0m11:43:53.096415 [debug] [Thread-1 (]: On model.my_project.beer_types: Close
[0m11:43:53.099956 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.116 seconds
[0m11:43:53.102447 [debug] [Thread-2 (]: On model.my_project.staging: Close
[0m11:43:53.103232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf80701d-9dca-4b02-9a30-ed72f688f99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d066f84a660>]}
[0m11:43:53.104070 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf80701d-9dca-4b02-9a30-ed72f688f99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d066c2a51f0>]}
[0m11:43:53.105039 [info ] [Thread-1 (]: 1 of 6 OK created sql table model dev_dev.beer_types ........................... [[32mSELECT 414[0m in 1.58s]
[0m11:43:53.106505 [info ] [Thread-2 (]: 2 of 6 OK created sql table model dev.staging .................................. [[32mSELECT 414[0m in 1.59s]
[0m11:43:53.107980 [debug] [Thread-1 (]: Finished running node model.my_project.beer_types
[0m11:43:53.108963 [debug] [Thread-2 (]: Finished running node model.my_project.staging
[0m11:43:53.111435 [debug] [Thread-4 (]: Began running node model.my_project.beer_released
[0m11:43:53.112325 [debug] [Thread-3 (]: Began running node model.my_project.type_by_year
[0m11:43:53.113388 [debug] [Thread-1 (]: Began running node model.my_project.beer_report
[0m11:43:53.114206 [info ] [Thread-4 (]: 3 of 6 START sql table model dev_dev.beer_released ............................. [RUN]
[0m11:43:53.115207 [debug] [Thread-2 (]: Began running node model.my_project.master_beer_table
[0m11:43:53.116321 [info ] [Thread-3 (]: 4 of 6 START sql table model dev_dev.type_by_year .............................. [RUN]
[0m11:43:53.117502 [info ] [Thread-1 (]: 5 of 6 START sql table model dev.beer_report ................................... [RUN]
[0m11:43:53.118598 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.beer_released'
[0m11:43:53.119425 [info ] [Thread-2 (]: 6 of 6 START sql table model dev.master_beer_table ............................. [RUN]
[0m11:43:53.120364 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.type_by_year'
[0m11:43:53.121088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.beer_types, now model.my_project.beer_report)
[0m11:43:53.121774 [debug] [Thread-4 (]: Began compiling node model.my_project.beer_released
[0m11:43:53.122568 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_project.staging, now model.my_project.master_beer_table)
[0m11:43:53.123549 [debug] [Thread-3 (]: Began compiling node model.my_project.type_by_year
[0m11:43:53.124190 [debug] [Thread-1 (]: Began compiling node model.my_project.beer_report
[0m11:43:53.128684 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.beer_released"
[0m11:43:53.129387 [debug] [Thread-2 (]: Began compiling node model.my_project.master_beer_table
[0m11:43:53.133269 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.type_by_year"
[0m11:43:53.137060 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.beer_report"
[0m11:43:53.141299 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_project.master_beer_table"
[0m11:43:53.142398 [debug] [Thread-4 (]: Began executing node model.my_project.beer_released
[0m11:43:53.143408 [debug] [Thread-3 (]: Began executing node model.my_project.type_by_year
[0m11:43:53.144677 [debug] [Thread-1 (]: Began executing node model.my_project.beer_report
[0m11:43:53.149406 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.beer_released"
[0m11:43:53.150325 [debug] [Thread-2 (]: Began executing node model.my_project.master_beer_table
[0m11:43:53.155336 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.type_by_year"
[0m11:43:53.160512 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.beer_report"
[0m11:43:53.165096 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_project.master_beer_table"
[0m11:43:53.166328 [debug] [Thread-4 (]: Using postgres connection "model.my_project.beer_released"
[0m11:43:53.166966 [debug] [Thread-3 (]: Using postgres connection "model.my_project.type_by_year"
[0m11:43:53.168203 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_report"
[0m11:43:53.168841 [debug] [Thread-4 (]: On model.my_project.beer_released: BEGIN
[0m11:43:53.169603 [debug] [Thread-2 (]: Using postgres connection "model.my_project.master_beer_table"
[0m11:43:53.170138 [debug] [Thread-3 (]: On model.my_project.type_by_year: BEGIN
[0m11:43:53.170795 [debug] [Thread-1 (]: On model.my_project.beer_report: BEGIN
[0m11:43:53.171488 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:43:53.172120 [debug] [Thread-2 (]: On model.my_project.master_beer_table: BEGIN
[0m11:43:53.172871 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:43:53.173505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:53.174631 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:43:53.188673 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m11:43:53.189816 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m11:43:53.190591 [debug] [Thread-2 (]: Using postgres connection "model.my_project.master_beer_table"
[0m11:43:53.191457 [debug] [Thread-3 (]: Using postgres connection "model.my_project.type_by_year"
[0m11:43:53.192195 [debug] [Thread-4 (]: SQL status: BEGIN in 0.021 seconds
[0m11:43:53.193214 [debug] [Thread-2 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */

  
    

  create  table "db"."dev"."master_beer_table__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    beer_id,
    beer_name,
    tagline as category,         -- category/style approximation
    description,
    abv as alcohol_percent,
    first_brewed
from beers
  );
  
[0m11:43:53.193895 [debug] [Thread-3 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */

  
    

  create  table "db"."dev_dev"."type_by_year__dbt_tmp"
  
  
    as
  
  (
    

select
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4) as year,
    type,
    count(*) as beer_count
from "db"."dev_dev"."beer_types"
where
    -- Only keep non-null, non-empty years and ensure first 4 chars are digits
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4) ~ '^\d{4}$'
group by
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4),
    type
order by
    year,
    type
  );
  
[0m11:43:53.194811 [debug] [Thread-4 (]: Using postgres connection "model.my_project.beer_released"
[0m11:43:53.196511 [debug] [Thread-4 (]: On model.my_project.beer_released: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_released"} */

  
    

  create  table "db"."dev_dev"."beer_released__dbt_tmp"
  
  
    as
  
  (
    

select
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4) as year,
    count(*) as beer_count
from "db"."dev_dev"."beer_types"
where
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4) ~ '^\d{4}$'
group by year
order by year
  );
  
[0m11:43:53.197739 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m11:43:53.199351 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_report"
[0m11:43:53.200598 [debug] [Thread-1 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */

  
    

  create  table "db"."dev"."beer_report__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    count(*) as total_beers,
    round(avg(abv)::numeric, 2) as avg_abv,
    round(min(abv)::numeric, 2) as min_abv,
    round(max(abv)::numeric, 2) as max_abv,
    round(avg(ibu)::numeric, 2) as avg_ibu,
    round(min(ibu)::numeric, 2) as min_ibu,
    round(max(ibu)::numeric, 2) as max_ibu,
    round(avg(ebc)::numeric, 2) as avg_ebc,
    round(min(ebc)::numeric, 2) as min_ebc,
    round(max(ebc)::numeric, 2) as max_ebc,
    round(avg(ph)::numeric, 2) as avg_ph,
    min(first_brewed) as oldest_brew,
    max(first_brewed) as newest_brew,
    count(distinct contributed_by) as unique_contributors
from beers
  );
  
[0m11:43:53.204689 [debug] [Thread-2 (]: SQL status: SELECT 414 in 0.009 seconds
[0m11:43:53.205953 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.007 seconds
[0m11:43:53.211338 [debug] [Thread-2 (]: Using postgres connection "model.my_project.master_beer_table"
[0m11:43:53.212091 [debug] [Thread-3 (]: SQL status: SELECT 12 in 0.016 seconds
[0m11:43:53.217124 [debug] [Thread-4 (]: Using postgres connection "model.my_project.beer_released"
[0m11:43:53.217799 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.016 seconds
[0m11:43:53.218582 [debug] [Thread-2 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */
alter table "db"."dev"."master_beer_table" rename to "master_beer_table__dbt_backup"
[0m11:43:53.224201 [debug] [Thread-3 (]: Using postgres connection "model.my_project.type_by_year"
[0m11:43:53.224999 [debug] [Thread-4 (]: On model.my_project.beer_released: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_released"} */
alter table "db"."dev_dev"."beer_released" rename to "beer_released__dbt_backup"
[0m11:43:53.229254 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_report"
[0m11:43:53.230139 [debug] [Thread-3 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */
alter table "db"."dev_dev"."type_by_year" rename to "type_by_year__dbt_backup"
[0m11:43:53.230810 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:43:53.231590 [debug] [Thread-1 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report" rename to "beer_report__dbt_backup"
[0m11:43:53.232221 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:43:53.236146 [debug] [Thread-2 (]: Using postgres connection "model.my_project.master_beer_table"
[0m11:43:53.236846 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m11:43:53.240927 [debug] [Thread-4 (]: Using postgres connection "model.my_project.beer_released"
[0m11:43:53.241637 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m11:43:53.242228 [debug] [Thread-2 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */
alter table "db"."dev"."master_beer_table__dbt_tmp" rename to "master_beer_table"
[0m11:43:53.246112 [debug] [Thread-3 (]: Using postgres connection "model.my_project.type_by_year"
[0m11:43:53.246792 [debug] [Thread-4 (]: On model.my_project.beer_released: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_released"} */
alter table "db"."dev_dev"."beer_released__dbt_tmp" rename to "beer_released"
[0m11:43:53.251354 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_report"
[0m11:43:53.252221 [debug] [Thread-3 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */
alter table "db"."dev_dev"."type_by_year__dbt_tmp" rename to "type_by_year"
[0m11:43:53.252891 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:43:53.253634 [debug] [Thread-1 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report__dbt_tmp" rename to "beer_report"
[0m11:43:53.254261 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:43:53.256707 [debug] [Thread-2 (]: On model.my_project.master_beer_table: COMMIT
[0m11:43:53.257337 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m11:43:53.259676 [debug] [Thread-4 (]: On model.my_project.beer_released: COMMIT
[0m11:43:53.260615 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m11:43:53.261330 [debug] [Thread-2 (]: Using postgres connection "model.my_project.master_beer_table"
[0m11:43:53.263834 [debug] [Thread-3 (]: On model.my_project.type_by_year: COMMIT
[0m11:43:53.264554 [debug] [Thread-4 (]: Using postgres connection "model.my_project.beer_released"
[0m11:43:53.266697 [debug] [Thread-1 (]: On model.my_project.beer_report: COMMIT
[0m11:43:53.267375 [debug] [Thread-2 (]: On model.my_project.master_beer_table: COMMIT
[0m11:43:53.268007 [debug] [Thread-3 (]: Using postgres connection "model.my_project.type_by_year"
[0m11:43:53.268635 [debug] [Thread-4 (]: On model.my_project.beer_released: COMMIT
[0m11:43:53.269273 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_report"
[0m11:43:53.270197 [debug] [Thread-3 (]: On model.my_project.type_by_year: COMMIT
[0m11:43:53.271058 [debug] [Thread-1 (]: On model.my_project.beer_report: COMMIT
[0m11:43:53.277644 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m11:43:53.281134 [debug] [Thread-2 (]: Applying DROP to: "db"."dev"."master_beer_table__dbt_backup"
[0m11:43:53.282010 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m11:43:53.283490 [debug] [Thread-2 (]: Using postgres connection "model.my_project.master_beer_table"
[0m11:43:53.284317 [debug] [Thread-4 (]: SQL status: COMMIT in 0.013 seconds
[0m11:43:53.285037 [debug] [Thread-3 (]: SQL status: COMMIT in 0.013 seconds
[0m11:43:53.289100 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."beer_report__dbt_backup"
[0m11:43:53.289765 [debug] [Thread-2 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */
drop table if exists "db"."dev"."master_beer_table__dbt_backup" cascade
[0m11:43:53.292697 [debug] [Thread-4 (]: Applying DROP to: "db"."dev_dev"."beer_released__dbt_backup"
[0m11:43:53.296120 [debug] [Thread-3 (]: Applying DROP to: "db"."dev_dev"."type_by_year__dbt_backup"
[0m11:43:53.297217 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_report"
[0m11:43:53.298593 [debug] [Thread-4 (]: Using postgres connection "model.my_project.beer_released"
[0m11:43:53.299579 [debug] [Thread-3 (]: Using postgres connection "model.my_project.type_by_year"
[0m11:43:53.300259 [debug] [Thread-1 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
drop table if exists "db"."dev"."beer_report__dbt_backup" cascade
[0m11:43:53.300916 [debug] [Thread-4 (]: On model.my_project.beer_released: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_released"} */
drop table if exists "db"."dev_dev"."beer_released__dbt_backup" cascade
[0m11:43:53.301642 [debug] [Thread-3 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */
drop table if exists "db"."dev_dev"."type_by_year__dbt_backup" cascade
[0m11:43:53.305627 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.007 seconds
[0m11:43:53.307729 [debug] [Thread-2 (]: On model.my_project.master_beer_table: Close
[0m11:43:53.308582 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf80701d-9dca-4b02-9a30-ed72f688f99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d066c3ae060>]}
[0m11:43:53.309425 [info ] [Thread-2 (]: 6 of 6 OK created sql table model dev.master_beer_table ........................ [[32mSELECT 414[0m in 0.19s]
[0m11:43:53.310261 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.008 seconds
[0m11:43:53.310967 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.009 seconds
[0m11:43:53.311691 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.009 seconds
[0m11:43:53.312599 [debug] [Thread-2 (]: Finished running node model.my_project.master_beer_table
[0m11:43:53.314678 [debug] [Thread-3 (]: On model.my_project.type_by_year: Close
[0m11:43:53.316557 [debug] [Thread-1 (]: On model.my_project.beer_report: Close
[0m11:43:53.318349 [debug] [Thread-4 (]: On model.my_project.beer_released: Close
[0m11:43:53.319694 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf80701d-9dca-4b02-9a30-ed72f688f99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d066c2a5190>]}
[0m11:43:53.320562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf80701d-9dca-4b02-9a30-ed72f688f99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d066c2f83b0>]}
[0m11:43:53.321446 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf80701d-9dca-4b02-9a30-ed72f688f99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d066d0aeed0>]}
[0m11:43:53.322521 [info ] [Thread-3 (]: 4 of 6 OK created sql table model dev_dev.type_by_year ......................... [[32mSELECT 12[0m in 0.20s]
[0m11:43:53.323991 [info ] [Thread-1 (]: 5 of 6 OK created sql table model dev.beer_report .............................. [[32mSELECT 1[0m in 0.20s]
[0m11:43:53.325308 [info ] [Thread-4 (]: 3 of 6 OK created sql table model dev_dev.beer_released ........................ [[32mSELECT 5[0m in 0.20s]
[0m11:43:53.326671 [debug] [Thread-3 (]: Finished running node model.my_project.type_by_year
[0m11:43:53.327782 [debug] [Thread-1 (]: Finished running node model.my_project.beer_report
[0m11:43:53.328658 [debug] [Thread-4 (]: Finished running node model.my_project.beer_released
[0m11:43:53.333174 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:53.333753 [debug] [MainThread]: On master: BEGIN
[0m11:43:53.334209 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:43:53.349229 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m11:43:53.350262 [debug] [MainThread]: On master: COMMIT
[0m11:43:53.351016 [debug] [MainThread]: Using postgres connection "master"
[0m11:43:53.352279 [debug] [MainThread]: On master: COMMIT
[0m11:43:53.353687 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:43:53.354788 [debug] [MainThread]: On master: Close
[0m11:43:53.356637 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:43:53.367556 [debug] [MainThread]: Connection 'model.my_project.master_beer_table' was properly closed.
[0m11:43:53.369356 [debug] [MainThread]: Connection 'model.my_project.beer_report' was properly closed.
[0m11:43:53.370290 [debug] [MainThread]: Connection 'model.my_project.beer_released' was properly closed.
[0m11:43:53.371939 [debug] [MainThread]: Connection 'model.my_project.type_by_year' was properly closed.
[0m11:43:53.388464 [info ] [MainThread]: 
[0m11:43:53.389572 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 2.16 seconds (2.16s).
[0m11:43:53.393374 [debug] [MainThread]: Command end result
[0m11:43:53.433814 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:43:53.436205 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:43:53.446791 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:43:53.447426 [info ] [MainThread]: 
[0m11:43:53.448132 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:43:53.448919 [info ] [MainThread]: 
[0m11:43:53.449850 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m11:43:53.451921 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.6695318, "process_in_blocks": "5488", "process_kernel_time": 1.172359, "process_mem_max_rss": "108840", "process_out_blocks": "3632", "process_user_time": 4.117456}
[0m11:43:53.453320 [debug] [MainThread]: Command `dbt run` succeeded at 11:43:53.452991 after 3.67 seconds
[0m11:43:53.453937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d066ef40b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d066d4c8830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d066d4dff20>]}
[0m11:43:53.454654 [debug] [MainThread]: Flushing usage events
[0m11:43:55.153009 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:52:53.995840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70270960baa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70270aa843b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70270942b9e0>]}


============================== 11:52:54.004404 | 3d506e01-fa5a-44f0-b0ae-3b43b27005df ==============================
[0m11:52:54.004404 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:52:54.005597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select top_malts', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:52:54.278562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d506e01-fa5a-44f0-b0ae-3b43b27005df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702708e8ffb0>]}
[0m11:52:54.356922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d506e01-fa5a-44f0-b0ae-3b43b27005df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702709a65ca0>]}
[0m11:52:54.357959 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:52:54.489117 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:52:54.656212 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:52:54.657009 [debug] [MainThread]: Partial parsing: added file: my_project://models/mart/top_malts.sql
[0m11:52:55.039079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d506e01-fa5a-44f0-b0ae-3b43b27005df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702705f1cd10>]}
[0m11:52:55.157857 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:52:55.161327 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:52:55.196497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d506e01-fa5a-44f0-b0ae-3b43b27005df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702705eace60>]}
[0m11:52:55.197169 [info ] [MainThread]: Found 7 models, 6 data tests, 5 sources, 429 macros
[0m11:52:55.197751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d506e01-fa5a-44f0-b0ae-3b43b27005df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702705ef3ef0>]}
[0m11:52:55.200224 [info ] [MainThread]: 
[0m11:52:55.200947 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:52:55.201609 [info ] [MainThread]: 
[0m11:52:55.202860 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:52:55.204534 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:52:55.273988 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:52:55.274539 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:52:55.274954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:52:55.289079 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.014 seconds
[0m11:52:55.290912 [debug] [ThreadPool]: On list_db: Close
[0m11:52:55.297636 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev_dev)
[0m11:52:55.298665 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_dev'
[0m11:52:55.306168 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m11:52:55.308429 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:52:55.309022 [debug] [ThreadPool]: On list_db_dev_dev: BEGIN
[0m11:52:55.309609 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:52:55.310113 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:52:55.310645 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:52:55.322437 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m11:52:55.323229 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m11:52:55.323959 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m11:52:55.324586 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:52:55.325185 [debug] [ThreadPool]: On list_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_dev'
  
[0m11:52:55.325797 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:52:55.330568 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m11:52:55.331532 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.005 seconds
[0m11:52:55.334317 [debug] [ThreadPool]: On list_db_dev_dev: ROLLBACK
[0m11:52:55.336936 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:52:55.338056 [debug] [ThreadPool]: On list_db_dev_dev: Close
[0m11:52:55.338577 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:52:55.349254 [debug] [MainThread]: Using postgres connection "master"
[0m11:52:55.349982 [debug] [MainThread]: On master: BEGIN
[0m11:52:55.350416 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:52:55.362546 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m11:52:55.363622 [debug] [MainThread]: Using postgres connection "master"
[0m11:52:55.364379 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:52:55.369527 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m11:52:55.371909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d506e01-fa5a-44f0-b0ae-3b43b27005df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7027050d3f80>]}
[0m11:52:55.372946 [debug] [MainThread]: On master: ROLLBACK
[0m11:52:55.373837 [debug] [MainThread]: Using postgres connection "master"
[0m11:52:55.374320 [debug] [MainThread]: On master: BEGIN
[0m11:52:55.375416 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:52:55.376029 [debug] [MainThread]: On master: COMMIT
[0m11:52:55.376732 [debug] [MainThread]: Using postgres connection "master"
[0m11:52:55.377178 [debug] [MainThread]: On master: COMMIT
[0m11:52:55.377973 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:52:55.378491 [debug] [MainThread]: On master: Close
[0m11:52:55.382744 [debug] [Thread-1 (]: Began running node model.my_project.top_malts
[0m11:52:55.383626 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_dev.top_malts ................................. [RUN]
[0m11:52:55.384831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.top_malts)
[0m11:52:55.386031 [debug] [Thread-1 (]: Began compiling node model.my_project.top_malts
[0m11:52:55.397027 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.top_malts"
[0m11:52:55.398903 [debug] [Thread-1 (]: Began executing node model.my_project.top_malts
[0m11:52:55.452257 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.top_malts"
[0m11:52:55.454279 [debug] [Thread-1 (]: Using postgres connection "model.my_project.top_malts"
[0m11:52:55.454819 [debug] [Thread-1 (]: On model.my_project.top_malts: BEGIN
[0m11:52:55.455246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:52:55.467273 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m11:52:55.468226 [debug] [Thread-1 (]: Using postgres connection "model.my_project.top_malts"
[0m11:52:55.468833 [debug] [Thread-1 (]: On model.my_project.top_malts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_malts"} */

  
    

  create  table "db"."dev_dev"."top_malts__dbt_tmp"
  
  
    as
  
  (
    

select
    malt_name,
    count(distinct beer_id) as beers_with_malt
from "db"."dev"."malt_ingredients"
where malt_name is not null
group by malt_name
order by beers_with_malt desc
  );
  
[0m11:52:55.480897 [debug] [Thread-1 (]: SQL status: SELECT 133 in 0.011 seconds
[0m11:52:55.489396 [debug] [Thread-1 (]: Using postgres connection "model.my_project.top_malts"
[0m11:52:55.489993 [debug] [Thread-1 (]: On model.my_project.top_malts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_malts"} */
alter table "db"."dev_dev"."top_malts__dbt_tmp" rename to "top_malts"
[0m11:52:55.491127 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:52:55.514933 [debug] [Thread-1 (]: On model.my_project.top_malts: COMMIT
[0m11:52:55.515465 [debug] [Thread-1 (]: Using postgres connection "model.my_project.top_malts"
[0m11:52:55.515910 [debug] [Thread-1 (]: On model.my_project.top_malts: COMMIT
[0m11:52:55.521352 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m11:52:55.533613 [debug] [Thread-1 (]: Applying DROP to: "db"."dev_dev"."top_malts__dbt_backup"
[0m11:52:55.541930 [debug] [Thread-1 (]: Using postgres connection "model.my_project.top_malts"
[0m11:52:55.542590 [debug] [Thread-1 (]: On model.my_project.top_malts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_malts"} */
drop table if exists "db"."dev_dev"."top_malts__dbt_backup" cascade
[0m11:52:55.543577 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m11:52:55.546828 [debug] [Thread-1 (]: On model.my_project.top_malts: Close
[0m11:52:55.549157 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d506e01-fa5a-44f0-b0ae-3b43b27005df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7027051660f0>]}
[0m11:52:55.550083 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_dev.top_malts ............................ [[32mSELECT 133[0m in 0.16s]
[0m11:52:55.551178 [debug] [Thread-1 (]: Finished running node model.my_project.top_malts
[0m11:52:55.554277 [debug] [MainThread]: Using postgres connection "master"
[0m11:52:55.554791 [debug] [MainThread]: On master: BEGIN
[0m11:52:55.555232 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:52:55.568416 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m11:52:55.569600 [debug] [MainThread]: On master: COMMIT
[0m11:52:55.570414 [debug] [MainThread]: Using postgres connection "master"
[0m11:52:55.571116 [debug] [MainThread]: On master: COMMIT
[0m11:52:55.572055 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:52:55.572763 [debug] [MainThread]: On master: Close
[0m11:52:55.573550 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:52:55.573999 [debug] [MainThread]: Connection 'list_db_dev_dev' was properly closed.
[0m11:52:55.574516 [debug] [MainThread]: Connection 'model.my_project.top_malts' was properly closed.
[0m11:52:55.575159 [info ] [MainThread]: 
[0m11:52:55.575949 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m11:52:55.578312 [debug] [MainThread]: Command end result
[0m11:52:55.614698 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:52:55.617383 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:52:55.627678 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:52:55.628312 [info ] [MainThread]: 
[0m11:52:55.629101 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:52:55.629969 [info ] [MainThread]: 
[0m11:52:55.630818 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:52:55.632798 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7040551, "process_in_blocks": "3528", "process_kernel_time": 0.497719, "process_mem_max_rss": "110848", "process_out_blocks": "4376", "process_user_time": 3.182997}
[0m11:52:55.633595 [debug] [MainThread]: Command `dbt run` succeeded at 11:52:55.633429 after 1.71 seconds
[0m11:52:55.634169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7027091ae5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7027096082f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7027090b1eb0>]}
[0m11:52:55.635207 [debug] [MainThread]: Flushing usage events
[0m11:52:57.079899 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:13:32.388755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a69044c710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a68df38bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a68dc7bda0>]}


============================== 12:13:32.396572 | 02c7edc3-e2df-450a-9d66-19a547158ac4 ==============================
[0m12:13:32.396572 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:13:32.397627 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select top_hops', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:13:32.940005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02c7edc3-e2df-450a-9d66-19a547158ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a68deb5160>]}
[0m12:13:33.021023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02c7edc3-e2df-450a-9d66-19a547158ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a68dc2e9f0>]}
[0m12:13:33.022320 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:13:33.151967 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:13:33.331262 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:13:33.332410 [debug] [MainThread]: Partial parsing: added file: my_project://models/mart/top_hops.sql
[0m12:13:33.780481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02c7edc3-e2df-450a-9d66-19a547158ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a68aeb52e0>]}
[0m12:13:33.904182 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:13:33.907705 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:13:33.943468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02c7edc3-e2df-450a-9d66-19a547158ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a68ae452b0>]}
[0m12:13:33.944168 [info ] [MainThread]: Found 8 models, 6 data tests, 5 sources, 429 macros
[0m12:13:33.944684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02c7edc3-e2df-450a-9d66-19a547158ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a68c03a6c0>]}
[0m12:13:33.947024 [info ] [MainThread]: 
[0m12:13:33.947564 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:13:33.948237 [info ] [MainThread]: 
[0m12:13:33.949283 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:13:33.951101 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:13:34.023486 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:13:34.024336 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:13:34.024793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:34.038512 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.014 seconds
[0m12:13:34.040503 [debug] [ThreadPool]: On list_db: Close
[0m12:13:34.047295 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:13:34.048382 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_dev_dev'
[0m12:13:34.055855 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:13:34.058044 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m12:13:34.058614 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:13:34.059155 [debug] [ThreadPool]: On list_db_dev_dev: BEGIN
[0m12:13:34.059860 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:13:34.060445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:34.072335 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m12:13:34.073139 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m12:13:34.073678 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:13:34.074316 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m12:13:34.074891 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:13:34.075487 [debug] [ThreadPool]: On list_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_dev'
  
[0m12:13:34.080064 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m12:13:34.080956 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.005 seconds
[0m12:13:34.083305 [debug] [ThreadPool]: On list_db_dev_dev: ROLLBACK
[0m12:13:34.085441 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:13:34.086541 [debug] [ThreadPool]: On list_db_dev_dev: Close
[0m12:13:34.087131 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:13:34.098536 [debug] [MainThread]: Using postgres connection "master"
[0m12:13:34.099100 [debug] [MainThread]: On master: BEGIN
[0m12:13:34.099526 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:13:34.111590 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m12:13:34.112355 [debug] [MainThread]: Using postgres connection "master"
[0m12:13:34.112943 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:13:34.118567 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m12:13:34.120801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02c7edc3-e2df-450a-9d66-19a547158ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a68a077620>]}
[0m12:13:34.121675 [debug] [MainThread]: On master: ROLLBACK
[0m12:13:34.122623 [debug] [MainThread]: Using postgres connection "master"
[0m12:13:34.123086 [debug] [MainThread]: On master: BEGIN
[0m12:13:34.124167 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:13:34.124883 [debug] [MainThread]: On master: COMMIT
[0m12:13:34.125443 [debug] [MainThread]: Using postgres connection "master"
[0m12:13:34.125988 [debug] [MainThread]: On master: COMMIT
[0m12:13:34.126733 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:13:34.127208 [debug] [MainThread]: On master: Close
[0m12:13:34.131779 [debug] [Thread-1 (]: Began running node model.my_project.top_hops
[0m12:13:34.132774 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_dev.top_hops .................................. [RUN]
[0m12:13:34.133728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.top_hops)
[0m12:13:34.134635 [debug] [Thread-1 (]: Began compiling node model.my_project.top_hops
[0m12:13:34.146535 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.top_hops"
[0m12:13:34.147420 [debug] [Thread-1 (]: Began executing node model.my_project.top_hops
[0m12:13:34.200857 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.top_hops"
[0m12:13:34.201746 [debug] [Thread-1 (]: Using postgres connection "model.my_project.top_hops"
[0m12:13:34.202225 [debug] [Thread-1 (]: On model.my_project.top_hops: BEGIN
[0m12:13:34.202646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:13:34.214359 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m12:13:34.215172 [debug] [Thread-1 (]: Using postgres connection "model.my_project.top_hops"
[0m12:13:34.215775 [debug] [Thread-1 (]: On model.my_project.top_hops: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_hops"} */

  
    

  create  table "db"."dev_dev"."top_hops__dbt_tmp"
  
  
    as
  
  (
    

select
    hop_name,
    count(distinct beer_id) as beers_with_hop
from "db"."dev"."hop_ingredients"
where hop_name is not null
group by hop_name
order by beers_with_hop desc
  );
  
[0m12:13:34.228314 [debug] [Thread-1 (]: SQL status: SELECT 178 in 0.012 seconds
[0m12:13:34.236206 [debug] [Thread-1 (]: Using postgres connection "model.my_project.top_hops"
[0m12:13:34.236707 [debug] [Thread-1 (]: On model.my_project.top_hops: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_hops"} */
alter table "db"."dev_dev"."top_hops__dbt_tmp" rename to "top_hops"
[0m12:13:34.237731 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:13:34.259459 [debug] [Thread-1 (]: On model.my_project.top_hops: COMMIT
[0m12:13:34.260011 [debug] [Thread-1 (]: Using postgres connection "model.my_project.top_hops"
[0m12:13:34.260408 [debug] [Thread-1 (]: On model.my_project.top_hops: COMMIT
[0m12:13:34.267539 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m12:13:34.276641 [debug] [Thread-1 (]: Applying DROP to: "db"."dev_dev"."top_hops__dbt_backup"
[0m12:13:34.285308 [debug] [Thread-1 (]: Using postgres connection "model.my_project.top_hops"
[0m12:13:34.285883 [debug] [Thread-1 (]: On model.my_project.top_hops: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_hops"} */
drop table if exists "db"."dev_dev"."top_hops__dbt_backup" cascade
[0m12:13:34.286827 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:13:34.290278 [debug] [Thread-1 (]: On model.my_project.top_hops: Close
[0m12:13:34.292444 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02c7edc3-e2df-450a-9d66-19a547158ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a68e782690>]}
[0m12:13:34.293287 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_dev.top_hops ............................. [[32mSELECT 178[0m in 0.16s]
[0m12:13:34.294602 [debug] [Thread-1 (]: Finished running node model.my_project.top_hops
[0m12:13:34.297673 [debug] [MainThread]: Using postgres connection "master"
[0m12:13:34.298167 [debug] [MainThread]: On master: BEGIN
[0m12:13:34.298592 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:13:34.311175 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m12:13:34.312076 [debug] [MainThread]: On master: COMMIT
[0m12:13:34.312705 [debug] [MainThread]: Using postgres connection "master"
[0m12:13:34.313158 [debug] [MainThread]: On master: COMMIT
[0m12:13:34.313913 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:13:34.314430 [debug] [MainThread]: On master: Close
[0m12:13:34.315151 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:13:34.315577 [debug] [MainThread]: Connection 'model.my_project.top_hops' was properly closed.
[0m12:13:34.316075 [debug] [MainThread]: Connection 'list_db_dev_dev' was properly closed.
[0m12:13:34.316572 [info ] [MainThread]: 
[0m12:13:34.317195 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m12:13:34.319019 [debug] [MainThread]: Command end result
[0m12:13:34.357688 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:13:34.360089 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:13:34.368838 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:13:34.369313 [info ] [MainThread]: 
[0m12:13:34.370037 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:13:34.371186 [info ] [MainThread]: 
[0m12:13:34.372693 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:13:34.374899 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.055706, "process_in_blocks": "0", "process_kernel_time": 0.62751, "process_mem_max_rss": "110800", "process_out_blocks": "4392", "process_user_time": 3.403647}
[0m12:13:34.375717 [debug] [MainThread]: Command `dbt run` succeeded at 12:13:34.375519 after 2.06 seconds
[0m12:13:34.376276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a68e16b530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a68df3f440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a68e29b020>]}
[0m12:13:34.376847 [debug] [MainThread]: Flushing usage events
[0m12:13:35.733251 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:15:43.689081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dafd8b36d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dafda55c3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dafd8ab29f0>]}


============================== 12:15:43.697670 | bd77a957-6461-4368-a32b-0af8db8c3d56 ==============================
[0m12:15:43.697670 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:15:43.698739 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select abv_ibu', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:15:43.971167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd77a957-6461-4368-a32b-0af8db8c3d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dafd8c3a1e0>]}
[0m12:15:44.051125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd77a957-6461-4368-a32b-0af8db8c3d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dafda7c6ea0>]}
[0m12:15:44.052262 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:15:44.202407 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:15:44.357229 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:15:44.357945 [debug] [MainThread]: Partial parsing: added file: my_project://models/mart/abv_ibu.sql
[0m12:15:44.742088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd77a957-6461-4368-a32b-0af8db8c3d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dafd57e1df0>]}
[0m12:15:44.876828 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:15:44.880525 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:15:44.915855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd77a957-6461-4368-a32b-0af8db8c3d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dafd68b8aa0>]}
[0m12:15:44.916541 [info ] [MainThread]: Found 9 models, 6 data tests, 5 sources, 429 macros
[0m12:15:44.917134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd77a957-6461-4368-a32b-0af8db8c3d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dafd8549820>]}
[0m12:15:44.919875 [info ] [MainThread]: 
[0m12:15:44.920587 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:15:44.921285 [info ] [MainThread]: 
[0m12:15:44.922285 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:15:44.923964 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:15:44.996761 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:15:44.997277 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:15:44.997708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:15:45.011401 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.014 seconds
[0m12:15:45.013146 [debug] [ThreadPool]: On list_db: Close
[0m12:15:45.019936 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev_dev)
[0m12:15:45.026304 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_dev'
[0m12:15:45.028143 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m12:15:45.030301 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:15:45.030859 [debug] [ThreadPool]: On list_db_dev_dev: BEGIN
[0m12:15:45.031390 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:15:45.031914 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:15:45.032487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:15:45.043674 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m12:15:45.044504 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m12:15:45.045087 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m12:15:45.045753 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:15:45.046518 [debug] [ThreadPool]: On list_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_dev'
  
[0m12:15:45.047158 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:15:45.051683 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m12:15:45.052314 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m12:15:45.054522 [debug] [ThreadPool]: On list_db_dev_dev: ROLLBACK
[0m12:15:45.056948 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:15:45.058334 [debug] [ThreadPool]: On list_db_dev_dev: Close
[0m12:15:45.058832 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:15:45.069637 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:45.070201 [debug] [MainThread]: On master: BEGIN
[0m12:15:45.070645 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:15:45.082667 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m12:15:45.083319 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:45.084089 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:15:45.088750 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m12:15:45.090904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd77a957-6461-4368-a32b-0af8db8c3d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dafda38c5f0>]}
[0m12:15:45.091694 [debug] [MainThread]: On master: ROLLBACK
[0m12:15:45.092603 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:45.093145 [debug] [MainThread]: On master: BEGIN
[0m12:15:45.094404 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:15:45.095159 [debug] [MainThread]: On master: COMMIT
[0m12:15:45.095630 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:45.096082 [debug] [MainThread]: On master: COMMIT
[0m12:15:45.097102 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:15:45.097611 [debug] [MainThread]: On master: Close
[0m12:15:45.102642 [debug] [Thread-1 (]: Began running node model.my_project.abv_ibu
[0m12:15:45.103595 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_dev.abv_ibu ................................... [RUN]
[0m12:15:45.104457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.abv_ibu)
[0m12:15:45.105278 [debug] [Thread-1 (]: Began compiling node model.my_project.abv_ibu
[0m12:15:45.116038 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.abv_ibu"
[0m12:15:45.116893 [debug] [Thread-1 (]: Began executing node model.my_project.abv_ibu
[0m12:15:45.168965 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.abv_ibu"
[0m12:15:45.169943 [debug] [Thread-1 (]: Using postgres connection "model.my_project.abv_ibu"
[0m12:15:45.170498 [debug] [Thread-1 (]: On model.my_project.abv_ibu: BEGIN
[0m12:15:45.170966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:15:45.183976 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m12:15:45.184879 [debug] [Thread-1 (]: Using postgres connection "model.my_project.abv_ibu"
[0m12:15:45.185548 [debug] [Thread-1 (]: On model.my_project.abv_ibu: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.abv_ibu"} */

  
    

  create  table "db"."dev_dev"."abv_ibu__dbt_tmp"
  
  
    as
  
  (
    

select
    abv,
    ibu,
    type
from "db"."dev_dev"."beer_types"
where abv is not null and ibu is not null
  );
  
[0m12:15:45.190016 [debug] [Thread-1 (]: SQL status: SELECT 409 in 0.004 seconds
[0m12:15:45.201254 [debug] [Thread-1 (]: Using postgres connection "model.my_project.abv_ibu"
[0m12:15:45.201866 [debug] [Thread-1 (]: On model.my_project.abv_ibu: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.abv_ibu"} */
alter table "db"."dev_dev"."abv_ibu__dbt_tmp" rename to "abv_ibu"
[0m12:15:45.203104 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:15:45.227101 [debug] [Thread-1 (]: On model.my_project.abv_ibu: COMMIT
[0m12:15:45.227646 [debug] [Thread-1 (]: Using postgres connection "model.my_project.abv_ibu"
[0m12:15:45.228065 [debug] [Thread-1 (]: On model.my_project.abv_ibu: COMMIT
[0m12:15:45.234231 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m12:15:45.243688 [debug] [Thread-1 (]: Applying DROP to: "db"."dev_dev"."abv_ibu__dbt_backup"
[0m12:15:45.255122 [debug] [Thread-1 (]: Using postgres connection "model.my_project.abv_ibu"
[0m12:15:45.255737 [debug] [Thread-1 (]: On model.my_project.abv_ibu: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.abv_ibu"} */
drop table if exists "db"."dev_dev"."abv_ibu__dbt_backup" cascade
[0m12:15:45.256699 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:15:45.260562 [debug] [Thread-1 (]: On model.my_project.abv_ibu: Close
[0m12:15:45.263217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd77a957-6461-4368-a32b-0af8db8c3d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dafda4d23f0>]}
[0m12:15:45.264182 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_dev.abv_ibu .............................. [[32mSELECT 409[0m in 0.16s]
[0m12:15:45.265463 [debug] [Thread-1 (]: Finished running node model.my_project.abv_ibu
[0m12:15:45.268248 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:45.268821 [debug] [MainThread]: On master: BEGIN
[0m12:15:45.269385 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:15:45.282533 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m12:15:45.283346 [debug] [MainThread]: On master: COMMIT
[0m12:15:45.284127 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:45.284583 [debug] [MainThread]: On master: COMMIT
[0m12:15:45.285359 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:15:45.285851 [debug] [MainThread]: On master: Close
[0m12:15:45.286670 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:15:45.287113 [debug] [MainThread]: Connection 'list_db_dev_dev' was properly closed.
[0m12:15:45.287533 [debug] [MainThread]: Connection 'model.my_project.abv_ibu' was properly closed.
[0m12:15:45.288007 [info ] [MainThread]: 
[0m12:15:45.288726 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m12:15:45.292904 [debug] [MainThread]: Command end result
[0m12:15:45.330846 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:15:45.333316 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:15:45.342661 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:15:45.343205 [info ] [MainThread]: 
[0m12:15:45.343939 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:15:45.344653 [info ] [MainThread]: 
[0m12:15:45.345421 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:15:45.347400 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7206266, "process_in_blocks": "0", "process_kernel_time": 0.612073, "process_mem_max_rss": "110976", "process_out_blocks": "4408", "process_user_time": 3.358453}
[0m12:15:45.348144 [debug] [MainThread]: Command `dbt run` succeeded at 12:15:45.347990 after 1.72 seconds
[0m12:15:45.348721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dafd9907f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dafd4a8ffe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dafd57c45f0>]}
[0m12:15:45.349244 [debug] [MainThread]: Flushing usage events
[0m12:15:46.703769 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:20:43.341365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7d57d49730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7d597c02c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7d57c03170>]}


============================== 12:20:43.350531 | 179ec03a-a8ae-4601-99c1-311eb8eeb0ca ==============================
[0m12:20:43.350531 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:20:43.351270 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select food_pairing', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:20:43.625583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '179ec03a-a8ae-4601-99c1-311eb8eeb0ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7d597332c0>]}
[0m12:20:43.702254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '179ec03a-a8ae-4601-99c1-311eb8eeb0ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7d577b7c80>]}
[0m12:20:43.703301 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:20:43.829798 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:20:44.026221 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:20:44.027090 [debug] [MainThread]: Partial parsing: added file: my_project://models/mart/food_pairing.sql
[0m12:20:44.445163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '179ec03a-a8ae-4601-99c1-311eb8eeb0ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7d55f16cf0>]}
[0m12:20:44.586493 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:20:44.590245 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:20:44.650916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '179ec03a-a8ae-4601-99c1-311eb8eeb0ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7d549f19a0>]}
[0m12:20:44.651635 [info ] [MainThread]: Found 10 models, 6 data tests, 5 sources, 429 macros
[0m12:20:44.652220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '179ec03a-a8ae-4601-99c1-311eb8eeb0ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7d55b4aba0>]}
[0m12:20:44.655003 [info ] [MainThread]: 
[0m12:20:44.655608 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:20:44.656208 [info ] [MainThread]: 
[0m12:20:44.657437 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:20:44.659313 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:20:44.765538 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:20:44.987036 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:20:44.988120 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:20:45.012634 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.024 seconds
[0m12:20:45.015454 [debug] [ThreadPool]: On list_db: Close
[0m12:20:45.034260 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:20:45.037405 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_dev_dev'
[0m12:20:45.057897 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:20:45.061902 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m12:20:45.062580 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:20:45.063334 [debug] [ThreadPool]: On list_db_dev_dev: BEGIN
[0m12:20:45.063938 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:20:45.064550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:20:45.077012 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m12:20:45.078019 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:20:45.078883 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:20:45.081477 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m12:20:45.082341 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m12:20:45.083097 [debug] [ThreadPool]: On list_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_dev'
  
[0m12:20:45.095654 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.016 seconds
[0m12:20:45.098091 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:20:45.098925 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.015 seconds
[0m12:20:45.099381 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:20:45.101174 [debug] [ThreadPool]: On list_db_dev_dev: ROLLBACK
[0m12:20:45.104572 [debug] [ThreadPool]: On list_db_dev_dev: Close
[0m12:20:45.116179 [debug] [MainThread]: Using postgres connection "master"
[0m12:20:45.116755 [debug] [MainThread]: On master: BEGIN
[0m12:20:45.117205 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:20:45.129386 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m12:20:45.130258 [debug] [MainThread]: Using postgres connection "master"
[0m12:20:45.130878 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:20:45.146890 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m12:20:45.149180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '179ec03a-a8ae-4601-99c1-311eb8eeb0ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7d5442f1a0>]}
[0m12:20:45.149887 [debug] [MainThread]: On master: ROLLBACK
[0m12:20:45.150714 [debug] [MainThread]: Using postgres connection "master"
[0m12:20:45.151184 [debug] [MainThread]: On master: BEGIN
[0m12:20:45.152254 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:20:45.152841 [debug] [MainThread]: On master: COMMIT
[0m12:20:45.153501 [debug] [MainThread]: Using postgres connection "master"
[0m12:20:45.154117 [debug] [MainThread]: On master: COMMIT
[0m12:20:45.154900 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:20:45.155377 [debug] [MainThread]: On master: Close
[0m12:20:45.160925 [debug] [Thread-1 (]: Began running node model.my_project.food_pairing
[0m12:20:45.162283 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_dev.food_pairing .............................. [RUN]
[0m12:20:45.163393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev_dev, now model.my_project.food_pairing)
[0m12:20:45.164246 [debug] [Thread-1 (]: Began compiling node model.my_project.food_pairing
[0m12:20:45.177718 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.food_pairing"
[0m12:20:45.211752 [debug] [Thread-1 (]: Began executing node model.my_project.food_pairing
[0m12:20:45.272711 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.food_pairing"
[0m12:20:45.273738 [debug] [Thread-1 (]: Using postgres connection "model.my_project.food_pairing"
[0m12:20:45.274201 [debug] [Thread-1 (]: On model.my_project.food_pairing: BEGIN
[0m12:20:45.274619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:20:45.285965 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m12:20:45.287055 [debug] [Thread-1 (]: Using postgres connection "model.my_project.food_pairing"
[0m12:20:45.287612 [debug] [Thread-1 (]: On model.my_project.food_pairing: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.food_pairing"} */

  
    

  create  table "db"."dev_dev"."food_pairing__dbt_tmp"
  
  
    as
  
  (
    

select
    pairing,
    count(*) as pairing_count
from "db"."dev"."food_pairings"
where pairing is not null
group by pairing
order by pairing_count desc
  );
  
[0m12:20:45.297346 [debug] [Thread-1 (]: SQL status: SELECT 1149 in 0.009 seconds
[0m12:20:45.306072 [debug] [Thread-1 (]: Using postgres connection "model.my_project.food_pairing"
[0m12:20:45.306605 [debug] [Thread-1 (]: On model.my_project.food_pairing: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.food_pairing"} */
alter table "db"."dev_dev"."food_pairing__dbt_tmp" rename to "food_pairing"
[0m12:20:45.307684 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:20:45.331895 [debug] [Thread-1 (]: On model.my_project.food_pairing: COMMIT
[0m12:20:45.332538 [debug] [Thread-1 (]: Using postgres connection "model.my_project.food_pairing"
[0m12:20:45.333092 [debug] [Thread-1 (]: On model.my_project.food_pairing: COMMIT
[0m12:20:46.724802 [debug] [Thread-1 (]: SQL status: COMMIT in 1.391 seconds
[0m12:20:46.752399 [debug] [Thread-1 (]: Applying DROP to: "db"."dev_dev"."food_pairing__dbt_backup"
[0m12:20:46.764001 [debug] [Thread-1 (]: Using postgres connection "model.my_project.food_pairing"
[0m12:20:46.764835 [debug] [Thread-1 (]: On model.my_project.food_pairing: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.food_pairing"} */
drop table if exists "db"."dev_dev"."food_pairing__dbt_backup" cascade
[0m12:20:46.766251 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m12:20:46.770655 [debug] [Thread-1 (]: On model.my_project.food_pairing: Close
[0m12:20:46.773703 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '179ec03a-a8ae-4601-99c1-311eb8eeb0ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7d58335f70>]}
[0m12:20:46.775037 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_dev.food_pairing ......................... [[32mSELECT 1149[0m in 1.61s]
[0m12:20:46.776125 [debug] [Thread-1 (]: Finished running node model.my_project.food_pairing
[0m12:20:46.779340 [debug] [MainThread]: Using postgres connection "master"
[0m12:20:46.779871 [debug] [MainThread]: On master: BEGIN
[0m12:20:46.780316 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:20:46.797961 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m12:20:46.798957 [debug] [MainThread]: On master: COMMIT
[0m12:20:46.799467 [debug] [MainThread]: Using postgres connection "master"
[0m12:20:46.800259 [debug] [MainThread]: On master: COMMIT
[0m12:20:46.801239 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:20:46.801863 [debug] [MainThread]: On master: Close
[0m12:20:46.802851 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:20:46.803762 [debug] [MainThread]: Connection 'list_db_dev' was properly closed.
[0m12:20:46.804262 [debug] [MainThread]: Connection 'model.my_project.food_pairing' was properly closed.
[0m12:20:46.805176 [info ] [MainThread]: 
[0m12:20:46.805986 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.15 seconds (2.15s).
[0m12:20:46.808066 [debug] [MainThread]: Command end result
[0m12:20:46.847704 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:20:46.850263 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:20:46.859146 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:20:46.859699 [info ] [MainThread]: 
[0m12:20:46.861495 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:20:46.862745 [info ] [MainThread]: 
[0m12:20:46.864057 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:20:46.866251 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.599119, "process_in_blocks": "4272", "process_kernel_time": 0.702575, "process_mem_max_rss": "111260", "process_out_blocks": "4416", "process_user_time": 3.516845}
[0m12:20:46.867205 [debug] [MainThread]: Command `dbt run` succeeded at 12:20:46.867003 after 3.60 seconds
[0m12:20:46.867802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7d57aa6930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7d57a71160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7d57a71070>]}
[0m12:20:46.868432 [debug] [MainThread]: Flushing usage events
[0m12:20:48.323988 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:43:36.576451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799751b52f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7997517eb3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799751b50b60>]}


============================== 12:43:36.600674 | 9c87f54e-dc42-4efc-8c3c-a96952db7b2f ==============================
[0m12:43:36.600674 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:43:36.601777 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:43:37.039938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c87f54e-dc42-4efc-8c3c-a96952db7b2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799751557020>]}
[0m12:43:37.153048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c87f54e-dc42-4efc-8c3c-a96952db7b2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799751532630>]}
[0m12:43:37.155081 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:43:37.611822 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:43:37.912455 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:43:37.913045 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:43:38.039820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c87f54e-dc42-4efc-8c3c-a96952db7b2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79974fd03e30>]}
[0m12:43:38.283783 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:43:38.293602 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:43:38.370692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c87f54e-dc42-4efc-8c3c-a96952db7b2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79974fa66420>]}
[0m12:43:38.371470 [info ] [MainThread]: Found 10 models, 6 data tests, 5 sources, 429 macros
[0m12:43:38.372101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c87f54e-dc42-4efc-8c3c-a96952db7b2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799751583b30>]}
[0m12:43:38.375461 [info ] [MainThread]: 
[0m12:43:38.376272 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:43:38.377119 [info ] [MainThread]: 
[0m12:43:38.378508 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:43:38.385535 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:43:38.386750 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:43:38.650562 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:43:38.651226 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:43:38.651813 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:43:38.652582 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:43:38.653181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:38.653893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:38.678956 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.026 seconds
[0m12:43:38.681192 [debug] [ThreadPool]: On list_db: Close
[0m12:43:38.681722 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.028 seconds
[0m12:43:38.685433 [debug] [ThreadPool]: On list_db: Close
[0m12:43:38.691847 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev_dev)
[0m12:43:38.692894 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:43:38.701038 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m12:43:38.703605 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:43:38.704455 [debug] [ThreadPool]: On list_db_dev_dev: BEGIN
[0m12:43:38.705289 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:43:38.706120 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:38.706809 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:38.727696 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m12:43:38.728489 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:43:38.729497 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:43:38.730063 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m12:43:38.731032 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m12:43:38.731600 [debug] [ThreadPool]: On list_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_dev'
  
[0m12:43:38.745653 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.015 seconds
[0m12:43:38.747834 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:43:38.748340 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.016 seconds
[0m12:43:38.750469 [debug] [ThreadPool]: On list_db_dev_dev: ROLLBACK
[0m12:43:38.751305 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:43:38.753141 [debug] [ThreadPool]: On list_db_dev_dev: Close
[0m12:43:38.769738 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:38.770329 [debug] [MainThread]: On master: BEGIN
[0m12:43:38.770760 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:43:38.785807 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m12:43:38.786756 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:38.787636 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:43:38.802138 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m12:43:38.804307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c87f54e-dc42-4efc-8c3c-a96952db7b2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79974fcb3e30>]}
[0m12:43:38.805108 [debug] [MainThread]: On master: ROLLBACK
[0m12:43:38.806046 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:38.806541 [debug] [MainThread]: On master: BEGIN
[0m12:43:38.807771 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:43:38.808453 [debug] [MainThread]: On master: COMMIT
[0m12:43:38.809110 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:38.809536 [debug] [MainThread]: On master: COMMIT
[0m12:43:38.810262 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:43:38.810738 [debug] [MainThread]: On master: Close
[0m12:43:38.818001 [debug] [Thread-1 (]: Began running node model.my_project.beer_types
[0m12:43:38.818657 [debug] [Thread-2 (]: Began running node model.my_project.food_pairing
[0m12:43:38.819502 [debug] [Thread-3 (]: Began running node model.my_project.staging
[0m12:43:38.820481 [info ] [Thread-1 (]: 1 of 10 START sql table model dev_dev.beer_types ............................... [RUN]
[0m12:43:38.821565 [debug] [Thread-4 (]: Began running node model.my_project.top_hops
[0m12:43:38.822540 [info ] [Thread-2 (]: 2 of 10 START sql table model dev_dev.food_pairing ............................. [RUN]
[0m12:43:38.823625 [info ] [Thread-3 (]: 3 of 10 START sql table model dev.staging ...................................... [RUN]
[0m12:43:38.824550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev_dev, now model.my_project.beer_types)
[0m12:43:38.825592 [info ] [Thread-4 (]: 4 of 10 START sql table model dev_dev.top_hops ................................. [RUN]
[0m12:43:38.826600 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.food_pairing)
[0m12:43:38.827795 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.staging'
[0m12:43:38.828639 [debug] [Thread-1 (]: Began compiling node model.my_project.beer_types
[0m12:43:38.829544 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.top_hops'
[0m12:43:38.830398 [debug] [Thread-2 (]: Began compiling node model.my_project.food_pairing
[0m12:43:38.831260 [debug] [Thread-3 (]: Began compiling node model.my_project.staging
[0m12:43:38.843878 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.beer_types"
[0m12:43:38.844640 [debug] [Thread-4 (]: Began compiling node model.my_project.top_hops
[0m12:43:38.848873 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_project.food_pairing"
[0m12:43:38.854211 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.staging"
[0m12:43:38.859328 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.top_hops"
[0m12:43:38.860767 [debug] [Thread-1 (]: Began executing node model.my_project.beer_types
[0m12:43:38.861982 [debug] [Thread-2 (]: Began executing node model.my_project.food_pairing
[0m12:43:38.886768 [debug] [Thread-4 (]: Began executing node model.my_project.top_hops
[0m12:43:38.914131 [debug] [Thread-3 (]: Began executing node model.my_project.staging
[0m12:43:38.970576 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.beer_types"
[0m12:43:38.978121 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.top_hops"
[0m12:43:38.979486 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_project.food_pairing"
[0m12:43:38.984141 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.staging"
[0m12:43:38.985768 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_hops"
[0m12:43:38.986494 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m12:43:38.987818 [debug] [Thread-4 (]: On model.my_project.top_hops: BEGIN
[0m12:43:38.988576 [debug] [Thread-2 (]: Using postgres connection "model.my_project.food_pairing"
[0m12:43:38.989368 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m12:43:38.989955 [debug] [Thread-1 (]: On model.my_project.beer_types: BEGIN
[0m12:43:38.990566 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:43:38.991199 [debug] [Thread-2 (]: On model.my_project.food_pairing: BEGIN
[0m12:43:38.991853 [debug] [Thread-3 (]: On model.my_project.staging: BEGIN
[0m12:43:38.992466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:38.993352 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:43:38.994032 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:43:39.011191 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m12:43:39.012261 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m12:43:39.012969 [debug] [Thread-1 (]: On model.my_project.beer_types: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_types"} */

  
    

  create  table "db"."dev_dev"."beer_types__dbt_tmp"
  
  
    as
  
  (
    

select
    beer_id,
    name,
    tagline,
    first_brewed,
    abv,
    ibu,
    ebc,
    ph,
    case
        when lower(tagline) like '%lager%' then 'Lager'
        when lower(tagline) like '%pilsner%' then 'Lager'
        when lower(tagline) like '%ipa%' then 'Ale'
        when lower(tagline) like '%stout%' then 'Ale'
        when lower(tagline) like '%porter%' then 'Ale'
        when lower(tagline) like '%ale%' then 'Ale'
        when lower(tagline) like '%wheat%' then 'Ale'
        else 'Other'
    end as type
from "db"."dev"."raw_beer_data"
  );
  
[0m12:43:39.014558 [debug] [Thread-3 (]: SQL status: BEGIN in 0.020 seconds
[0m12:43:39.015488 [debug] [Thread-4 (]: SQL status: BEGIN in 0.025 seconds
[0m12:43:39.016619 [debug] [Thread-2 (]: SQL status: BEGIN in 0.023 seconds
[0m12:43:39.017408 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m12:43:39.018100 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_hops"
[0m12:43:39.018909 [debug] [Thread-2 (]: Using postgres connection "model.my_project.food_pairing"
[0m12:43:39.020034 [debug] [Thread-3 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * 
    from "db"."dev"."raw_beer_data"
)

select 
    id,
    beer_id,
    name as beer_name,
    tagline,
    first_brewed,
    description,
    image,
    abv,
    ibu,
    ebc,
    ph,
    brewers_tips,
    contributed_by,
    inserted_at
from source
  );
  
[0m12:43:39.021201 [debug] [Thread-4 (]: On model.my_project.top_hops: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_hops"} */

  
    

  create  table "db"."dev_dev"."top_hops__dbt_tmp"
  
  
    as
  
  (
    

select
    hop_name,
    count(distinct beer_id) as beers_with_hop
from "db"."dev"."hop_ingredients"
where hop_name is not null
group by hop_name
order by beers_with_hop desc
  );
  
[0m12:43:39.022634 [debug] [Thread-2 (]: On model.my_project.food_pairing: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.food_pairing"} */

  
    

  create  table "db"."dev_dev"."food_pairing__dbt_tmp"
  
  
    as
  
  (
    

select
    pairing,
    count(*) as pairing_count
from "db"."dev"."food_pairings"
where pairing is not null
group by pairing
order by pairing_count desc
  );
  
[0m12:43:39.034597 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.020 seconds
[0m12:43:39.052246 [debug] [Thread-3 (]: SQL status: SELECT 414 in 0.028 seconds
[0m12:43:39.064470 [debug] [Thread-2 (]: SQL status: SELECT 1149 in 0.040 seconds
[0m12:43:39.065848 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m12:43:39.067935 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m12:43:39.069370 [debug] [Thread-4 (]: SQL status: SELECT 178 in 0.045 seconds
[0m12:43:39.080000 [debug] [Thread-1 (]: On model.my_project.beer_types: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_types"} */
alter table "db"."dev_dev"."beer_types" rename to "beer_types__dbt_backup"
[0m12:43:39.078028 [debug] [Thread-2 (]: Using postgres connection "model.my_project.food_pairing"
[0m12:43:39.091405 [debug] [Thread-2 (]: On model.my_project.food_pairing: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.food_pairing"} */
alter table "db"."dev_dev"."food_pairing" rename to "food_pairing__dbt_backup"
[0m12:43:39.089709 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_hops"
[0m12:43:39.081583 [debug] [Thread-3 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m12:43:39.093637 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:43:39.094619 [debug] [Thread-4 (]: On model.my_project.top_hops: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_hops"} */
alter table "db"."dev_dev"."top_hops" rename to "top_hops__dbt_backup"
[0m12:43:39.106349 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m12:43:39.102596 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m12:43:39.095541 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:43:39.107691 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:43:39.109384 [debug] [Thread-1 (]: On model.my_project.beer_types: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_types"} */
alter table "db"."dev_dev"."beer_types__dbt_tmp" rename to "beer_types"
[0m12:43:39.122426 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m12:43:39.131426 [debug] [Thread-2 (]: Using postgres connection "model.my_project.food_pairing"
[0m12:43:39.140227 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_hops"
[0m12:43:39.145388 [debug] [Thread-4 (]: On model.my_project.top_hops: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_hops"} */
alter table "db"."dev_dev"."top_hops__dbt_tmp" rename to "top_hops"
[0m12:43:39.143460 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:43:39.142180 [debug] [Thread-3 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m12:43:39.144298 [debug] [Thread-2 (]: On model.my_project.food_pairing: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.food_pairing"} */
alter table "db"."dev_dev"."food_pairing__dbt_tmp" rename to "food_pairing"
[0m12:43:39.158630 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m12:43:39.164818 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m12:43:39.186420 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m12:43:39.230147 [debug] [Thread-1 (]: On model.my_project.beer_types: COMMIT
[0m12:43:39.230825 [debug] [Thread-4 (]: On model.my_project.top_hops: COMMIT
[0m12:43:39.233100 [debug] [Thread-2 (]: On model.my_project.food_pairing: COMMIT
[0m12:43:39.235290 [debug] [Thread-3 (]: On model.my_project.staging: COMMIT
[0m12:43:39.235903 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m12:43:39.236451 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_hops"
[0m12:43:39.237009 [debug] [Thread-2 (]: Using postgres connection "model.my_project.food_pairing"
[0m12:43:39.237594 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m12:43:39.238259 [debug] [Thread-1 (]: On model.my_project.beer_types: COMMIT
[0m12:43:39.238924 [debug] [Thread-4 (]: On model.my_project.top_hops: COMMIT
[0m12:43:39.239551 [debug] [Thread-2 (]: On model.my_project.food_pairing: COMMIT
[0m12:43:39.240472 [debug] [Thread-3 (]: On model.my_project.staging: COMMIT
[0m12:43:39.245610 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m12:43:39.254509 [debug] [Thread-4 (]: SQL status: COMMIT in 0.013 seconds
[0m12:43:39.257714 [debug] [Thread-1 (]: Applying DROP to: "db"."dev_dev"."beer_types__dbt_backup"
[0m12:43:39.258355 [debug] [Thread-3 (]: SQL status: COMMIT in 0.017 seconds
[0m12:43:39.259079 [debug] [Thread-2 (]: SQL status: COMMIT in 0.018 seconds
[0m12:43:39.262140 [debug] [Thread-4 (]: Applying DROP to: "db"."dev_dev"."top_hops__dbt_backup"
[0m12:43:39.270936 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m12:43:39.276313 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m12:43:39.279378 [debug] [Thread-2 (]: Applying DROP to: "db"."dev_dev"."food_pairing__dbt_backup"
[0m12:43:39.280407 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_hops"
[0m12:43:39.281021 [debug] [Thread-1 (]: On model.my_project.beer_types: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_types"} */
drop table if exists "db"."dev_dev"."beer_types__dbt_backup" cascade
[0m12:43:39.281912 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m12:43:39.282910 [debug] [Thread-2 (]: Using postgres connection "model.my_project.food_pairing"
[0m12:43:39.283573 [debug] [Thread-4 (]: On model.my_project.top_hops: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_hops"} */
drop table if exists "db"."dev_dev"."top_hops__dbt_backup" cascade
[0m12:43:39.284596 [debug] [Thread-3 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m12:43:39.285472 [debug] [Thread-2 (]: On model.my_project.food_pairing: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.food_pairing"} */
drop table if exists "db"."dev_dev"."food_pairing__dbt_backup" cascade
[0m12:43:39.291985 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m12:43:39.295543 [debug] [Thread-1 (]: On model.my_project.beer_types: Close
[0m12:43:39.296691 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.011 seconds
[0m12:43:39.297237 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.011 seconds
[0m12:43:39.297825 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.011 seconds
[0m12:43:39.301615 [debug] [Thread-4 (]: On model.my_project.top_hops: Close
[0m12:43:39.307828 [debug] [Thread-3 (]: On model.my_project.staging: Close
[0m12:43:39.310590 [debug] [Thread-2 (]: On model.my_project.food_pairing: Close
[0m12:43:39.311184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c87f54e-dc42-4efc-8c3c-a96952db7b2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79975208a180>]}
[0m12:43:39.312363 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c87f54e-dc42-4efc-8c3c-a96952db7b2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79974e2cbf80>]}
[0m12:43:39.313123 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c87f54e-dc42-4efc-8c3c-a96952db7b2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79974e331b50>]}
[0m12:43:39.313946 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c87f54e-dc42-4efc-8c3c-a96952db7b2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79974e333800>]}
[0m12:43:39.314963 [info ] [Thread-1 (]: 1 of 10 OK created sql table model dev_dev.beer_types .......................... [[32mSELECT 414[0m in 0.48s]
[0m12:43:39.316348 [info ] [Thread-4 (]: 4 of 10 OK created sql table model dev_dev.top_hops ............................ [[32mSELECT 178[0m in 0.48s]
[0m12:43:39.317676 [info ] [Thread-3 (]: 3 of 10 OK created sql table model dev.staging ................................. [[32mSELECT 414[0m in 0.49s]
[0m12:43:39.319080 [info ] [Thread-2 (]: 2 of 10 OK created sql table model dev_dev.food_pairing ........................ [[32mSELECT 1149[0m in 0.49s]
[0m12:43:39.320629 [debug] [Thread-1 (]: Finished running node model.my_project.beer_types
[0m12:43:39.321551 [debug] [Thread-4 (]: Finished running node model.my_project.top_hops
[0m12:43:39.322719 [debug] [Thread-3 (]: Finished running node model.my_project.staging
[0m12:43:39.323922 [debug] [Thread-2 (]: Finished running node model.my_project.food_pairing
[0m12:43:39.324845 [debug] [Thread-1 (]: Began running node model.my_project.top_malts
[0m12:43:39.326156 [debug] [Thread-4 (]: Began running node model.my_project.abv_ibu
[0m12:43:39.327032 [debug] [Thread-3 (]: Began running node model.my_project.beer_released
[0m12:43:39.327907 [debug] [Thread-2 (]: Began running node model.my_project.type_by_year
[0m12:43:39.329133 [info ] [Thread-1 (]: 5 of 10 START sql table model dev_dev.top_malts ................................ [RUN]
[0m12:43:39.330062 [info ] [Thread-4 (]: 6 of 10 START sql table model dev_dev.abv_ibu .................................. [RUN]
[0m12:43:39.331081 [info ] [Thread-3 (]: 7 of 10 START sql table model dev_dev.beer_released ............................ [RUN]
[0m12:43:39.332037 [info ] [Thread-2 (]: 8 of 10 START sql table model dev_dev.type_by_year ............................. [RUN]
[0m12:43:39.332939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.beer_types, now model.my_project.top_malts)
[0m12:43:39.333642 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_project.top_hops, now model.my_project.abv_ibu)
[0m12:43:39.334432 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_project.staging, now model.my_project.beer_released)
[0m12:43:39.335120 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_project.food_pairing, now model.my_project.type_by_year)
[0m12:43:39.335829 [debug] [Thread-1 (]: Began compiling node model.my_project.top_malts
[0m12:43:39.336540 [debug] [Thread-4 (]: Began compiling node model.my_project.abv_ibu
[0m12:43:39.337093 [debug] [Thread-3 (]: Began compiling node model.my_project.beer_released
[0m12:43:39.337747 [debug] [Thread-2 (]: Began compiling node model.my_project.type_by_year
[0m12:43:39.342306 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.top_malts"
[0m12:43:39.346156 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.abv_ibu"
[0m12:43:39.349959 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.beer_released"
[0m12:43:39.353712 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_project.type_by_year"
[0m12:43:39.356226 [debug] [Thread-3 (]: Began executing node model.my_project.beer_released
[0m12:43:39.357526 [debug] [Thread-4 (]: Began executing node model.my_project.abv_ibu
[0m12:43:39.358697 [debug] [Thread-1 (]: Began executing node model.my_project.top_malts
[0m12:43:39.363423 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.beer_released"
[0m12:43:39.364071 [debug] [Thread-2 (]: Began executing node model.my_project.type_by_year
[0m12:43:39.368440 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.abv_ibu"
[0m12:43:39.372790 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.top_malts"
[0m12:43:39.378056 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_project.type_by_year"
[0m12:43:39.379393 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_released"
[0m12:43:39.380551 [debug] [Thread-4 (]: Using postgres connection "model.my_project.abv_ibu"
[0m12:43:39.381281 [debug] [Thread-1 (]: Using postgres connection "model.my_project.top_malts"
[0m12:43:39.382138 [debug] [Thread-3 (]: On model.my_project.beer_released: BEGIN
[0m12:43:39.382899 [debug] [Thread-4 (]: On model.my_project.abv_ibu: BEGIN
[0m12:43:39.383773 [debug] [Thread-2 (]: Using postgres connection "model.my_project.type_by_year"
[0m12:43:39.384449 [debug] [Thread-1 (]: On model.my_project.top_malts: BEGIN
[0m12:43:39.385092 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:43:39.385724 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:43:39.386399 [debug] [Thread-2 (]: On model.my_project.type_by_year: BEGIN
[0m12:43:39.387006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:39.388427 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:43:39.402801 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m12:43:39.404140 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m12:43:39.405181 [debug] [Thread-4 (]: SQL status: BEGIN in 0.019 seconds
[0m12:43:39.406104 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_released"
[0m12:43:39.407056 [debug] [Thread-2 (]: Using postgres connection "model.my_project.type_by_year"
[0m12:43:39.408294 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m12:43:39.409013 [debug] [Thread-4 (]: Using postgres connection "model.my_project.abv_ibu"
[0m12:43:39.409791 [debug] [Thread-3 (]: On model.my_project.beer_released: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_released"} */

  
    

  create  table "db"."dev_dev"."beer_released__dbt_tmp"
  
  
    as
  
  (
    

select
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4) as year,
    count(*) as beer_count
from "db"."dev_dev"."beer_types"
where
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4) ~ '^\d{4}$'
group by year
order by year
  );
  
[0m12:43:39.410597 [debug] [Thread-2 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */

  
    

  create  table "db"."dev_dev"."type_by_year__dbt_tmp"
  
  
    as
  
  (
    

select
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4) as year,
    type,
    count(*) as beer_count
from "db"."dev_dev"."beer_types"
where
    -- Only keep non-null, non-empty years and ensure first 4 chars are digits
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4) ~ '^\d{4}$'
group by
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4),
    type
order by
    year,
    type
  );
  
[0m12:43:39.411307 [debug] [Thread-1 (]: Using postgres connection "model.my_project.top_malts"
[0m12:43:39.412262 [debug] [Thread-4 (]: On model.my_project.abv_ibu: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.abv_ibu"} */

  
    

  create  table "db"."dev_dev"."abv_ibu__dbt_tmp"
  
  
    as
  
  (
    

select
    abv,
    ibu,
    type
from "db"."dev_dev"."beer_types"
where abv is not null and ibu is not null
  );
  
[0m12:43:39.413643 [debug] [Thread-1 (]: On model.my_project.top_malts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_malts"} */

  
    

  create  table "db"."dev_dev"."top_malts__dbt_tmp"
  
  
    as
  
  (
    

select
    malt_name,
    count(distinct beer_id) as beers_with_malt
from "db"."dev"."malt_ingredients"
where malt_name is not null
group by malt_name
order by beers_with_malt desc
  );
  
[0m12:43:39.419827 [debug] [Thread-4 (]: SQL status: SELECT 409 in 0.005 seconds
[0m12:43:39.420674 [debug] [Thread-3 (]: SQL status: SELECT 5 in 0.008 seconds
[0m12:43:39.421320 [debug] [Thread-2 (]: SQL status: SELECT 12 in 0.008 seconds
[0m12:43:39.427194 [debug] [Thread-4 (]: Using postgres connection "model.my_project.abv_ibu"
[0m12:43:39.433637 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_released"
[0m12:43:39.434252 [debug] [Thread-1 (]: SQL status: SELECT 133 in 0.019 seconds
[0m12:43:39.437925 [debug] [Thread-2 (]: Using postgres connection "model.my_project.type_by_year"
[0m12:43:39.438885 [debug] [Thread-4 (]: On model.my_project.abv_ibu: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.abv_ibu"} */
alter table "db"."dev_dev"."abv_ibu" rename to "abv_ibu__dbt_backup"
[0m12:43:39.440099 [debug] [Thread-3 (]: On model.my_project.beer_released: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_released"} */
alter table "db"."dev_dev"."beer_released" rename to "beer_released__dbt_backup"
[0m12:43:39.444819 [debug] [Thread-1 (]: Using postgres connection "model.my_project.top_malts"
[0m12:43:39.445734 [debug] [Thread-2 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */
alter table "db"."dev_dev"."type_by_year" rename to "type_by_year__dbt_backup"
[0m12:43:39.446874 [debug] [Thread-1 (]: On model.my_project.top_malts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_malts"} */
alter table "db"."dev_dev"."top_malts" rename to "top_malts__dbt_backup"
[0m12:43:39.447845 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:39.448560 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:43:39.452737 [debug] [Thread-4 (]: Using postgres connection "model.my_project.abv_ibu"
[0m12:43:39.453627 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:43:39.454194 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m12:43:39.458969 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_released"
[0m12:43:39.459770 [debug] [Thread-4 (]: On model.my_project.abv_ibu: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.abv_ibu"} */
alter table "db"."dev_dev"."abv_ibu__dbt_tmp" rename to "abv_ibu"
[0m12:43:39.463604 [debug] [Thread-1 (]: Using postgres connection "model.my_project.top_malts"
[0m12:43:39.467318 [debug] [Thread-2 (]: Using postgres connection "model.my_project.type_by_year"
[0m12:43:39.467975 [debug] [Thread-3 (]: On model.my_project.beer_released: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_released"} */
alter table "db"."dev_dev"."beer_released__dbt_tmp" rename to "beer_released"
[0m12:43:39.469123 [debug] [Thread-1 (]: On model.my_project.top_malts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_malts"} */
alter table "db"."dev_dev"."top_malts__dbt_tmp" rename to "top_malts"
[0m12:43:39.469894 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:39.470536 [debug] [Thread-2 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */
alter table "db"."dev_dev"."type_by_year__dbt_tmp" rename to "type_by_year"
[0m12:43:39.474015 [debug] [Thread-4 (]: On model.my_project.abv_ibu: COMMIT
[0m12:43:39.475042 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:43:39.475815 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:43:39.476601 [debug] [Thread-4 (]: Using postgres connection "model.my_project.abv_ibu"
[0m12:43:39.477244 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:39.479619 [debug] [Thread-3 (]: On model.my_project.beer_released: COMMIT
[0m12:43:39.481846 [debug] [Thread-1 (]: On model.my_project.top_malts: COMMIT
[0m12:43:39.482482 [debug] [Thread-4 (]: On model.my_project.abv_ibu: COMMIT
[0m12:43:39.485555 [debug] [Thread-2 (]: On model.my_project.type_by_year: COMMIT
[0m12:43:39.486447 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_released"
[0m12:43:39.487099 [debug] [Thread-1 (]: Using postgres connection "model.my_project.top_malts"
[0m12:43:39.488038 [debug] [Thread-2 (]: Using postgres connection "model.my_project.type_by_year"
[0m12:43:39.488923 [debug] [Thread-3 (]: On model.my_project.beer_released: COMMIT
[0m12:43:39.489878 [debug] [Thread-1 (]: On model.my_project.top_malts: COMMIT
[0m12:43:39.490637 [debug] [Thread-2 (]: On model.my_project.type_by_year: COMMIT
[0m12:43:39.493377 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m12:43:39.496955 [debug] [Thread-4 (]: Applying DROP to: "db"."dev_dev"."abv_ibu__dbt_backup"
[0m12:43:39.497612 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m12:43:39.498503 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m12:43:39.499549 [debug] [Thread-4 (]: Using postgres connection "model.my_project.abv_ibu"
[0m12:43:39.500211 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m12:43:39.503445 [debug] [Thread-3 (]: Applying DROP to: "db"."dev_dev"."beer_released__dbt_backup"
[0m12:43:39.507417 [debug] [Thread-1 (]: Applying DROP to: "db"."dev_dev"."top_malts__dbt_backup"
[0m12:43:39.508589 [debug] [Thread-4 (]: On model.my_project.abv_ibu: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.abv_ibu"} */
drop table if exists "db"."dev_dev"."abv_ibu__dbt_backup" cascade
[0m12:43:39.512105 [debug] [Thread-2 (]: Applying DROP to: "db"."dev_dev"."type_by_year__dbt_backup"
[0m12:43:39.513195 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_released"
[0m12:43:39.514141 [debug] [Thread-1 (]: Using postgres connection "model.my_project.top_malts"
[0m12:43:39.515310 [debug] [Thread-2 (]: Using postgres connection "model.my_project.type_by_year"
[0m12:43:39.516062 [debug] [Thread-3 (]: On model.my_project.beer_released: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_released"} */
drop table if exists "db"."dev_dev"."beer_released__dbt_backup" cascade
[0m12:43:39.516749 [debug] [Thread-1 (]: On model.my_project.top_malts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_malts"} */
drop table if exists "db"."dev_dev"."top_malts__dbt_backup" cascade
[0m12:43:39.517463 [debug] [Thread-2 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */
drop table if exists "db"."dev_dev"."type_by_year__dbt_backup" cascade
[0m12:43:39.520865 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m12:43:39.523132 [debug] [Thread-4 (]: On model.my_project.abv_ibu: Close
[0m12:43:39.524142 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c87f54e-dc42-4efc-8c3c-a96952db7b2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79974e3f1070>]}
[0m12:43:39.525669 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m12:43:39.525043 [info ] [Thread-4 (]: 6 of 10 OK created sql table model dev_dev.abv_ibu ............................. [[32mSELECT 409[0m in 0.19s]
[0m12:43:39.526688 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.008 seconds
[0m12:43:39.527477 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.009 seconds
[0m12:43:39.529472 [debug] [Thread-1 (]: On model.my_project.top_malts: Close
[0m12:43:39.530376 [debug] [Thread-4 (]: Finished running node model.my_project.abv_ibu
[0m12:43:39.532533 [debug] [Thread-3 (]: On model.my_project.beer_released: Close
[0m12:43:39.534458 [debug] [Thread-2 (]: On model.my_project.type_by_year: Close
[0m12:43:39.535403 [debug] [Thread-4 (]: Began running node model.my_project.beer_report
[0m12:43:39.536189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c87f54e-dc42-4efc-8c3c-a96952db7b2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79974c1a83b0>]}
[0m12:43:39.537345 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c87f54e-dc42-4efc-8c3c-a96952db7b2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79974f87d8b0>]}
[0m12:43:39.538313 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c87f54e-dc42-4efc-8c3c-a96952db7b2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79974c1a92e0>]}
[0m12:43:39.539329 [info ] [Thread-4 (]: 9 of 10 START sql table model dev.beer_report .................................. [RUN]
[0m12:43:39.540792 [info ] [Thread-1 (]: 5 of 10 OK created sql table model dev_dev.top_malts ........................... [[32mSELECT 133[0m in 0.20s]
[0m12:43:39.542262 [info ] [Thread-3 (]: 7 of 10 OK created sql table model dev_dev.beer_released ....................... [[32mSELECT 5[0m in 0.20s]
[0m12:43:39.543463 [info ] [Thread-2 (]: 8 of 10 OK created sql table model dev_dev.type_by_year ........................ [[32mSELECT 12[0m in 0.20s]
[0m12:43:39.544541 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_project.abv_ibu, now model.my_project.beer_report)
[0m12:43:39.545472 [debug] [Thread-1 (]: Finished running node model.my_project.top_malts
[0m12:43:39.546347 [debug] [Thread-3 (]: Finished running node model.my_project.beer_released
[0m12:43:39.547351 [debug] [Thread-2 (]: Finished running node model.my_project.type_by_year
[0m12:43:39.548069 [debug] [Thread-4 (]: Began compiling node model.my_project.beer_report
[0m12:43:39.548829 [debug] [Thread-1 (]: Began running node model.my_project.master_beer_table
[0m12:43:39.553710 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.beer_report"
[0m12:43:39.554555 [info ] [Thread-1 (]: 10 of 10 START sql table model dev.master_beer_table ........................... [RUN]
[0m12:43:39.556072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.top_malts, now model.my_project.master_beer_table)
[0m12:43:39.556754 [debug] [Thread-1 (]: Began compiling node model.my_project.master_beer_table
[0m12:43:39.560311 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.master_beer_table"
[0m12:43:39.561183 [debug] [Thread-4 (]: Began executing node model.my_project.beer_report
[0m12:43:39.567871 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.beer_report"
[0m12:43:39.568474 [debug] [Thread-1 (]: Began executing node model.my_project.master_beer_table
[0m12:43:39.573332 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.master_beer_table"
[0m12:43:39.574458 [debug] [Thread-4 (]: Using postgres connection "model.my_project.beer_report"
[0m12:43:39.575160 [debug] [Thread-4 (]: On model.my_project.beer_report: BEGIN
[0m12:43:39.575790 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:43:39.576792 [debug] [Thread-1 (]: Using postgres connection "model.my_project.master_beer_table"
[0m12:43:39.578000 [debug] [Thread-1 (]: On model.my_project.master_beer_table: BEGIN
[0m12:43:39.579149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:39.591131 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m12:43:39.592517 [debug] [Thread-4 (]: Using postgres connection "model.my_project.beer_report"
[0m12:43:39.593146 [debug] [Thread-4 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */

  
    

  create  table "db"."dev"."beer_report__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    count(*) as total_beers,
    round(avg(abv)::numeric, 2) as avg_abv,
    round(min(abv)::numeric, 2) as min_abv,
    round(max(abv)::numeric, 2) as max_abv,
    round(avg(ibu)::numeric, 2) as avg_ibu,
    round(min(ibu)::numeric, 2) as min_ibu,
    round(max(ibu)::numeric, 2) as max_ibu,
    round(avg(ebc)::numeric, 2) as avg_ebc,
    round(min(ebc)::numeric, 2) as min_ebc,
    round(max(ebc)::numeric, 2) as max_ebc,
    round(avg(ph)::numeric, 2) as avg_ph,
    min(first_brewed) as oldest_brew,
    max(first_brewed) as newest_brew,
    count(distinct contributed_by) as unique_contributors
from beers
  );
  
[0m12:43:39.594520 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m12:43:39.595208 [debug] [Thread-1 (]: Using postgres connection "model.my_project.master_beer_table"
[0m12:43:39.596135 [debug] [Thread-1 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */

  
    

  create  table "db"."dev"."master_beer_table__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    beer_id,
    beer_name,
    tagline as category,         -- category/style approximation
    description,
    abv as alcohol_percent,
    first_brewed
from beers
  );
  
[0m12:43:39.600307 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m12:43:39.604546 [debug] [Thread-4 (]: Using postgres connection "model.my_project.beer_report"
[0m12:43:39.605211 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.009 seconds
[0m12:43:39.606041 [debug] [Thread-4 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report" rename to "beer_report__dbt_backup"
[0m12:43:39.611169 [debug] [Thread-1 (]: Using postgres connection "model.my_project.master_beer_table"
[0m12:43:39.612123 [debug] [Thread-1 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */
alter table "db"."dev"."master_beer_table" rename to "master_beer_table__dbt_backup"
[0m12:43:39.612690 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:39.616684 [debug] [Thread-4 (]: Using postgres connection "model.my_project.beer_report"
[0m12:43:39.617311 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:43:39.617868 [debug] [Thread-4 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report__dbt_tmp" rename to "beer_report"
[0m12:43:39.621596 [debug] [Thread-1 (]: Using postgres connection "model.my_project.master_beer_table"
[0m12:43:39.622845 [debug] [Thread-1 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */
alter table "db"."dev"."master_beer_table__dbt_tmp" rename to "master_beer_table"
[0m12:43:39.623942 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:43:39.626786 [debug] [Thread-4 (]: On model.my_project.beer_report: COMMIT
[0m12:43:39.627393 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:43:39.628029 [debug] [Thread-4 (]: Using postgres connection "model.my_project.beer_report"
[0m12:43:39.630221 [debug] [Thread-1 (]: On model.my_project.master_beer_table: COMMIT
[0m12:43:39.630855 [debug] [Thread-4 (]: On model.my_project.beer_report: COMMIT
[0m12:43:39.631517 [debug] [Thread-1 (]: Using postgres connection "model.my_project.master_beer_table"
[0m12:43:39.632357 [debug] [Thread-1 (]: On model.my_project.master_beer_table: COMMIT
[0m12:43:39.637443 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m12:43:39.641101 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."beer_report__dbt_backup"
[0m12:43:39.642160 [debug] [Thread-4 (]: Using postgres connection "model.my_project.beer_report"
[0m12:43:39.642720 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m12:43:39.643291 [debug] [Thread-4 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
drop table if exists "db"."dev"."beer_report__dbt_backup" cascade
[0m12:43:39.646390 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."master_beer_table__dbt_backup"
[0m12:43:39.647538 [debug] [Thread-1 (]: Using postgres connection "model.my_project.master_beer_table"
[0m12:43:39.648145 [debug] [Thread-1 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */
drop table if exists "db"."dev"."master_beer_table__dbt_backup" cascade
[0m12:43:39.653373 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m12:43:39.655552 [debug] [Thread-4 (]: On model.my_project.beer_report: Close
[0m12:43:39.657097 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c87f54e-dc42-4efc-8c3c-a96952db7b2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79974e40bb90>]}
[0m12:43:39.658372 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.009 seconds
[0m12:43:39.660125 [info ] [Thread-4 (]: 9 of 10 OK created sql table model dev.beer_report ............................. [[32mSELECT 1[0m in 0.11s]
[0m12:43:39.662743 [debug] [Thread-1 (]: On model.my_project.master_beer_table: Close
[0m12:43:39.663764 [debug] [Thread-4 (]: Finished running node model.my_project.beer_report
[0m12:43:39.664809 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c87f54e-dc42-4efc-8c3c-a96952db7b2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79974e372240>]}
[0m12:43:39.665996 [info ] [Thread-1 (]: 10 of 10 OK created sql table model dev.master_beer_table ...................... [[32mSELECT 414[0m in 0.11s]
[0m12:43:39.667120 [debug] [Thread-1 (]: Finished running node model.my_project.master_beer_table
[0m12:43:39.670200 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:39.670719 [debug] [MainThread]: On master: BEGIN
[0m12:43:39.671264 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:43:39.683951 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m12:43:39.684539 [debug] [MainThread]: On master: COMMIT
[0m12:43:39.685046 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:39.685538 [debug] [MainThread]: On master: COMMIT
[0m12:43:39.686278 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:43:39.686951 [debug] [MainThread]: On master: Close
[0m12:43:39.687991 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:39.688486 [debug] [MainThread]: Connection 'model.my_project.master_beer_table' was properly closed.
[0m12:43:39.688921 [debug] [MainThread]: Connection 'model.my_project.type_by_year' was properly closed.
[0m12:43:39.689427 [debug] [MainThread]: Connection 'model.my_project.beer_released' was properly closed.
[0m12:43:39.690005 [debug] [MainThread]: Connection 'model.my_project.beer_report' was properly closed.
[0m12:43:39.690654 [info ] [MainThread]: 
[0m12:43:39.691691 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 1.31 seconds (1.31s).
[0m12:43:39.696025 [debug] [MainThread]: Command end result
[0m12:43:39.734853 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:43:39.737319 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:43:39.747768 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:43:39.748296 [info ] [MainThread]: 
[0m12:43:39.748907 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:43:39.749684 [info ] [MainThread]: 
[0m12:43:39.750420 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m12:43:39.753175 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.2877097, "process_in_blocks": "5328", "process_kernel_time": 1.569156, "process_mem_max_rss": "109064", "process_out_blocks": "3784", "process_user_time": 5.221157}
[0m12:43:39.754698 [debug] [MainThread]: Command `dbt run` succeeded at 12:43:39.754421 after 3.29 seconds
[0m12:43:39.755803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799751556db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7997515c4200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79974c20e8d0>]}
[0m12:43:39.757034 [debug] [MainThread]: Flushing usage events
[0m12:43:41.713170 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:49:36.656424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c86c6d6780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c86c80f170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c86bce4d10>]}


============================== 04:49:36.675309 | 6c3e889d-e1b7-4e59-9368-5939206cb66f ==============================
[0m04:49:36.675309 [info ] [MainThread]: Running with dbt=1.9.0
[0m04:49:36.676707 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:49:37.495251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c3e889d-e1b7-4e59-9368-5939206cb66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c86c80f170>]}
[0m04:49:37.659570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c3e889d-e1b7-4e59-9368-5939206cb66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c86c1d5ee0>]}
[0m04:49:37.662487 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m04:49:37.918312 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m04:49:38.540065 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:49:38.540839 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:49:38.667133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c3e889d-e1b7-4e59-9368-5939206cb66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c86a230cb0>]}
[0m04:49:38.889343 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m04:49:38.896077 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m04:49:38.964358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c3e889d-e1b7-4e59-9368-5939206cb66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c86a05b890>]}
[0m04:49:38.965485 [info ] [MainThread]: Found 10 models, 6 data tests, 5 sources, 429 macros
[0m04:49:38.967359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c3e889d-e1b7-4e59-9368-5939206cb66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c86ca84560>]}
[0m04:49:38.976052 [info ] [MainThread]: 
[0m04:49:38.977332 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:49:38.978207 [info ] [MainThread]: 
[0m04:49:38.979729 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:49:38.994374 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m04:49:38.995628 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m04:49:39.238279 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m04:49:39.239298 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m04:49:39.240133 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m04:49:39.241074 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m04:49:39.241893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:49:39.242701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:49:39.465309 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.223 seconds
[0m04:49:39.466229 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.224 seconds
[0m04:49:39.469498 [debug] [ThreadPool]: On list_db: Close
[0m04:49:39.472588 [debug] [ThreadPool]: On list_db: Close
[0m04:49:39.478782 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m04:49:39.480683 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev_dev)
[0m04:49:39.494662 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m04:49:39.498889 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m04:49:39.499814 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m04:49:39.500812 [debug] [ThreadPool]: On list_db_dev_dev: BEGIN
[0m04:49:39.501644 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:49:39.502551 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:49:39.527411 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m04:49:39.528664 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m04:49:39.529725 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m04:49:39.531874 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m04:49:39.530969 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m04:49:39.534577 [debug] [ThreadPool]: On list_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_dev'
  
[0m04:49:39.608039 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.072 seconds
[0m04:49:39.610225 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.077 seconds
[0m04:49:39.619704 [debug] [ThreadPool]: On list_db_dev_dev: ROLLBACK
[0m04:49:39.623380 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m04:49:39.625128 [debug] [ThreadPool]: On list_db_dev_dev: Close
[0m04:49:39.627014 [debug] [ThreadPool]: On list_db_dev: Close
[0m04:49:39.651880 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:39.652822 [debug] [MainThread]: On master: BEGIN
[0m04:49:39.653584 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:49:39.678712 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m04:49:39.679974 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:39.681156 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:49:39.714527 [debug] [MainThread]: SQL status: SELECT 0 in 0.032 seconds
[0m04:49:39.718449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c3e889d-e1b7-4e59-9368-5939206cb66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c869ee3680>]}
[0m04:49:39.719749 [debug] [MainThread]: On master: ROLLBACK
[0m04:49:39.721434 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:39.722564 [debug] [MainThread]: On master: BEGIN
[0m04:49:39.724400 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m04:49:39.727351 [debug] [MainThread]: On master: COMMIT
[0m04:49:39.728559 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:39.729475 [debug] [MainThread]: On master: COMMIT
[0m04:49:39.730728 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:49:39.731700 [debug] [MainThread]: On master: Close
[0m04:49:39.740322 [debug] [Thread-1 (]: Began running node model.my_project.beer_types
[0m04:49:39.741964 [debug] [Thread-2 (]: Began running node model.my_project.food_pairing
[0m04:49:39.743238 [debug] [Thread-3 (]: Began running node model.my_project.staging
[0m04:49:39.745358 [debug] [Thread-4 (]: Began running node model.my_project.top_hops
[0m04:49:39.744576 [info ] [Thread-1 (]: 1 of 10 START sql table model dev_dev.beer_types ............................... [RUN]
[0m04:49:39.747431 [info ] [Thread-2 (]: 2 of 10 START sql table model dev_dev.food_pairing ............................. [RUN]
[0m04:49:39.748739 [info ] [Thread-3 (]: 3 of 10 START sql table model dev.staging ...................................... [RUN]
[0m04:49:39.750198 [info ] [Thread-4 (]: 4 of 10 START sql table model dev_dev.top_hops ................................. [RUN]
[0m04:49:39.751475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.beer_types)
[0m04:49:39.752826 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_dev_dev, now model.my_project.food_pairing)
[0m04:49:39.754778 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.staging'
[0m04:49:39.756118 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.top_hops'
[0m04:49:39.759066 [debug] [Thread-1 (]: Began compiling node model.my_project.beer_types
[0m04:49:39.760445 [debug] [Thread-2 (]: Began compiling node model.my_project.food_pairing
[0m04:49:39.761236 [debug] [Thread-3 (]: Began compiling node model.my_project.staging
[0m04:49:39.761913 [debug] [Thread-4 (]: Began compiling node model.my_project.top_hops
[0m04:49:39.790643 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_project.food_pairing"
[0m04:49:39.788549 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.beer_types"
[0m04:49:39.802068 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.staging"
[0m04:49:39.819514 [debug] [Thread-2 (]: Began executing node model.my_project.food_pairing
[0m04:49:39.821114 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.top_hops"
[0m04:49:39.828761 [debug] [Thread-3 (]: Began executing node model.my_project.staging
[0m04:49:39.829759 [debug] [Thread-1 (]: Began executing node model.my_project.beer_types
[0m04:49:39.870798 [debug] [Thread-4 (]: Began executing node model.my_project.top_hops
[0m04:49:40.053362 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_project.food_pairing"
[0m04:49:40.063209 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.top_hops"
[0m04:49:40.069800 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.staging"
[0m04:49:40.075719 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.beer_types"
[0m04:49:40.076874 [debug] [Thread-2 (]: Using postgres connection "model.my_project.food_pairing"
[0m04:49:40.078794 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_hops"
[0m04:49:40.079695 [debug] [Thread-2 (]: On model.my_project.food_pairing: BEGIN
[0m04:49:40.080879 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m04:49:40.081927 [debug] [Thread-4 (]: On model.my_project.top_hops: BEGIN
[0m04:49:40.082837 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m04:49:40.083873 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:49:40.084973 [debug] [Thread-3 (]: On model.my_project.staging: BEGIN
[0m04:49:40.086119 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m04:49:40.087198 [debug] [Thread-1 (]: On model.my_project.beer_types: BEGIN
[0m04:49:40.090255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:49:40.088704 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m04:49:40.116463 [debug] [Thread-4 (]: SQL status: BEGIN in 0.030 seconds
[0m04:49:40.117755 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_hops"
[0m04:49:40.119059 [debug] [Thread-4 (]: On model.my_project.top_hops: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_hops"} */

  
    

  create  table "db"."dev_dev"."top_hops__dbt_tmp"
  
  
    as
  
  (
    

select
    hop_name,
    count(distinct beer_id) as beers_with_hop
from "db"."dev"."hop_ingredients"
where hop_name is not null
group by hop_name
order by beers_with_hop desc
  );
  
[0m04:49:40.127108 [debug] [Thread-3 (]: SQL status: BEGIN in 0.038 seconds
[0m04:49:40.130050 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m04:49:40.131185 [debug] [Thread-3 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * 
    from "db"."dev"."raw_beer_data"
)

select 
    id,
    beer_id,
    name as beer_name,
    tagline,
    first_brewed,
    description,
    image,
    abv,
    ibu,
    ebc,
    ph,
    brewers_tips,
    contributed_by,
    inserted_at
from source
  );
  
[0m04:49:40.128701 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m04:49:40.132982 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m04:49:40.134573 [debug] [Thread-1 (]: On model.my_project.beer_types: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_types"} */

  
    

  create  table "db"."dev_dev"."beer_types__dbt_tmp"
  
  
    as
  
  (
    

select
    beer_id,
    name,
    tagline,
    first_brewed,
    abv,
    ibu,
    ebc,
    ph,
    case
        when lower(tagline) like '%lager%' then 'Lager'
        when lower(tagline) like '%pilsner%' then 'Lager'
        when lower(tagline) like '%ipa%' then 'Ale'
        when lower(tagline) like '%stout%' then 'Ale'
        when lower(tagline) like '%porter%' then 'Ale'
        when lower(tagline) like '%ale%' then 'Ale'
        when lower(tagline) like '%wheat%' then 'Ale'
        else 'Other'
    end as type
from "db"."dev"."raw_beer_data"
  );
  
[0m04:49:40.136697 [debug] [Thread-2 (]: SQL status: BEGIN in 0.053 seconds
[0m04:49:40.141019 [debug] [Thread-2 (]: Using postgres connection "model.my_project.food_pairing"
[0m04:49:40.142565 [debug] [Thread-2 (]: On model.my_project.food_pairing: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.food_pairing"} */

  
    

  create  table "db"."dev_dev"."food_pairing__dbt_tmp"
  
  
    as
  
  (
    

select
    pairing,
    count(*) as pairing_count
from "db"."dev"."food_pairings"
where pairing is not null
group by pairing
order by pairing_count desc
  );
  
[0m04:49:40.342926 [debug] [Thread-3 (]: SQL status: SELECT 414 in 0.211 seconds
[0m04:49:40.343979 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.204 seconds
[0m04:49:40.350517 [debug] [Thread-2 (]: SQL status: SELECT 1149 in 0.206 seconds
[0m04:49:40.363206 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m04:49:40.370033 [debug] [Thread-4 (]: SQL status: SELECT 178 in 0.249 seconds
[0m04:49:40.373236 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m04:49:40.381601 [debug] [Thread-2 (]: Using postgres connection "model.my_project.food_pairing"
[0m04:49:40.382714 [debug] [Thread-3 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m04:49:40.392027 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_hops"
[0m04:49:40.393067 [debug] [Thread-1 (]: On model.my_project.beer_types: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_types"} */
alter table "db"."dev_dev"."beer_types" rename to "beer_types__dbt_backup"
[0m04:49:40.394306 [debug] [Thread-2 (]: On model.my_project.food_pairing: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.food_pairing"} */
alter table "db"."dev_dev"."food_pairing" rename to "food_pairing__dbt_backup"
[0m04:49:40.396435 [debug] [Thread-4 (]: On model.my_project.top_hops: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_hops"} */
alter table "db"."dev_dev"."top_hops" rename to "top_hops__dbt_backup"
[0m04:49:40.397233 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m04:49:40.404967 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m04:49:40.407111 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m04:49:40.410043 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m04:49:40.411121 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m04:49:40.418145 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m04:49:40.426299 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_hops"
[0m04:49:40.427584 [debug] [Thread-3 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m04:49:40.432850 [debug] [Thread-2 (]: Using postgres connection "model.my_project.food_pairing"
[0m04:49:40.435865 [debug] [Thread-2 (]: On model.my_project.food_pairing: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.food_pairing"} */
alter table "db"."dev_dev"."food_pairing__dbt_tmp" rename to "food_pairing"
[0m04:49:40.434708 [debug] [Thread-4 (]: On model.my_project.top_hops: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_hops"} */
alter table "db"."dev_dev"."top_hops__dbt_tmp" rename to "top_hops"
[0m04:49:40.433798 [debug] [Thread-1 (]: On model.my_project.beer_types: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_types"} */
alter table "db"."dev_dev"."beer_types__dbt_tmp" rename to "beer_types"
[0m04:49:40.436984 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:49:40.444457 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m04:49:40.445700 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m04:49:40.458977 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.020 seconds
[0m04:49:40.519011 [debug] [Thread-2 (]: On model.my_project.food_pairing: COMMIT
[0m04:49:40.528022 [debug] [Thread-1 (]: On model.my_project.beer_types: COMMIT
[0m04:49:40.529181 [debug] [Thread-3 (]: On model.my_project.staging: COMMIT
[0m04:49:40.531780 [debug] [Thread-4 (]: On model.my_project.top_hops: COMMIT
[0m04:49:40.532630 [debug] [Thread-2 (]: Using postgres connection "model.my_project.food_pairing"
[0m04:49:40.533440 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m04:49:40.534417 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m04:49:40.535371 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_hops"
[0m04:49:40.536015 [debug] [Thread-2 (]: On model.my_project.food_pairing: COMMIT
[0m04:49:40.536809 [debug] [Thread-1 (]: On model.my_project.beer_types: COMMIT
[0m04:49:40.537847 [debug] [Thread-3 (]: On model.my_project.staging: COMMIT
[0m04:49:40.538662 [debug] [Thread-4 (]: On model.my_project.top_hops: COMMIT
[0m04:49:40.549616 [debug] [Thread-2 (]: SQL status: COMMIT in 0.010 seconds
[0m04:49:40.550235 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m04:49:40.550785 [debug] [Thread-4 (]: SQL status: COMMIT in 0.011 seconds
[0m04:49:40.551536 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m04:49:40.564580 [debug] [Thread-2 (]: Applying DROP to: "db"."dev_dev"."food_pairing__dbt_backup"
[0m04:49:40.568764 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m04:49:40.572288 [debug] [Thread-4 (]: Applying DROP to: "db"."dev_dev"."top_hops__dbt_backup"
[0m04:49:40.576562 [debug] [Thread-1 (]: Applying DROP to: "db"."dev_dev"."beer_types__dbt_backup"
[0m04:49:40.587930 [debug] [Thread-2 (]: Using postgres connection "model.my_project.food_pairing"
[0m04:49:40.589094 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m04:49:40.590387 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_hops"
[0m04:49:40.591500 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m04:49:40.592197 [debug] [Thread-2 (]: On model.my_project.food_pairing: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.food_pairing"} */
drop table if exists "db"."dev_dev"."food_pairing__dbt_backup" cascade
[0m04:49:40.592874 [debug] [Thread-3 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m04:49:40.593809 [debug] [Thread-4 (]: On model.my_project.top_hops: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_hops"} */
drop table if exists "db"."dev_dev"."top_hops__dbt_backup" cascade
[0m04:49:40.595039 [debug] [Thread-1 (]: On model.my_project.beer_types: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_types"} */
drop table if exists "db"."dev_dev"."beer_types__dbt_backup" cascade
[0m04:49:40.630280 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.034 seconds
[0m04:49:40.634141 [debug] [Thread-2 (]: On model.my_project.food_pairing: Close
[0m04:49:40.634936 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.039 seconds
[0m04:49:40.635718 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.040 seconds
[0m04:49:40.636497 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.040 seconds
[0m04:49:40.643916 [debug] [Thread-4 (]: On model.my_project.top_hops: Close
[0m04:49:40.647648 [debug] [Thread-3 (]: On model.my_project.staging: Close
[0m04:49:40.653122 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c3e889d-e1b7-4e59-9368-5939206cb66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c868159130>]}
[0m04:49:40.651568 [debug] [Thread-1 (]: On model.my_project.beer_types: Close
[0m04:49:40.657644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c3e889d-e1b7-4e59-9368-5939206cb66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c868a21700>]}
[0m04:49:40.648773 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c3e889d-e1b7-4e59-9368-5939206cb66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c86d8de390>]}
[0m04:49:40.656138 [info ] [Thread-4 (]: 4 of 10 OK created sql table model dev_dev.top_hops ............................ [[32mSELECT 178[0m in 0.90s]
[0m04:49:40.654566 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c3e889d-e1b7-4e59-9368-5939206cb66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c868a28980>]}
[0m04:49:40.659895 [info ] [Thread-1 (]: 1 of 10 OK created sql table model dev_dev.beer_types .......................... [[32mSELECT 414[0m in 0.91s]
[0m04:49:40.661813 [info ] [Thread-2 (]: 2 of 10 OK created sql table model dev_dev.food_pairing ........................ [[32mSELECT 1149[0m in 0.88s]
[0m04:49:40.663494 [debug] [Thread-4 (]: Finished running node model.my_project.top_hops
[0m04:49:40.677187 [debug] [Thread-4 (]: Began running node model.my_project.top_malts
[0m04:49:40.669242 [debug] [Thread-1 (]: Finished running node model.my_project.beer_types
[0m04:49:40.675464 [debug] [Thread-2 (]: Finished running node model.my_project.food_pairing
[0m04:49:40.665218 [info ] [Thread-3 (]: 3 of 10 OK created sql table model dev.staging ................................. [[32mSELECT 414[0m in 0.90s]
[0m04:49:40.679384 [info ] [Thread-4 (]: 5 of 10 START sql table model dev_dev.top_malts ................................ [RUN]
[0m04:49:40.685271 [debug] [Thread-3 (]: Finished running node model.my_project.staging
[0m04:49:40.689830 [debug] [Thread-1 (]: Began running node model.my_project.abv_ibu
[0m04:49:40.691708 [debug] [Thread-2 (]: Began running node model.my_project.beer_released
[0m04:49:40.693494 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_project.top_hops, now model.my_project.top_malts)
[0m04:49:40.703639 [debug] [Thread-4 (]: Began compiling node model.my_project.top_malts
[0m04:49:40.696978 [info ] [Thread-1 (]: 6 of 10 START sql table model dev_dev.abv_ibu .................................. [RUN]
[0m04:49:40.702260 [info ] [Thread-2 (]: 7 of 10 START sql table model dev_dev.beer_released ............................ [RUN]
[0m04:49:40.694797 [debug] [Thread-3 (]: Began running node model.my_project.type_by_year
[0m04:49:40.714759 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.top_malts"
[0m04:49:40.715981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.beer_types, now model.my_project.abv_ibu)
[0m04:49:40.720702 [debug] [Thread-1 (]: Began compiling node model.my_project.abv_ibu
[0m04:49:40.719005 [info ] [Thread-3 (]: 8 of 10 START sql table model dev_dev.type_by_year ............................. [RUN]
[0m04:49:40.717704 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_project.food_pairing, now model.my_project.beer_released)
[0m04:49:40.727779 [debug] [Thread-4 (]: Began executing node model.my_project.top_malts
[0m04:49:40.729126 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_project.staging, now model.my_project.type_by_year)
[0m04:49:40.731930 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.abv_ibu"
[0m04:49:40.733224 [debug] [Thread-2 (]: Began compiling node model.my_project.beer_released
[0m04:49:40.744073 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.top_malts"
[0m04:49:40.745262 [debug] [Thread-3 (]: Began compiling node model.my_project.type_by_year
[0m04:49:40.752870 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_project.beer_released"
[0m04:49:40.754656 [debug] [Thread-1 (]: Began executing node model.my_project.abv_ibu
[0m04:49:40.765569 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.type_by_year"
[0m04:49:40.781257 [debug] [Thread-3 (]: Began executing node model.my_project.type_by_year
[0m04:49:40.779529 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_malts"
[0m04:49:40.767548 [debug] [Thread-2 (]: Began executing node model.my_project.beer_released
[0m04:49:40.788467 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.abv_ibu"
[0m04:49:40.794052 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.type_by_year"
[0m04:49:40.795310 [debug] [Thread-4 (]: On model.my_project.top_malts: BEGIN
[0m04:49:40.803549 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_project.beer_released"
[0m04:49:40.806553 [debug] [Thread-1 (]: Using postgres connection "model.my_project.abv_ibu"
[0m04:49:40.807232 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:49:40.808059 [debug] [Thread-3 (]: Using postgres connection "model.my_project.type_by_year"
[0m04:49:40.809437 [debug] [Thread-1 (]: On model.my_project.abv_ibu: BEGIN
[0m04:49:40.810836 [debug] [Thread-2 (]: Using postgres connection "model.my_project.beer_released"
[0m04:49:40.811963 [debug] [Thread-3 (]: On model.my_project.type_by_year: BEGIN
[0m04:49:40.812993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:49:40.814183 [debug] [Thread-2 (]: On model.my_project.beer_released: BEGIN
[0m04:49:40.815267 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:49:40.817023 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:49:40.831271 [debug] [Thread-4 (]: SQL status: BEGIN in 0.024 seconds
[0m04:49:40.832149 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_malts"
[0m04:49:40.833724 [debug] [Thread-4 (]: On model.my_project.top_malts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_malts"} */

  
    

  create  table "db"."dev_dev"."top_malts__dbt_tmp"
  
  
    as
  
  (
    

select
    malt_name,
    count(distinct beer_id) as beers_with_malt
from "db"."dev"."malt_ingredients"
where malt_name is not null
group by malt_name
order by beers_with_malt desc
  );
  
[0m04:49:40.837423 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m04:49:40.838382 [debug] [Thread-1 (]: Using postgres connection "model.my_project.abv_ibu"
[0m04:49:40.840175 [debug] [Thread-3 (]: SQL status: BEGIN in 0.025 seconds
[0m04:49:40.843684 [debug] [Thread-1 (]: On model.my_project.abv_ibu: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.abv_ibu"} */

  
    

  create  table "db"."dev_dev"."abv_ibu__dbt_tmp"
  
  
    as
  
  (
    

select
    abv,
    ibu,
    type
from "db"."dev_dev"."beer_types"
where abv is not null and ibu is not null
  );
  
[0m04:49:40.845956 [debug] [Thread-3 (]: Using postgres connection "model.my_project.type_by_year"
[0m04:49:40.848006 [debug] [Thread-2 (]: SQL status: BEGIN in 0.031 seconds
[0m04:49:40.852892 [debug] [Thread-2 (]: Using postgres connection "model.my_project.beer_released"
[0m04:49:40.850543 [debug] [Thread-3 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */

  
    

  create  table "db"."dev_dev"."type_by_year__dbt_tmp"
  
  
    as
  
  (
    

select
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4) as year,
    type,
    count(*) as beer_count
from "db"."dev_dev"."beer_types"
where
    -- Only keep non-null, non-empty years and ensure first 4 chars are digits
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4) ~ '^\d{4}$'
group by
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4),
    type
order by
    year,
    type
  );
  
[0m04:49:40.854324 [debug] [Thread-2 (]: On model.my_project.beer_released: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_released"} */

  
    

  create  table "db"."dev_dev"."beer_released__dbt_tmp"
  
  
    as
  
  (
    

select
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4) as year,
    count(*) as beer_count
from "db"."dev_dev"."beer_types"
where
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4) ~ '^\d{4}$'
group by year
order by year
  );
  
[0m04:49:40.857358 [debug] [Thread-1 (]: SQL status: SELECT 409 in 0.009 seconds
[0m04:49:40.868806 [debug] [Thread-1 (]: Using postgres connection "model.my_project.abv_ibu"
[0m04:49:40.869485 [debug] [Thread-1 (]: On model.my_project.abv_ibu: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.abv_ibu"} */
alter table "db"."dev_dev"."abv_ibu" rename to "abv_ibu__dbt_backup"
[0m04:49:40.870769 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:49:40.878244 [debug] [Thread-1 (]: Using postgres connection "model.my_project.abv_ibu"
[0m04:49:40.879256 [debug] [Thread-1 (]: On model.my_project.abv_ibu: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.abv_ibu"} */
alter table "db"."dev_dev"."abv_ibu__dbt_tmp" rename to "abv_ibu"
[0m04:49:40.880964 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:49:40.889239 [debug] [Thread-1 (]: On model.my_project.abv_ibu: COMMIT
[0m04:49:40.891244 [debug] [Thread-1 (]: Using postgres connection "model.my_project.abv_ibu"
[0m04:49:40.892644 [debug] [Thread-1 (]: On model.my_project.abv_ibu: COMMIT
[0m04:49:40.895513 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.039 seconds
[0m04:49:40.896462 [debug] [Thread-3 (]: SQL status: SELECT 12 in 0.040 seconds
[0m04:49:40.900860 [debug] [Thread-2 (]: Using postgres connection "model.my_project.beer_released"
[0m04:49:40.902121 [debug] [Thread-4 (]: SQL status: SELECT 133 in 0.066 seconds
[0m04:49:40.906813 [debug] [Thread-3 (]: Using postgres connection "model.my_project.type_by_year"
[0m04:49:40.907772 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m04:49:40.908669 [debug] [Thread-2 (]: On model.my_project.beer_released: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_released"} */
alter table "db"."dev_dev"."beer_released" rename to "beer_released__dbt_backup"
[0m04:49:40.917122 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_malts"
[0m04:49:40.918377 [debug] [Thread-3 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */
alter table "db"."dev_dev"."type_by_year" rename to "type_by_year__dbt_backup"
[0m04:49:40.926497 [debug] [Thread-1 (]: Applying DROP to: "db"."dev_dev"."abv_ibu__dbt_backup"
[0m04:49:40.928137 [debug] [Thread-4 (]: On model.my_project.top_malts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_malts"} */
alter table "db"."dev_dev"."top_malts" rename to "top_malts__dbt_backup"
[0m04:49:40.929117 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:49:40.930803 [debug] [Thread-1 (]: Using postgres connection "model.my_project.abv_ibu"
[0m04:49:40.931525 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m04:49:40.938037 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m04:49:40.940046 [debug] [Thread-2 (]: Using postgres connection "model.my_project.beer_released"
[0m04:49:40.941045 [debug] [Thread-1 (]: On model.my_project.abv_ibu: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.abv_ibu"} */
drop table if exists "db"."dev_dev"."abv_ibu__dbt_backup" cascade
[0m04:49:40.947994 [debug] [Thread-3 (]: Using postgres connection "model.my_project.type_by_year"
[0m04:49:40.952743 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_malts"
[0m04:49:40.953606 [debug] [Thread-2 (]: On model.my_project.beer_released: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_released"} */
alter table "db"."dev_dev"."beer_released__dbt_tmp" rename to "beer_released"
[0m04:49:40.954957 [debug] [Thread-3 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */
alter table "db"."dev_dev"."type_by_year__dbt_tmp" rename to "type_by_year"
[0m04:49:40.956036 [debug] [Thread-4 (]: On model.my_project.top_malts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_malts"} */
alter table "db"."dev_dev"."top_malts__dbt_tmp" rename to "top_malts"
[0m04:49:40.957878 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:49:40.958976 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:49:40.959772 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m04:49:40.965823 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.011 seconds
[0m04:49:40.966874 [debug] [Thread-2 (]: On model.my_project.beer_released: COMMIT
[0m04:49:40.970273 [debug] [Thread-4 (]: On model.my_project.top_malts: COMMIT
[0m04:49:40.973838 [debug] [Thread-3 (]: On model.my_project.type_by_year: COMMIT
[0m04:49:40.976468 [debug] [Thread-1 (]: On model.my_project.abv_ibu: Close
[0m04:49:40.977275 [debug] [Thread-2 (]: Using postgres connection "model.my_project.beer_released"
[0m04:49:40.980116 [debug] [Thread-2 (]: On model.my_project.beer_released: COMMIT
[0m04:49:40.979041 [debug] [Thread-3 (]: Using postgres connection "model.my_project.type_by_year"
[0m04:49:40.978118 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_malts"
[0m04:49:40.981046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c3e889d-e1b7-4e59-9368-5939206cb66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c8680d5df0>]}
[0m04:49:40.982227 [debug] [Thread-3 (]: On model.my_project.type_by_year: COMMIT
[0m04:49:40.983427 [debug] [Thread-4 (]: On model.my_project.top_malts: COMMIT
[0m04:49:40.985066 [info ] [Thread-1 (]: 6 of 10 OK created sql table model dev_dev.abv_ibu ............................. [[32mSELECT 409[0m in 0.27s]
[0m04:49:40.987257 [debug] [Thread-1 (]: Finished running node model.my_project.abv_ibu
[0m04:49:40.988283 [debug] [Thread-1 (]: Began running node model.my_project.beer_report
[0m04:49:40.990510 [debug] [Thread-2 (]: SQL status: COMMIT in 0.009 seconds
[0m04:49:40.989601 [info ] [Thread-1 (]: 9 of 10 START sql table model dev.beer_report .................................. [RUN]
[0m04:49:40.996517 [debug] [Thread-2 (]: Applying DROP to: "db"."dev_dev"."beer_released__dbt_backup"
[0m04:49:40.997599 [debug] [Thread-3 (]: SQL status: COMMIT in 0.011 seconds
[0m04:49:40.998612 [debug] [Thread-4 (]: SQL status: COMMIT in 0.012 seconds
[0m04:49:40.999693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.abv_ibu, now model.my_project.beer_report)
[0m04:49:41.001114 [debug] [Thread-2 (]: Using postgres connection "model.my_project.beer_released"
[0m04:49:41.005948 [debug] [Thread-3 (]: Applying DROP to: "db"."dev_dev"."type_by_year__dbt_backup"
[0m04:49:41.014237 [debug] [Thread-4 (]: Applying DROP to: "db"."dev_dev"."top_malts__dbt_backup"
[0m04:49:41.015573 [debug] [Thread-1 (]: Began compiling node model.my_project.beer_report
[0m04:49:41.016937 [debug] [Thread-2 (]: On model.my_project.beer_released: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_released"} */
drop table if exists "db"."dev_dev"."beer_released__dbt_backup" cascade
[0m04:49:41.018754 [debug] [Thread-3 (]: Using postgres connection "model.my_project.type_by_year"
[0m04:49:41.021506 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_malts"
[0m04:49:41.029592 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.beer_report"
[0m04:49:41.031005 [debug] [Thread-3 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */
drop table if exists "db"."dev_dev"."type_by_year__dbt_backup" cascade
[0m04:49:41.032613 [debug] [Thread-4 (]: On model.my_project.top_malts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_malts"} */
drop table if exists "db"."dev_dev"."top_malts__dbt_backup" cascade
[0m04:49:41.034294 [debug] [Thread-1 (]: Began executing node model.my_project.beer_report
[0m04:49:41.047311 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.017 seconds
[0m04:49:41.053831 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.018 seconds
[0m04:49:41.054777 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.019 seconds
[0m04:49:41.052702 [debug] [Thread-2 (]: On model.my_project.beer_released: Close
[0m04:49:41.046688 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.beer_report"
[0m04:49:41.067990 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c3e889d-e1b7-4e59-9368-5939206cb66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c868a142c0>]}
[0m04:49:41.059722 [debug] [Thread-3 (]: On model.my_project.type_by_year: Close
[0m04:49:41.065809 [debug] [Thread-4 (]: On model.my_project.top_malts: Close
[0m04:49:41.069864 [info ] [Thread-2 (]: 7 of 10 OK created sql table model dev_dev.beer_released ....................... [[32mSELECT 5[0m in 0.35s]
[0m04:49:41.072302 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_report"
[0m04:49:41.074182 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c3e889d-e1b7-4e59-9368-5939206cb66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c8681a70e0>]}
[0m04:49:41.077635 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c3e889d-e1b7-4e59-9368-5939206cb66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c868a17aa0>]}
[0m04:49:41.080975 [debug] [Thread-2 (]: Finished running node model.my_project.beer_released
[0m04:49:41.089700 [debug] [Thread-2 (]: Began running node model.my_project.master_beer_table
[0m04:49:41.082260 [debug] [Thread-1 (]: On model.my_project.beer_report: BEGIN
[0m04:49:41.086471 [info ] [Thread-4 (]: 5 of 10 OK created sql table model dev_dev.top_malts ........................... [[32mSELECT 133[0m in 0.38s]
[0m04:49:41.088113 [info ] [Thread-3 (]: 8 of 10 OK created sql table model dev_dev.type_by_year ........................ [[32mSELECT 12[0m in 0.34s]
[0m04:49:41.103987 [debug] [Thread-3 (]: Finished running node model.my_project.type_by_year
[0m04:49:41.094255 [info ] [Thread-2 (]: 10 of 10 START sql table model dev.master_beer_table ........................... [RUN]
[0m04:49:41.106062 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_project.beer_released, now model.my_project.master_beer_table)
[0m04:49:41.102268 [debug] [Thread-4 (]: Finished running node model.my_project.top_malts
[0m04:49:41.099402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:49:41.109315 [debug] [Thread-2 (]: Began compiling node model.my_project.master_beer_table
[0m04:49:41.122843 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_project.master_beer_table"
[0m04:49:41.131142 [debug] [Thread-2 (]: Began executing node model.my_project.master_beer_table
[0m04:49:41.144675 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_project.master_beer_table"
[0m04:49:41.147090 [debug] [Thread-2 (]: Using postgres connection "model.my_project.master_beer_table"
[0m04:49:41.148662 [debug] [Thread-2 (]: On model.my_project.master_beer_table: BEGIN
[0m04:49:41.149816 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m04:49:41.151238 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:49:41.152861 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_report"
[0m04:49:41.155025 [debug] [Thread-1 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */

  
    

  create  table "db"."dev"."beer_report__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    count(*) as total_beers,
    round(avg(abv)::numeric, 2) as avg_abv,
    round(min(abv)::numeric, 2) as min_abv,
    round(max(abv)::numeric, 2) as max_abv,
    round(avg(ibu)::numeric, 2) as avg_ibu,
    round(min(ibu)::numeric, 2) as min_ibu,
    round(max(ibu)::numeric, 2) as max_ibu,
    round(avg(ebc)::numeric, 2) as avg_ebc,
    round(min(ebc)::numeric, 2) as min_ebc,
    round(max(ebc)::numeric, 2) as max_ebc,
    round(avg(ph)::numeric, 2) as avg_ph,
    min(first_brewed) as oldest_brew,
    max(first_brewed) as newest_brew,
    count(distinct contributed_by) as unique_contributors
from beers
  );
  
[0m04:49:41.182949 [debug] [Thread-2 (]: SQL status: BEGIN in 0.031 seconds
[0m04:49:41.184465 [debug] [Thread-2 (]: Using postgres connection "model.my_project.master_beer_table"
[0m04:49:41.185579 [debug] [Thread-2 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */

  
    

  create  table "db"."dev"."master_beer_table__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    beer_id,
    beer_name,
    tagline as category,         -- category/style approximation
    description,
    abv as alcohol_percent,
    first_brewed
from beers
  );
  
[0m04:49:41.196760 [debug] [Thread-2 (]: SQL status: SELECT 414 in 0.010 seconds
[0m04:49:41.204890 [debug] [Thread-2 (]: Using postgres connection "model.my_project.master_beer_table"
[0m04:49:41.205858 [debug] [Thread-2 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */
alter table "db"."dev"."master_beer_table" rename to "master_beer_table__dbt_backup"
[0m04:49:41.207667 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:49:41.216659 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.059 seconds
[0m04:49:41.230039 [debug] [Thread-2 (]: Using postgres connection "model.my_project.master_beer_table"
[0m04:49:41.233783 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_report"
[0m04:49:41.235118 [debug] [Thread-2 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */
alter table "db"."dev"."master_beer_table__dbt_tmp" rename to "master_beer_table"
[0m04:49:41.239003 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:49:41.236635 [debug] [Thread-1 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report" rename to "beer_report__dbt_backup"
[0m04:49:41.245854 [debug] [Thread-2 (]: On model.my_project.master_beer_table: COMMIT
[0m04:49:41.247605 [debug] [Thread-2 (]: Using postgres connection "model.my_project.master_beer_table"
[0m04:49:41.248870 [debug] [Thread-2 (]: On model.my_project.master_beer_table: COMMIT
[0m04:49:41.251592 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m04:49:41.266376 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_report"
[0m04:49:41.267464 [debug] [Thread-1 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report__dbt_tmp" rename to "beer_report"
[0m04:49:41.269464 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:49:41.274311 [debug] [Thread-1 (]: On model.my_project.beer_report: COMMIT
[0m04:49:41.275702 [debug] [Thread-2 (]: SQL status: COMMIT in 0.026 seconds
[0m04:49:41.277652 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_report"
[0m04:49:41.290521 [debug] [Thread-1 (]: On model.my_project.beer_report: COMMIT
[0m04:49:41.294769 [debug] [Thread-2 (]: Applying DROP to: "db"."dev"."master_beer_table__dbt_backup"
[0m04:49:41.296681 [debug] [Thread-2 (]: Using postgres connection "model.my_project.master_beer_table"
[0m04:49:41.297826 [debug] [Thread-2 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */
drop table if exists "db"."dev"."master_beer_table__dbt_backup" cascade
[0m04:49:41.308263 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m04:49:41.313920 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."beer_report__dbt_backup"
[0m04:49:41.316146 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_report"
[0m04:49:41.317361 [debug] [Thread-1 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
drop table if exists "db"."dev"."beer_report__dbt_backup" cascade
[0m04:49:41.330567 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.012 seconds
[0m04:49:41.334661 [debug] [Thread-1 (]: On model.my_project.beer_report: Close
[0m04:49:41.336152 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.037 seconds
[0m04:49:41.340401 [debug] [Thread-2 (]: On model.my_project.master_beer_table: Close
[0m04:49:41.344368 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c3e889d-e1b7-4e59-9368-5939206cb66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c859f62300>]}
[0m04:49:41.341678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c3e889d-e1b7-4e59-9368-5939206cb66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c859f240b0>]}
[0m04:49:41.346029 [info ] [Thread-2 (]: 10 of 10 OK created sql table model dev.master_beer_table ...................... [[32mSELECT 414[0m in 0.24s]
[0m04:49:41.350305 [info ] [Thread-1 (]: 9 of 10 OK created sql table model dev.beer_report ............................. [[32mSELECT 1[0m in 0.34s]
[0m04:49:41.353240 [debug] [Thread-2 (]: Finished running node model.my_project.master_beer_table
[0m04:49:41.355271 [debug] [Thread-1 (]: Finished running node model.my_project.beer_report
[0m04:49:41.366249 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:41.367429 [debug] [MainThread]: On master: BEGIN
[0m04:49:41.368389 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:49:41.397379 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m04:49:41.398485 [debug] [MainThread]: On master: COMMIT
[0m04:49:41.399358 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:41.400174 [debug] [MainThread]: On master: COMMIT
[0m04:49:41.401501 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:49:41.402390 [debug] [MainThread]: On master: Close
[0m04:49:41.403774 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:49:41.404834 [debug] [MainThread]: Connection 'model.my_project.beer_report' was properly closed.
[0m04:49:41.405790 [debug] [MainThread]: Connection 'model.my_project.master_beer_table' was properly closed.
[0m04:49:41.411771 [debug] [MainThread]: Connection 'model.my_project.type_by_year' was properly closed.
[0m04:49:41.414153 [debug] [MainThread]: Connection 'model.my_project.top_malts' was properly closed.
[0m04:49:41.416067 [info ] [MainThread]: 
[0m04:49:41.417664 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 2.44 seconds (2.44s).
[0m04:49:41.435306 [debug] [MainThread]: Command end result
[0m04:49:41.526980 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m04:49:41.533014 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m04:49:41.554574 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m04:49:41.555513 [info ] [MainThread]: 
[0m04:49:41.557991 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:49:41.559966 [info ] [MainThread]: 
[0m04:49:41.561395 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m04:49:41.577062 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.177085, "process_in_blocks": "111200", "process_kernel_time": 1.330912, "process_mem_max_rss": "109368", "process_out_blocks": "2168", "process_user_time": 6.784805}
[0m04:49:41.579583 [debug] [MainThread]: Command `dbt run` succeeded at 04:49:41.578404 after 5.18 seconds
[0m04:49:41.581111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c86c102cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c86a2f0920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c86c4e2420>]}
[0m04:49:41.582645 [debug] [MainThread]: Flushing usage events
[0m04:49:43.281685 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:52:18.501205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adf8a095760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adf8b9f1d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adf8a24d7f0>]}


============================== 04:52:18.523971 | 01581029-fe36-4026-a82f-721bb563aaa3 ==============================
[0m04:52:18.523971 [info ] [MainThread]: Running with dbt=1.9.0
[0m04:52:18.525527 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:52:19.128198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01581029-fe36-4026-a82f-721bb563aaa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adf8baaf530>]}
[0m04:52:19.344413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01581029-fe36-4026-a82f-721bb563aaa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adf89d23e60>]}
[0m04:52:19.346094 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m04:52:19.600903 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m04:52:20.050189 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:52:20.067374 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:52:20.220112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01581029-fe36-4026-a82f-721bb563aaa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adf8832f7d0>]}
[0m04:52:20.470319 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m04:52:20.478172 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m04:52:20.563829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01581029-fe36-4026-a82f-721bb563aaa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adf880a8e30>]}
[0m04:52:20.564951 [info ] [MainThread]: Found 10 models, 6 data tests, 5 sources, 429 macros
[0m04:52:20.565863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01581029-fe36-4026-a82f-721bb563aaa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adf8832db80>]}
[0m04:52:20.569933 [info ] [MainThread]: 
[0m04:52:20.570802 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:52:20.571779 [info ] [MainThread]: 
[0m04:52:20.573186 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:52:20.581387 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m04:52:20.582974 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m04:52:20.674453 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m04:52:20.675036 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m04:52:20.675521 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m04:52:20.676151 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m04:52:20.676697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:52:20.677452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:52:20.693699 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.017 seconds
[0m04:52:20.694493 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.017 seconds
[0m04:52:20.696679 [debug] [ThreadPool]: On list_db: Close
[0m04:52:20.698793 [debug] [ThreadPool]: On list_db: Close
[0m04:52:20.703468 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m04:52:20.704808 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev_dev)
[0m04:52:20.714074 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m04:52:20.716865 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m04:52:20.717616 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m04:52:20.718193 [debug] [ThreadPool]: On list_db_dev_dev: BEGIN
[0m04:52:20.718743 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:52:20.719441 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:52:20.734818 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m04:52:20.736085 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m04:52:20.740058 [debug] [ThreadPool]: On list_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_dev'
  
[0m04:52:20.741178 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m04:52:20.742160 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m04:52:20.743177 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m04:52:20.749837 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.006 seconds
[0m04:52:20.752934 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m04:52:20.753629 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.012 seconds
[0m04:52:20.756957 [debug] [ThreadPool]: On list_db_dev_dev: ROLLBACK
[0m04:52:20.757591 [debug] [ThreadPool]: On list_db_dev: Close
[0m04:52:20.758847 [debug] [ThreadPool]: On list_db_dev_dev: Close
[0m04:52:20.776977 [debug] [MainThread]: Using postgres connection "master"
[0m04:52:20.777834 [debug] [MainThread]: On master: BEGIN
[0m04:52:20.778312 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:52:20.795704 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m04:52:20.796565 [debug] [MainThread]: Using postgres connection "master"
[0m04:52:20.797678 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:52:20.808756 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m04:52:20.812491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01581029-fe36-4026-a82f-721bb563aaa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adf87ee7c50>]}
[0m04:52:20.813640 [debug] [MainThread]: On master: ROLLBACK
[0m04:52:20.814474 [debug] [MainThread]: Using postgres connection "master"
[0m04:52:20.814969 [debug] [MainThread]: On master: BEGIN
[0m04:52:20.816892 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m04:52:20.818294 [debug] [MainThread]: On master: COMMIT
[0m04:52:20.821269 [debug] [MainThread]: Using postgres connection "master"
[0m04:52:20.822862 [debug] [MainThread]: On master: COMMIT
[0m04:52:20.824288 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:52:20.825405 [debug] [MainThread]: On master: Close
[0m04:52:20.833205 [debug] [Thread-1 (]: Began running node model.my_project.beer_types
[0m04:52:20.836369 [debug] [Thread-2 (]: Began running node model.my_project.food_pairing
[0m04:52:20.838992 [debug] [Thread-3 (]: Began running node model.my_project.staging
[0m04:52:20.840121 [debug] [Thread-4 (]: Began running node model.my_project.top_hops
[0m04:52:20.841342 [info ] [Thread-1 (]: 1 of 10 START sql table model dev_dev.beer_types ............................... [RUN]
[0m04:52:20.842779 [info ] [Thread-2 (]: 2 of 10 START sql table model dev_dev.food_pairing ............................. [RUN]
[0m04:52:20.844478 [info ] [Thread-3 (]: 3 of 10 START sql table model dev.staging ...................................... [RUN]
[0m04:52:20.846112 [info ] [Thread-4 (]: 4 of 10 START sql table model dev_dev.top_hops ................................. [RUN]
[0m04:52:20.847435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev_dev, now model.my_project.beer_types)
[0m04:52:20.848375 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.food_pairing)
[0m04:52:20.849475 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.staging'
[0m04:52:20.850637 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.top_hops'
[0m04:52:20.851996 [debug] [Thread-1 (]: Began compiling node model.my_project.beer_types
[0m04:52:20.853304 [debug] [Thread-2 (]: Began compiling node model.my_project.food_pairing
[0m04:52:20.854644 [debug] [Thread-3 (]: Began compiling node model.my_project.staging
[0m04:52:20.855670 [debug] [Thread-4 (]: Began compiling node model.my_project.top_hops
[0m04:52:20.872630 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.beer_types"
[0m04:52:20.878205 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_project.food_pairing"
[0m04:52:20.885003 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.staging"
[0m04:52:20.891979 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.top_hops"
[0m04:52:20.895892 [debug] [Thread-1 (]: Began executing node model.my_project.beer_types
[0m04:52:20.897283 [debug] [Thread-2 (]: Began executing node model.my_project.food_pairing
[0m04:52:20.898433 [debug] [Thread-3 (]: Began executing node model.my_project.staging
[0m04:52:20.910722 [debug] [Thread-4 (]: Began executing node model.my_project.top_hops
[0m04:52:21.082453 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_project.food_pairing"
[0m04:52:21.083220 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.beer_types"
[0m04:52:21.088631 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.top_hops"
[0m04:52:21.093052 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.staging"
[0m04:52:21.095861 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m04:52:21.096886 [debug] [Thread-1 (]: On model.my_project.beer_types: BEGIN
[0m04:52:21.097870 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_hops"
[0m04:52:21.098365 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:52:21.099011 [debug] [Thread-2 (]: Using postgres connection "model.my_project.food_pairing"
[0m04:52:21.099642 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m04:52:21.100176 [debug] [Thread-4 (]: On model.my_project.top_hops: BEGIN
[0m04:52:21.101019 [debug] [Thread-2 (]: On model.my_project.food_pairing: BEGIN
[0m04:52:21.101687 [debug] [Thread-3 (]: On model.my_project.staging: BEGIN
[0m04:52:21.102373 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m04:52:21.103056 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:52:21.104075 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m04:52:21.116472 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m04:52:21.117604 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m04:52:21.118252 [debug] [Thread-1 (]: On model.my_project.beer_types: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_types"} */

  
    

  create  table "db"."dev_dev"."beer_types__dbt_tmp"
  
  
    as
  
  (
    

select
    beer_id,
    name,
    tagline,
    first_brewed,
    abv,
    ibu,
    ebc,
    ph,
    case
        when lower(tagline) like '%lager%' then 'Lager'
        when lower(tagline) like '%pilsner%' then 'Lager'
        when lower(tagline) like '%ipa%' then 'Ale'
        when lower(tagline) like '%stout%' then 'Ale'
        when lower(tagline) like '%porter%' then 'Ale'
        when lower(tagline) like '%ale%' then 'Ale'
        when lower(tagline) like '%wheat%' then 'Ale'
        else 'Other'
    end as type
from "db"."dev"."raw_beer_data"
  );
  
[0m04:52:21.119958 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m04:52:21.121164 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_hops"
[0m04:52:21.123317 [debug] [Thread-4 (]: On model.my_project.top_hops: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_hops"} */

  
    

  create  table "db"."dev_dev"."top_hops__dbt_tmp"
  
  
    as
  
  (
    

select
    hop_name,
    count(distinct beer_id) as beers_with_hop
from "db"."dev"."hop_ingredients"
where hop_name is not null
group by hop_name
order by beers_with_hop desc
  );
  
[0m04:52:21.122200 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m04:52:21.124755 [debug] [Thread-2 (]: SQL status: BEGIN in 0.022 seconds
[0m04:52:21.126135 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m04:52:21.126894 [debug] [Thread-2 (]: Using postgres connection "model.my_project.food_pairing"
[0m04:52:21.128306 [debug] [Thread-3 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * 
    from "db"."dev"."raw_beer_data"
)

select 
    id,
    beer_id,
    name as beer_name,
    tagline,
    first_brewed,
    description,
    image,
    abv,
    ibu,
    ebc,
    ph,
    brewers_tips,
    contributed_by,
    inserted_at
from source
  );
  
[0m04:52:21.129447 [debug] [Thread-2 (]: On model.my_project.food_pairing: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.food_pairing"} */

  
    

  create  table "db"."dev_dev"."food_pairing__dbt_tmp"
  
  
    as
  
  (
    

select
    pairing,
    count(*) as pairing_count
from "db"."dev"."food_pairings"
where pairing is not null
group by pairing
order by pairing_count desc
  );
  
[0m04:52:21.135841 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.017 seconds
[0m04:52:21.142844 [debug] [Thread-3 (]: SQL status: SELECT 414 in 0.012 seconds
[0m04:52:21.153161 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m04:52:21.153806 [debug] [Thread-2 (]: SQL status: SELECT 1149 in 0.023 seconds
[0m04:52:21.158089 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m04:52:21.158676 [debug] [Thread-4 (]: SQL status: SELECT 178 in 0.033 seconds
[0m04:52:21.159364 [debug] [Thread-1 (]: On model.my_project.beer_types: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_types"} */
alter table "db"."dev_dev"."beer_types" rename to "beer_types__dbt_backup"
[0m04:52:21.164998 [debug] [Thread-2 (]: Using postgres connection "model.my_project.food_pairing"
[0m04:52:21.165931 [debug] [Thread-3 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m04:52:21.170787 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_hops"
[0m04:52:21.171892 [debug] [Thread-2 (]: On model.my_project.food_pairing: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.food_pairing"} */
alter table "db"."dev_dev"."food_pairing" rename to "food_pairing__dbt_backup"
[0m04:52:21.172574 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:52:21.173281 [debug] [Thread-4 (]: On model.my_project.top_hops: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_hops"} */
alter table "db"."dev_dev"."top_hops" rename to "top_hops__dbt_backup"
[0m04:52:21.173926 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:52:21.177993 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m04:52:21.178654 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m04:52:21.184843 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m04:52:21.185645 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m04:52:21.186196 [debug] [Thread-1 (]: On model.my_project.beer_types: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_types"} */
alter table "db"."dev_dev"."beer_types__dbt_tmp" rename to "beer_types"
[0m04:52:21.192406 [debug] [Thread-2 (]: Using postgres connection "model.my_project.food_pairing"
[0m04:52:21.193269 [debug] [Thread-3 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m04:52:21.199880 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_hops"
[0m04:52:21.201024 [debug] [Thread-2 (]: On model.my_project.food_pairing: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.food_pairing"} */
alter table "db"."dev_dev"."food_pairing__dbt_tmp" rename to "food_pairing"
[0m04:52:21.201798 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:52:21.202765 [debug] [Thread-4 (]: On model.my_project.top_hops: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_hops"} */
alter table "db"."dev_dev"."top_hops__dbt_tmp" rename to "top_hops"
[0m04:52:21.203411 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:52:21.210015 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m04:52:21.233397 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m04:52:21.239522 [debug] [Thread-1 (]: On model.my_project.beer_types: COMMIT
[0m04:52:21.242074 [debug] [Thread-3 (]: On model.my_project.staging: COMMIT
[0m04:52:21.244514 [debug] [Thread-2 (]: On model.my_project.food_pairing: COMMIT
[0m04:52:21.247233 [debug] [Thread-4 (]: On model.my_project.top_hops: COMMIT
[0m04:52:21.248115 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m04:52:21.248750 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m04:52:21.250087 [debug] [Thread-2 (]: Using postgres connection "model.my_project.food_pairing"
[0m04:52:21.251304 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_hops"
[0m04:52:21.252210 [debug] [Thread-1 (]: On model.my_project.beer_types: COMMIT
[0m04:52:21.252984 [debug] [Thread-3 (]: On model.my_project.staging: COMMIT
[0m04:52:21.253796 [debug] [Thread-2 (]: On model.my_project.food_pairing: COMMIT
[0m04:52:21.254761 [debug] [Thread-4 (]: On model.my_project.top_hops: COMMIT
[0m04:52:21.263181 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m04:52:21.272793 [debug] [Thread-2 (]: SQL status: COMMIT in 0.017 seconds
[0m04:52:21.277524 [debug] [Thread-1 (]: Applying DROP to: "db"."dev_dev"."beer_types__dbt_backup"
[0m04:52:21.278446 [debug] [Thread-3 (]: SQL status: COMMIT in 0.022 seconds
[0m04:52:21.279250 [debug] [Thread-4 (]: SQL status: COMMIT in 0.023 seconds
[0m04:52:21.282737 [debug] [Thread-2 (]: Applying DROP to: "db"."dev_dev"."food_pairing__dbt_backup"
[0m04:52:21.298146 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m04:52:21.307112 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m04:52:21.312234 [debug] [Thread-4 (]: Applying DROP to: "db"."dev_dev"."top_hops__dbt_backup"
[0m04:52:21.313563 [debug] [Thread-2 (]: Using postgres connection "model.my_project.food_pairing"
[0m04:52:21.314716 [debug] [Thread-1 (]: On model.my_project.beer_types: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_types"} */
drop table if exists "db"."dev_dev"."beer_types__dbt_backup" cascade
[0m04:52:21.316813 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m04:52:21.318056 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_hops"
[0m04:52:21.318749 [debug] [Thread-2 (]: On model.my_project.food_pairing: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.food_pairing"} */
drop table if exists "db"."dev_dev"."food_pairing__dbt_backup" cascade
[0m04:52:21.319643 [debug] [Thread-3 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m04:52:21.320239 [debug] [Thread-4 (]: On model.my_project.top_hops: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_hops"} */
drop table if exists "db"."dev_dev"."top_hops__dbt_backup" cascade
[0m04:52:21.328505 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.009 seconds
[0m04:52:21.332373 [debug] [Thread-1 (]: On model.my_project.beer_types: Close
[0m04:52:21.333490 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.012 seconds
[0m04:52:21.334145 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.013 seconds
[0m04:52:21.334901 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.014 seconds
[0m04:52:21.340097 [debug] [Thread-4 (]: On model.my_project.top_hops: Close
[0m04:52:21.342445 [debug] [Thread-3 (]: On model.my_project.staging: Close
[0m04:52:21.346852 [debug] [Thread-2 (]: On model.my_project.food_pairing: Close
[0m04:52:21.348169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01581029-fe36-4026-a82f-721bb563aaa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adf8baae600>]}
[0m04:52:21.349554 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01581029-fe36-4026-a82f-721bb563aaa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adf869723c0>]}
[0m04:52:21.350442 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01581029-fe36-4026-a82f-721bb563aaa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adf8695dee0>]}
[0m04:52:21.352970 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01581029-fe36-4026-a82f-721bb563aaa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adf880a95b0>]}
[0m04:52:21.351816 [info ] [Thread-1 (]: 1 of 10 OK created sql table model dev_dev.beer_types .......................... [[32mSELECT 414[0m in 0.49s]
[0m04:52:21.355381 [info ] [Thread-4 (]: 4 of 10 OK created sql table model dev_dev.top_hops ............................ [[32mSELECT 178[0m in 0.50s]
[0m04:52:21.357361 [info ] [Thread-3 (]: 3 of 10 OK created sql table model dev.staging ................................. [[32mSELECT 414[0m in 0.50s]
[0m04:52:21.358983 [info ] [Thread-2 (]: 2 of 10 OK created sql table model dev_dev.food_pairing ........................ [[32mSELECT 1149[0m in 0.50s]
[0m04:52:21.360863 [debug] [Thread-1 (]: Finished running node model.my_project.beer_types
[0m04:52:21.362762 [debug] [Thread-4 (]: Finished running node model.my_project.top_hops
[0m04:52:21.364213 [debug] [Thread-3 (]: Finished running node model.my_project.staging
[0m04:52:21.365348 [debug] [Thread-2 (]: Finished running node model.my_project.food_pairing
[0m04:52:21.366332 [debug] [Thread-1 (]: Began running node model.my_project.top_malts
[0m04:52:21.368115 [debug] [Thread-4 (]: Began running node model.my_project.abv_ibu
[0m04:52:21.369331 [debug] [Thread-3 (]: Began running node model.my_project.beer_released
[0m04:52:21.370746 [debug] [Thread-2 (]: Began running node model.my_project.type_by_year
[0m04:52:21.371907 [info ] [Thread-1 (]: 5 of 10 START sql table model dev_dev.top_malts ................................ [RUN]
[0m04:52:21.372882 [info ] [Thread-4 (]: 6 of 10 START sql table model dev_dev.abv_ibu .................................. [RUN]
[0m04:52:21.374053 [info ] [Thread-3 (]: 7 of 10 START sql table model dev_dev.beer_released ............................ [RUN]
[0m04:52:21.375278 [info ] [Thread-2 (]: 8 of 10 START sql table model dev_dev.type_by_year ............................. [RUN]
[0m04:52:21.376396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.beer_types, now model.my_project.top_malts)
[0m04:52:21.377214 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_project.top_hops, now model.my_project.abv_ibu)
[0m04:52:21.378037 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_project.staging, now model.my_project.beer_released)
[0m04:52:21.378671 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_project.food_pairing, now model.my_project.type_by_year)
[0m04:52:21.379425 [debug] [Thread-1 (]: Began compiling node model.my_project.top_malts
[0m04:52:21.380362 [debug] [Thread-4 (]: Began compiling node model.my_project.abv_ibu
[0m04:52:21.381136 [debug] [Thread-3 (]: Began compiling node model.my_project.beer_released
[0m04:52:21.381833 [debug] [Thread-2 (]: Began compiling node model.my_project.type_by_year
[0m04:52:21.388631 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.top_malts"
[0m04:52:21.393775 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.abv_ibu"
[0m04:52:21.398071 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.beer_released"
[0m04:52:21.403538 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_project.type_by_year"
[0m04:52:21.406706 [debug] [Thread-4 (]: Began executing node model.my_project.abv_ibu
[0m04:52:21.407543 [debug] [Thread-1 (]: Began executing node model.my_project.top_malts
[0m04:52:21.412423 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.abv_ibu"
[0m04:52:21.412970 [debug] [Thread-3 (]: Began executing node model.my_project.beer_released
[0m04:52:21.417273 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.top_malts"
[0m04:52:21.417952 [debug] [Thread-2 (]: Began executing node model.my_project.type_by_year
[0m04:52:21.424782 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.beer_released"
[0m04:52:21.426473 [debug] [Thread-4 (]: Using postgres connection "model.my_project.abv_ibu"
[0m04:52:21.431309 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_project.type_by_year"
[0m04:52:21.432412 [debug] [Thread-1 (]: Using postgres connection "model.my_project.top_malts"
[0m04:52:21.433098 [debug] [Thread-4 (]: On model.my_project.abv_ibu: BEGIN
[0m04:52:21.434120 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_released"
[0m04:52:21.434895 [debug] [Thread-1 (]: On model.my_project.top_malts: BEGIN
[0m04:52:21.435608 [debug] [Thread-2 (]: Using postgres connection "model.my_project.type_by_year"
[0m04:52:21.436220 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:52:21.436825 [debug] [Thread-3 (]: On model.my_project.beer_released: BEGIN
[0m04:52:21.437386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:52:21.438073 [debug] [Thread-2 (]: On model.my_project.type_by_year: BEGIN
[0m04:52:21.439166 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:52:21.440246 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:52:21.460870 [debug] [Thread-4 (]: SQL status: BEGIN in 0.024 seconds
[0m04:52:21.462149 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m04:52:21.463507 [debug] [Thread-3 (]: SQL status: BEGIN in 0.024 seconds
[0m04:52:21.464503 [debug] [Thread-2 (]: SQL status: BEGIN in 0.024 seconds
[0m04:52:21.465565 [debug] [Thread-4 (]: Using postgres connection "model.my_project.abv_ibu"
[0m04:52:21.466651 [debug] [Thread-1 (]: Using postgres connection "model.my_project.top_malts"
[0m04:52:21.467807 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_released"
[0m04:52:21.469180 [debug] [Thread-2 (]: Using postgres connection "model.my_project.type_by_year"
[0m04:52:21.470020 [debug] [Thread-4 (]: On model.my_project.abv_ibu: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.abv_ibu"} */

  
    

  create  table "db"."dev_dev"."abv_ibu__dbt_tmp"
  
  
    as
  
  (
    

select
    abv,
    ibu,
    type
from "db"."dev_dev"."beer_types"
where abv is not null and ibu is not null
  );
  
[0m04:52:21.471212 [debug] [Thread-1 (]: On model.my_project.top_malts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_malts"} */

  
    

  create  table "db"."dev_dev"."top_malts__dbt_tmp"
  
  
    as
  
  (
    

select
    malt_name,
    count(distinct beer_id) as beers_with_malt
from "db"."dev"."malt_ingredients"
where malt_name is not null
group by malt_name
order by beers_with_malt desc
  );
  
[0m04:52:21.472747 [debug] [Thread-3 (]: On model.my_project.beer_released: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_released"} */

  
    

  create  table "db"."dev_dev"."beer_released__dbt_tmp"
  
  
    as
  
  (
    

select
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4) as year,
    count(*) as beer_count
from "db"."dev_dev"."beer_types"
where
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4) ~ '^\d{4}$'
group by year
order by year
  );
  
[0m04:52:21.474662 [debug] [Thread-2 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */

  
    

  create  table "db"."dev_dev"."type_by_year__dbt_tmp"
  
  
    as
  
  (
    

select
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4) as year,
    type,
    count(*) as beer_count
from "db"."dev_dev"."beer_types"
where
    -- Only keep non-null, non-empty years and ensure first 4 chars are digits
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4) ~ '^\d{4}$'
group by
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4),
    type
order by
    year,
    type
  );
  
[0m04:52:21.485464 [debug] [Thread-4 (]: SQL status: SELECT 409 in 0.009 seconds
[0m04:52:21.486514 [debug] [Thread-3 (]: SQL status: SELECT 5 in 0.010 seconds
[0m04:52:21.487839 [debug] [Thread-2 (]: SQL status: SELECT 12 in 0.011 seconds
[0m04:52:21.508405 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_released"
[0m04:52:21.513513 [debug] [Thread-4 (]: Using postgres connection "model.my_project.abv_ibu"
[0m04:52:21.514535 [debug] [Thread-1 (]: SQL status: SELECT 133 in 0.038 seconds
[0m04:52:21.520610 [debug] [Thread-2 (]: Using postgres connection "model.my_project.type_by_year"
[0m04:52:21.521848 [debug] [Thread-3 (]: On model.my_project.beer_released: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_released"} */
alter table "db"."dev_dev"."beer_released" rename to "beer_released__dbt_backup"
[0m04:52:21.523147 [debug] [Thread-4 (]: On model.my_project.abv_ibu: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.abv_ibu"} */
alter table "db"."dev_dev"."abv_ibu" rename to "abv_ibu__dbt_backup"
[0m04:52:21.536533 [debug] [Thread-1 (]: Using postgres connection "model.my_project.top_malts"
[0m04:52:21.538616 [debug] [Thread-2 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */
alter table "db"."dev_dev"."type_by_year" rename to "type_by_year__dbt_backup"
[0m04:52:21.540964 [debug] [Thread-1 (]: On model.my_project.top_malts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_malts"} */
alter table "db"."dev_dev"."top_malts" rename to "top_malts__dbt_backup"
[0m04:52:21.542611 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m04:52:21.544705 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m04:52:21.548258 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m04:52:21.555851 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m04:52:21.577612 [debug] [Thread-2 (]: Using postgres connection "model.my_project.type_by_year"
[0m04:52:21.580985 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_released"
[0m04:52:21.589365 [debug] [Thread-4 (]: Using postgres connection "model.my_project.abv_ibu"
[0m04:52:21.598390 [debug] [Thread-1 (]: Using postgres connection "model.my_project.top_malts"
[0m04:52:21.599628 [debug] [Thread-2 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */
alter table "db"."dev_dev"."type_by_year__dbt_tmp" rename to "type_by_year"
[0m04:52:21.600599 [debug] [Thread-3 (]: On model.my_project.beer_released: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_released"} */
alter table "db"."dev_dev"."beer_released__dbt_tmp" rename to "beer_released"
[0m04:52:21.601581 [debug] [Thread-4 (]: On model.my_project.abv_ibu: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.abv_ibu"} */
alter table "db"."dev_dev"."abv_ibu__dbt_tmp" rename to "abv_ibu"
[0m04:52:21.602367 [debug] [Thread-1 (]: On model.my_project.top_malts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_malts"} */
alter table "db"."dev_dev"."top_malts__dbt_tmp" rename to "top_malts"
[0m04:52:21.604185 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:52:21.605005 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m04:52:21.605861 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m04:52:21.606834 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m04:52:21.611052 [debug] [Thread-4 (]: On model.my_project.abv_ibu: COMMIT
[0m04:52:21.615823 [debug] [Thread-3 (]: On model.my_project.beer_released: COMMIT
[0m04:52:21.619319 [debug] [Thread-2 (]: On model.my_project.type_by_year: COMMIT
[0m04:52:21.622527 [debug] [Thread-1 (]: On model.my_project.top_malts: COMMIT
[0m04:52:21.623704 [debug] [Thread-4 (]: Using postgres connection "model.my_project.abv_ibu"
[0m04:52:21.624585 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_released"
[0m04:52:21.625301 [debug] [Thread-2 (]: Using postgres connection "model.my_project.type_by_year"
[0m04:52:21.626093 [debug] [Thread-1 (]: Using postgres connection "model.my_project.top_malts"
[0m04:52:21.626967 [debug] [Thread-4 (]: On model.my_project.abv_ibu: COMMIT
[0m04:52:21.629727 [debug] [Thread-3 (]: On model.my_project.beer_released: COMMIT
[0m04:52:21.631265 [debug] [Thread-2 (]: On model.my_project.type_by_year: COMMIT
[0m04:52:21.632730 [debug] [Thread-1 (]: On model.my_project.top_malts: COMMIT
[0m04:52:21.641558 [debug] [Thread-4 (]: SQL status: COMMIT in 0.007 seconds
[0m04:52:21.645501 [debug] [Thread-4 (]: Applying DROP to: "db"."dev_dev"."abv_ibu__dbt_backup"
[0m04:52:21.646662 [debug] [Thread-4 (]: Using postgres connection "model.my_project.abv_ibu"
[0m04:52:21.647810 [debug] [Thread-2 (]: SQL status: COMMIT in 0.013 seconds
[0m04:52:21.648440 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m04:52:21.648972 [debug] [Thread-3 (]: SQL status: COMMIT in 0.015 seconds
[0m04:52:21.649497 [debug] [Thread-4 (]: On model.my_project.abv_ibu: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.abv_ibu"} */
drop table if exists "db"."dev_dev"."abv_ibu__dbt_backup" cascade
[0m04:52:21.652828 [debug] [Thread-2 (]: Applying DROP to: "db"."dev_dev"."type_by_year__dbt_backup"
[0m04:52:21.656192 [debug] [Thread-1 (]: Applying DROP to: "db"."dev_dev"."top_malts__dbt_backup"
[0m04:52:21.660750 [debug] [Thread-3 (]: Applying DROP to: "db"."dev_dev"."beer_released__dbt_backup"
[0m04:52:21.662360 [debug] [Thread-2 (]: Using postgres connection "model.my_project.type_by_year"
[0m04:52:21.663804 [debug] [Thread-1 (]: Using postgres connection "model.my_project.top_malts"
[0m04:52:21.664971 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_released"
[0m04:52:21.665686 [debug] [Thread-2 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */
drop table if exists "db"."dev_dev"."type_by_year__dbt_backup" cascade
[0m04:52:21.666342 [debug] [Thread-1 (]: On model.my_project.top_malts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_malts"} */
drop table if exists "db"."dev_dev"."top_malts__dbt_backup" cascade
[0m04:52:21.667126 [debug] [Thread-3 (]: On model.my_project.beer_released: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_released"} */
drop table if exists "db"."dev_dev"."beer_released__dbt_backup" cascade
[0m04:52:21.668126 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m04:52:21.670656 [debug] [Thread-4 (]: On model.my_project.abv_ibu: Close
[0m04:52:21.671773 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01581029-fe36-4026-a82f-721bb563aaa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adf87ef9d30>]}
[0m04:52:21.672860 [info ] [Thread-4 (]: 6 of 10 OK created sql table model dev_dev.abv_ibu ............................. [[32mSELECT 409[0m in 0.29s]
[0m04:52:21.674360 [debug] [Thread-4 (]: Finished running node model.my_project.abv_ibu
[0m04:52:21.675261 [debug] [Thread-4 (]: Began running node model.my_project.beer_report
[0m04:52:21.676254 [info ] [Thread-4 (]: 9 of 10 START sql table model dev.beer_report .................................. [RUN]
[0m04:52:21.677180 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_project.abv_ibu, now model.my_project.beer_report)
[0m04:52:21.677773 [debug] [Thread-4 (]: Began compiling node model.my_project.beer_report
[0m04:52:21.681716 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.beer_report"
[0m04:52:21.682517 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.015 seconds
[0m04:52:21.685820 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.014 seconds
[0m04:52:21.686518 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.019 seconds
[0m04:52:21.688979 [debug] [Thread-2 (]: On model.my_project.type_by_year: Close
[0m04:52:21.691420 [debug] [Thread-3 (]: On model.my_project.beer_released: Close
[0m04:52:21.693740 [debug] [Thread-1 (]: On model.my_project.top_malts: Close
[0m04:52:21.694265 [debug] [Thread-4 (]: Began executing node model.my_project.beer_report
[0m04:52:21.695408 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01581029-fe36-4026-a82f-721bb563aaa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adf67fbfa40>]}
[0m04:52:21.696133 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01581029-fe36-4026-a82f-721bb563aaa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adf67fbd3d0>]}
[0m04:52:21.702535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01581029-fe36-4026-a82f-721bb563aaa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adf67fa76e0>]}
[0m04:52:21.704413 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.beer_report"
[0m04:52:21.705418 [info ] [Thread-2 (]: 8 of 10 OK created sql table model dev_dev.type_by_year ........................ [[32mSELECT 12[0m in 0.32s]
[0m04:52:21.706795 [info ] [Thread-3 (]: 7 of 10 OK created sql table model dev_dev.beer_released ....................... [[32mSELECT 5[0m in 0.32s]
[0m04:52:21.708447 [info ] [Thread-1 (]: 5 of 10 OK created sql table model dev_dev.top_malts ........................... [[32mSELECT 133[0m in 0.33s]
[0m04:52:21.710318 [debug] [Thread-2 (]: Finished running node model.my_project.type_by_year
[0m04:52:21.711319 [debug] [Thread-4 (]: Using postgres connection "model.my_project.beer_report"
[0m04:52:21.712203 [debug] [Thread-3 (]: Finished running node model.my_project.beer_released
[0m04:52:21.713110 [debug] [Thread-1 (]: Finished running node model.my_project.top_malts
[0m04:52:21.713923 [debug] [Thread-2 (]: Began running node model.my_project.master_beer_table
[0m04:52:21.715164 [debug] [Thread-4 (]: On model.my_project.beer_report: BEGIN
[0m04:52:21.717566 [info ] [Thread-2 (]: 10 of 10 START sql table model dev.master_beer_table ........................... [RUN]
[0m04:52:21.719760 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:52:21.721462 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_project.type_by_year, now model.my_project.master_beer_table)
[0m04:52:21.723072 [debug] [Thread-2 (]: Began compiling node model.my_project.master_beer_table
[0m04:52:21.730278 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_project.master_beer_table"
[0m04:52:21.731742 [debug] [Thread-2 (]: Began executing node model.my_project.master_beer_table
[0m04:52:21.739736 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_project.master_beer_table"
[0m04:52:21.741370 [debug] [Thread-2 (]: Using postgres connection "model.my_project.master_beer_table"
[0m04:52:21.742436 [debug] [Thread-4 (]: SQL status: BEGIN in 0.023 seconds
[0m04:52:21.743488 [debug] [Thread-2 (]: On model.my_project.master_beer_table: BEGIN
[0m04:52:21.744406 [debug] [Thread-4 (]: Using postgres connection "model.my_project.beer_report"
[0m04:52:21.745086 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:52:21.745812 [debug] [Thread-4 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */

  
    

  create  table "db"."dev"."beer_report__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    count(*) as total_beers,
    round(avg(abv)::numeric, 2) as avg_abv,
    round(min(abv)::numeric, 2) as min_abv,
    round(max(abv)::numeric, 2) as max_abv,
    round(avg(ibu)::numeric, 2) as avg_ibu,
    round(min(ibu)::numeric, 2) as min_ibu,
    round(max(ibu)::numeric, 2) as max_ibu,
    round(avg(ebc)::numeric, 2) as avg_ebc,
    round(min(ebc)::numeric, 2) as min_ebc,
    round(max(ebc)::numeric, 2) as max_ebc,
    round(avg(ph)::numeric, 2) as avg_ph,
    min(first_brewed) as oldest_brew,
    max(first_brewed) as newest_brew,
    count(distinct contributed_by) as unique_contributors
from beers
  );
  
[0m04:52:21.756787 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.010 seconds
[0m04:52:21.764457 [debug] [Thread-4 (]: Using postgres connection "model.my_project.beer_report"
[0m04:52:21.765463 [debug] [Thread-4 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report" rename to "beer_report__dbt_backup"
[0m04:52:21.766502 [debug] [Thread-2 (]: SQL status: BEGIN in 0.021 seconds
[0m04:52:21.770024 [debug] [Thread-2 (]: Using postgres connection "model.my_project.master_beer_table"
[0m04:52:21.771266 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m04:52:21.773212 [debug] [Thread-2 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */

  
    

  create  table "db"."dev"."master_beer_table__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    beer_id,
    beer_name,
    tagline as category,         -- category/style approximation
    description,
    abv as alcohol_percent,
    first_brewed
from beers
  );
  
[0m04:52:21.778887 [debug] [Thread-4 (]: Using postgres connection "model.my_project.beer_report"
[0m04:52:21.780054 [debug] [Thread-4 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report__dbt_tmp" rename to "beer_report"
[0m04:52:21.781202 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:52:21.784384 [debug] [Thread-4 (]: On model.my_project.beer_report: COMMIT
[0m04:52:21.785964 [debug] [Thread-4 (]: Using postgres connection "model.my_project.beer_report"
[0m04:52:21.787530 [debug] [Thread-2 (]: SQL status: SELECT 414 in 0.007 seconds
[0m04:52:21.790179 [debug] [Thread-4 (]: On model.my_project.beer_report: COMMIT
[0m04:52:21.795223 [debug] [Thread-2 (]: Using postgres connection "model.my_project.master_beer_table"
[0m04:52:21.796202 [debug] [Thread-2 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */
alter table "db"."dev"."master_beer_table" rename to "master_beer_table__dbt_backup"
[0m04:52:21.797581 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:52:21.806829 [debug] [Thread-4 (]: SQL status: COMMIT in 0.010 seconds
[0m04:52:21.809640 [debug] [Thread-2 (]: Using postgres connection "model.my_project.master_beer_table"
[0m04:52:21.813956 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."beer_report__dbt_backup"
[0m04:52:21.814941 [debug] [Thread-2 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */
alter table "db"."dev"."master_beer_table__dbt_tmp" rename to "master_beer_table"
[0m04:52:21.816066 [debug] [Thread-4 (]: Using postgres connection "model.my_project.beer_report"
[0m04:52:21.817015 [debug] [Thread-4 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
drop table if exists "db"."dev"."beer_report__dbt_backup" cascade
[0m04:52:21.817706 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:52:21.821971 [debug] [Thread-2 (]: On model.my_project.master_beer_table: COMMIT
[0m04:52:21.822674 [debug] [Thread-2 (]: Using postgres connection "model.my_project.master_beer_table"
[0m04:52:21.823360 [debug] [Thread-2 (]: On model.my_project.master_beer_table: COMMIT
[0m04:52:21.825417 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.007 seconds
[0m04:52:21.828900 [debug] [Thread-4 (]: On model.my_project.beer_report: Close
[0m04:52:21.829866 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m04:52:21.834948 [debug] [Thread-2 (]: Applying DROP to: "db"."dev"."master_beer_table__dbt_backup"
[0m04:52:21.836134 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01581029-fe36-4026-a82f-721bb563aaa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adf86973410>]}
[0m04:52:21.837670 [debug] [Thread-2 (]: Using postgres connection "model.my_project.master_beer_table"
[0m04:52:21.838921 [info ] [Thread-4 (]: 9 of 10 OK created sql table model dev.beer_report ............................. [[32mSELECT 1[0m in 0.16s]
[0m04:52:21.840526 [debug] [Thread-2 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */
drop table if exists "db"."dev"."master_beer_table__dbt_backup" cascade
[0m04:52:21.841790 [debug] [Thread-4 (]: Finished running node model.my_project.beer_report
[0m04:52:21.851591 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.009 seconds
[0m04:52:21.854151 [debug] [Thread-2 (]: On model.my_project.master_beer_table: Close
[0m04:52:21.855165 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01581029-fe36-4026-a82f-721bb563aaa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adf67fbfb60>]}
[0m04:52:21.856045 [info ] [Thread-2 (]: 10 of 10 OK created sql table model dev.master_beer_table ...................... [[32mSELECT 414[0m in 0.13s]
[0m04:52:21.857283 [debug] [Thread-2 (]: Finished running node model.my_project.master_beer_table
[0m04:52:21.861567 [debug] [MainThread]: Using postgres connection "master"
[0m04:52:21.862664 [debug] [MainThread]: On master: BEGIN
[0m04:52:21.863614 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:52:21.879700 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m04:52:21.880533 [debug] [MainThread]: On master: COMMIT
[0m04:52:21.881416 [debug] [MainThread]: Using postgres connection "master"
[0m04:52:21.882247 [debug] [MainThread]: On master: COMMIT
[0m04:52:21.883457 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:52:21.884200 [debug] [MainThread]: On master: Close
[0m04:52:21.885313 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:52:21.885915 [debug] [MainThread]: Connection 'model.my_project.top_malts' was properly closed.
[0m04:52:21.886586 [debug] [MainThread]: Connection 'model.my_project.master_beer_table' was properly closed.
[0m04:52:21.887604 [debug] [MainThread]: Connection 'model.my_project.beer_released' was properly closed.
[0m04:52:21.888780 [debug] [MainThread]: Connection 'model.my_project.beer_report' was properly closed.
[0m04:52:21.889793 [info ] [MainThread]: 
[0m04:52:21.890908 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 1.32 seconds (1.32s).
[0m04:52:21.896941 [debug] [MainThread]: Command end result
[0m04:52:21.965763 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m04:52:21.968557 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m04:52:21.984453 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m04:52:21.985297 [info ] [MainThread]: 
[0m04:52:21.988000 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:52:21.989569 [info ] [MainThread]: 
[0m04:52:21.991433 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m04:52:21.994822 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.6689403, "process_in_blocks": "4048", "process_kernel_time": 1.089848, "process_mem_max_rss": "110728", "process_out_blocks": "3784", "process_user_time": 6.703977}
[0m04:52:21.995981 [debug] [MainThread]: Command `dbt run` succeeded at 04:52:21.995762 after 3.67 seconds
[0m04:52:21.996613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adf8a095760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adf8a6a06e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7adf8a6a02f0>]}
[0m04:52:21.997190 [debug] [MainThread]: Flushing usage events
[0m04:52:23.756945 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:52:29.851204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c24f3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c1fa2ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c3842180>]}


============================== 04:52:29.859644 | 9cb9911d-ee91-4c06-b91f-31413d8c8cff ==============================
[0m04:52:29.859644 [info ] [MainThread]: Running with dbt=1.9.0
[0m04:52:29.860468 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:52:30.178007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9cb9911d-ee91-4c06-b91f-31413d8c8cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c1d6fb30>]}
[0m04:52:30.259096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9cb9911d-ee91-4c06-b91f-31413d8c8cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c193fdd0>]}
[0m04:52:30.260645 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m04:52:30.437255 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m04:52:30.650960 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:52:30.651673 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:52:30.736273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9cb9911d-ee91-4c06-b91f-31413d8c8cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c013cbf0>]}
[0m04:52:30.916488 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m04:52:30.920261 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m04:52:32.056077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9cb9911d-ee91-4c06-b91f-31413d8c8cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9bfe825d0>]}
[0m04:52:32.057537 [info ] [MainThread]: Found 10 models, 6 data tests, 5 sources, 429 macros
[0m04:52:32.058614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cb9911d-ee91-4c06-b91f-31413d8c8cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c0120bc0>]}
[0m04:52:32.062574 [info ] [MainThread]: 
[0m04:52:32.063372 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:52:32.063992 [info ] [MainThread]: 
[0m04:52:32.065078 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:52:32.072422 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m04:52:32.073570 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m04:52:32.149289 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m04:52:32.149969 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m04:52:32.150591 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m04:52:32.151239 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m04:52:32.151844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:52:32.152429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:52:32.404778 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.253 seconds
[0m04:52:32.407749 [debug] [ThreadPool]: On list_db: Close
[0m04:52:32.517065 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.364 seconds
[0m04:52:32.519618 [debug] [ThreadPool]: On list_db: Close
[0m04:52:32.523362 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev_dev)
[0m04:52:32.524435 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m04:52:32.533401 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m04:52:32.535908 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m04:52:32.536716 [debug] [ThreadPool]: On list_db_dev_dev: BEGIN
[0m04:52:32.537586 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m04:52:32.538383 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:52:32.539027 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:52:32.554508 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m04:52:32.555552 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m04:52:32.556402 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m04:52:32.557925 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m04:52:32.558700 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m04:52:32.559522 [debug] [ThreadPool]: On list_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_dev'
  
[0m04:52:32.563132 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.006 seconds
[0m04:52:32.565677 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m04:52:32.566696 [debug] [ThreadPool]: On list_db_dev: Close
[0m04:52:32.572064 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.012 seconds
[0m04:52:32.576268 [debug] [ThreadPool]: On list_db_dev_dev: ROLLBACK
[0m04:52:32.578083 [debug] [ThreadPool]: On list_db_dev_dev: Close
[0m04:52:32.591043 [debug] [MainThread]: Using postgres connection "master"
[0m04:52:32.591805 [debug] [MainThread]: On master: BEGIN
[0m04:52:32.592301 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:52:32.605169 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m04:52:32.606106 [debug] [MainThread]: Using postgres connection "master"
[0m04:52:32.607787 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:52:32.614334 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m04:52:32.616641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cb9911d-ee91-4c06-b91f-31413d8c8cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9bfd0fd70>]}
[0m04:52:32.617948 [debug] [MainThread]: On master: ROLLBACK
[0m04:52:32.619019 [debug] [MainThread]: Using postgres connection "master"
[0m04:52:32.619641 [debug] [MainThread]: On master: BEGIN
[0m04:52:32.620815 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m04:52:32.621764 [debug] [MainThread]: On master: COMMIT
[0m04:52:32.622650 [debug] [MainThread]: Using postgres connection "master"
[0m04:52:32.623412 [debug] [MainThread]: On master: COMMIT
[0m04:52:32.625507 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m04:52:32.626234 [debug] [MainThread]: On master: Close
[0m04:52:32.631492 [debug] [Thread-1 (]: Began running node model.my_project.beer_types
[0m04:52:32.632476 [debug] [Thread-2 (]: Began running node model.my_project.food_pairing
[0m04:52:32.634621 [debug] [Thread-3 (]: Began running node model.my_project.staging
[0m04:52:32.633604 [info ] [Thread-1 (]: 1 of 10 START sql table model dev_dev.beer_types ............................... [RUN]
[0m04:52:32.636091 [debug] [Thread-4 (]: Began running node model.my_project.top_hops
[0m04:52:32.637416 [info ] [Thread-2 (]: 2 of 10 START sql table model dev_dev.food_pairing ............................. [RUN]
[0m04:52:32.639719 [info ] [Thread-3 (]: 3 of 10 START sql table model dev.staging ...................................... [RUN]
[0m04:52:32.641745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev_dev, now model.my_project.beer_types)
[0m04:52:32.644109 [info ] [Thread-4 (]: 4 of 10 START sql table model dev_dev.top_hops ................................. [RUN]
[0m04:52:32.646836 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.food_pairing)
[0m04:52:32.647971 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.staging'
[0m04:52:32.648689 [debug] [Thread-1 (]: Began compiling node model.my_project.beer_types
[0m04:52:32.649673 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.top_hops'
[0m04:52:32.650341 [debug] [Thread-2 (]: Began compiling node model.my_project.food_pairing
[0m04:52:32.650981 [debug] [Thread-3 (]: Began compiling node model.my_project.staging
[0m04:52:32.662638 [debug] [Thread-4 (]: Began compiling node model.my_project.top_hops
[0m04:52:32.666361 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.beer_types"
[0m04:52:32.670709 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_project.food_pairing"
[0m04:52:32.676143 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.staging"
[0m04:52:32.680553 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.top_hops"
[0m04:52:32.682741 [debug] [Thread-2 (]: Began executing node model.my_project.food_pairing
[0m04:52:32.683420 [debug] [Thread-1 (]: Began executing node model.my_project.beer_types
[0m04:52:32.684549 [debug] [Thread-3 (]: Began executing node model.my_project.staging
[0m04:52:32.691002 [debug] [Thread-4 (]: Began executing node model.my_project.top_hops
[0m04:52:32.823398 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.beer_types"
[0m04:52:32.840029 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_project.food_pairing"
[0m04:52:32.845096 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.staging"
[0m04:52:32.846507 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.top_hops"
[0m04:52:32.848499 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m04:52:32.850756 [debug] [Thread-2 (]: Using postgres connection "model.my_project.food_pairing"
[0m04:52:32.851793 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m04:52:32.852747 [debug] [Thread-1 (]: On model.my_project.beer_types: BEGIN
[0m04:52:32.853728 [debug] [Thread-2 (]: On model.my_project.food_pairing: BEGIN
[0m04:52:32.854644 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_hops"
[0m04:52:32.855293 [debug] [Thread-3 (]: On model.my_project.staging: BEGIN
[0m04:52:32.855930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:52:32.856568 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:52:32.857225 [debug] [Thread-4 (]: On model.my_project.top_hops: BEGIN
[0m04:52:32.857913 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m04:52:32.859289 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m04:52:32.889554 [debug] [Thread-3 (]: SQL status: BEGIN in 0.031 seconds
[0m04:52:32.890808 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m04:52:32.891942 [debug] [Thread-3 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * 
    from "db"."dev"."raw_beer_data"
)

select 
    id,
    beer_id,
    name as beer_name,
    tagline,
    first_brewed,
    description,
    image,
    abv,
    ibu,
    ebc,
    ph,
    brewers_tips,
    contributed_by,
    inserted_at
from source
  );
  
[0m04:52:32.904549 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m04:52:32.905815 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m04:52:32.906844 [debug] [Thread-1 (]: On model.my_project.beer_types: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_types"} */

  
    

  create  table "db"."dev_dev"."beer_types__dbt_tmp"
  
  
    as
  
  (
    

select
    beer_id,
    name,
    tagline,
    first_brewed,
    abv,
    ibu,
    ebc,
    ph,
    case
        when lower(tagline) like '%lager%' then 'Lager'
        when lower(tagline) like '%pilsner%' then 'Lager'
        when lower(tagline) like '%ipa%' then 'Ale'
        when lower(tagline) like '%stout%' then 'Ale'
        when lower(tagline) like '%porter%' then 'Ale'
        when lower(tagline) like '%ale%' then 'Ale'
        when lower(tagline) like '%wheat%' then 'Ale'
        else 'Other'
    end as type
from "db"."dev"."raw_beer_data"
  );
  
[0m04:52:32.918414 [debug] [Thread-3 (]: SQL status: SELECT 414 in 0.025 seconds
[0m04:52:32.932481 [debug] [Thread-2 (]: SQL status: BEGIN in 0.076 seconds
[0m04:52:32.950311 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.042 seconds
[0m04:52:32.955201 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m04:52:32.956093 [debug] [Thread-2 (]: Using postgres connection "model.my_project.food_pairing"
[0m04:52:32.963500 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m04:52:32.965165 [debug] [Thread-4 (]: SQL status: BEGIN in 0.106 seconds
[0m04:52:32.966772 [debug] [Thread-3 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m04:52:32.968034 [debug] [Thread-2 (]: On model.my_project.food_pairing: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.food_pairing"} */

  
    

  create  table "db"."dev_dev"."food_pairing__dbt_tmp"
  
  
    as
  
  (
    

select
    pairing,
    count(*) as pairing_count
from "db"."dev"."food_pairings"
where pairing is not null
group by pairing
order by pairing_count desc
  );
  
[0m04:52:32.969165 [debug] [Thread-1 (]: On model.my_project.beer_types: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_types"} */
alter table "db"."dev_dev"."beer_types" rename to "beer_types__dbt_backup"
[0m04:52:32.970223 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_hops"
[0m04:52:32.972237 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:52:32.973591 [debug] [Thread-4 (]: On model.my_project.top_hops: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_hops"} */

  
    

  create  table "db"."dev_dev"."top_hops__dbt_tmp"
  
  
    as
  
  (
    

select
    hop_name,
    count(distinct beer_id) as beers_with_hop
from "db"."dev"."hop_ingredients"
where hop_name is not null
group by hop_name
order by beers_with_hop desc
  );
  
[0m04:52:32.975137 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m04:52:32.984108 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m04:52:32.990783 [debug] [Thread-2 (]: SQL status: SELECT 1149 in 0.019 seconds
[0m04:52:32.993568 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m04:52:32.994977 [debug] [Thread-3 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m04:52:33.007665 [debug] [Thread-2 (]: Using postgres connection "model.my_project.food_pairing"
[0m04:52:33.008400 [debug] [Thread-1 (]: On model.my_project.beer_types: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_types"} */
alter table "db"."dev_dev"."beer_types__dbt_tmp" rename to "beer_types"
[0m04:52:33.009443 [debug] [Thread-2 (]: On model.my_project.food_pairing: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.food_pairing"} */
alter table "db"."dev_dev"."food_pairing" rename to "food_pairing__dbt_backup"
[0m04:52:33.010376 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:52:33.017144 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m04:52:33.023341 [debug] [Thread-4 (]: SQL status: SELECT 178 in 0.038 seconds
[0m04:52:33.044697 [debug] [Thread-2 (]: Using postgres connection "model.my_project.food_pairing"
[0m04:52:33.054962 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.044 seconds
[0m04:52:33.063864 [debug] [Thread-3 (]: On model.my_project.staging: COMMIT
[0m04:52:33.071541 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_hops"
[0m04:52:33.072448 [debug] [Thread-2 (]: On model.my_project.food_pairing: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.food_pairing"} */
alter table "db"."dev_dev"."food_pairing__dbt_tmp" rename to "food_pairing"
[0m04:52:33.075019 [debug] [Thread-1 (]: On model.my_project.beer_types: COMMIT
[0m04:52:33.075758 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m04:52:33.076391 [debug] [Thread-4 (]: On model.my_project.top_hops: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_hops"} */
alter table "db"."dev_dev"."top_hops" rename to "top_hops__dbt_backup"
[0m04:52:33.077379 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m04:52:33.078094 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:52:33.078644 [debug] [Thread-3 (]: On model.my_project.staging: COMMIT
[0m04:52:33.079420 [debug] [Thread-1 (]: On model.my_project.beer_types: COMMIT
[0m04:52:33.080004 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:52:33.083047 [debug] [Thread-2 (]: On model.my_project.food_pairing: COMMIT
[0m04:52:33.088227 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_hops"
[0m04:52:33.089020 [debug] [Thread-2 (]: Using postgres connection "model.my_project.food_pairing"
[0m04:52:33.089673 [debug] [Thread-4 (]: On model.my_project.top_hops: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_hops"} */
alter table "db"."dev_dev"."top_hops__dbt_tmp" rename to "top_hops"
[0m04:52:33.090345 [debug] [Thread-2 (]: On model.my_project.food_pairing: COMMIT
[0m04:52:33.091521 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:52:33.093851 [debug] [Thread-4 (]: On model.my_project.top_hops: COMMIT
[0m04:52:33.094370 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_hops"
[0m04:52:33.094849 [debug] [Thread-4 (]: On model.my_project.top_hops: COMMIT
[0m04:52:33.460585 [debug] [Thread-2 (]: SQL status: COMMIT in 0.368 seconds
[0m04:52:33.463596 [debug] [Thread-4 (]: SQL status: COMMIT in 0.368 seconds
[0m04:52:33.466392 [debug] [Thread-3 (]: SQL status: COMMIT in 0.382 seconds
[0m04:52:33.469607 [debug] [Thread-1 (]: SQL status: COMMIT in 0.384 seconds
[0m04:52:33.514851 [debug] [Thread-4 (]: Applying DROP to: "db"."dev_dev"."top_hops__dbt_backup"
[0m04:52:33.516352 [debug] [Thread-2 (]: Applying DROP to: "db"."dev_dev"."food_pairing__dbt_backup"
[0m04:52:33.523119 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m04:52:33.531646 [debug] [Thread-1 (]: Applying DROP to: "db"."dev_dev"."beer_types__dbt_backup"
[0m04:52:33.552679 [debug] [Thread-2 (]: Using postgres connection "model.my_project.food_pairing"
[0m04:52:33.554497 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_hops"
[0m04:52:33.556332 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m04:52:33.558315 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m04:52:33.559758 [debug] [Thread-2 (]: On model.my_project.food_pairing: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.food_pairing"} */
drop table if exists "db"."dev_dev"."food_pairing__dbt_backup" cascade
[0m04:52:33.560862 [debug] [Thread-4 (]: On model.my_project.top_hops: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_hops"} */
drop table if exists "db"."dev_dev"."top_hops__dbt_backup" cascade
[0m04:52:33.562142 [debug] [Thread-3 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m04:52:33.563398 [debug] [Thread-1 (]: On model.my_project.beer_types: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_types"} */
drop table if exists "db"."dev_dev"."beer_types__dbt_backup" cascade
[0m04:52:33.779885 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.215 seconds
[0m04:52:33.784999 [debug] [Thread-4 (]: On model.my_project.top_hops: Close
[0m04:52:33.788107 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cb9911d-ee91-4c06-b91f-31413d8c8cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c24f2600>]}
[0m04:52:33.790203 [info ] [Thread-4 (]: 4 of 10 OK created sql table model dev_dev.top_hops ............................ [[32mSELECT 178[0m in 1.14s]
[0m04:52:33.791652 [debug] [Thread-4 (]: Finished running node model.my_project.top_hops
[0m04:52:33.792624 [debug] [Thread-4 (]: Began running node model.my_project.top_malts
[0m04:52:33.794031 [info ] [Thread-4 (]: 5 of 10 START sql table model dev_dev.top_malts ................................ [RUN]
[0m04:52:33.797705 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_project.top_hops, now model.my_project.top_malts)
[0m04:52:33.799213 [debug] [Thread-4 (]: Began compiling node model.my_project.top_malts
[0m04:52:33.806311 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.top_malts"
[0m04:52:33.808039 [debug] [Thread-4 (]: Began executing node model.my_project.top_malts
[0m04:52:33.820720 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.top_malts"
[0m04:52:33.822607 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_malts"
[0m04:52:33.823797 [debug] [Thread-4 (]: On model.my_project.top_malts: BEGIN
[0m04:52:33.824830 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:52:33.846272 [debug] [Thread-4 (]: SQL status: BEGIN in 0.021 seconds
[0m04:52:33.847678 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_malts"
[0m04:52:33.848454 [debug] [Thread-4 (]: On model.my_project.top_malts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_malts"} */

  
    

  create  table "db"."dev_dev"."top_malts__dbt_tmp"
  
  
    as
  
  (
    

select
    malt_name,
    count(distinct beer_id) as beers_with_malt
from "db"."dev"."malt_ingredients"
where malt_name is not null
group by malt_name
order by beers_with_malt desc
  );
  
[0m04:52:33.882123 [debug] [Thread-4 (]: SQL status: SELECT 133 in 0.033 seconds
[0m04:52:33.889308 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_malts"
[0m04:52:33.890254 [debug] [Thread-4 (]: On model.my_project.top_malts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_malts"} */
alter table "db"."dev_dev"."top_malts" rename to "top_malts__dbt_backup"
[0m04:52:33.892282 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:52:33.899850 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_malts"
[0m04:52:33.901200 [debug] [Thread-4 (]: On model.my_project.top_malts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_malts"} */
alter table "db"."dev_dev"."top_malts__dbt_tmp" rename to "top_malts"
[0m04:52:33.902552 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:52:33.906640 [debug] [Thread-4 (]: On model.my_project.top_malts: COMMIT
[0m04:52:33.908818 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_malts"
[0m04:52:33.910589 [debug] [Thread-4 (]: On model.my_project.top_malts: COMMIT
[0m04:52:34.037643 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.472 seconds
[0m04:52:34.038510 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.474 seconds
[0m04:52:34.039156 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.475 seconds
[0m04:52:34.041724 [debug] [Thread-1 (]: On model.my_project.beer_types: Close
[0m04:52:34.043864 [debug] [Thread-3 (]: On model.my_project.staging: Close
[0m04:52:34.046056 [debug] [Thread-2 (]: On model.my_project.food_pairing: Close
[0m04:52:34.047388 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cb9911d-ee91-4c06-b91f-31413d8c8cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9be8c0680>]}
[0m04:52:34.048503 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cb9911d-ee91-4c06-b91f-31413d8c8cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9be9aba40>]}
[0m04:52:34.050219 [info ] [Thread-1 (]: 1 of 10 OK created sql table model dev_dev.beer_types .......................... [[32mSELECT 414[0m in 1.41s]
[0m04:52:34.051450 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cb9911d-ee91-4c06-b91f-31413d8c8cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c196b260>]}
[0m04:52:34.052656 [info ] [Thread-3 (]: 3 of 10 OK created sql table model dev.staging ................................. [[32mSELECT 414[0m in 1.40s]
[0m04:52:34.053878 [debug] [Thread-1 (]: Finished running node model.my_project.beer_types
[0m04:52:34.054824 [info ] [Thread-2 (]: 2 of 10 OK created sql table model dev_dev.food_pairing ........................ [[32mSELECT 1149[0m in 1.41s]
[0m04:52:34.056176 [debug] [Thread-3 (]: Finished running node model.my_project.staging
[0m04:52:34.058049 [debug] [Thread-2 (]: Finished running node model.my_project.food_pairing
[0m04:52:34.058728 [debug] [Thread-1 (]: Began running node model.my_project.abv_ibu
[0m04:52:34.059469 [debug] [Thread-3 (]: Began running node model.my_project.beer_released
[0m04:52:34.060531 [debug] [Thread-2 (]: Began running node model.my_project.type_by_year
[0m04:52:34.061641 [info ] [Thread-1 (]: 6 of 10 START sql table model dev_dev.abv_ibu .................................. [RUN]
[0m04:52:34.062562 [info ] [Thread-3 (]: 7 of 10 START sql table model dev_dev.beer_released ............................ [RUN]
[0m04:52:34.063730 [info ] [Thread-2 (]: 8 of 10 START sql table model dev_dev.type_by_year ............................. [RUN]
[0m04:52:34.064963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.beer_types, now model.my_project.abv_ibu)
[0m04:52:34.065858 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_project.staging, now model.my_project.beer_released)
[0m04:52:34.066668 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_project.food_pairing, now model.my_project.type_by_year)
[0m04:52:34.067575 [debug] [Thread-1 (]: Began compiling node model.my_project.abv_ibu
[0m04:52:34.068321 [debug] [Thread-3 (]: Began compiling node model.my_project.beer_released
[0m04:52:34.069141 [debug] [Thread-2 (]: Began compiling node model.my_project.type_by_year
[0m04:52:34.073428 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.abv_ibu"
[0m04:52:34.077270 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.beer_released"
[0m04:52:34.081229 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_project.type_by_year"
[0m04:52:34.082992 [debug] [Thread-1 (]: Began executing node model.my_project.abv_ibu
[0m04:52:34.089967 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.abv_ibu"
[0m04:52:34.090887 [debug] [Thread-3 (]: Began executing node model.my_project.beer_released
[0m04:52:34.092102 [debug] [Thread-2 (]: Began executing node model.my_project.type_by_year
[0m04:52:34.098638 [debug] [Thread-1 (]: Using postgres connection "model.my_project.abv_ibu"
[0m04:52:34.097758 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.beer_released"
[0m04:52:34.105348 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_project.type_by_year"
[0m04:52:34.106106 [debug] [Thread-1 (]: On model.my_project.abv_ibu: BEGIN
[0m04:52:34.107509 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_released"
[0m04:52:34.108193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:52:34.108996 [debug] [Thread-2 (]: Using postgres connection "model.my_project.type_by_year"
[0m04:52:34.109646 [debug] [Thread-3 (]: On model.my_project.beer_released: BEGIN
[0m04:52:34.110795 [debug] [Thread-2 (]: On model.my_project.type_by_year: BEGIN
[0m04:52:34.111834 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:52:34.112864 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:52:34.123870 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m04:52:34.124944 [debug] [Thread-1 (]: Using postgres connection "model.my_project.abv_ibu"
[0m04:52:34.126025 [debug] [Thread-1 (]: On model.my_project.abv_ibu: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.abv_ibu"} */

  
    

  create  table "db"."dev_dev"."abv_ibu__dbt_tmp"
  
  
    as
  
  (
    

select
    abv,
    ibu,
    type
from "db"."dev_dev"."beer_types"
where abv is not null and ibu is not null
  );
  
[0m04:52:34.126952 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m04:52:34.129733 [debug] [Thread-2 (]: Using postgres connection "model.my_project.type_by_year"
[0m04:52:34.131015 [debug] [Thread-2 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */

  
    

  create  table "db"."dev_dev"."type_by_year__dbt_tmp"
  
  
    as
  
  (
    

select
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4) as year,
    type,
    count(*) as beer_count
from "db"."dev_dev"."beer_types"
where
    -- Only keep non-null, non-empty years and ensure first 4 chars are digits
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4) ~ '^\d{4}$'
group by
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4),
    type
order by
    year,
    type
  );
  
[0m04:52:34.128199 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m04:52:34.132041 [debug] [Thread-1 (]: SQL status: SELECT 409 in 0.004 seconds
[0m04:52:34.133231 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_released"
[0m04:52:34.139501 [debug] [Thread-2 (]: SQL status: SELECT 12 in 0.008 seconds
[0m04:52:34.141166 [debug] [Thread-1 (]: Using postgres connection "model.my_project.abv_ibu"
[0m04:52:34.142080 [debug] [Thread-3 (]: On model.my_project.beer_released: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_released"} */

  
    

  create  table "db"."dev_dev"."beer_released__dbt_tmp"
  
  
    as
  
  (
    

select
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4) as year,
    count(*) as beer_count
from "db"."dev_dev"."beer_types"
where
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4) ~ '^\d{4}$'
group by year
order by year
  );
  
[0m04:52:34.146978 [debug] [Thread-2 (]: Using postgres connection "model.my_project.type_by_year"
[0m04:52:34.147899 [debug] [Thread-1 (]: On model.my_project.abv_ibu: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.abv_ibu"} */
alter table "db"."dev_dev"."abv_ibu" rename to "abv_ibu__dbt_backup"
[0m04:52:34.148954 [debug] [Thread-2 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */
alter table "db"."dev_dev"."type_by_year" rename to "type_by_year__dbt_backup"
[0m04:52:34.150537 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:52:34.151327 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:52:34.158671 [debug] [Thread-1 (]: Using postgres connection "model.my_project.abv_ibu"
[0m04:52:34.159662 [debug] [Thread-3 (]: SQL status: SELECT 5 in 0.011 seconds
[0m04:52:34.164335 [debug] [Thread-2 (]: Using postgres connection "model.my_project.type_by_year"
[0m04:52:34.165171 [debug] [Thread-1 (]: On model.my_project.abv_ibu: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.abv_ibu"} */
alter table "db"."dev_dev"."abv_ibu__dbt_tmp" rename to "abv_ibu"
[0m04:52:34.172231 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_released"
[0m04:52:34.173377 [debug] [Thread-4 (]: SQL status: COMMIT in 0.262 seconds
[0m04:52:34.174091 [debug] [Thread-2 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */
alter table "db"."dev_dev"."type_by_year__dbt_tmp" rename to "type_by_year"
[0m04:52:34.175014 [debug] [Thread-3 (]: On model.my_project.beer_released: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_released"} */
alter table "db"."dev_dev"."beer_released" rename to "beer_released__dbt_backup"
[0m04:52:34.175725 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:52:34.179075 [debug] [Thread-4 (]: Applying DROP to: "db"."dev_dev"."top_malts__dbt_backup"
[0m04:52:34.182651 [debug] [Thread-1 (]: On model.my_project.abv_ibu: COMMIT
[0m04:52:34.183566 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m04:52:34.184233 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m04:52:34.185984 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_malts"
[0m04:52:34.187626 [debug] [Thread-1 (]: Using postgres connection "model.my_project.abv_ibu"
[0m04:52:34.192259 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_released"
[0m04:52:34.195377 [debug] [Thread-2 (]: On model.my_project.type_by_year: COMMIT
[0m04:52:34.196151 [debug] [Thread-4 (]: On model.my_project.top_malts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_malts"} */
drop table if exists "db"."dev_dev"."top_malts__dbt_backup" cascade
[0m04:52:34.197008 [debug] [Thread-1 (]: On model.my_project.abv_ibu: COMMIT
[0m04:52:34.198049 [debug] [Thread-3 (]: On model.my_project.beer_released: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_released"} */
alter table "db"."dev_dev"."beer_released__dbt_tmp" rename to "beer_released"
[0m04:52:34.198867 [debug] [Thread-2 (]: Using postgres connection "model.my_project.type_by_year"
[0m04:52:34.200206 [debug] [Thread-2 (]: On model.my_project.type_by_year: COMMIT
[0m04:52:34.201092 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:52:34.204866 [debug] [Thread-3 (]: On model.my_project.beer_released: COMMIT
[0m04:52:34.205570 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_released"
[0m04:52:34.206079 [debug] [Thread-3 (]: On model.my_project.beer_released: COMMIT
[0m04:52:34.453587 [debug] [Thread-1 (]: SQL status: COMMIT in 0.253 seconds
[0m04:52:34.464407 [debug] [Thread-3 (]: SQL status: COMMIT in 0.257 seconds
[0m04:52:34.468650 [debug] [Thread-1 (]: Applying DROP to: "db"."dev_dev"."abv_ibu__dbt_backup"
[0m04:52:34.470509 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.271 seconds
[0m04:52:34.471775 [debug] [Thread-2 (]: SQL status: COMMIT in 0.270 seconds
[0m04:52:34.478423 [debug] [Thread-3 (]: Applying DROP to: "db"."dev_dev"."beer_released__dbt_backup"
[0m04:52:34.480678 [debug] [Thread-1 (]: Using postgres connection "model.my_project.abv_ibu"
[0m04:52:34.483529 [debug] [Thread-4 (]: On model.my_project.top_malts: Close
[0m04:52:34.488038 [debug] [Thread-2 (]: Applying DROP to: "db"."dev_dev"."type_by_year__dbt_backup"
[0m04:52:34.489666 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_released"
[0m04:52:34.490458 [debug] [Thread-1 (]: On model.my_project.abv_ibu: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.abv_ibu"} */
drop table if exists "db"."dev_dev"."abv_ibu__dbt_backup" cascade
[0m04:52:34.492655 [debug] [Thread-2 (]: Using postgres connection "model.my_project.type_by_year"
[0m04:52:34.493932 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cb9911d-ee91-4c06-b91f-31413d8c8cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9bc791100>]}
[0m04:52:34.495368 [debug] [Thread-3 (]: On model.my_project.beer_released: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_released"} */
drop table if exists "db"."dev_dev"."beer_released__dbt_backup" cascade
[0m04:52:34.496610 [debug] [Thread-2 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */
drop table if exists "db"."dev_dev"."type_by_year__dbt_backup" cascade
[0m04:52:34.498087 [info ] [Thread-4 (]: 5 of 10 OK created sql table model dev_dev.top_malts ........................... [[32mSELECT 133[0m in 0.70s]
[0m04:52:34.500178 [debug] [Thread-4 (]: Finished running node model.my_project.top_malts
[0m04:52:34.501005 [debug] [Thread-4 (]: Began running node model.my_project.beer_report
[0m04:52:34.501991 [info ] [Thread-4 (]: 9 of 10 START sql table model dev.beer_report .................................. [RUN]
[0m04:52:34.502986 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_project.top_malts, now model.my_project.beer_report)
[0m04:52:34.503918 [debug] [Thread-4 (]: Began compiling node model.my_project.beer_report
[0m04:52:34.510800 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.beer_report"
[0m04:52:34.512092 [debug] [Thread-4 (]: Began executing node model.my_project.beer_report
[0m04:52:34.516716 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.beer_report"
[0m04:52:34.517650 [debug] [Thread-4 (]: Using postgres connection "model.my_project.beer_report"
[0m04:52:34.518155 [debug] [Thread-4 (]: On model.my_project.beer_report: BEGIN
[0m04:52:34.518621 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:52:34.531200 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m04:52:34.532112 [debug] [Thread-4 (]: Using postgres connection "model.my_project.beer_report"
[0m04:52:34.532757 [debug] [Thread-4 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */

  
    

  create  table "db"."dev"."beer_report__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    count(*) as total_beers,
    round(avg(abv)::numeric, 2) as avg_abv,
    round(min(abv)::numeric, 2) as min_abv,
    round(max(abv)::numeric, 2) as max_abv,
    round(avg(ibu)::numeric, 2) as avg_ibu,
    round(min(ibu)::numeric, 2) as min_ibu,
    round(max(ibu)::numeric, 2) as max_ibu,
    round(avg(ebc)::numeric, 2) as avg_ebc,
    round(min(ebc)::numeric, 2) as min_ebc,
    round(max(ebc)::numeric, 2) as max_ebc,
    round(avg(ph)::numeric, 2) as avg_ph,
    min(first_brewed) as oldest_brew,
    max(first_brewed) as newest_brew,
    count(distinct contributed_by) as unique_contributors
from beers
  );
  
[0m04:52:34.537708 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m04:52:34.542114 [debug] [Thread-4 (]: Using postgres connection "model.my_project.beer_report"
[0m04:52:34.543248 [debug] [Thread-4 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report" rename to "beer_report__dbt_backup"
[0m04:52:34.544569 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:52:34.548727 [debug] [Thread-4 (]: Using postgres connection "model.my_project.beer_report"
[0m04:52:34.549324 [debug] [Thread-4 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report__dbt_tmp" rename to "beer_report"
[0m04:52:34.550386 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:52:34.552477 [debug] [Thread-4 (]: On model.my_project.beer_report: COMMIT
[0m04:52:34.553087 [debug] [Thread-4 (]: Using postgres connection "model.my_project.beer_report"
[0m04:52:34.553576 [debug] [Thread-4 (]: On model.my_project.beer_report: COMMIT
[0m04:52:35.233490 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.737 seconds
[0m04:52:35.237169 [debug] [Thread-1 (]: On model.my_project.abv_ibu: Close
[0m04:52:35.238284 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.739 seconds
[0m04:52:35.239633 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.740 seconds
[0m04:52:35.240868 [debug] [Thread-4 (]: SQL status: COMMIT in 0.686 seconds
[0m04:52:35.245357 [debug] [Thread-2 (]: On model.my_project.type_by_year: Close
[0m04:52:35.246720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cb9911d-ee91-4c06-b91f-31413d8c8cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9bc7d4a10>]}
[0m04:52:35.251046 [debug] [Thread-3 (]: On model.my_project.beer_released: Close
[0m04:52:35.257207 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."beer_report__dbt_backup"
[0m04:52:35.258741 [info ] [Thread-1 (]: 6 of 10 OK created sql table model dev_dev.abv_ibu ............................. [[32mSELECT 409[0m in 1.18s]
[0m04:52:35.259981 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cb9911d-ee91-4c06-b91f-31413d8c8cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9bc751550>]}
[0m04:52:35.261959 [debug] [Thread-4 (]: Using postgres connection "model.my_project.beer_report"
[0m04:52:35.263268 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cb9911d-ee91-4c06-b91f-31413d8c8cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9bc750bf0>]}
[0m04:52:35.265331 [debug] [Thread-1 (]: Finished running node model.my_project.abv_ibu
[0m04:52:35.266740 [info ] [Thread-2 (]: 8 of 10 OK created sql table model dev_dev.type_by_year ........................ [[32mSELECT 12[0m in 1.19s]
[0m04:52:35.267820 [debug] [Thread-4 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
drop table if exists "db"."dev"."beer_report__dbt_backup" cascade
[0m04:52:35.269365 [info ] [Thread-3 (]: 7 of 10 OK created sql table model dev_dev.beer_released ....................... [[32mSELECT 5[0m in 1.20s]
[0m04:52:35.270779 [debug] [Thread-1 (]: Began running node model.my_project.master_beer_table
[0m04:52:35.272441 [debug] [Thread-2 (]: Finished running node model.my_project.type_by_year
[0m04:52:35.274243 [debug] [Thread-3 (]: Finished running node model.my_project.beer_released
[0m04:52:35.275182 [info ] [Thread-1 (]: 10 of 10 START sql table model dev.master_beer_table ........................... [RUN]
[0m04:52:35.277501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.abv_ibu, now model.my_project.master_beer_table)
[0m04:52:35.278634 [debug] [Thread-1 (]: Began compiling node model.my_project.master_beer_table
[0m04:52:35.285605 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.master_beer_table"
[0m04:52:35.286943 [debug] [Thread-1 (]: Began executing node model.my_project.master_beer_table
[0m04:52:35.292737 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.master_beer_table"
[0m04:52:35.293822 [debug] [Thread-1 (]: Using postgres connection "model.my_project.master_beer_table"
[0m04:52:35.294562 [debug] [Thread-1 (]: On model.my_project.master_beer_table: BEGIN
[0m04:52:35.295095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:52:35.311715 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m04:52:35.313016 [debug] [Thread-1 (]: Using postgres connection "model.my_project.master_beer_table"
[0m04:52:35.314224 [debug] [Thread-1 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */

  
    

  create  table "db"."dev"."master_beer_table__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    beer_id,
    beer_name,
    tagline as category,         -- category/style approximation
    description,
    abv as alcohol_percent,
    first_brewed
from beers
  );
  
[0m04:52:35.321122 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.006 seconds
[0m04:52:35.328540 [debug] [Thread-1 (]: Using postgres connection "model.my_project.master_beer_table"
[0m04:52:35.329994 [debug] [Thread-1 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */
alter table "db"."dev"."master_beer_table" rename to "master_beer_table__dbt_backup"
[0m04:52:35.331807 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:52:35.339228 [debug] [Thread-1 (]: Using postgres connection "model.my_project.master_beer_table"
[0m04:52:35.340470 [debug] [Thread-1 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */
alter table "db"."dev"."master_beer_table__dbt_tmp" rename to "master_beer_table"
[0m04:52:35.343221 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:52:35.347159 [debug] [Thread-1 (]: On model.my_project.master_beer_table: COMMIT
[0m04:52:35.348343 [debug] [Thread-1 (]: Using postgres connection "model.my_project.master_beer_table"
[0m04:52:35.349094 [debug] [Thread-1 (]: On model.my_project.master_beer_table: COMMIT
[0m04:52:35.396630 [debug] [Thread-1 (]: SQL status: COMMIT in 0.046 seconds
[0m04:52:35.397818 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.124 seconds
[0m04:52:35.404503 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."master_beer_table__dbt_backup"
[0m04:52:35.408437 [debug] [Thread-4 (]: On model.my_project.beer_report: Close
[0m04:52:35.410143 [debug] [Thread-1 (]: Using postgres connection "model.my_project.master_beer_table"
[0m04:52:35.411369 [debug] [Thread-1 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */
drop table if exists "db"."dev"."master_beer_table__dbt_backup" cascade
[0m04:52:35.412578 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cb9911d-ee91-4c06-b91f-31413d8c8cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9bc610e00>]}
[0m04:52:35.414494 [info ] [Thread-4 (]: 9 of 10 OK created sql table model dev.beer_report ............................. [[32mSELECT 1[0m in 0.91s]
[0m04:52:35.416009 [debug] [Thread-4 (]: Finished running node model.my_project.beer_report
[0m04:52:35.421377 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m04:52:35.425358 [debug] [Thread-1 (]: On model.my_project.master_beer_table: Close
[0m04:52:35.428690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cb9911d-ee91-4c06-b91f-31413d8c8cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9bc7ce990>]}
[0m04:52:35.431136 [info ] [Thread-1 (]: 10 of 10 OK created sql table model dev.master_beer_table ...................... [[32mSELECT 414[0m in 0.15s]
[0m04:52:35.433208 [debug] [Thread-1 (]: Finished running node model.my_project.master_beer_table
[0m04:52:35.437177 [debug] [MainThread]: Using postgres connection "master"
[0m04:52:35.437876 [debug] [MainThread]: On master: BEGIN
[0m04:52:35.438496 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:52:35.454848 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m04:52:35.455972 [debug] [MainThread]: On master: COMMIT
[0m04:52:35.456931 [debug] [MainThread]: Using postgres connection "master"
[0m04:52:35.457529 [debug] [MainThread]: On master: COMMIT
[0m04:52:35.458346 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:52:35.458885 [debug] [MainThread]: On master: Close
[0m04:52:35.460280 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:52:35.461452 [debug] [MainThread]: Connection 'model.my_project.type_by_year' was properly closed.
[0m04:52:35.462548 [debug] [MainThread]: Connection 'model.my_project.master_beer_table' was properly closed.
[0m04:52:35.463563 [debug] [MainThread]: Connection 'model.my_project.beer_released' was properly closed.
[0m04:52:35.464806 [debug] [MainThread]: Connection 'model.my_project.beer_report' was properly closed.
[0m04:52:35.466447 [info ] [MainThread]: 
[0m04:52:35.468642 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 3.40 seconds (3.40s).
[0m04:52:35.475616 [debug] [MainThread]: Command end result
[0m04:52:35.536011 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m04:52:35.538547 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m04:52:35.553658 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m04:52:35.554724 [info ] [MainThread]: 
[0m04:52:35.555858 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:52:35.557065 [info ] [MainThread]: 
[0m04:52:35.559270 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m04:52:35.563003 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.7839804, "process_in_blocks": "2696", "process_kernel_time": 0.883274, "process_mem_max_rss": "111044", "process_out_blocks": "3776", "process_user_time": 5.056947}
[0m04:52:35.564855 [debug] [MainThread]: Command `dbt run` succeeded at 04:52:35.564279 after 5.79 seconds
[0m04:52:35.566795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c24f3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c1a027b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c2510f80>]}
[0m04:52:35.568118 [debug] [MainThread]: Flushing usage events
[0m04:52:37.209524 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:23:51.944743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78237cff3170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78237d62ab40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78237da16840>]}


============================== 05:23:51.955712 | a3a1bde0-3b12-40ba-af00-ac88e27e61ac ==============================
[0m05:23:51.955712 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:23:51.956665 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:23:52.511858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3a1bde0-3b12-40ba-af00-ac88e27e61ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78237d050c20>]}
[0m05:23:52.616329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3a1bde0-3b12-40ba-af00-ac88e27e61ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78237cfb3aa0>]}
[0m05:23:52.617594 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:23:52.850677 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:23:53.157261 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:23:53.158027 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:23:53.279119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3a1bde0-3b12-40ba-af00-ac88e27e61ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78237ce8a540>]}
[0m05:23:53.480994 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:23:53.486531 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:23:53.773671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3a1bde0-3b12-40ba-af00-ac88e27e61ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78237b443380>]}
[0m05:23:53.774745 [info ] [MainThread]: Found 10 models, 6 data tests, 5 sources, 429 macros
[0m05:23:53.775453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3a1bde0-3b12-40ba-af00-ac88e27e61ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78237cf870b0>]}
[0m05:23:53.780682 [info ] [MainThread]: 
[0m05:23:53.781653 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:23:53.782799 [info ] [MainThread]: 
[0m05:23:53.784500 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:23:53.797767 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:23:53.810354 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:23:53.919628 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:23:53.920286 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:23:53.920806 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:23:53.921417 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:23:53.922093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:23:53.922670 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:23:54.023274 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.100 seconds
[0m05:23:54.023858 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.102 seconds
[0m05:23:54.025882 [debug] [ThreadPool]: On list_db: Close
[0m05:23:54.027789 [debug] [ThreadPool]: On list_db: Close
[0m05:23:54.033876 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m05:23:54.035000 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev_dev)
[0m05:23:54.045286 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:23:54.047799 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m05:23:54.048459 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m05:23:54.049103 [debug] [ThreadPool]: On list_db_dev_dev: BEGIN
[0m05:23:54.049779 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:23:54.050464 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:23:54.067956 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m05:23:54.068992 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m05:23:54.069784 [debug] [ThreadPool]: On list_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_dev'
  
[0m05:23:54.070419 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m05:23:54.071260 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:23:54.072137 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m05:23:54.106424 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.033 seconds
[0m05:23:54.107125 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.036 seconds
[0m05:23:54.109472 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m05:23:54.111820 [debug] [ThreadPool]: On list_db_dev_dev: ROLLBACK
[0m05:23:54.112978 [debug] [ThreadPool]: On list_db_dev: Close
[0m05:23:54.113621 [debug] [ThreadPool]: On list_db_dev_dev: Close
[0m05:23:53.973516 [debug] [MainThread]: Using postgres connection "master"
[0m05:23:53.974165 [debug] [MainThread]: On master: BEGIN
[0m05:23:53.974630 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:23:53.988174 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m05:23:53.989182 [debug] [MainThread]: Using postgres connection "master"
[0m05:23:53.990173 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:23:54.011278 [debug] [MainThread]: SQL status: SELECT 0 in 0.020 seconds
[0m05:23:54.013576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3a1bde0-3b12-40ba-af00-ac88e27e61ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78237b2b7800>]}
[0m05:23:54.014290 [debug] [MainThread]: On master: ROLLBACK
[0m05:23:54.015100 [debug] [MainThread]: Using postgres connection "master"
[0m05:23:54.015597 [debug] [MainThread]: On master: BEGIN
[0m05:23:54.016871 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:23:54.017700 [debug] [MainThread]: On master: COMMIT
[0m05:23:54.018528 [debug] [MainThread]: Using postgres connection "master"
[0m05:23:54.019304 [debug] [MainThread]: On master: COMMIT
[0m05:23:54.020474 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:23:54.021002 [debug] [MainThread]: On master: Close
[0m05:23:54.026605 [debug] [Thread-1 (]: Began running node model.my_project.beer_types
[0m05:23:54.027528 [debug] [Thread-2 (]: Began running node model.my_project.food_pairing
[0m05:23:54.028772 [debug] [Thread-3 (]: Began running node model.my_project.staging
[0m05:23:54.030942 [debug] [Thread-4 (]: Began running node model.my_project.top_hops
[0m05:23:54.036152 [info ] [Thread-4 (]: 4 of 10 START sql table model dev_dev.top_hops ................................. [RUN]
[0m05:23:54.037492 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.top_hops'
[0m05:23:54.034796 [info ] [Thread-3 (]: 3 of 10 START sql table model dev.staging ...................................... [RUN]
[0m05:23:54.038669 [debug] [Thread-4 (]: Began compiling node model.my_project.top_hops
[0m05:23:54.030137 [info ] [Thread-1 (]: 1 of 10 START sql table model dev_dev.beer_types ............................... [RUN]
[0m05:23:54.033285 [info ] [Thread-2 (]: 2 of 10 START sql table model dev_dev.food_pairing ............................. [RUN]
[0m05:23:54.040295 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.staging'
[0m05:23:54.054113 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.top_hops"
[0m05:23:54.054923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev_dev, now model.my_project.beer_types)
[0m05:23:54.055796 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.food_pairing)
[0m05:23:54.056605 [debug] [Thread-3 (]: Began compiling node model.my_project.staging
[0m05:23:54.057934 [debug] [Thread-1 (]: Began compiling node model.my_project.beer_types
[0m05:23:54.059157 [debug] [Thread-2 (]: Began compiling node model.my_project.food_pairing
[0m05:23:54.060360 [debug] [Thread-4 (]: Began executing node model.my_project.top_hops
[0m05:23:54.065741 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.staging"
[0m05:23:54.070118 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.beer_types"
[0m05:23:54.076605 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_project.food_pairing"
[0m05:23:54.121661 [debug] [Thread-3 (]: Began executing node model.my_project.staging
[0m05:23:54.129141 [debug] [Thread-1 (]: Began executing node model.my_project.beer_types
[0m05:23:54.163052 [debug] [Thread-2 (]: Began executing node model.my_project.food_pairing
[0m05:23:54.170569 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.top_hops"
[0m05:23:54.176667 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.staging"
[0m05:23:54.181471 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.beer_types"
[0m05:23:54.187997 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_project.food_pairing"
[0m05:23:54.190307 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_hops"
[0m05:23:54.191841 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m05:23:54.192617 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m05:23:54.193522 [debug] [Thread-4 (]: On model.my_project.top_hops: BEGIN
[0m05:23:54.194430 [debug] [Thread-3 (]: On model.my_project.staging: BEGIN
[0m05:23:54.195181 [debug] [Thread-1 (]: On model.my_project.beer_types: BEGIN
[0m05:23:54.195889 [debug] [Thread-2 (]: Using postgres connection "model.my_project.food_pairing"
[0m05:23:54.196584 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:23:54.197308 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:23:54.198007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:23:54.198803 [debug] [Thread-2 (]: On model.my_project.food_pairing: BEGIN
[0m05:23:54.200987 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:23:54.218237 [debug] [Thread-4 (]: SQL status: BEGIN in 0.022 seconds
[0m05:23:54.219582 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_hops"
[0m05:23:54.221310 [debug] [Thread-3 (]: SQL status: BEGIN in 0.024 seconds
[0m05:23:54.222773 [debug] [Thread-4 (]: On model.my_project.top_hops: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_hops"} */

  
    

  create  table "db"."dev_dev"."top_hops__dbt_tmp"
  
  
    as
  
  (
    

select
    hop_name,
    count(distinct beer_id) as beers_with_hop
from "db"."dev"."hop_ingredients"
where hop_name is not null
group by hop_name
order by beers_with_hop desc
  );
  
[0m05:23:54.223924 [debug] [Thread-2 (]: SQL status: BEGIN in 0.023 seconds
[0m05:23:54.227317 [debug] [Thread-2 (]: Using postgres connection "model.my_project.food_pairing"
[0m05:23:54.226000 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m05:23:54.228473 [debug] [Thread-2 (]: On model.my_project.food_pairing: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.food_pairing"} */

  
    

  create  table "db"."dev_dev"."food_pairing__dbt_tmp"
  
  
    as
  
  (
    

select
    pairing,
    count(*) as pairing_count
from "db"."dev"."food_pairings"
where pairing is not null
group by pairing
order by pairing_count desc
  );
  
[0m05:23:54.225096 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m05:23:54.229779 [debug] [Thread-3 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * 
    from "db"."dev"."raw_beer_data"
)

select 
    id,
    beer_id,
    name as beer_name,
    tagline,
    first_brewed,
    description,
    image,
    abv,
    ibu,
    ebc,
    ph,
    brewers_tips,
    contributed_by,
    inserted_at
from source
  );
  
[0m05:23:54.231323 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m05:23:54.232886 [debug] [Thread-1 (]: On model.my_project.beer_types: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_types"} */

  
    

  create  table "db"."dev_dev"."beer_types__dbt_tmp"
  
  
    as
  
  (
    

select
    beer_id,
    name,
    tagline,
    first_brewed,
    abv,
    ibu,
    ebc,
    ph,
    case
        when lower(tagline) like '%lager%' then 'Lager'
        when lower(tagline) like '%pilsner%' then 'Lager'
        when lower(tagline) like '%ipa%' then 'Ale'
        when lower(tagline) like '%stout%' then 'Ale'
        when lower(tagline) like '%porter%' then 'Ale'
        when lower(tagline) like '%ale%' then 'Ale'
        when lower(tagline) like '%wheat%' then 'Ale'
        else 'Other'
    end as type
from "db"."dev"."raw_beer_data"
  );
  
[0m05:23:53.547518 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.223 seconds
[0m05:23:53.548401 [debug] [Thread-3 (]: SQL status: SELECT 414 in 0.225 seconds
[0m05:23:53.560217 [debug] [Thread-2 (]: SQL status: SELECT 1149 in 0.238 seconds
[0m05:23:53.563425 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m05:23:53.568529 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m05:23:53.575582 [debug] [Thread-4 (]: SQL status: SELECT 178 in 0.257 seconds
[0m05:23:53.577295 [debug] [Thread-2 (]: Using postgres connection "model.my_project.food_pairing"
[0m05:23:53.578452 [debug] [Thread-1 (]: On model.my_project.beer_types: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_types"} */
alter table "db"."dev_dev"."beer_types" rename to "beer_types__dbt_backup"
[0m05:23:53.579640 [debug] [Thread-3 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m05:23:53.587398 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_hops"
[0m05:23:53.588123 [debug] [Thread-2 (]: On model.my_project.food_pairing: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.food_pairing"} */
alter table "db"."dev_dev"."food_pairing" rename to "food_pairing__dbt_backup"
[0m05:23:53.589416 [debug] [Thread-4 (]: On model.my_project.top_hops: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_hops"} */
alter table "db"."dev_dev"."top_hops" rename to "top_hops__dbt_backup"
[0m05:23:53.590505 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m05:23:53.591320 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m05:23:53.596403 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m05:23:53.597458 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m05:23:53.598029 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m05:23:53.602241 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m05:23:53.603312 [debug] [Thread-1 (]: On model.my_project.beer_types: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_types"} */
alter table "db"."dev_dev"."beer_types__dbt_tmp" rename to "beer_types"
[0m05:23:53.607573 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_hops"
[0m05:23:53.611936 [debug] [Thread-2 (]: Using postgres connection "model.my_project.food_pairing"
[0m05:23:53.612799 [debug] [Thread-3 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m05:23:53.613812 [debug] [Thread-4 (]: On model.my_project.top_hops: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_hops"} */
alter table "db"."dev_dev"."top_hops__dbt_tmp" rename to "top_hops"
[0m05:23:53.614822 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:23:53.615592 [debug] [Thread-2 (]: On model.my_project.food_pairing: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.food_pairing"} */
alter table "db"."dev_dev"."food_pairing__dbt_tmp" rename to "food_pairing"
[0m05:23:53.622082 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m05:23:53.622890 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m05:23:53.635913 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m05:23:53.662680 [debug] [Thread-1 (]: On model.my_project.beer_types: COMMIT
[0m05:23:53.663930 [debug] [Thread-3 (]: On model.my_project.staging: COMMIT
[0m05:23:53.667692 [debug] [Thread-4 (]: On model.my_project.top_hops: COMMIT
[0m05:23:53.672447 [debug] [Thread-2 (]: On model.my_project.food_pairing: COMMIT
[0m05:23:53.674128 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m05:23:53.675633 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m05:23:53.677007 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_hops"
[0m05:23:53.678268 [debug] [Thread-2 (]: Using postgres connection "model.my_project.food_pairing"
[0m05:23:53.679195 [debug] [Thread-1 (]: On model.my_project.beer_types: COMMIT
[0m05:23:53.679944 [debug] [Thread-3 (]: On model.my_project.staging: COMMIT
[0m05:23:53.680581 [debug] [Thread-4 (]: On model.my_project.top_hops: COMMIT
[0m05:23:53.681260 [debug] [Thread-2 (]: On model.my_project.food_pairing: COMMIT
[0m05:23:53.722620 [debug] [Thread-1 (]: SQL status: COMMIT in 0.040 seconds
[0m05:23:53.738907 [debug] [Thread-1 (]: Applying DROP to: "db"."dev_dev"."beer_types__dbt_backup"
[0m05:23:53.739818 [debug] [Thread-3 (]: SQL status: COMMIT in 0.057 seconds
[0m05:23:53.740492 [debug] [Thread-4 (]: SQL status: COMMIT in 0.058 seconds
[0m05:23:53.741066 [debug] [Thread-2 (]: SQL status: COMMIT in 0.058 seconds
[0m05:23:53.753124 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m05:23:53.756255 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m05:23:53.760260 [debug] [Thread-4 (]: Applying DROP to: "db"."dev_dev"."top_hops__dbt_backup"
[0m05:23:53.763818 [debug] [Thread-2 (]: Applying DROP to: "db"."dev_dev"."food_pairing__dbt_backup"
[0m05:23:53.764592 [debug] [Thread-1 (]: On model.my_project.beer_types: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_types"} */
drop table if exists "db"."dev_dev"."beer_types__dbt_backup" cascade
[0m05:23:53.765675 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m05:23:53.766878 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_hops"
[0m05:23:53.767943 [debug] [Thread-2 (]: Using postgres connection "model.my_project.food_pairing"
[0m05:23:53.768907 [debug] [Thread-3 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m05:23:53.769918 [debug] [Thread-4 (]: On model.my_project.top_hops: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_hops"} */
drop table if exists "db"."dev_dev"."top_hops__dbt_backup" cascade
[0m05:23:53.770783 [debug] [Thread-2 (]: On model.my_project.food_pairing: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.food_pairing"} */
drop table if exists "db"."dev_dev"."food_pairing__dbt_backup" cascade
[0m05:23:53.904193 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.132 seconds
[0m05:23:53.911488 [debug] [Thread-4 (]: On model.my_project.top_hops: Close
[0m05:23:53.912855 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.141 seconds
[0m05:23:53.917167 [debug] [Thread-2 (]: On model.my_project.food_pairing: Close
[0m05:23:53.914566 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.143 seconds
[0m05:23:53.913820 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.145 seconds
[0m05:23:53.924915 [debug] [Thread-3 (]: On model.my_project.staging: Close
[0m05:23:53.926001 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3a1bde0-3b12-40ba-af00-ac88e27e61ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782379caf8c0>]}
[0m05:23:53.926923 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3a1bde0-3b12-40ba-af00-ac88e27e61ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78237b443dd0>]}
[0m05:23:53.930305 [debug] [Thread-1 (]: On model.my_project.beer_types: Close
[0m05:23:53.932356 [info ] [Thread-4 (]: 4 of 10 OK created sql table model dev_dev.top_hops ............................ [[32mSELECT 178[0m in -0.12s]
[0m05:23:53.934103 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3a1bde0-3b12-40ba-af00-ac88e27e61ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78237b2d33e0>]}
[0m05:23:53.935968 [info ] [Thread-2 (]: 2 of 10 OK created sql table model dev_dev.food_pairing ........................ [[32mSELECT 1149[0m in -0.13s]
[0m05:23:53.938468 [debug] [Thread-4 (]: Finished running node model.my_project.top_hops
[0m05:23:53.939986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3a1bde0-3b12-40ba-af00-ac88e27e61ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782379d132c0>]}
[0m05:23:53.943472 [info ] [Thread-3 (]: 3 of 10 OK created sql table model dev.staging ................................. [[32mSELECT 414[0m in -0.11s]
[0m05:23:53.946290 [debug] [Thread-2 (]: Finished running node model.my_project.food_pairing
[0m05:23:53.948955 [debug] [Thread-4 (]: Began running node model.my_project.top_malts
[0m05:23:53.951431 [info ] [Thread-1 (]: 1 of 10 OK created sql table model dev_dev.beer_types .......................... [[32mSELECT 414[0m in -0.12s]
[0m05:23:53.954027 [debug] [Thread-3 (]: Finished running node model.my_project.staging
[0m05:23:53.955831 [info ] [Thread-4 (]: 5 of 10 START sql table model dev_dev.top_malts ................................ [RUN]
[0m05:23:53.957406 [debug] [Thread-1 (]: Finished running node model.my_project.beer_types
[0m05:23:53.959477 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_project.top_hops, now model.my_project.top_malts)
[0m05:23:53.960486 [debug] [Thread-2 (]: Began running node model.my_project.beer_report
[0m05:23:53.962008 [debug] [Thread-3 (]: Began running node model.my_project.master_beer_table
[0m05:23:53.964885 [debug] [Thread-4 (]: Began compiling node model.my_project.top_malts
[0m05:23:53.965912 [debug] [Thread-1 (]: Began running node model.my_project.abv_ibu
[0m05:23:53.966976 [info ] [Thread-2 (]: 6 of 10 START sql table model dev.beer_report .................................. [RUN]
[0m05:23:53.968610 [info ] [Thread-3 (]: 7 of 10 START sql table model dev.master_beer_table ............................ [RUN]
[0m05:23:53.977487 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.top_malts"
[0m05:23:53.979520 [info ] [Thread-1 (]: 8 of 10 START sql table model dev_dev.abv_ibu .................................. [RUN]
[0m05:23:53.981270 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_project.food_pairing, now model.my_project.beer_report)
[0m05:23:53.983113 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_project.staging, now model.my_project.master_beer_table)
[0m05:23:53.984873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.beer_types, now model.my_project.abv_ibu)
[0m05:23:53.985944 [debug] [Thread-2 (]: Began compiling node model.my_project.beer_report
[0m05:23:53.986856 [debug] [Thread-4 (]: Began executing node model.my_project.top_malts
[0m05:23:53.987711 [debug] [Thread-3 (]: Began compiling node model.my_project.master_beer_table
[0m05:23:53.988496 [debug] [Thread-1 (]: Began compiling node model.my_project.abv_ibu
[0m05:23:53.995979 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_project.beer_report"
[0m05:23:54.002634 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.top_malts"
[0m05:23:54.006689 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.master_beer_table"
[0m05:23:54.011072 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.abv_ibu"
[0m05:23:54.013875 [debug] [Thread-2 (]: Began executing node model.my_project.beer_report
[0m05:23:54.015926 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_malts"
[0m05:23:54.016588 [debug] [Thread-3 (]: Began executing node model.my_project.master_beer_table
[0m05:23:54.021531 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_project.beer_report"
[0m05:23:54.022441 [debug] [Thread-4 (]: On model.my_project.top_malts: BEGIN
[0m05:23:54.023123 [debug] [Thread-1 (]: Began executing node model.my_project.abv_ibu
[0m05:23:54.027819 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.master_beer_table"
[0m05:23:54.029049 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m05:23:54.040993 [debug] [Thread-2 (]: Using postgres connection "model.my_project.beer_report"
[0m05:23:54.041776 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.abv_ibu"
[0m05:23:54.043982 [debug] [Thread-2 (]: On model.my_project.beer_report: BEGIN
[0m05:23:54.045328 [debug] [Thread-3 (]: Using postgres connection "model.my_project.master_beer_table"
[0m05:23:54.048800 [debug] [Thread-3 (]: On model.my_project.master_beer_table: BEGIN
[0m05:23:54.047354 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:23:54.049946 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m05:23:54.051182 [debug] [Thread-1 (]: Using postgres connection "model.my_project.abv_ibu"
[0m05:23:54.053400 [debug] [Thread-1 (]: On model.my_project.abv_ibu: BEGIN
[0m05:23:54.054623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:23:54.063172 [debug] [Thread-4 (]: SQL status: BEGIN in 0.034 seconds
[0m05:23:54.064076 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_malts"
[0m05:23:54.064857 [debug] [Thread-4 (]: On model.my_project.top_malts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_malts"} */

  
    

  create  table "db"."dev_dev"."top_malts__dbt_tmp"
  
  
    as
  
  (
    

select
    malt_name,
    count(distinct beer_id) as beers_with_malt
from "db"."dev"."malt_ingredients"
where malt_name is not null
group by malt_name
order by beers_with_malt desc
  );
  
[0m05:23:54.075537 [debug] [Thread-3 (]: SQL status: BEGIN in 0.025 seconds
[0m05:23:54.076996 [debug] [Thread-3 (]: Using postgres connection "model.my_project.master_beer_table"
[0m05:23:54.078769 [debug] [Thread-3 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */

  
    

  create  table "db"."dev"."master_beer_table__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    beer_id,
    beer_name,
    tagline as category,         -- category/style approximation
    description,
    abv as alcohol_percent,
    first_brewed
from beers
  );
  
[0m05:23:54.082511 [debug] [Thread-2 (]: SQL status: BEGIN in 0.035 seconds
[0m05:23:54.084199 [debug] [Thread-2 (]: Using postgres connection "model.my_project.beer_report"
[0m05:23:54.085795 [debug] [Thread-2 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */

  
    

  create  table "db"."dev"."beer_report__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    count(*) as total_beers,
    round(avg(abv)::numeric, 2) as avg_abv,
    round(min(abv)::numeric, 2) as min_abv,
    round(max(abv)::numeric, 2) as max_abv,
    round(avg(ibu)::numeric, 2) as avg_ibu,
    round(min(ibu)::numeric, 2) as min_ibu,
    round(max(ibu)::numeric, 2) as max_ibu,
    round(avg(ebc)::numeric, 2) as avg_ebc,
    round(min(ebc)::numeric, 2) as min_ebc,
    round(max(ebc)::numeric, 2) as max_ebc,
    round(avg(ph)::numeric, 2) as avg_ph,
    min(first_brewed) as oldest_brew,
    max(first_brewed) as newest_brew,
    count(distinct contributed_by) as unique_contributors
from beers
  );
  
[0m05:23:54.087587 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m05:23:54.089446 [debug] [Thread-1 (]: Using postgres connection "model.my_project.abv_ibu"
[0m05:23:54.091079 [debug] [Thread-1 (]: On model.my_project.abv_ibu: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.abv_ibu"} */

  
    

  create  table "db"."dev_dev"."abv_ibu__dbt_tmp"
  
  
    as
  
  (
    

select
    abv,
    ibu,
    type
from "db"."dev_dev"."beer_types"
where abv is not null and ibu is not null
  );
  
[0m05:23:54.094564 [debug] [Thread-3 (]: SQL status: SELECT 414 in 0.014 seconds
[0m05:23:54.104136 [debug] [Thread-1 (]: SQL status: SELECT 409 in 0.012 seconds
[0m05:23:54.103219 [debug] [Thread-3 (]: Using postgres connection "model.my_project.master_beer_table"
[0m05:23:54.104977 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.018 seconds
[0m05:23:54.109311 [debug] [Thread-1 (]: Using postgres connection "model.my_project.abv_ibu"
[0m05:23:54.109941 [debug] [Thread-4 (]: SQL status: SELECT 133 in 0.044 seconds
[0m05:23:54.110566 [debug] [Thread-3 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */
alter table "db"."dev"."master_beer_table" rename to "master_beer_table__dbt_backup"
[0m05:23:54.114639 [debug] [Thread-2 (]: Using postgres connection "model.my_project.beer_report"
[0m05:23:54.115613 [debug] [Thread-1 (]: On model.my_project.abv_ibu: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.abv_ibu"} */
alter table "db"."dev_dev"."abv_ibu" rename to "abv_ibu__dbt_backup"
[0m05:23:54.121056 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_malts"
[0m05:23:54.122198 [debug] [Thread-2 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report" rename to "beer_report__dbt_backup"
[0m05:23:54.123159 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:23:54.124253 [debug] [Thread-4 (]: On model.my_project.top_malts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_malts"} */
alter table "db"."dev_dev"."top_malts" rename to "top_malts__dbt_backup"
[0m05:23:54.131468 [debug] [Thread-3 (]: Using postgres connection "model.my_project.master_beer_table"
[0m05:23:54.132291 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m05:23:54.133197 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m05:23:54.134420 [debug] [Thread-3 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */
alter table "db"."dev"."master_beer_table__dbt_tmp" rename to "master_beer_table"
[0m05:23:54.135078 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:23:54.139213 [debug] [Thread-2 (]: Using postgres connection "model.my_project.beer_report"
[0m05:23:54.143529 [debug] [Thread-1 (]: Using postgres connection "model.my_project.abv_ibu"
[0m05:23:54.148219 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_malts"
[0m05:23:54.149004 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m05:23:54.149613 [debug] [Thread-2 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report__dbt_tmp" rename to "beer_report"
[0m05:23:54.150616 [debug] [Thread-1 (]: On model.my_project.abv_ibu: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.abv_ibu"} */
alter table "db"."dev_dev"."abv_ibu__dbt_tmp" rename to "abv_ibu"
[0m05:23:54.151773 [debug] [Thread-4 (]: On model.my_project.top_malts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_malts"} */
alter table "db"."dev_dev"."top_malts__dbt_tmp" rename to "top_malts"
[0m05:23:54.154557 [debug] [Thread-3 (]: On model.my_project.master_beer_table: COMMIT
[0m05:23:54.156158 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:23:54.157160 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:23:54.157941 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m05:23:54.158492 [debug] [Thread-3 (]: Using postgres connection "model.my_project.master_beer_table"
[0m05:23:54.161317 [debug] [Thread-2 (]: On model.my_project.beer_report: COMMIT
[0m05:23:54.163887 [debug] [Thread-4 (]: On model.my_project.top_malts: COMMIT
[0m05:23:54.168151 [debug] [Thread-1 (]: On model.my_project.abv_ibu: COMMIT
[0m05:23:54.169978 [debug] [Thread-3 (]: On model.my_project.master_beer_table: COMMIT
[0m05:23:54.171301 [debug] [Thread-2 (]: Using postgres connection "model.my_project.beer_report"
[0m05:23:54.172698 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_malts"
[0m05:23:54.173828 [debug] [Thread-1 (]: Using postgres connection "model.my_project.abv_ibu"
[0m05:23:54.180305 [debug] [Thread-1 (]: On model.my_project.abv_ibu: COMMIT
[0m05:23:54.178873 [debug] [Thread-4 (]: On model.my_project.top_malts: COMMIT
[0m05:23:54.176761 [debug] [Thread-2 (]: On model.my_project.beer_report: COMMIT
[0m05:23:54.331883 [debug] [Thread-3 (]: SQL status: COMMIT in 0.157 seconds
[0m05:23:54.340154 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."master_beer_table__dbt_backup"
[0m05:23:54.343508 [debug] [Thread-3 (]: Using postgres connection "model.my_project.master_beer_table"
[0m05:23:54.345401 [debug] [Thread-3 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */
drop table if exists "db"."dev"."master_beer_table__dbt_backup" cascade
[0m05:23:54.347719 [debug] [Thread-4 (]: SQL status: COMMIT in 0.166 seconds
[0m05:23:54.349497 [debug] [Thread-2 (]: SQL status: COMMIT in 0.166 seconds
[0m05:23:54.350618 [debug] [Thread-1 (]: SQL status: COMMIT in 0.169 seconds
[0m05:23:54.357458 [debug] [Thread-4 (]: Applying DROP to: "db"."dev_dev"."top_malts__dbt_backup"
[0m05:23:54.371842 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_malts"
[0m05:23:54.364433 [debug] [Thread-2 (]: Applying DROP to: "db"."dev"."beer_report__dbt_backup"
[0m05:23:54.358746 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.007 seconds
[0m05:23:54.372592 [debug] [Thread-4 (]: On model.my_project.top_malts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_malts"} */
drop table if exists "db"."dev_dev"."top_malts__dbt_backup" cascade
[0m05:23:54.375125 [debug] [Thread-1 (]: Applying DROP to: "db"."dev_dev"."abv_ibu__dbt_backup"
[0m05:23:54.382884 [debug] [Thread-1 (]: Using postgres connection "model.my_project.abv_ibu"
[0m05:23:54.383908 [debug] [Thread-1 (]: On model.my_project.abv_ibu: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.abv_ibu"} */
drop table if exists "db"."dev_dev"."abv_ibu__dbt_backup" cascade
[0m05:23:54.377011 [debug] [Thread-2 (]: Using postgres connection "model.my_project.beer_report"
[0m05:23:54.380798 [debug] [Thread-3 (]: On model.my_project.master_beer_table: Close
[0m05:23:54.386389 [debug] [Thread-2 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
drop table if exists "db"."dev"."beer_report__dbt_backup" cascade
[0m05:23:54.390890 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3a1bde0-3b12-40ba-af00-ac88e27e61ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7823783da090>]}
[0m05:23:54.392325 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.010 seconds
[0m05:23:54.395537 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.011 seconds
[0m05:23:54.394542 [info ] [Thread-3 (]: 7 of 10 OK created sql table model dev.master_beer_table ....................... [[32mSELECT 414[0m in 0.41s]
[0m05:23:54.406820 [debug] [Thread-3 (]: Finished running node model.my_project.master_beer_table
[0m05:23:54.400317 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.007 seconds
[0m05:23:54.408197 [debug] [Thread-3 (]: Began running node model.my_project.beer_released
[0m05:23:54.399378 [debug] [Thread-4 (]: On model.my_project.top_malts: Close
[0m05:23:54.404903 [debug] [Thread-1 (]: On model.my_project.abv_ibu: Close
[0m05:23:54.413945 [debug] [Thread-2 (]: On model.my_project.beer_report: Close
[0m05:23:54.422007 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3a1bde0-3b12-40ba-af00-ac88e27e61ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782379df1010>]}
[0m05:23:54.418267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3a1bde0-3b12-40ba-af00-ac88e27e61ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7823783af7a0>]}
[0m05:23:54.420134 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3a1bde0-3b12-40ba-af00-ac88e27e61ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7823783adf40>]}
[0m05:23:54.415834 [info ] [Thread-3 (]: 9 of 10 START sql table model dev_dev.beer_released ............................ [RUN]
[0m05:23:54.437765 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_project.master_beer_table, now model.my_project.beer_released)
[0m05:23:54.438999 [debug] [Thread-3 (]: Began compiling node model.my_project.beer_released
[0m05:23:54.428416 [info ] [Thread-2 (]: 6 of 10 OK created sql table model dev.beer_report ............................. [[32mSELECT 1[0m in 0.44s]
[0m05:23:54.432005 [info ] [Thread-1 (]: 8 of 10 OK created sql table model dev_dev.abv_ibu ............................. [[32mSELECT 409[0m in 0.43s]
[0m05:23:54.455498 [debug] [Thread-1 (]: Finished running node model.my_project.abv_ibu
[0m05:23:54.456566 [debug] [Thread-1 (]: Began running node model.my_project.type_by_year
[0m05:23:54.453353 [debug] [Thread-2 (]: Finished running node model.my_project.beer_report
[0m05:23:54.433898 [info ] [Thread-4 (]: 5 of 10 OK created sql table model dev_dev.top_malts ........................... [[32mSELECT 133[0m in 0.46s]
[0m05:23:54.451512 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.beer_released"
[0m05:23:54.465412 [debug] [Thread-3 (]: Began executing node model.my_project.beer_released
[0m05:23:54.457861 [info ] [Thread-1 (]: 10 of 10 START sql table model dev_dev.type_by_year ............................ [RUN]
[0m05:23:54.462669 [debug] [Thread-4 (]: Finished running node model.my_project.top_malts
[0m05:23:54.474286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.abv_ibu, now model.my_project.type_by_year)
[0m05:23:54.484653 [debug] [Thread-1 (]: Began compiling node model.my_project.type_by_year
[0m05:23:54.482645 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.beer_released"
[0m05:23:54.493705 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_released"
[0m05:23:54.502639 [debug] [Thread-3 (]: On model.my_project.beer_released: BEGIN
[0m05:23:54.509293 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.type_by_year"
[0m05:23:54.512094 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m05:23:54.517155 [debug] [Thread-1 (]: Began executing node model.my_project.type_by_year
[0m05:23:54.528247 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.type_by_year"
[0m05:23:54.534358 [debug] [Thread-1 (]: Using postgres connection "model.my_project.type_by_year"
[0m05:23:54.535995 [debug] [Thread-1 (]: On model.my_project.type_by_year: BEGIN
[0m05:23:54.536781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:23:54.539931 [debug] [Thread-3 (]: SQL status: BEGIN in 0.027 seconds
[0m05:23:54.541979 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_released"
[0m05:23:54.542872 [debug] [Thread-3 (]: On model.my_project.beer_released: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_released"} */

  
    

  create  table "db"."dev_dev"."beer_released__dbt_tmp"
  
  
    as
  
  (
    

select
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4) as year,
    count(*) as beer_count
from "db"."dev_dev"."beer_types"
where
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4) ~ '^\d{4}$'
group by year
order by year
  );
  
[0m05:23:54.558460 [debug] [Thread-3 (]: SQL status: SELECT 5 in 0.014 seconds
[0m05:23:54.572812 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_released"
[0m05:23:54.573919 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m05:23:54.575185 [debug] [Thread-3 (]: On model.my_project.beer_released: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_released"} */
alter table "db"."dev_dev"."beer_released" rename to "beer_released__dbt_backup"
[0m05:23:54.576454 [debug] [Thread-1 (]: Using postgres connection "model.my_project.type_by_year"
[0m05:23:54.577349 [debug] [Thread-1 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */

  
    

  create  table "db"."dev_dev"."type_by_year__dbt_tmp"
  
  
    as
  
  (
    

select
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4) as year,
    type,
    count(*) as beer_count
from "db"."dev_dev"."beer_types"
where
    -- Only keep non-null, non-empty years and ensure first 4 chars are digits
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4) ~ '^\d{4}$'
group by
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4),
    type
order by
    year,
    type
  );
  
[0m05:23:54.578180 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:23:54.588960 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_released"
[0m05:23:54.589951 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.011 seconds
[0m05:23:54.590960 [debug] [Thread-3 (]: On model.my_project.beer_released: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_released"} */
alter table "db"."dev_dev"."beer_released__dbt_tmp" rename to "beer_released"
[0m05:23:54.598026 [debug] [Thread-1 (]: Using postgres connection "model.my_project.type_by_year"
[0m05:23:54.599172 [debug] [Thread-1 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */
alter table "db"."dev_dev"."type_by_year" rename to "type_by_year__dbt_backup"
[0m05:23:54.600256 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:23:54.604847 [debug] [Thread-3 (]: On model.my_project.beer_released: COMMIT
[0m05:23:54.605650 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m05:23:54.606352 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_released"
[0m05:23:54.610668 [debug] [Thread-1 (]: Using postgres connection "model.my_project.type_by_year"
[0m05:23:54.611491 [debug] [Thread-3 (]: On model.my_project.beer_released: COMMIT
[0m05:23:54.612117 [debug] [Thread-1 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */
alter table "db"."dev_dev"."type_by_year__dbt_tmp" rename to "type_by_year"
[0m05:23:54.613526 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:23:54.616046 [debug] [Thread-1 (]: On model.my_project.type_by_year: COMMIT
[0m05:23:54.616914 [debug] [Thread-1 (]: Using postgres connection "model.my_project.type_by_year"
[0m05:23:54.617546 [debug] [Thread-1 (]: On model.my_project.type_by_year: COMMIT
[0m05:23:54.618214 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m05:23:54.623804 [debug] [Thread-3 (]: Applying DROP to: "db"."dev_dev"."beer_released__dbt_backup"
[0m05:23:54.624672 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m05:23:54.625892 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_released"
[0m05:23:54.629242 [debug] [Thread-1 (]: Applying DROP to: "db"."dev_dev"."type_by_year__dbt_backup"
[0m05:23:54.629956 [debug] [Thread-3 (]: On model.my_project.beer_released: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_released"} */
drop table if exists "db"."dev_dev"."beer_released__dbt_backup" cascade
[0m05:23:54.631029 [debug] [Thread-1 (]: Using postgres connection "model.my_project.type_by_year"
[0m05:23:54.631988 [debug] [Thread-1 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */
drop table if exists "db"."dev_dev"."type_by_year__dbt_backup" cascade
[0m05:23:54.637908 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m05:23:54.640470 [debug] [Thread-3 (]: On model.my_project.beer_released: Close
[0m05:23:54.641824 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3a1bde0-3b12-40ba-af00-ac88e27e61ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782379d31340>]}
[0m05:23:54.642683 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m05:23:54.643663 [info ] [Thread-3 (]: 9 of 10 OK created sql table model dev_dev.beer_released ....................... [[32mSELECT 5[0m in 0.20s]
[0m05:23:54.647152 [debug] [Thread-1 (]: On model.my_project.type_by_year: Close
[0m05:23:54.648495 [debug] [Thread-3 (]: Finished running node model.my_project.beer_released
[0m05:23:54.650061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3a1bde0-3b12-40ba-af00-ac88e27e61ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782379e03ef0>]}
[0m05:23:54.651593 [info ] [Thread-1 (]: 10 of 10 OK created sql table model dev_dev.type_by_year ....................... [[32mSELECT 12[0m in 0.18s]
[0m05:23:54.654754 [debug] [Thread-1 (]: Finished running node model.my_project.type_by_year
[0m05:23:54.658765 [debug] [MainThread]: Using postgres connection "master"
[0m05:23:54.659733 [debug] [MainThread]: On master: BEGIN
[0m05:23:54.660655 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:23:54.681598 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m05:23:54.682688 [debug] [MainThread]: On master: COMMIT
[0m05:23:54.683854 [debug] [MainThread]: Using postgres connection "master"
[0m05:23:54.684707 [debug] [MainThread]: On master: COMMIT
[0m05:23:54.685574 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:23:54.686380 [debug] [MainThread]: On master: Close
[0m05:23:54.687855 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:23:54.689031 [debug] [MainThread]: Connection 'model.my_project.beer_report' was properly closed.
[0m05:23:54.690213 [debug] [MainThread]: Connection 'model.my_project.type_by_year' was properly closed.
[0m05:23:54.691330 [debug] [MainThread]: Connection 'model.my_project.top_malts' was properly closed.
[0m05:23:54.692127 [debug] [MainThread]: Connection 'model.my_project.beer_released' was properly closed.
[0m05:23:54.692864 [info ] [MainThread]: 
[0m05:23:54.693524 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m05:23:54.698801 [debug] [MainThread]: Command end result
[0m05:23:54.761449 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:23:54.764349 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:23:54.775072 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:23:54.775655 [info ] [MainThread]: 
[0m05:23:54.776479 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:23:54.778159 [info ] [MainThread]: 
[0m05:23:54.779699 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m05:23:54.901753 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.17985, "process_in_blocks": "29312", "process_kernel_time": 1.15606, "process_mem_max_rss": "109128", "process_out_blocks": "2168", "process_user_time": 5.163215}
[0m05:23:54.902742 [debug] [MainThread]: Command `dbt run` succeeded at 05:23:54.902511 after 4.18 seconds
[0m05:23:54.903400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78237e2382f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78237b618440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78237d8e7b30>]}
[0m05:23:54.904013 [debug] [MainThread]: Flushing usage events
[0m05:23:56.615200 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:51:40.740911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73200f7671a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73200e96e840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73200f7661b0>]}


============================== 05:51:40.757529 | 98fa8d47-7716-4350-b900-ea08cd16c2fe ==============================
[0m05:51:40.757529 [info ] [MainThread]: Running with dbt=1.9.0
[0m05:51:40.758561 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:51:41.170205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98fa8d47-7716-4350-b900-ea08cd16c2fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73200ca0f7a0>]}
[0m05:51:41.272472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98fa8d47-7716-4350-b900-ea08cd16c2fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7320100d0260>]}
[0m05:51:41.273776 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:51:41.429063 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m05:51:41.645011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:51:41.645532 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:51:41.716666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98fa8d47-7716-4350-b900-ea08cd16c2fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73200ca85d90>]}
[0m05:51:41.866407 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:51:41.871223 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:51:42.026571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98fa8d47-7716-4350-b900-ea08cd16c2fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73200c5d6900>]}
[0m05:51:42.027376 [info ] [MainThread]: Found 10 models, 6 data tests, 5 sources, 429 macros
[0m05:51:42.028057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98fa8d47-7716-4350-b900-ea08cd16c2fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73200c796990>]}
[0m05:51:42.032158 [info ] [MainThread]: 
[0m05:51:42.032877 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:51:42.033545 [info ] [MainThread]: 
[0m05:51:42.034808 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:51:42.042323 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:51:42.043828 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m05:51:42.168138 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:51:42.169012 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m05:51:42.170054 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:51:42.170852 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m05:51:42.171555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:51:42.172281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:51:42.194771 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.023 seconds
[0m05:51:42.196981 [debug] [ThreadPool]: On list_db: Close
[0m05:51:42.203528 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.031 seconds
[0m05:51:42.206408 [debug] [ThreadPool]: On list_db: Close
[0m05:51:42.212461 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m05:51:42.213610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev_dev)
[0m05:51:42.222599 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:51:42.225388 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m05:51:42.226084 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m05:51:42.226716 [debug] [ThreadPool]: On list_db_dev_dev: BEGIN
[0m05:51:42.227339 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:51:42.228124 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:51:42.242214 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m05:51:42.243127 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m05:51:42.244246 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m05:51:42.259675 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.015 seconds
[0m05:51:42.262858 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m05:51:42.263570 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m05:51:42.264352 [debug] [ThreadPool]: On list_db_dev: Close
[0m05:51:42.265060 [debug] [ThreadPool]: Using postgres connection "list_db_dev_dev"
[0m05:51:42.266314 [debug] [ThreadPool]: On list_db_dev_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_dev'
  
[0m05:51:42.275505 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m05:51:42.278607 [debug] [ThreadPool]: On list_db_dev_dev: ROLLBACK
[0m05:51:42.279541 [debug] [ThreadPool]: On list_db_dev_dev: Close
[0m05:51:42.291631 [debug] [MainThread]: Using postgres connection "master"
[0m05:51:42.292327 [debug] [MainThread]: On master: BEGIN
[0m05:51:42.292782 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:51:42.307023 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m05:51:42.307763 [debug] [MainThread]: Using postgres connection "master"
[0m05:51:42.308858 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:51:42.323545 [debug] [MainThread]: SQL status: SELECT 0 in 0.014 seconds
[0m05:51:42.326028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98fa8d47-7716-4350-b900-ea08cd16c2fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73200b15ca70>]}
[0m05:51:42.326774 [debug] [MainThread]: On master: ROLLBACK
[0m05:51:42.327695 [debug] [MainThread]: Using postgres connection "master"
[0m05:51:42.328351 [debug] [MainThread]: On master: BEGIN
[0m05:51:42.329344 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:51:42.329833 [debug] [MainThread]: On master: COMMIT
[0m05:51:42.330424 [debug] [MainThread]: Using postgres connection "master"
[0m05:51:42.331156 [debug] [MainThread]: On master: COMMIT
[0m05:51:42.331982 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:51:42.332560 [debug] [MainThread]: On master: Close
[0m05:51:42.338800 [debug] [Thread-1 (]: Began running node model.my_project.beer_types
[0m05:51:42.339644 [debug] [Thread-2 (]: Began running node model.my_project.food_pairing
[0m05:51:42.341660 [debug] [Thread-3 (]: Began running node model.my_project.staging
[0m05:51:42.340649 [info ] [Thread-1 (]: 1 of 10 START sql table model dev_dev.beer_types ............................... [RUN]
[0m05:51:42.342946 [debug] [Thread-4 (]: Began running node model.my_project.top_hops
[0m05:51:42.344170 [info ] [Thread-2 (]: 2 of 10 START sql table model dev_dev.food_pairing ............................. [RUN]
[0m05:51:42.345323 [info ] [Thread-3 (]: 3 of 10 START sql table model dev.staging ...................................... [RUN]
[0m05:51:42.346311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev_dev, now model.my_project.beer_types)
[0m05:51:42.347162 [info ] [Thread-4 (]: 4 of 10 START sql table model dev_dev.top_hops ................................. [RUN]
[0m05:51:42.348090 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.food_pairing)
[0m05:51:42.348897 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.staging'
[0m05:51:42.349594 [debug] [Thread-1 (]: Began compiling node model.my_project.beer_types
[0m05:51:42.350453 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.top_hops'
[0m05:51:42.351101 [debug] [Thread-2 (]: Began compiling node model.my_project.food_pairing
[0m05:51:42.351863 [debug] [Thread-3 (]: Began compiling node model.my_project.staging
[0m05:51:42.362718 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.beer_types"
[0m05:51:42.363603 [debug] [Thread-4 (]: Began compiling node model.my_project.top_hops
[0m05:51:42.367640 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_project.food_pairing"
[0m05:51:42.371733 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.staging"
[0m05:51:42.377422 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.top_hops"
[0m05:51:42.378513 [debug] [Thread-1 (]: Began executing node model.my_project.beer_types
[0m05:51:42.380133 [debug] [Thread-2 (]: Began executing node model.my_project.food_pairing
[0m05:51:42.392087 [debug] [Thread-4 (]: Began executing node model.my_project.top_hops
[0m05:51:42.392673 [debug] [Thread-3 (]: Began executing node model.my_project.staging
[0m05:51:42.638173 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.top_hops"
[0m05:51:42.634179 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.beer_types"
[0m05:51:42.640512 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.staging"
[0m05:51:42.645261 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_project.food_pairing"
[0m05:51:42.647408 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_hops"
[0m05:51:42.649106 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m05:51:42.649960 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m05:51:42.651353 [debug] [Thread-4 (]: On model.my_project.top_hops: BEGIN
[0m05:51:42.652590 [debug] [Thread-1 (]: On model.my_project.beer_types: BEGIN
[0m05:51:42.653638 [debug] [Thread-2 (]: Using postgres connection "model.my_project.food_pairing"
[0m05:51:42.654542 [debug] [Thread-3 (]: On model.my_project.staging: BEGIN
[0m05:51:42.655539 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m05:51:42.656729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:51:42.657778 [debug] [Thread-2 (]: On model.my_project.food_pairing: BEGIN
[0m05:51:42.658791 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:51:42.661048 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:51:42.677960 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m05:51:42.679294 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m05:51:42.680135 [debug] [Thread-1 (]: On model.my_project.beer_types: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_types"} */

  
    

  create  table "db"."dev_dev"."beer_types__dbt_tmp"
  
  
    as
  
  (
    

select
    beer_id,
    name,
    tagline,
    first_brewed,
    abv,
    ibu,
    ebc,
    ph,
    case
        when lower(tagline) like '%lager%' then 'Lager'
        when lower(tagline) like '%pilsner%' then 'Lager'
        when lower(tagline) like '%ipa%' then 'Ale'
        when lower(tagline) like '%stout%' then 'Ale'
        when lower(tagline) like '%porter%' then 'Ale'
        when lower(tagline) like '%ale%' then 'Ale'
        when lower(tagline) like '%wheat%' then 'Ale'
        else 'Other'
    end as type
from "db"."dev"."raw_beer_data"
  );
  
[0m05:51:42.682410 [debug] [Thread-3 (]: SQL status: BEGIN in 0.024 seconds
[0m05:51:42.683131 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m05:51:42.683887 [debug] [Thread-3 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * 
    from "db"."dev"."raw_beer_data"
)

select 
    id,
    beer_id,
    name as beer_name,
    tagline,
    first_brewed,
    description,
    image,
    abv,
    ibu,
    ebc,
    ph,
    brewers_tips,
    contributed_by,
    inserted_at
from source
  );
  
[0m05:51:42.689373 [debug] [Thread-4 (]: SQL status: BEGIN in 0.034 seconds
[0m05:51:42.690434 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_hops"
[0m05:51:42.691529 [debug] [Thread-4 (]: On model.my_project.top_hops: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_hops"} */

  
    

  create  table "db"."dev_dev"."top_hops__dbt_tmp"
  
  
    as
  
  (
    

select
    hop_name,
    count(distinct beer_id) as beers_with_hop
from "db"."dev"."hop_ingredients"
where hop_name is not null
group by hop_name
order by beers_with_hop desc
  );
  
[0m05:51:42.695659 [debug] [Thread-2 (]: SQL status: BEGIN in 0.033 seconds
[0m05:51:42.697152 [debug] [Thread-2 (]: Using postgres connection "model.my_project.food_pairing"
[0m05:51:42.698535 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.017 seconds
[0m05:51:42.700484 [debug] [Thread-2 (]: On model.my_project.food_pairing: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.food_pairing"} */

  
    

  create  table "db"."dev_dev"."food_pairing__dbt_tmp"
  
  
    as
  
  (
    

select
    pairing,
    count(*) as pairing_count
from "db"."dev"."food_pairings"
where pairing is not null
group by pairing
order by pairing_count desc
  );
  
[0m05:51:42.702202 [debug] [Thread-3 (]: SQL status: SELECT 414 in 0.018 seconds
[0m05:51:42.719377 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m05:51:42.730891 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m05:51:42.731898 [debug] [Thread-1 (]: On model.my_project.beer_types: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_types"} */
alter table "db"."dev_dev"."beer_types" rename to "beer_types__dbt_backup"
[0m05:51:42.732674 [debug] [Thread-3 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging" rename to "staging__dbt_backup"
[0m05:51:42.734154 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:51:42.734718 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:51:42.739035 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m05:51:42.743501 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m05:51:42.744212 [debug] [Thread-2 (]: SQL status: SELECT 1149 in 0.022 seconds
[0m05:51:42.744772 [debug] [Thread-4 (]: SQL status: SELECT 178 in 0.052 seconds
[0m05:51:42.745377 [debug] [Thread-3 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m05:51:42.745995 [debug] [Thread-1 (]: On model.my_project.beer_types: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_types"} */
alter table "db"."dev_dev"."beer_types__dbt_tmp" rename to "beer_types"
[0m05:51:42.749933 [debug] [Thread-2 (]: Using postgres connection "model.my_project.food_pairing"
[0m05:51:42.754270 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_hops"
[0m05:51:42.755258 [debug] [Thread-2 (]: On model.my_project.food_pairing: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.food_pairing"} */
alter table "db"."dev_dev"."food_pairing" rename to "food_pairing__dbt_backup"
[0m05:51:42.755840 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:51:42.756581 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:51:42.757218 [debug] [Thread-4 (]: On model.my_project.top_hops: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_hops"} */
alter table "db"."dev_dev"."top_hops" rename to "top_hops__dbt_backup"
[0m05:51:42.763455 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m05:51:42.807758 [debug] [Thread-3 (]: On model.my_project.staging: COMMIT
[0m05:51:42.808572 [debug] [Thread-1 (]: On model.my_project.beer_types: COMMIT
[0m05:51:42.812756 [debug] [Thread-2 (]: Using postgres connection "model.my_project.food_pairing"
[0m05:51:42.813469 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m05:51:42.813993 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m05:51:42.814657 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m05:51:42.815331 [debug] [Thread-2 (]: On model.my_project.food_pairing: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.food_pairing"} */
alter table "db"."dev_dev"."food_pairing__dbt_tmp" rename to "food_pairing"
[0m05:51:42.819167 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_hops"
[0m05:51:42.819947 [debug] [Thread-3 (]: On model.my_project.staging: COMMIT
[0m05:51:42.820621 [debug] [Thread-1 (]: On model.my_project.beer_types: COMMIT
[0m05:51:42.821558 [debug] [Thread-4 (]: On model.my_project.top_hops: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_hops"} */
alter table "db"."dev_dev"."top_hops__dbt_tmp" rename to "top_hops"
[0m05:51:42.822322 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:51:42.825775 [debug] [Thread-2 (]: On model.my_project.food_pairing: COMMIT
[0m05:51:42.826448 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m05:51:42.827047 [debug] [Thread-2 (]: Using postgres connection "model.my_project.food_pairing"
[0m05:51:42.829242 [debug] [Thread-4 (]: On model.my_project.top_hops: COMMIT
[0m05:51:42.829951 [debug] [Thread-2 (]: On model.my_project.food_pairing: COMMIT
[0m05:51:42.830687 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_hops"
[0m05:51:42.831569 [debug] [Thread-4 (]: On model.my_project.top_hops: COMMIT
[0m05:51:42.953610 [debug] [Thread-3 (]: SQL status: COMMIT in 0.130 seconds
[0m05:51:42.965040 [debug] [Thread-2 (]: SQL status: COMMIT in 0.133 seconds
[0m05:51:42.980644 [debug] [Thread-4 (]: SQL status: COMMIT in 0.148 seconds
[0m05:51:43.008434 [debug] [Thread-1 (]: SQL status: COMMIT in 0.185 seconds
[0m05:51:43.040679 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m05:51:43.042793 [debug] [Thread-2 (]: Applying DROP to: "db"."dev_dev"."food_pairing__dbt_backup"
[0m05:51:43.045033 [debug] [Thread-4 (]: Applying DROP to: "db"."dev_dev"."top_hops__dbt_backup"
[0m05:51:43.056581 [debug] [Thread-1 (]: Applying DROP to: "db"."dev_dev"."beer_types__dbt_backup"
[0m05:51:43.128597 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_hops"
[0m05:51:43.120535 [debug] [Thread-2 (]: Using postgres connection "model.my_project.food_pairing"
[0m05:51:43.130842 [debug] [Thread-3 (]: Using postgres connection "model.my_project.staging"
[0m05:51:43.133275 [debug] [Thread-1 (]: Using postgres connection "model.my_project.beer_types"
[0m05:51:43.134685 [debug] [Thread-4 (]: On model.my_project.top_hops: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_hops"} */
drop table if exists "db"."dev_dev"."top_hops__dbt_backup" cascade
[0m05:51:43.136089 [debug] [Thread-2 (]: On model.my_project.food_pairing: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.food_pairing"} */
drop table if exists "db"."dev_dev"."food_pairing__dbt_backup" cascade
[0m05:51:43.137422 [debug] [Thread-3 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m05:51:43.138741 [debug] [Thread-1 (]: On model.my_project.beer_types: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_types"} */
drop table if exists "db"."dev_dev"."beer_types__dbt_backup" cascade
[0m05:51:43.148619 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.009 seconds
[0m05:51:43.155690 [debug] [Thread-4 (]: On model.my_project.top_hops: Close
[0m05:51:43.157049 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.017 seconds
[0m05:51:43.158046 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.017 seconds
[0m05:51:43.159002 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.018 seconds
[0m05:51:43.164167 [debug] [Thread-2 (]: On model.my_project.food_pairing: Close
[0m05:51:43.173238 [debug] [Thread-1 (]: On model.my_project.beer_types: Close
[0m05:51:43.174325 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98fa8d47-7716-4350-b900-ea08cd16c2fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73200edfe780>]}
[0m05:51:43.178154 [debug] [Thread-3 (]: On model.my_project.staging: Close
[0m05:51:43.180305 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98fa8d47-7716-4350-b900-ea08cd16c2fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73200b0b0140>]}
[0m05:51:43.182024 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98fa8d47-7716-4350-b900-ea08cd16c2fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73200b0aa120>]}
[0m05:51:43.183715 [info ] [Thread-4 (]: 4 of 10 OK created sql table model dev_dev.top_hops ............................ [[32mSELECT 178[0m in 0.82s]
[0m05:51:43.186434 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98fa8d47-7716-4350-b900-ea08cd16c2fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73200b0aae10>]}
[0m05:51:43.189274 [info ] [Thread-2 (]: 2 of 10 OK created sql table model dev_dev.food_pairing ........................ [[32mSELECT 1149[0m in 0.83s]
[0m05:51:43.191636 [info ] [Thread-1 (]: 1 of 10 OK created sql table model dev_dev.beer_types .......................... [[32mSELECT 414[0m in 0.84s]
[0m05:51:43.194707 [debug] [Thread-4 (]: Finished running node model.my_project.top_hops
[0m05:51:43.196889 [info ] [Thread-3 (]: 3 of 10 OK created sql table model dev.staging ................................. [[32mSELECT 414[0m in 0.84s]
[0m05:51:43.199546 [debug] [Thread-2 (]: Finished running node model.my_project.food_pairing
[0m05:51:43.201282 [debug] [Thread-1 (]: Finished running node model.my_project.beer_types
[0m05:51:43.202804 [debug] [Thread-4 (]: Began running node model.my_project.top_malts
[0m05:51:43.204968 [debug] [Thread-3 (]: Finished running node model.my_project.staging
[0m05:51:43.208236 [info ] [Thread-4 (]: 5 of 10 START sql table model dev_dev.top_malts ................................ [RUN]
[0m05:51:43.210857 [debug] [Thread-2 (]: Began running node model.my_project.abv_ibu
[0m05:51:43.212173 [debug] [Thread-3 (]: Began running node model.my_project.beer_released
[0m05:51:43.213310 [debug] [Thread-1 (]: Began running node model.my_project.type_by_year
[0m05:51:43.215762 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_project.top_hops, now model.my_project.top_malts)
[0m05:51:43.217482 [info ] [Thread-2 (]: 6 of 10 START sql table model dev_dev.abv_ibu .................................. [RUN]
[0m05:51:43.219275 [info ] [Thread-3 (]: 7 of 10 START sql table model dev_dev.beer_released ............................ [RUN]
[0m05:51:43.221224 [info ] [Thread-1 (]: 8 of 10 START sql table model dev_dev.type_by_year ............................. [RUN]
[0m05:51:43.223090 [debug] [Thread-4 (]: Began compiling node model.my_project.top_malts
[0m05:51:43.224978 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_project.food_pairing, now model.my_project.abv_ibu)
[0m05:51:43.226295 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_project.staging, now model.my_project.beer_released)
[0m05:51:43.227808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.beer_types, now model.my_project.type_by_year)
[0m05:51:43.235507 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.top_malts"
[0m05:51:43.236778 [debug] [Thread-2 (]: Began compiling node model.my_project.abv_ibu
[0m05:51:43.237880 [debug] [Thread-3 (]: Began compiling node model.my_project.beer_released
[0m05:51:43.239034 [debug] [Thread-1 (]: Began compiling node model.my_project.type_by_year
[0m05:51:43.246689 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_project.abv_ibu"
[0m05:51:43.248482 [debug] [Thread-4 (]: Began executing node model.my_project.top_malts
[0m05:51:43.257330 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.beer_released"
[0m05:51:43.266214 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.type_by_year"
[0m05:51:43.276892 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.top_malts"
[0m05:51:43.278622 [debug] [Thread-2 (]: Began executing node model.my_project.abv_ibu
[0m05:51:43.280643 [debug] [Thread-3 (]: Began executing node model.my_project.beer_released
[0m05:51:43.292860 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_project.abv_ibu"
[0m05:51:43.294888 [debug] [Thread-1 (]: Began executing node model.my_project.type_by_year
[0m05:51:43.302387 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_malts"
[0m05:51:43.306653 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.beer_released"
[0m05:51:43.316420 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.type_by_year"
[0m05:51:43.317975 [debug] [Thread-4 (]: On model.my_project.top_malts: BEGIN
[0m05:51:43.319186 [debug] [Thread-2 (]: Using postgres connection "model.my_project.abv_ibu"
[0m05:51:43.321894 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_released"
[0m05:51:43.323323 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m05:51:43.324677 [debug] [Thread-1 (]: Using postgres connection "model.my_project.type_by_year"
[0m05:51:43.325972 [debug] [Thread-2 (]: On model.my_project.abv_ibu: BEGIN
[0m05:51:43.327113 [debug] [Thread-3 (]: On model.my_project.beer_released: BEGIN
[0m05:51:43.328714 [debug] [Thread-1 (]: On model.my_project.type_by_year: BEGIN
[0m05:51:43.329977 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:51:43.331071 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m05:51:43.332283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:51:43.361469 [debug] [Thread-3 (]: SQL status: BEGIN in 0.030 seconds
[0m05:51:43.363100 [debug] [Thread-4 (]: SQL status: BEGIN in 0.040 seconds
[0m05:51:43.364749 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_released"
[0m05:51:43.367082 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_malts"
[0m05:51:43.369548 [debug] [Thread-3 (]: On model.my_project.beer_released: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_released"} */

  
    

  create  table "db"."dev_dev"."beer_released__dbt_tmp"
  
  
    as
  
  (
    

select
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4) as year,
    count(*) as beer_count
from "db"."dev_dev"."beer_types"
where
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4) ~ '^\d{4}$'
group by year
order by year
  );
  
[0m05:51:43.372101 [debug] [Thread-2 (]: SQL status: BEGIN in 0.041 seconds
[0m05:51:43.374815 [debug] [Thread-4 (]: On model.my_project.top_malts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_malts"} */

  
    

  create  table "db"."dev_dev"."top_malts__dbt_tmp"
  
  
    as
  
  (
    

select
    malt_name,
    count(distinct beer_id) as beers_with_malt
from "db"."dev"."malt_ingredients"
where malt_name is not null
group by malt_name
order by beers_with_malt desc
  );
  
[0m05:51:43.376881 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m05:51:43.380142 [debug] [Thread-2 (]: Using postgres connection "model.my_project.abv_ibu"
[0m05:51:43.382723 [debug] [Thread-1 (]: Using postgres connection "model.my_project.type_by_year"
[0m05:51:43.385402 [debug] [Thread-2 (]: On model.my_project.abv_ibu: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.abv_ibu"} */

  
    

  create  table "db"."dev_dev"."abv_ibu__dbt_tmp"
  
  
    as
  
  (
    

select
    abv,
    ibu,
    type
from "db"."dev_dev"."beer_types"
where abv is not null and ibu is not null
  );
  
[0m05:51:43.388660 [debug] [Thread-1 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */

  
    

  create  table "db"."dev_dev"."type_by_year__dbt_tmp"
  
  
    as
  
  (
    

select
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4) as year,
    type,
    count(*) as beer_count
from "db"."dev_dev"."beer_types"
where
    -- Only keep non-null, non-empty years and ensure first 4 chars are digits
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4) ~ '^\d{4}$'
group by
    left(coalesce(nullif(trim(first_brewed),''), '0000'), 4),
    type
order by
    year,
    type
  );
  
[0m05:51:43.392087 [debug] [Thread-3 (]: SQL status: SELECT 5 in 0.013 seconds
[0m05:51:43.403142 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_released"
[0m05:51:43.404747 [debug] [Thread-3 (]: On model.my_project.beer_released: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_released"} */
alter table "db"."dev_dev"."beer_released" rename to "beer_released__dbt_backup"
[0m05:51:43.407704 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:51:43.409190 [debug] [Thread-2 (]: SQL status: SELECT 409 in 0.019 seconds
[0m05:51:43.410786 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.020 seconds
[0m05:51:43.418165 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_released"
[0m05:51:43.419519 [debug] [Thread-4 (]: SQL status: SELECT 133 in 0.037 seconds
[0m05:51:43.427602 [debug] [Thread-2 (]: Using postgres connection "model.my_project.abv_ibu"
[0m05:51:43.435119 [debug] [Thread-1 (]: Using postgres connection "model.my_project.type_by_year"
[0m05:51:43.436307 [debug] [Thread-3 (]: On model.my_project.beer_released: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_released"} */
alter table "db"."dev_dev"."beer_released__dbt_tmp" rename to "beer_released"
[0m05:51:43.443653 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_malts"
[0m05:51:43.444964 [debug] [Thread-2 (]: On model.my_project.abv_ibu: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.abv_ibu"} */
alter table "db"."dev_dev"."abv_ibu" rename to "abv_ibu__dbt_backup"
[0m05:51:43.446077 [debug] [Thread-1 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */
alter table "db"."dev_dev"."type_by_year" rename to "type_by_year__dbt_backup"
[0m05:51:43.447842 [debug] [Thread-4 (]: On model.my_project.top_malts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_malts"} */
alter table "db"."dev_dev"."top_malts" rename to "top_malts__dbt_backup"
[0m05:51:43.449118 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m05:51:43.455087 [debug] [Thread-3 (]: On model.my_project.beer_released: COMMIT
[0m05:51:43.456749 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_released"
[0m05:51:43.458136 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m05:51:43.459270 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m05:51:43.460530 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m05:51:43.461602 [debug] [Thread-3 (]: On model.my_project.beer_released: COMMIT
[0m05:51:43.469605 [debug] [Thread-1 (]: Using postgres connection "model.my_project.type_by_year"
[0m05:51:43.476839 [debug] [Thread-2 (]: Using postgres connection "model.my_project.abv_ibu"
[0m05:51:43.484958 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_malts"
[0m05:51:43.486375 [debug] [Thread-1 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */
alter table "db"."dev_dev"."type_by_year__dbt_tmp" rename to "type_by_year"
[0m05:51:43.487614 [debug] [Thread-2 (]: On model.my_project.abv_ibu: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.abv_ibu"} */
alter table "db"."dev_dev"."abv_ibu__dbt_tmp" rename to "abv_ibu"
[0m05:51:43.488923 [debug] [Thread-4 (]: On model.my_project.top_malts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_malts"} */
alter table "db"."dev_dev"."top_malts__dbt_tmp" rename to "top_malts"
[0m05:51:43.490992 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:51:43.492173 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:51:43.493164 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m05:51:43.494274 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m05:51:43.499338 [debug] [Thread-1 (]: On model.my_project.type_by_year: COMMIT
[0m05:51:43.504615 [debug] [Thread-4 (]: On model.my_project.top_malts: COMMIT
[0m05:51:43.508965 [debug] [Thread-2 (]: On model.my_project.abv_ibu: COMMIT
[0m05:51:43.515153 [debug] [Thread-3 (]: Applying DROP to: "db"."dev_dev"."beer_released__dbt_backup"
[0m05:51:43.516512 [debug] [Thread-1 (]: Using postgres connection "model.my_project.type_by_year"
[0m05:51:43.517770 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_malts"
[0m05:51:43.519055 [debug] [Thread-2 (]: Using postgres connection "model.my_project.abv_ibu"
[0m05:51:43.521149 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_released"
[0m05:51:43.522363 [debug] [Thread-1 (]: On model.my_project.type_by_year: COMMIT
[0m05:51:43.523522 [debug] [Thread-4 (]: On model.my_project.top_malts: COMMIT
[0m05:51:43.524942 [debug] [Thread-2 (]: On model.my_project.abv_ibu: COMMIT
[0m05:51:43.526174 [debug] [Thread-3 (]: On model.my_project.beer_released: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_released"} */
drop table if exists "db"."dev_dev"."beer_released__dbt_backup" cascade
[0m05:51:43.653851 [debug] [Thread-1 (]: SQL status: COMMIT in 0.126 seconds
[0m05:51:43.674962 [debug] [Thread-1 (]: Applying DROP to: "db"."dev_dev"."type_by_year__dbt_backup"
[0m05:51:43.692339 [debug] [Thread-1 (]: Using postgres connection "model.my_project.type_by_year"
[0m05:51:43.693452 [debug] [Thread-1 (]: On model.my_project.type_by_year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.type_by_year"} */
drop table if exists "db"."dev_dev"."type_by_year__dbt_backup" cascade
[0m05:51:43.746621 [debug] [Thread-4 (]: SQL status: COMMIT in 0.219 seconds
[0m05:51:43.747295 [debug] [Thread-2 (]: SQL status: COMMIT in 0.219 seconds
[0m05:51:43.751599 [debug] [Thread-4 (]: Applying DROP to: "db"."dev_dev"."top_malts__dbt_backup"
[0m05:51:43.752542 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.224 seconds
[0m05:51:43.753233 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.059 seconds
[0m05:51:43.757815 [debug] [Thread-2 (]: Applying DROP to: "db"."dev_dev"."abv_ibu__dbt_backup"
[0m05:51:43.760195 [debug] [Thread-4 (]: Using postgres connection "model.my_project.top_malts"
[0m05:51:43.763934 [debug] [Thread-3 (]: On model.my_project.beer_released: Close
[0m05:51:43.766170 [debug] [Thread-1 (]: On model.my_project.type_by_year: Close
[0m05:51:43.767312 [debug] [Thread-2 (]: Using postgres connection "model.my_project.abv_ibu"
[0m05:51:43.768099 [debug] [Thread-4 (]: On model.my_project.top_malts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.top_malts"} */
drop table if exists "db"."dev_dev"."top_malts__dbt_backup" cascade
[0m05:51:43.769565 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98fa8d47-7716-4350-b900-ea08cd16c2fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73200b0aeb40>]}
[0m05:51:43.770747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98fa8d47-7716-4350-b900-ea08cd16c2fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73200c7a7ef0>]}
[0m05:51:43.771808 [debug] [Thread-2 (]: On model.my_project.abv_ibu: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.abv_ibu"} */
drop table if exists "db"."dev_dev"."abv_ibu__dbt_backup" cascade
[0m05:51:43.773518 [info ] [Thread-3 (]: 7 of 10 OK created sql table model dev_dev.beer_released ....................... [[32mSELECT 5[0m in 0.54s]
[0m05:51:43.774900 [info ] [Thread-1 (]: 8 of 10 OK created sql table model dev_dev.type_by_year ........................ [[32mSELECT 12[0m in 0.54s]
[0m05:51:43.776539 [debug] [Thread-3 (]: Finished running node model.my_project.beer_released
[0m05:51:43.777594 [debug] [Thread-1 (]: Finished running node model.my_project.type_by_year
[0m05:51:43.778396 [debug] [Thread-3 (]: Began running node model.my_project.beer_report
[0m05:51:43.779019 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m05:51:43.779968 [debug] [Thread-1 (]: Began running node model.my_project.master_beer_table
[0m05:51:43.781067 [info ] [Thread-3 (]: 9 of 10 START sql table model dev.beer_report .................................. [RUN]
[0m05:51:43.783481 [debug] [Thread-4 (]: On model.my_project.top_malts: Close
[0m05:51:43.784153 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.008 seconds
[0m05:51:43.784921 [info ] [Thread-1 (]: 10 of 10 START sql table model dev.master_beer_table ........................... [RUN]
[0m05:51:43.785917 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_project.beer_released, now model.my_project.beer_report)
[0m05:51:43.786990 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98fa8d47-7716-4350-b900-ea08cd16c2fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73200b073ad0>]}
[0m05:51:43.789216 [debug] [Thread-2 (]: On model.my_project.abv_ibu: Close
[0m05:51:43.789957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.type_by_year, now model.my_project.master_beer_table)
[0m05:51:43.790691 [debug] [Thread-3 (]: Began compiling node model.my_project.beer_report
[0m05:51:43.791741 [info ] [Thread-4 (]: 5 of 10 OK created sql table model dev_dev.top_malts ........................... [[32mSELECT 133[0m in 0.57s]
[0m05:51:43.792834 [debug] [Thread-1 (]: Began compiling node model.my_project.master_beer_table
[0m05:51:43.793629 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98fa8d47-7716-4350-b900-ea08cd16c2fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73200b15dc40>]}
[0m05:51:43.800186 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.beer_report"
[0m05:51:43.801194 [debug] [Thread-4 (]: Finished running node model.my_project.top_malts
[0m05:51:43.804989 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.master_beer_table"
[0m05:51:43.806094 [info ] [Thread-2 (]: 6 of 10 OK created sql table model dev_dev.abv_ibu ............................. [[32mSELECT 409[0m in 0.57s]
[0m05:51:43.808401 [debug] [Thread-2 (]: Finished running node model.my_project.abv_ibu
[0m05:51:43.809151 [debug] [Thread-3 (]: Began executing node model.my_project.beer_report
[0m05:51:43.813945 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.beer_report"
[0m05:51:43.814559 [debug] [Thread-1 (]: Began executing node model.my_project.master_beer_table
[0m05:51:43.818730 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.master_beer_table"
[0m05:51:43.819726 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m05:51:43.820427 [debug] [Thread-1 (]: Using postgres connection "model.my_project.master_beer_table"
[0m05:51:43.821035 [debug] [Thread-3 (]: On model.my_project.beer_report: BEGIN
[0m05:51:43.821636 [debug] [Thread-1 (]: On model.my_project.master_beer_table: BEGIN
[0m05:51:43.822383 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m05:51:43.823188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:51:43.837094 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m05:51:43.837816 [debug] [Thread-1 (]: Using postgres connection "model.my_project.master_beer_table"
[0m05:51:43.839099 [debug] [Thread-1 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */

  
    

  create  table "db"."dev"."master_beer_table__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    beer_id,
    beer_name,
    tagline as category,         -- category/style approximation
    description,
    abv as alcohol_percent,
    first_brewed
from beers
  );
  
[0m05:51:43.839790 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m05:51:43.840804 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m05:51:43.841594 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */

  
    

  create  table "db"."dev"."beer_report__dbt_tmp"
  
  
    as
  
  (
    

with beers as (
    select * from "db"."dev"."staging"
)

select
    count(*) as total_beers,
    round(avg(abv)::numeric, 2) as avg_abv,
    round(min(abv)::numeric, 2) as min_abv,
    round(max(abv)::numeric, 2) as max_abv,
    round(avg(ibu)::numeric, 2) as avg_ibu,
    round(min(ibu)::numeric, 2) as min_ibu,
    round(max(ibu)::numeric, 2) as max_ibu,
    round(avg(ebc)::numeric, 2) as avg_ebc,
    round(min(ebc)::numeric, 2) as min_ebc,
    round(max(ebc)::numeric, 2) as max_ebc,
    round(avg(ph)::numeric, 2) as avg_ph,
    min(first_brewed) as oldest_brew,
    max(first_brewed) as newest_brew,
    count(distinct contributed_by) as unique_contributors
from beers
  );
  
[0m05:51:43.846790 [debug] [Thread-1 (]: SQL status: SELECT 414 in 0.006 seconds
[0m05:51:43.852958 [debug] [Thread-1 (]: Using postgres connection "model.my_project.master_beer_table"
[0m05:51:43.853561 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m05:51:43.854483 [debug] [Thread-1 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */
alter table "db"."dev"."master_beer_table" rename to "master_beer_table__dbt_backup"
[0m05:51:43.859064 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m05:51:43.860191 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report" rename to "beer_report__dbt_backup"
[0m05:51:43.860777 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:51:43.864938 [debug] [Thread-1 (]: Using postgres connection "model.my_project.master_beer_table"
[0m05:51:43.865475 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m05:51:43.866144 [debug] [Thread-1 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */
alter table "db"."dev"."master_beer_table__dbt_tmp" rename to "master_beer_table"
[0m05:51:43.869890 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m05:51:43.870815 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
alter table "db"."dev"."beer_report__dbt_tmp" rename to "beer_report"
[0m05:51:43.871358 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:51:43.873963 [debug] [Thread-1 (]: On model.my_project.master_beer_table: COMMIT
[0m05:51:43.874661 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m05:51:43.875230 [debug] [Thread-1 (]: Using postgres connection "model.my_project.master_beer_table"
[0m05:51:43.877467 [debug] [Thread-3 (]: On model.my_project.beer_report: COMMIT
[0m05:51:43.878197 [debug] [Thread-1 (]: On model.my_project.master_beer_table: COMMIT
[0m05:51:43.878881 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m05:51:43.879715 [debug] [Thread-3 (]: On model.my_project.beer_report: COMMIT
[0m05:51:43.884446 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m05:51:43.887580 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."master_beer_table__dbt_backup"
[0m05:51:43.888373 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m05:51:43.889327 [debug] [Thread-1 (]: Using postgres connection "model.my_project.master_beer_table"
[0m05:51:43.892414 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."beer_report__dbt_backup"
[0m05:51:43.893216 [debug] [Thread-1 (]: On model.my_project.master_beer_table: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.master_beer_table"} */
drop table if exists "db"."dev"."master_beer_table__dbt_backup" cascade
[0m05:51:43.894262 [debug] [Thread-3 (]: Using postgres connection "model.my_project.beer_report"
[0m05:51:43.895071 [debug] [Thread-3 (]: On model.my_project.beer_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.beer_report"} */
drop table if exists "db"."dev"."beer_report__dbt_backup" cascade
[0m05:51:43.901289 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m05:51:43.903303 [debug] [Thread-1 (]: On model.my_project.master_beer_table: Close
[0m05:51:43.904223 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98fa8d47-7716-4350-b900-ea08cd16c2fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73200b0abd40>]}
[0m05:51:43.904761 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.009 seconds
[0m05:51:43.906049 [info ] [Thread-1 (]: 10 of 10 OK created sql table model dev.master_beer_table ...................... [[32mSELECT 414[0m in 0.11s]
[0m05:51:43.909286 [debug] [Thread-3 (]: On model.my_project.beer_report: Close
[0m05:51:43.910398 [debug] [Thread-1 (]: Finished running node model.my_project.master_beer_table
[0m05:51:43.911935 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98fa8d47-7716-4350-b900-ea08cd16c2fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732008796420>]}
[0m05:51:43.912800 [info ] [Thread-3 (]: 9 of 10 OK created sql table model dev.beer_report ............................. [[32mSELECT 1[0m in 0.13s]
[0m05:51:43.914021 [debug] [Thread-3 (]: Finished running node model.my_project.beer_report
[0m05:51:43.917123 [debug] [MainThread]: Using postgres connection "master"
[0m05:51:43.917660 [debug] [MainThread]: On master: BEGIN
[0m05:51:43.918109 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:51:43.937344 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m05:51:43.938059 [debug] [MainThread]: On master: COMMIT
[0m05:51:43.938536 [debug] [MainThread]: Using postgres connection "master"
[0m05:51:43.939075 [debug] [MainThread]: On master: COMMIT
[0m05:51:43.940099 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:51:43.940640 [debug] [MainThread]: On master: Close
[0m05:51:43.941401 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:51:43.941833 [debug] [MainThread]: Connection 'model.my_project.abv_ibu' was properly closed.
[0m05:51:43.942240 [debug] [MainThread]: Connection 'model.my_project.master_beer_table' was properly closed.
[0m05:51:43.942671 [debug] [MainThread]: Connection 'model.my_project.beer_report' was properly closed.
[0m05:51:43.943105 [debug] [MainThread]: Connection 'model.my_project.top_malts' was properly closed.
[0m05:51:43.943709 [info ] [MainThread]: 
[0m05:51:43.944356 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 1.91 seconds (1.91s).
[0m05:51:43.948730 [debug] [MainThread]: Command end result
[0m05:51:43.989042 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m05:51:43.991520 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m05:51:44.000748 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m05:51:44.001512 [info ] [MainThread]: 
[0m05:51:44.002536 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:51:44.003542 [info ] [MainThread]: 
[0m05:51:44.004712 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m05:51:44.007357 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.3553069, "process_in_blocks": "24576", "process_kernel_time": 1.472032, "process_mem_max_rss": "110312", "process_out_blocks": "3776", "process_user_time": 4.970088}
[0m05:51:44.008284 [debug] [MainThread]: Command `dbt run` succeeded at 05:51:44.008126 after 3.36 seconds
[0m05:51:44.008806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73200e8658b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73200fc87260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73200b2570e0>]}
[0m05:51:44.009465 [debug] [MainThread]: Flushing usage events
[0m05:51:45.160685 [debug] [MainThread]: An error was encountered while trying to flush usage events
